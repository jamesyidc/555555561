# OKX交易页面仓位配置文档更新

## 更新时间
**2026-02-18 02:00 UTC (10:00 北京时间)**

## 更新内容

### 1. 策略执行流程说明更新（2处）

**位置：** 第1390行、第1414行

**更新前：**
```html
<li><strong>仓位计算：</strong>每个币种用总权益的1.5%（上限5 USDT），10倍杠杆</li>
```

**更新后：**
```html
<li><strong>仓位计算：</strong>每个币种用总权益 × positionSize%（默认1.5%，上限5 USDT），10倍杠杆
    <ul style="margin: 2px 0 0 20px; font-size: 10px; color: #64748b;">
        <li>📝 可在配置文件中设置 positionSize 字段（如 0.5、1.5、3.0）</li>
        <li>💰 计算公式：min(总权益 × positionSize%, 5 USDT)</li>
        <li>🟢 保守：0.5% | 🟡 稳健：1.5% | 🔴 激进：3.0%</li>
        <li>📊 示例（总权益198.64 USDT）：1.5% → 2.98 USDT/币 × 8 = 23.84 USDT</li>
    </ul>
</li>
```

### 2. 配置文件示例说明

**位置：** 第1457行之后

在 `account_main.json` 配置示例后添加了 `positionSize` 字段的详细说明框：

```html
<div style="margin: 8px 0; padding: 8px; background: #dbeafe; border-left: 3px solid #3b82f6;">
    <p style="margin: 0 0 4px 0; font-weight: 600; color: #1e40af;">📊 positionSize 字段说明（v2.6新增）</p>
    <ul>
        <li><strong>作用：</strong>每个币种的开仓金额占总权益的百分比</li>
        <li><strong>默认值：</strong>1.5（即1.5%）</li>
        <li><strong>计算公式：</strong>开仓金额 = min(总权益 × positionSize%, 5 USDT)</li>
        <li><strong>推荐配置：</strong>🟢 保守 0.5% | 🟡 稳健 1.5% | 🔴 激进 3.0%</li>
        <li><strong>示例：</strong>总权益198.64 USDT，positionSize=1.5 → 每币2.98 USDT，8币总计23.84 USDT</li>
        <li><strong>修改方式：</strong>直接编辑JSON文件，保存后下次触发时生效</li>
    </ul>
</div>
```

### 3. 新增"仓位配置指南"章节

**位置：** 第1436行之后（数据存储结构章节之前）

新增了一个完整的"二.五、仓位配置指南"章节，包含：

#### 3.1 配置说明
- positionSize 字段含义
- 默认值和计算公式
- 上限保护机制
- 生效时机

#### 3.2 推荐配置表格

| 风险等级 | positionSize | 每币开仓* | 8币总计* | 占总权益 | 适用场景 |
|---------|--------------|----------|---------|----------|---------|
| 🟢 保守 | 0.5 | 0.99 U | 7.95 U | 4.0% | 策略测试、小资金 |
| **🟡 稳健（推荐）** | **1.5** | **2.98 U** | **23.84 U** | **12.0%** | **日常运行、平衡风险** |
| 🟠 中等 | 2.0 | 3.97 U | 31.78 U | 16.0% | 较激进策略 |
| 🔴 激进 | 3.0 | 5.00 U ⬆️ | 40.00 U | 20.1% | 高风险，触发上限 |

*基于总权益 198.64 USDT 计算示例

#### 3.3 配置方法
提供了完整的命令行示例：
```bash
# 编辑配置文件
vim /home/user/webapp/data/okx_auto_strategy/account_poit_main.json

# 修改 positionSize 字段
{
  "positionSize": 1.5,    ← 修改这个值
  ...
}
```

#### 3.4 验证配置
```bash
# 查看执行日志
pm2 logs flask-app --lines 20 | grep "开仓金额"

# 预期输出示例：
📊 每个币种开仓金额: 2.98 USDT (总权益198.64 × 1.5%, 上限5U)
```

#### 3.5 风险提示
- positionSize 过高会增加风险
- 8个币种同时开仓的总仓位计算
- 10倍杠杆的实际风险敞口
- 建议先小金额测试

## 更新效果

### 用户体验提升
1. **清晰的配置说明**：用户能够快速理解 positionSize 的作用
2. **直观的对比表格**：不同风险等级的配置一目了然
3. **完整的操作指南**：从配置到验证的完整流程
4. **风险提示醒目**：帮助用户做出明智的决策

### 文档结构
```
二、自动策略执行流程
  ├── BTC价格触发策略（更新了仓位计算说明）
  └── 上涨占比0触发策略（更新了仓位计算说明）

二.五、仓位配置指南（新增）✨
  ├── 配置说明
  ├── 推荐配置表格
  ├── 配置方法
  ├── 验证配置
  └── 风险提示

三、数据存储结构
  ├── 3.1 涨幅后8名策略设置（添加了positionSize字段说明）
  ├── 3.2 BTC策略执行许可
  └── ...
```

## 部署状态

- ✅ 文档已更新到 `templates/okx_trading.html`
- ✅ Flask应用已重启
- ✅ PM2配置已保存
- ✅ 用户访问页面即可看到新文档

## 访问方式

用户打开OKX交易页面后，点击右上角的"📖 技术文档"按钮，即可看到更新后的仓位配置指南。

## 相关文档

- `OKX_POSITION_SIZE_CONFIG_FIX.md` - 代码修复详细文档
- `POSITION_SIZE_FIX_SUMMARY.md` - 修复总结
- `POSITION_SIZE_QUICK_GUIDE.md` - 快速使用指南

## 总结

✅ **文档更新完成**：OKX交易页面现在包含完整的仓位配置说明，用户可以清楚地了解如何配置和使用 positionSize 字段。

✅ **用户友好**：通过表格、示例和操作指南，降低了用户的学习成本。

✅ **风险提示**：明确说明了不同配置的风险等级，帮助用户做出明智选择。
