<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>OKXå®ç›˜äº¤æ˜“ç³»ç»Ÿ v2.7.1</title>
    <!-- 
    ç‰ˆæœ¬: 2026-02-22 v2.7.1 
    
    ğŸ”§ é‡å¤§ä¿®å¤ (2026-02-22):
    1. âœ… è§é¡¶ä¿¡å·ç­–ç•¥å¯é…ç½®å‚æ•°å®ç° (Commit: 6d15f48, e22f8fd, e84646a)
       - æ·»åŠ RSIé˜ˆå€¼å¯è°ƒèŠ‚ï¼ˆ1000-3000ï¼Œé»˜è®¤1800ï¼‰
       - æ·»åŠ å•å¸ä¸Šé™å¯è°ƒèŠ‚ï¼ˆ1-100 USDTï¼Œé»˜è®¤5 USDTï¼‰
       - å‰ç«¯UIï¼šè¾“å…¥æ¡†ã€å®æ—¶æ˜¾ç¤ºã€èŒƒå›´éªŒè¯ã€ä¿å­˜æŒ‰é’®
       - åç«¯APIï¼šPOST /api/okx-trading/save-top-signal-config/<account_id>/<strategy_type>
       - åç«¯APIï¼šGET /api/okx-trading/get-top-signal-config/<account_id>/<strategy_type>
       - é…ç½®æ–‡ä»¶ï¼šdata/okx_top_signal_strategies/{account}_top_signal_{type}.jsonl
       - æ”¯æŒ4è´¦æˆ·Ã—2ç­–ç•¥=8é…ç½®æ–‡ä»¶ï¼ˆtop8_short, bottom8_shortï¼‰
       - ä¿®å¤Flask app.pyè¯­æ³•é”™è¯¯ï¼ˆé‡å¤app.run()ã€è·¯ç”±ä½ç½®é”™è¯¯ï¼‰
    
    2. âœ… è§é¡¶ä¿¡å·å¼€å…³çŠ¶æ€åŠ è½½ä¿®å¤ (Commit: b31ae4c, 5a4cb5a)
       ã€é—®é¢˜ã€‘é…ç½®æ–‡ä»¶enabled=trueï¼Œå‰ç«¯å¼€å…³æ˜¾ç¤ºçº¢è‰²ï¼ˆå…³é—­ï¼‰
       ã€åŸå› ã€‘å¼€å…³çŠ¶æ€ä»check-top-signal-status APIè¯»å–ï¼Œå‚æ•°ä»get-top-signal-configè¯»å–ï¼Œæ•°æ®æºä¸ä¸€è‡´
       ã€ä¿®å¤ã€‘ç»Ÿä¸€ä¸ºget-top-signal-configå•ä¸€æ•°æ®æºï¼ŒåŒæ—¶è¯»å–enabledã€rsi_thresholdã€max_order_usdt
       ã€ç»“æœã€‘å¼€å…³çŠ¶æ€ä¸é…ç½®æ–‡ä»¶100%åŒæ­¥ï¼Œä¸è§åº•ä¿¡å·é€»è¾‘å®Œå…¨ä¸€è‡´
    
    3. âœ… è§é¡¶ä¿¡å·å¼€å…³ä¿å­˜é€»è¾‘ä¿®å¤ (Commit: 5a4cb5a)
       ã€é—®é¢˜ã€‘åˆ‡æ¢å¼€å…³è°ƒç”¨æ—§API set-allowed-top-signalï¼ŒçŠ¶æ€æœªå†™å…¥é…ç½®æ–‡ä»¶
       ã€åŸå› ã€‘è§åº•ä¿¡å·è°ƒç”¨saveBottomSignalConfig()ä¿å­˜å®Œæ•´é…ç½®ï¼Œè§é¡¶ä¿¡å·ä½¿ç”¨å•ç‹¬API
       ã€ä¿®å¤ã€‘è§é¡¶ä¿¡å·Top8å¼€å…³â†’è°ƒç”¨saveTopSignalTop8Config()
              è§é¡¶ä¿¡å·Bottom8å¼€å…³â†’è°ƒç”¨saveTopSignalBottom8Config()
       ã€å¯¹æ¯”ã€‘ä»£ç é‡ä»84è¡Œå‡å°‘åˆ°6è¡Œï¼ˆ-93%ï¼‰ï¼ŒAPIè°ƒç”¨ä»4æ¬¡å‡å°‘åˆ°2æ¬¡ï¼ˆ-50%ï¼‰
       ã€éªŒè¯ã€‘åˆ‡æ¢å¼€å…³â†’è‡ªåŠ¨ä¿å­˜enabledå­—æ®µâ†’åˆ·æ–°é¡µé¢â†’çŠ¶æ€ä¿æŒ
    
    4. âœ… è§é¡¶/è§åº•ä¿¡å·å®Œå…¨ç»Ÿä¸€ (ä»£ç ä¼˜åŒ–)
       - ç»Ÿä¸€é…ç½®æ¨¡å¼ï¼š{enabled, rsi_threshold, max_order_usdt, position_percent, leverage}
       - ç»Ÿä¸€APIæ¨¡å¼ï¼šsave-<signal>-config, get-<signal>-config
       - ç»Ÿä¸€æ–‡ä»¶ç»“æ„ï¼šokx_top_signal_strategies/ vs okx_bottom_signal_strategies/
       - ç»Ÿä¸€å‰ç«¯é€»è¾‘ï¼šå¼€å…³äº‹ä»¶ã€åŠ è½½å‡½æ•°ã€éªŒè¯è§„åˆ™å®Œå…¨ä¸€è‡´
       ã€æ•°æ®ä¸€è‡´æ€§ã€‘å¼€å…³çŠ¶æ€ã€å‚æ•°é…ç½®100%åŒæ­¥ï¼Œå•ä¸€æ•°æ®æºï¼Œæ— å†—ä½™
    
    ğŸ†• æ–°å¢åŠŸèƒ½ (2026-02-21) v2.7.0:
    1. âœ… RSIç­–ç•¥å¼€å…³é¢œè‰²ä¼˜åŒ–
       - å°†æ‰€æœ‰ç­–ç•¥å¼€å…³æœªå¼€å¯é¢œè‰²ä»ç°è‰²æ”¹ä¸ºé²œè‰³å½©è‰²
       - è§é¡¶ä¿¡å·åšç©ºï¼š#f87171(é²œçº¢)ã€#ef4444(é²œäº®çº¢)
       - è§åº•ä¿¡å·åšå¤šï¼š#4ade80(é²œç»¿)ã€#34d399(é²œç»¿)
       - æå‡è§†è§‰å¯¹æ¯”åº¦ï¼ŒçŠ¶æ€æ›´æ˜“è¯†åˆ«
    
    2. âœ… RSIç­–ç•¥çŠ¶æ€æ€»è§ˆçª—å£
       - åœ¨RSIç­–ç•¥å¡ç‰‡é¡¶éƒ¨æ·»åŠ 2Ã—2ç½‘æ ¼çŠ¶æ€çª—å£
       - å®æ—¶æ˜¾ç¤º4ä¸ªç­–ç•¥çš„å¼€å…³å’Œè®¸å¯çŠ¶æ€
       - æ”¯æŒ16ä¸ªJSONLæ–‡ä»¶çŠ¶æ€ç›‘æ§ï¼ˆ4è´¦æˆ·Ã—4ç­–ç•¥ï¼‰
       - æ–°å¢"é‡ç½®æ‰€æœ‰ç­–ç•¥"æŒ‰é’®ï¼Œä¸€é”®è§£é™¤å†·å´é™åˆ¶
       - å›¾æ ‡è¯´æ˜ï¼šâœ…å·²å¼€å¯/å…è®¸ã€âšªå·²å…³é—­ã€ğŸš«å†·å´ä¸­
       - åˆ‡æ¢è´¦æˆ·è‡ªåŠ¨åˆ·æ–°ï¼Œæ”¯æŒæ‰‹åŠ¨åˆ·æ–°
    
    3. âœ… è§åº•ä¿¡å·åšå¤šç­–ç•¥å®Œæ•´å®ç°
       - æ–°å¢2ä¸ªåšå¤šç­–ç•¥ï¼šè§åº•+å‰8å¤šã€è§åº•+å8å¤š
       - è§¦å‘æ¡ä»¶ï¼šè§åº•ä¿¡å· + RSI<800ï¼ˆå¯é…ç½®300-1500ï¼‰
       - 10Ã—æ æ†ï¼Œ1.5%ä»“ä½ï¼Œå•å¸é™é¢5Uï¼ˆå¯é…ç½®1-100Uï¼‰
       - æ¯ä¸ªè´¦æˆ·ç‹¬ç«‹é…ç½®ï¼Œæ”¯æŒ4Ã—2=8ä¸ªJSONLæ–‡ä»¶
       - åå°ç›‘æ§è„šæœ¬ï¼šbottom_signal_long_monitor.py
       - å®Œæ•´APIæ”¯æŒï¼šä¿å­˜/è¯»å–é…ç½®ã€æ£€æŸ¥æ‰§è¡ŒçŠ¶æ€
    
    4. ğŸ”§ åç«¯APIå¢å¼º
       - æ–°å¢ï¼š/api/okx-trading/check-top-signal-statusï¼ˆæ£€æŸ¥è§é¡¶ç­–ç•¥çŠ¶æ€ï¼‰
       - æ–°å¢ï¼š/api/okx-trading/check-bottom-signal-statusï¼ˆæ£€æŸ¥è§åº•ç­–ç•¥çŠ¶æ€ï¼‰
       - æ–°å¢ï¼š/api/okx-trading/set-allowed-bottom-signalï¼ˆé‡ç½®è§åº•ç­–ç•¥è®¸å¯ï¼‰
       - 1å°æ—¶å†·å´æœŸè‡ªåŠ¨ç®¡ç†ï¼Œè¶…æ—¶è‡ªåŠ¨æ¢å¤
    
    å†å²ç‰ˆæœ¬:
    - v2.7.0 (2026-02-21): RSIç­–ç•¥å¼€å…³é¢œè‰²ä¼˜åŒ–ã€çŠ¶æ€æ€»è§ˆçª—å£ã€è§åº•ä¿¡å·åšå¤šç­–ç•¥
    - v2.6.6 (2026-02-20): è§é¡¶ä¿¡å·åšç©ºè´¦æˆ·éªŒè¯ä¼˜åŒ–ã€æ€»è§ˆé¢æ¿
    - v2.6.5: ä¿®å¤XRPç­‰å¤§é¢å€¼åˆçº¦è¶…é¢å¼€ä»“Bug
    - v2.6.4: RSIç©ºå•æ­¢ç›ˆåŠŸèƒ½
    - v2.6.3: å¸‚åœºæƒ…ç»ªæ­¢ç›ˆç›‘æ§
    -->
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB',
                'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
            padding: 30px;
            zoom: 1.5;
        }

        /* åŠ è½½è¿›åº¦è¦†ç›–å±‚ */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.5s;
        }

        .loading-overlay.fade-out {
            opacity: 0;
            pointer-events: none;
        }

        .loading-content {
            text-align: center;
            color: white;
            max-width: 500px;
            width: 90%;
        }

        .loading-logo {
            font-size: 64px;
            margin-bottom: 30px;
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.1); opacity: 0.8; }
        }

        .loading-title {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 40px;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }

        .progress-container {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 25px;
            height: 50px;
            overflow: hidden;
            margin-bottom: 25px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #3b82f6 0%, #8b5cf6 100%);
            border-radius: 25px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: width 0.3s ease;
            font-weight: 700;
            font-size: 18px;
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.5);
        }

        .loading-step {
            font-size: 18px;
            margin-top: 20px;
            opacity: 0.9;
            min-height: 28px;
        }

        .loading-substeps {
            font-size: 14px;
            margin-top: 15px;
            opacity: 0.7;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
        }

        .substep {
            background: rgba(255, 255, 255, 0.15);
            padding: 6px 14px;
            border-radius: 15px;
            transition: all 0.3s;
        }

        .substep.completed {
            background: rgba(34, 197, 94, 0.3);
            box-shadow: 0 0 15px rgba(34, 197, 94, 0.4);
        }

        .substep.loading {
            background: rgba(59, 130, 246, 0.3);
            animation: blink 1s infinite;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .container {
            max-width: 2100px;
            margin: 0 auto;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 25px 30px;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header h1 {
            font-size: 28px;
            color: #2d3748;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .mode-badge {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            box-shadow: 0 4px 12px rgba(239, 68, 68, 0.3);
        }

        .header-actions {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        /* è´¦æˆ·åˆ‡æ¢æ¨ªæ¡ */
        .account-switcher {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 15px 30px;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .account-switcher-label {
            font-size: 14px;
            font-weight: 600;
            color: #2d3748;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .account-tabs {
            display: flex;
            gap: 10px;
            flex: 1;
        }

        .account-tab {
            padding: 8px 20px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid #e2e8f0;
            background: white;
            color: #64748b;
        }

        .account-tab:hover {
            background: #f1f5f9;
            border-color: #cbd5e1;
        }

        .account-tab.active {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
            border-color: #2563eb;
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
        }

        .account-info {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-left: auto;
            padding-left: 20px;
            border-left: 2px solid #e2e8f0;
        }

        .account-balance {
            font-size: 14px;
            color: #64748b;
        }

        .account-balance strong {
            color: #10b981;
            font-size: 16px;
            margin-left: 5px;
        }

        .btn-manage-accounts {
            background: #8b5cf6;
            color: white;
            padding: 8px 16px;
            border: none;
            border-radius: 8px;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        .btn-manage-accounts:hover {
            background: #7c3aed;
            transform: translateY(-2px);
        }

        /* è´¦æˆ·ç®¡ç†å¯¹è¯æ¡† */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: white;
            border-radius: 15px;
            padding: 30px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e2e8f0;
        }

        .modal-header h2 {
            font-size: 22px;
            color: #2d3748;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .btn-close {
            background: none;
            border: none;
            font-size: 28px;
            cursor: pointer;
            color: #64748b;
            line-height: 1;
            padding: 0;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: all 0.3s;
        }

        .btn-close:hover {
            background: #f1f5f9;
            color: #2d3748;
        }

        .account-list {
            margin-bottom: 25px;
        }

        .account-item {
            background: #f8fafc;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s;
        }

        .account-item:hover {
            border-color: #3b82f6;
            box-shadow: 0 2px 8px rgba(59, 130, 246, 0.1);
        }

        .account-item-info {
            flex: 1;
        }

        .account-item-name {
            font-size: 16px;
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 5px;
        }

        .account-item-balance {
            font-size: 14px;
            color: #10b981;
            font-weight: 600;
        }

        .account-item-actions {
            display: flex;
            gap: 8px;
        }

        .btn-small {
            padding: 6px 12px;
            border: none;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-edit {
            background: #3b82f6;
            color: white;
        }

        .btn-edit:hover {
            background: #2563eb;
        }

        .btn-delete {
            background: #ef4444;
            color: white;
        }

        .btn-delete:hover {
            background: #dc2626;
        }
        
        /* RSIç­–ç•¥é‡ç½®æŒ‰é’®æ ·å¼ */
        .btn-reset-rsi:hover {
            background: #d97706 !important;
            transform: translateY(-1px);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .btn-reset-rsi:active {
            transform: translateY(0);
            box-shadow: none;
        }

        .account-form {
            background: #f8fafc;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 8px;
        }

        .form-group input {
            width: 100%;
            padding: 10px 12px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s;
        }

        .form-group input:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .form-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }

        .btn-primary {
            background: #10b981;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary:hover {
            background: #059669;
        }

        .btn-secondary {
            background: #64748b;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-secondary:hover {
            background: #475569;
        }

        .btn-add-account {
            background: #10b981;
            color: white;
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-add-account:hover {
            background: #059669;
            transform: translateY(-2px);
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        .btn-home {
            background: #10b981;
            color: white;
        }

        .btn-home:hover {
            background: #059669;
            transform: translateY(-2px);
        }

        .btn-refresh {
            background: #3b82f6;
            color: white;
        }

        .btn-refresh:hover {
            background: #2563eb;
        }

        .main-layout {
            display: grid;
            grid-template-columns: 280px 1fr 320px;
            gap: 20px;
        }

        /* å·¦ä¾§äº¤æ˜“å¯¹åˆ—è¡¨ */
        .symbols-panel {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            max-height: calc(100vh - 140px);
            overflow-y: auto;
        }

        .symbols-panel h3 {
            font-size: 16px;
            color: #2d3748;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e2e8f0;
        }

        .symbol-search {
            width: 100%;
            padding: 10px 12px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 14px;
            margin-bottom: 15px;
            outline: none;
            transition: all 0.3s;
        }

        .symbol-search:focus {
            border-color: #3b82f6;
        }

        .symbol-item {
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 8px;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: relative;
        }

        .symbol-item:hover {
            background: #f7fafc;
        }

        .symbol-item.active {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
            border-color: #1e40af;
        }

        .symbol-item.favorite {
            background: #fef3c7;
            border-color: #fbbf24;
        }

        .symbol-item.favorite.active {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            color: white;
            border-color: #b45309;
        }

        .symbol-content {
            flex: 1;
        }

        .symbol-name {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 4px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .favorite-badge {
            color: #f59e0b;
            font-size: 12px;
        }

        .symbol-item.active .favorite-badge {
            color: #fef3c7;
        }

        .symbol-price {
            font-size: 13px;
            opacity: 0.8;
        }

        .favorite-btn {
            padding: 4px 8px;
            background: transparent;
            border: none;
            cursor: pointer;
            font-size: 18px;
            transition: all 0.3s;
            opacity: 0;
            margin-left: 8px;
        }

        .symbol-item:hover .favorite-btn {
            opacity: 1;
        }

        .favorite-btn:hover {
            transform: scale(1.2);
        }

        .favorite-btn.favorited {
            opacity: 1;
        }

        .favorite-section {
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 2px solid #fbbf24;
        }

        .favorite-section-title {
            font-size: 13px;
            color: #d97706;
            font-weight: 600;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        /* ä¸­é—´äº¤æ˜“é¢æ¿ */
        .trading-panel {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        .symbol-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e2e8f0;
        }

        .symbol-info {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .current-symbol {
            font-size: 24px;
            font-weight: bold;
            color: #2d3748;
        }

        .symbol-subtitle {
            font-size: 14px;
            color: #718096;
        }

        .current-price {
            text-align: right;
        }

        .price-value {
            font-size: 32px;
            font-weight: bold;
            color: #10b981;
        }

        .price-change {
            font-size: 14px;
            padding: 4px 12px;
            border-radius: 20px;
            margin-top: 5px;
            display: inline-block;
        }

        .price-change.up {
            background: #dcfce7;
            color: #16a34a;
        }

        .price-change.down {
            background: #fee2e2;
            color: #dc2626;
        }

        /* äº¤æ˜“æ–¹å‘æŒ‰é’® */
        .direction-tabs {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 25px;
        }

        .direction-tab {
            padding: 15px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            background: white;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
            font-size: 16px;
            font-weight: 600;
        }

        .direction-tab:hover {
            transform: translateY(-2px);
        }

        .direction-tab.long {
            border-color: #10b981;
            color: #10b981;
        }

        .direction-tab.long.active {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            border-color: #059669;
        }

        .direction-tab.short {
            border-color: #ef4444;
            color: #ef4444;
        }

        .direction-tab.short.active {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
            border-color: #dc2626;
        }

        /* äº¤æ˜“è¡¨å• */
        .trading-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .form-label {
            font-size: 14px;
            font-weight: 600;
            color: #4a5568;
        }

        .form-control {
            padding: 12px 15px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 15px;
            outline: none;
            transition: all 0.3s;
        }

        .form-control:focus {
            border-color: #3b82f6;
        }

        .leverage-buttons {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
        }

        .leverage-btn {
            padding: 10px;
            border: 2px solid #e2e8f0;
            border-radius: 6px;
            background: white;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 14px;
            font-weight: 600;
            color: #4a5568;
        }

        .leverage-btn:hover {
            background: #f7fafc;
        }

        .leverage-btn.active {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
            border-color: #2563eb;
        }

        .amount-presets {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 8px;
        }

        .preset-btn {
            padding: 8px;
            border: 2px solid #e2e8f0;
            border-radius: 6px;
            background: white;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 13px;
            font-weight: 600;
            color: #4a5568;
        }

        .preset-btn:hover {
            background: #f7fafc;
            border-color: #cbd5e0;
        }

        .submit-order {
            padding: 16px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 10px;
        }

        .submit-order.long {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
        }

        .submit-order.long:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(16, 185, 129, 0.4);
        }

        .submit-order.short {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
        }

        .submit-order.short:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(239, 68, 68, 0.4);
        }

        /* æ‰¹é‡å¼€ä»“æŒ‰é’® */
        .batch-btn {
            padding: 12px 16px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: left;
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .batch-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .batch-btn-title {
            font-size: 14px;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .batch-btn-desc {
            font-size: 11px;
            color: #64748b;
        }

        .batch-btn.long .batch-btn-title {
            color: #10b981;
        }

        .batch-btn.short .batch-btn-title {
            color: #ef4444;
        }

        .batch-btn:active {
            transform: scale(0.98);
        }

        /* æ‰¹é‡å¹³ä»“æŒ‰é’® */
        .batch-close-btn {
            padding: 10px 14px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 600;
            transition: all 0.3s;
            text-align: center;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
        }

        .batch-close-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .batch-close-btn:active {
            transform: scale(0.98);
        }

        /* å¹³ä¸€åŠå¤šå• */
        .batch-close-long-half {
            background: linear-gradient(135deg, #86efac 0%, #4ade80 100%);
            color: #166534;
        }

        .batch-close-long-half:hover {
            box-shadow: 0 4px 12px rgba(74, 222, 128, 0.4);
        }

        /* å¹³ä¸€åŠç©ºå• */
        .batch-close-short-half {
            background: linear-gradient(135deg, #fca5a5 0%, #f87171 100%);
            color: #7f1d1d;
        }

        .batch-close-short-half:hover {
            box-shadow: 0 4px 12px rgba(248, 113, 113, 0.4);
        }

        /* å¹³å…¨éƒ¨å¤šå• */
        .batch-close-long-all {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
        }

        .batch-close-long-all:hover {
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.5);
        }

        /* å¹³å…¨éƒ¨ç©ºå• */
        .batch-close-short-all {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
        }

        .batch-close-short-all:hover {
            box-shadow: 0 4px 12px rgba(239, 68, 68, 0.5);
        }


        /* å³ä¾§è´¦æˆ·ä¿¡æ¯ */
        .account-panel {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .info-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        .info-card h3 {
            font-size: 16px;
            color: #2d3748;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e2e8f0;
        }

        .info-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #f7fafc;
        }

        .info-row:last-child {
            border-bottom: none;
        }

        .info-label {
            font-size: 13px;
            color: #718096;
        }

        .info-value {
            font-size: 14px;
            font-weight: 600;
            color: #2d3748;
        }

        .risk-warning {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            border-left: 4px solid #f59e0b;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
        }

        .risk-warning h4 {
            font-size: 14px;
            color: #92400e;
            margin-bottom: 8px;
        }

        .risk-warning ul {
            font-size: 12px;
            color: #78350f;
            padding-left: 20px;
        }

        .risk-warning li {
            margin-bottom: 4px;
        }

        /* æš‚æ— æŒä»“æç¤º */
        .no-positions {
            background: #f7fafc;
            border: 2px dashed #cbd5e0;
            border-radius: 10px;
            padding: 30px;
            text-align: center;
            color: #a0aec0;
            font-size: 14px;
        }

        /* æŒä»“é¡¹ç›® */
        .position-item {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 10px;
        }

        .position-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .position-symbol {
            font-weight: 600;
            font-size: 14px;
            color: #2d3748;
        }

        .position-side {
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
        }

        .position-side.long {
            background: #d1fae5;
            color: #065f46;
        }

        .position-side.short {
            background: #fee2e2;
            color: #991b1b;
        }

        .close-position-btn {
            padding: 4px 12px;
            background: #ef4444;
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s;
        }

        .close-position-btn:hover {
            background: #dc2626;
        }

        .close-position-btn:active {
            background: #b91c1c;
        }

        .cancel-order-btn {
            padding: 4px 12px;
            background: #f59e0b;
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s;
        }

        .cancel-order-btn:hover {
            background: #d97706;
        }

        .cancel-order-btn:active {
            background: #b45309;
        }


        .position-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 6px;
            font-size: 12px;
        }

        .position-detail-item {
            display: flex;
            justify-content: space-between;
        }

        .position-detail-label {
            color: #718096;
        }

        .position-detail-value {
            font-weight: 600;
            color: #2d3748;
        }

        .position-pnl {
            margin-top: 8px;
            padding-top: 8px;
            border-top: 1px solid #e2e8f0;
            display: flex;
            justify-content: space-between;
            font-size: 13px;
            font-weight: 600;
        }

        /* æ»šåŠ¨æ¡æ ·å¼ */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb {
            background: #cbd5e0;
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #a0aec0;
        }
        /* å¼€å…³æ ·å¼ */
        .switch input:checked + .slider {
            background-color: #10b981;
        }
        
        /* æ­¢ç›ˆå¼€å…³ - ç»¿è‰² */
        #takeProfitSwitch:checked + .slider-takeprofit {
            background-color: #10b981 !important;
        }
        
        /* æ­¢æŸå¼€å…³ - çº¢è‰² */
        #stopLossSwitch:checked + .slider-stoploss {
            background-color: #ef4444 !important;
        }
        
        /* RSIæ­¢ç›ˆå¼€å…³ - æ©™è‰² */
        #rsiTakeProfitSwitch:checked + .slider-rsi-takeprofit {
            background-color: #fb923c !important;
        }
        
        .slider-rsi-takeprofit:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        #rsiTakeProfitSwitch:checked + .slider-rsi-takeprofit:before {
            transform: translateX(20px);
        }
        
        /* RSIç©ºå•æ­¢ç›ˆå¼€å…³ - ç»¿è‰² */
        #rsiShortTakeProfitSwitch:checked + .slider-rsi-short-takeprofit {
            background-color: #10b981 !important;
        }
        
        .slider-rsi-short-takeprofit {
            position: absolute;
            cursor: pointer !important;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 24px;
            z-index: 1;
        }
        
        .slider-rsi-short-takeprofit:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        #rsiShortTakeProfitSwitch:checked + .slider-rsi-short-takeprofit:before {
            transform: translateX(20px);
        }
        
        /* è§é¡¶ä¿¡å·åšç©ºå¼€å…³ - æ¶¨å¹…å‰8 - æ·±çº¢è‰² */
        #topSignalTop8ShortSwitch:checked + .slider-top-signal-top8-short {
            background-color: #dc2626 !important;
        }
        
        .slider-top-signal-top8-short {
            position: absolute;
            cursor: pointer !important;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #f87171;
            transition: .4s;
            border-radius: 24px;
            z-index: 1;
        }
        
        .slider-top-signal-top8-short:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        #topSignalTop8ShortSwitch:checked + .slider-top-signal-top8-short:before {
            transform: translateX(20px);
        }
        
        /* è§é¡¶ä¿¡å·åšç©ºå¼€å…³ - æ¶¨å¹…å8 - æš—çº¢è‰² */
        #topSignalBottom8ShortSwitch:checked + .slider-top-signal-bottom8-short {
            background-color: #b91c1c !important;
        }
        
        .slider-top-signal-bottom8-short {
            position: absolute;
            cursor: pointer !important;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ef4444;
            transition: .4s;
            border-radius: 24px;
            z-index: 1;
        }
        
        .slider-top-signal-bottom8-short:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        #topSignalBottom8ShortSwitch:checked + .slider-top-signal-bottom8-short:before {
            transform: translateX(20px);
        }
        
        /* è§åº•ä¿¡å·åšå¤šå¼€å…³ - æ¶¨å¹…å‰8 - ç»¿è‰² */
        #bottomSignalTop8LongSwitch:checked + .slider-bottom-signal-top8-long {
            background-color: #22c55e !important;
        }
        
        .slider-bottom-signal-top8-long {
            position: absolute;
            cursor: pointer !important;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #4ade80;
            transition: .4s;
            border-radius: 24px;
            z-index: 1;
        }
        
        .slider-bottom-signal-top8-long:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        #bottomSignalTop8LongSwitch:checked + .slider-bottom-signal-top8-long:before {
            transform: translateX(20px);
        }
        
        /* è§åº•ä¿¡å·åšå¤šå¼€å…³ - æ¶¨å¹…å8 - æ·±ç»¿è‰² */
        #bottomSignalBottom8LongSwitch:checked + .slider-bottom-signal-bottom8-long {
            background-color: #10b981 !important;
        }
        
        .slider-bottom-signal-bottom8-long {
            position: absolute;
            cursor: pointer !important;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #34d399;
            transition: .4s;
            border-radius: 24px;
            z-index: 1;
        }
        
        .slider-bottom-signal-bottom8-long:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        #bottomSignalBottom8LongSwitch:checked + .slider-bottom-signal-bottom8-long:before {
            transform: translateX(20px);
        }
        
        /* å¸‚åœºæƒ…ç»ªæ­¢ç›ˆå¼€å…³ - çº¢è‰² */
        #sentimentTakeProfitSwitch:checked + .slider-sentiment-takeprofit {
            background-color: #ef4444 !important;
        }
        
        .slider-sentiment-takeprofit:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        #sentimentTakeProfitSwitch:checked + .slider-sentiment-takeprofit:before {
            transform: translateX(20px);
        }
        
        .switch input:checked + .slider:before {
            transform: translateX(20px);
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
    </style>
</head>
<body>
    <!-- åŠ è½½è¿›åº¦è¦†ç›–å±‚ -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-content">
            <div class="loading-logo">ğŸ’¹</div>
            <div class="loading-title">OKXå®ç›˜äº¤æ˜“ç³»ç»Ÿ</div>
            <div class="progress-container">
                <div class="progress-bar" id="progressBar" style="width: 0%;">
                    <span id="progressText">0%</span>
                </div>
            </div>
            <div class="loading-step" id="loadingStep">æ­£åœ¨åˆå§‹åŒ–...</div>
            <div class="loading-substeps" id="loadingSubsteps">
                <span class="substep" id="step-accounts">è´¦æˆ·é…ç½®</span>
                <span class="substep" id="step-favorites">å¸¸ç”¨å¸ç§</span>
                <span class="substep" id="step-tickers">å®æ—¶è¡Œæƒ…</span>
                <span class="substep" id="step-positions">æŒä»“ä¿¡æ¯</span>
                <span class="substep" id="step-orders">å§”æ‰˜è®¢å•</span>
                <span class="substep" id="step-logs">äº¤æ˜“æ—¥å¿—</span>
            </div>
        </div>
    </div>

    <div class="container" style="opacity: 0; transition: opacity 0.5s;" id="mainContent">
        <!-- é¡¶éƒ¨å¯¼èˆª -->
        <div class="header">
            <div>
                <h1>
                    ğŸ’¹ OKXå®ç›˜äº¤æ˜“ç³»ç»Ÿ
                    <span class="mode-badge">ğŸ”´ å®ç›˜äº¤æ˜“</span>
                </h1>
            </div>
            <div class="header-actions">
                <a href="/" class="btn btn-home">ğŸ  è¿”å›é¦–é¡µ</a>
                <a href="/okx-profit-analysis" class="btn btn-home" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">ğŸ“Š åˆ©æ¶¦åˆ†æ</a>
                <button class="btn btn-refresh" onclick="refreshData()">ğŸ”„ åˆ·æ–°</button>
            </div>
        </div>

        <!-- ç³»ç»Ÿæ¶æ„è¯´æ˜ï¼ˆå¯ä¼¸ç¼©ï¼‰ -->
        <div style="margin-top: 10px; padding: 10px; background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%); border-radius: 8px; border: 2px solid #0ea5e9;">
            <div style="cursor: pointer; display: flex; align-items: center; justify-content: space-between;" onclick="document.getElementById('systemArchitecture').style.display = document.getElementById('systemArchitecture').style.display === 'none' ? 'block' : 'none'; document.getElementById('archToggleIcon').textContent = document.getElementById('systemArchitecture').style.display === 'none' ? 'â–¶' : 'â–¼';">
                <span style="color: #0369a1; font-weight: 700; font-size: 13px;">ğŸ“š ç³»ç»Ÿæ¶æ„ä¸è¿è¡Œè¯´æ˜</span>
                <span id="archToggleIcon" style="color: #0369a1; font-weight: bold; font-size: 14px;">â–¼</span>
            </div>
            <div id="systemArchitecture" style="margin-top: 12px; max-height: 500px; overflow-y: auto; color: #0c4a6e; font-size: 11px; line-height: 1.8;">
                
                <!-- ğŸ”´ é‡è¦æ›´æ–°é€šçŸ¥ -->
                <div style="background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%); padding: 12px; border-radius: 6px; margin-bottom: 12px; border: 2px solid #dc2626; box-shadow: 0 2px 8px rgba(220, 38, 38, 0.2);">
                    <h4 style="margin: 0 0 8px 0; color: #991b1b; font-size: 13px; font-weight: 800;">ğŸš¨ é‡è¦ä¿®å¤åˆé›†ï¼ˆ2026-02-19ï¼‰</h4>
                    
                    <!-- ä¿®å¤1: ä¿è¯é‡‘è®¡ç®—é€»è¾‘é”™è¯¯ -->
                    <div style="background: white; padding: 10px; border-radius: 4px; margin-bottom: 8px;">
                        <p style="margin: 0 0 6px 0; font-weight: 700; color: #b91c1c;">ğŸ› é—®é¢˜1ï¼šä¿è¯é‡‘è®¡ç®—é€»è¾‘é”™è¯¯ï¼ˆæäº¤: 753da18ï¼‰</p>
                        <ul style="margin: 4px 0 0 20px; padding: 0; color: #7f1d1d; font-size: 10px;">
                            <li><strong>ç°è±¡ï¼š</strong>è®¾ç½®å•ç¬”ä¿è¯é‡‘5Uï¼Œä½†å®é™…åªå ç”¨0.5Uä¿è¯é‡‘</li>
                            <li><strong>æ ¹å› ï¼š</strong>å‰ç«¯ä¼ é€’ <code>sz = marginPerCoin</code>ï¼ˆ5ï¼‰ï¼Œåç«¯ç†è§£ä¸º"åˆçº¦ä»·å€¼5U"ï¼Œå®é™…ä¿è¯é‡‘ = 5/10 = 0.5U</li>
                            <li><strong>ç”¨æˆ·éœ€æ±‚ï¼š</strong>ä¿è¯é‡‘5U Ã— 10å€æ æ† = 50Uåˆçº¦ä»·å€¼</li>
                        </ul>
                        <p style="margin: 6px 0 0 0; font-weight: 700; color: #047857; font-size: 10px;">âœ… è§£å†³æ–¹æ¡ˆï¼š</p>
                        <ul style="margin: 4px 0 0 20px; padding: 0; color: #065f46; font-size: 10px;">
                            <li><strong>å‰ç«¯ä¿®æ­£ï¼š</strong><code>sz = contractValuePerCoin = marginPerCoin Ã— 10</code>ï¼ˆä¼ 50è€Œä¸æ˜¯5ï¼‰</li>
                            <li><strong>è®¡ç®—æµç¨‹ï¼š</strong>ä¿è¯é‡‘5U â†’ åˆçº¦ä»·å€¼ = 5Ã—10 = 50U â†’ sz=50 â†’ OKXå ç”¨ä¿è¯é‡‘ = 50/10 = 5U âœ…</li>
                            <li><strong>å¢å¼ºæ—¥å¿—ï¼š</strong>æ§åˆ¶å°è¯¦ç»†æ˜¾ç¤ºæ¯ä¸€æ­¥è®¡ç®—ï¼ˆä¿è¯é‡‘ã€åˆçº¦ä»·å€¼ã€å®é™…ä¼ å€¼ï¼‰</li>
                            <li><strong>å½±å“èŒƒå›´ï¼š</strong><code>batchOrderTop8</code>ã€<code>batchOrderBottom8</code>ã€<code>batchOrder</code></li>
                        </ul>
                    </div>
                    
                    <!-- ä¿®å¤2: è‡ªåŠ¨ç­–ç•¥åå¤è§¦å‘ -->
                    <div style="background: white; padding: 10px; border-radius: 4px; margin-bottom: 8px;">
                        <p style="margin: 0 0 6px 0; font-weight: 700; color: #b91c1c;">ğŸ› é—®é¢˜2ï¼šè‡ªåŠ¨ç­–ç•¥åå¤è§¦å‘ï¼ˆæäº¤: 9b808c1ï¼‰</p>
                        <ul style="margin: 4px 0 0 20px; padding: 0; color: #7f1d1d; font-size: 10px;">
                            <li><strong>ç°è±¡ï¼š</strong>ç­–ç•¥æ‰§è¡Œåï¼Œæ¯60ç§’åˆå†æ¬¡è§¦å‘æ‰§è¡Œ</li>
                            <li><strong>æ ¹å› ï¼š</strong>ç”¨æˆ·æ‰“å¼€å¼€å…³æ—¶ï¼Œå‰ç«¯ç«‹å³å†™å…¥ <code>allowed=true</code> åˆ°JSONL â†’ æ‰§è¡Œåè™½ç„¶å†™å…¥ <code>allowed=false</code>ï¼Œä½†ç”¨æˆ·å†æ¬¡æ‰“å¼€å¼€å…³åˆå†™å…¥ <code>allowed=true</code> â†’ å®šæ—¶å™¨æ£€æŸ¥å‘ç° <code>allowed=true</code> â†’ å†æ¬¡è§¦å‘</li>
                            <li><strong>è§¦å‘æµç¨‹ï¼š</strong>æ‰“å¼€å¼€å…³ â†’ allowed=true â†’ è§¦å‘æ‰§è¡Œ â†’ allowed=false â†’ ç”¨æˆ·å†å¼€å¼€å…³ â†’ allowed=true â†’ 60ç§’åå†æ¬¡è§¦å‘</li>
                        </ul>
                        <p style="margin: 6px 0 0 0; font-weight: 700; color: #047857; font-size: 10px;">âœ… è§£å†³æ–¹æ¡ˆï¼š</p>
                        <ul style="margin: 4px 0 0 20px; padding: 0; color: #065f46; font-size: 10px;">
                            <li><strong>åˆ é™¤è‡ªåŠ¨å†™å…¥ï¼š</strong>æ‰“å¼€å¼€å…³æ—¶ä¸å†è‡ªåŠ¨å†™å…¥ <code>allowed=true</code></li>
                            <li><strong>allowedç®¡ç†è§„åˆ™ï¼š</strong>åªèƒ½é€šè¿‡ä»¥ä¸‹æ–¹å¼ä¿®æ”¹ï¼šâ‘ ç­–ç•¥æ‰§è¡ŒæˆåŠŸåè‡ªåŠ¨è®¾ä¸ºfalse â‘¡ç”¨æˆ·æ‰‹åŠ¨ç‚¹å‡»"é‡ç½®æ‰§è¡Œè®¸å¯"æŒ‰é’®è®¾ä¸ºtrue</li>
                            <li><strong>æ­£ç¡®æµç¨‹ï¼š</strong>æ‰“å¼€å¼€å…³ â†’ ç‚¹å‡»"ğŸ”„é‡ç½®"æŒ‰é’® â†’ allowed=true â†’ ç­‰å¾…è§¦å‘ â†’ æ‰§è¡Œä¸€æ¬¡ â†’ allowed=false</li>
                        </ul>
                    </div>
                    
                    <!-- ä¿®å¤3: ç¼ºå°‘é‡ç½®æŒ‰é’® -->
                    <div style="background: white; padding: 10px; border-radius: 4px; margin-bottom: 8px;">
                        <p style="margin: 0 0 6px 0; font-weight: 700; color: #b91c1c;">ğŸ› é—®é¢˜3ï¼šä¸šåŠ¡é€»è¾‘ç¼ºé™· - ç¼ºå°‘é‡ç½®å…¥å£ï¼ˆæäº¤: 789d788ï¼‰</p>
                        <ul style="margin: 4px 0 0 20px; padding: 0; color: #7f1d1d; font-size: 10px;">
                            <li><strong>ç°è±¡ï¼š</strong>ç­–ç•¥æ‰§è¡Œåï¼Œç”¨æˆ·æ‰“å¼€å¼€å…³ä½†ç­–ç•¥ä¸æ‰§è¡Œ</li>
                            <li><strong>æ ¹å› ï¼š</strong>æ‰§è¡Œå <code>allowed=false</code> + <code>enabled=false</code> â†’ ç”¨æˆ·æ‰“å¼€å¼€å…³ <code>enabled=true</code>ï¼Œä½† <code>allowed</code> ä»æ˜¯ <code>false</code> â†’ ä¸æ»¡è¶³æ‰§è¡Œæ¡ä»¶ï¼ˆéœ€è¦ <code>enabled && allowed</code> éƒ½ä¸ºtrueï¼‰</li>
                            <li><strong>ç”¨æˆ·å›°æƒ‘ï¼š</strong>å¼€å…³å·²æ‰“å¼€ï¼Œä¸ºä»€ä¹ˆç­–ç•¥ä¸æ‰§è¡Œï¼Ÿå› ä¸ºç¼ºå°‘é‡ç½® <code>allowed</code> çš„UIå…¥å£</li>
                        </ul>
                        <p style="margin: 6px 0 0 0; font-weight: 700; color: #047857; font-size: 10px;">âœ… è§£å†³æ–¹æ¡ˆï¼š</p>
                        <ul style="margin: 4px 0 0 20px; padding: 0; color: #065f46; font-size: 10px;">
                            <li><strong>æ·»åŠ "ğŸ”„é‡ç½®"æŒ‰é’®ï¼š</strong>åœ¨"ğŸ“„JSONLæ‰§è¡Œè®¸å¯"çŠ¶æ€æ—è¾¹æ·»åŠ é‡ç½®æŒ‰é’®</li>
                            <li><strong>é‡ç½®æµç¨‹ï¼š</strong>ç‚¹å‡»æŒ‰é’® â†’ å¼¹å‡ºç¡®è®¤æ¡†ï¼ˆæ˜¾ç¤ºè´¦æˆ·ã€ç­–ç•¥ã€è§¦å‘ä»·æ ¼ï¼‰â†’ ç¡®è®¤åè®¾ç½® <code>allowed=true</code> â†’ åˆ·æ–°çŠ¶æ€æ˜¾ç¤º</li>
                            <li><strong>å®Œæ•´ä½¿ç”¨æµç¨‹ï¼š</strong>â‘ æ‰“å¼€ç­–ç•¥å¼€å…³ â‘¡ç‚¹å‡»"ğŸ”„é‡ç½®"æŒ‰é’® â‘¢ç­‰å¾…BTCä»·æ ¼è§¦å‘ â‘£ç­–ç•¥è‡ªåŠ¨æ‰§è¡Œä¸€æ¬¡</li>
                            <li><strong>å†æ¬¡ä½¿ç”¨ï¼š</strong>å¿…é¡»é‡å¤æ­¥éª¤â‘ â‘¡ï¼Œç¡®ä¿æ¯æ¬¡æ‰§è¡Œéƒ½æ˜¯æœ‰æ„ä¸ºä¹‹ï¼Œé˜²æ­¢è¯¯è§¦å‘</li>
                        </ul>
                    </div>
                    
                    <!-- ä¿®å¤4: é¡µé¢åŠ è½½å¡ä½ -->
                    <div style="background: white; padding: 10px; border-radius: 4px; margin-bottom: 8px;">
                        <p style="margin: 0 0 6px 0; font-weight: 700; color: #b91c1c;">ğŸ› é—®é¢˜4ï¼šé¡µé¢åŠ è½½å¡åœ¨20%ï¼ˆæäº¤: 79fce79ï¼‰</p>
                        <ul style="margin: 4px 0 0 20px; padding: 0; color: #7f1d1d; font-size: 10px;">
                            <li><strong>ç°è±¡ï¼š</strong>å¸æ¶¨è·Œè¿½è¸ªé¡µé¢æ˜¾ç¤ºåŠ è½½è¿›åº¦æ¡å¡åœ¨20%ï¼Œå†…å®¹å·²åŠ è½½ä½†è¢«é®ç½©å±‚è¦†ç›–</li>
                            <li><strong>æ ¹å› ï¼š</strong>JavaScriptåŠ¨æ€åˆ›å»ºçš„åŠ è½½é®ç½©å±‚ï¼ˆz-index:9999ï¼‰æ²¡æœ‰è¢«æ­£ç¡®ç§»é™¤</li>
                            <li><strong>è§¦å‘æ¡ä»¶ï¼š</strong>æ•°æ®åŠ è½½æˆåŠŸï¼Œä½† <code>LoadingManager.hide()</code> æœªæ‰§è¡Œæˆ–æ‰§è¡Œå¤±è´¥</li>
                        </ul>
                        <p style="margin: 6px 0 0 0; font-weight: 700; color: #047857; font-size: 10px;">âœ… è§£å†³æ–¹æ¡ˆï¼š</p>
                        <ul style="margin: 4px 0 0 20px; padding: 0; color: #065f46; font-size: 10px;">
                            <li><strong>å›æ»šç‰ˆæœ¬ï¼š</strong>å›æ»šåˆ°æ·»åŠ åŠ è½½è¿›åº¦åŠŸèƒ½ä¹‹å‰çš„ç‰ˆæœ¬ï¼ˆ6918937ï¼‰</li>
                            <li><strong>åˆ é™¤é®ç½©å±‚ï¼š</strong>å½»åº•ç§»é™¤åŠ¨æ€åˆ›å»ºåŠ è½½ç•Œé¢çš„ä»£ç ï¼Œæ¢å¤ç›´æ¥åŠ è½½æ˜¾ç¤º</li>
                            <li><strong>æ€§èƒ½ä¼˜åŒ–ï¼š</strong>å»é™¤ä¸å¿…è¦çš„UIåŠ¨ç”»ï¼Œå‡å°‘CSSè¡Œæ•°å’ŒåŠ¨ç”»æ•°é‡</li>
                        </ul>
                    </div>
                    
                    <!-- ä¿®å¤5: XRPç­‰å¤§é¢å€¼åˆçº¦å¼€ä»“é‡‘é¢é”™è¯¯ -->
                    <div style="background: white; padding: 10px; border-radius: 4px; margin-bottom: 8px;">
                        <p style="margin: 0 0 6px 0; font-weight: 700; color: #b91c1c;">ğŸ› é—®é¢˜5ï¼šXRPç­‰å¤§é¢å€¼åˆçº¦å¼€ä»“é‡‘é¢ä¸¥é‡è¶…é¢ï¼ˆæäº¤: 22be347ï¼‰</p>
                        <ul style="margin: 4px 0 0 20px; padding: 0; color: #7f1d1d; font-size: 10px;">
                            <li><strong>ç°è±¡ï¼š</strong>XRPæ¯æ¬¡å¼€ä»“é‡‘é¢éƒ½ä¸å¯¹ï¼Œç›®æ ‡5Uä¿è¯é‡‘ï¼ˆ50Uåˆçº¦ä»·å€¼ï¼‰ï¼Œå®é™…å¼€å‡º14.13 USDTä¿è¯é‡‘ï¼ˆ140Uåˆçº¦ä»·å€¼ï¼‰ï¼Œ<strong>è¶…é¢2.8å€</strong></li>
                            <li><strong>å—å½±å“å¸ç§ï¼š</strong>XRP(100/å¼ )ã€DOGE(1000/å¼ )ã€ADA(100/å¼ )ã€TRX(1000/å¼ ) - æ‰€æœ‰å¤§é¢å€¼åˆçº¦</li>
                            <li><strong>æ ¹å› åˆ†æï¼š</strong>
                                <ul style="margin: 2px 0 0 15px;">
                                    <li>â‘  XRPçœŸå®åˆçº¦è§„æ ¼ï¼š<code>ctVal=100 XRP/å¼ </code>ï¼Œæ¯å¼ â‰ˆ140 USDTï¼ˆä»·æ ¼1.40ï¼‰</li>
                                    <li>â‘¡ ç›®æ ‡å¼€ä»“50 USDT â†’ éœ€è¦ 50/140 = <strong>0.36å¼ </strong></li>
                                    <li>â‘¢ <strong>è‡´å‘½Bugï¼š</strong>ä»£ç å¼ºåˆ¶ <code>max(1, round(0.36)) = 1å¼ </code></li>
                                    <li>â‘£ å®é™…å¼€ä»“ï¼š1å¼  = 140 USDTåˆçº¦ä»·å€¼ = <strong>14 USDTä¿è¯é‡‘</strong> âŒ</li>
                                </ul>
                            </li>
                            <li><strong>é”™è¯¯ä»£ç ï¼š</strong><code>contracts_count = max(1, round(...)) # å¼ºåˆ¶è‡³å°‘1å¼ </code></li>
                            <li><strong>è¯¯è§£æ ¹æºï¼š</strong>OKXæ”¯æŒå°æ•°å¼ æ•°ï¼ˆminSz=0.01ï¼‰ï¼Œä¸éœ€è¦å¼ºåˆ¶å–æ•´ä¸º1å¼ </li>
                        </ul>
                        <p style="margin: 6px 0 0 0; font-weight: 700; color: #047857; font-size: 10px;">âœ… è§£å†³æ–¹æ¡ˆï¼š</p>
                        <ul style="margin: 4px 0 0 20px; padding: 0; color: #065f46; font-size: 10px;">
                            <li><strong>ç§»é™¤å¼ºåˆ¶é€»è¾‘ï¼š</strong>åˆ é™¤ <code>max(1, ...)</code>ï¼Œæ”¹ä¸º <code>round(contracts_count, 2)</code>ï¼ˆä¿ç•™2ä½å°æ•°ï¼‰</li>
                            <li><strong>æ”¯æŒå°æ•°å¼ æ•°ï¼š</strong>0.36å¼  â†’ å®é™…å¼€ä»“50.4 USDT âœ…ï¼ˆè¯¯å·®ä»…0.8%ï¼‰</li>
                            <li><strong>æœ€å°ä¸‹å•é‡ï¼š</strong>å¦‚æœè®¡ç®—ç»“æœ < 0.01å¼ ï¼Œåˆ™ä½¿ç”¨0.01å¼ ï¼ˆè€Œä¸æ˜¯1å¼ ï¼‰</li>
                            <li><strong>ä¿®å¤åæ•ˆæœï¼š</strong>
                                <ul style="margin: 2px 0 0 15px;">
                                    <li>ç›®æ ‡50 USDT â†’ è®¡ç®—0.36å¼  â†’ å®é™…å¼€ä»“ï¼š0.36Ã—140 = 50.4 USDT âœ…</li>
                                    <li>ç›®æ ‡5 USDT â†’ è®¡ç®—0.036å¼  â†’ å®é™…å¼€ä»“ï¼š0.04Ã—140 = 5.6 USDT âœ…</li>
                                    <li>è¶…é¢å€æ•°ï¼šä»2.8å€é™ä½åˆ°1.01å€ï¼ˆÂ±1%è¯¯å·®ï¼‰</li>
                                </ul>
                            </li>
                        </ul>
                        <p style="margin: 6px 0 0 0; font-weight: 700; color: #dc2626; font-size: 10px;">âš ï¸ å±é™©æ€§è¯´æ˜ï¼š</p>
                        <ul style="margin: 4px 0 0 20px; padding: 0; color: #991b1b; font-size: 10px;">
                            <li><strong>XRPï¼š</strong>1å¼ =100 XRPï¼Œå¼ºåˆ¶1å¼  â†’ è¶…é¢2.8å€</li>
                            <li><strong>DOGEï¼š</strong>1å¼ =1000 DOGEï¼Œå¼ºåˆ¶1å¼  â†’ <strong>è¶…é¢10å€+</strong></li>
                            <li><strong>é£é™©ç­‰çº§ï¼š</strong>ğŸ”´ <strong>è‡´å‘½çº§</strong>ï¼ˆå¯èƒ½å¯¼è‡´çˆ†ä»“æˆ–é‡å¤§äºæŸï¼‰</li>
                        </ul>
                    </div>
                    
                    <!-- ä¿®å¤6: æ‰¹é‡å¼€ä»“é£æ§æ£€æŸ¥å¤±æ•ˆ -->
                    <div style="background: white; padding: 10px; border-radius: 4px; margin-bottom: 8px;">
                        <p style="margin: 0 0 6px 0; font-weight: 700; color: #b91c1c;">ğŸ› é—®é¢˜6ï¼šæ‰¹é‡å¼€ä»“é£æ§æ£€æŸ¥å¤±æ•ˆï¼ˆæäº¤: 8bec4cbï¼‰</p>
                        <ul style="margin: 4px 0 0 20px; padding: 0; color: #7f1d1d; font-size: 10px;">
                            <li><strong>ç°è±¡ï¼š</strong>é…ç½®å•ç¬”ä¿è¯é‡‘ä¸Šé™5 USDTï¼Œä½†å®é™…å¼€ä»“é‡‘é¢è¶…è¿‡é™åˆ¶</li>
                            <li><strong>æ ¹å› ï¼š</strong>å‰ç«¯ä¼ é€’ <code>maxOrderSize: contractValuePerCoin</code>ï¼ˆ50 USDTï¼‰ç»™åç«¯ï¼Œè€Œä¸æ˜¯è´¦æˆ·é…ç½®çš„5 USDT</li>
                            <li><strong>åç«¯æ£€æŸ¥ï¼š</strong><code>if 50 > 50: reject()</code> â†’ Falseï¼Œé£æ§å¤±æ•ˆ</li>
                        </ul>
                        <p style="margin: 6px 0 0 0; font-weight: 700; color: #047857; font-size: 10px;">âœ… è§£å†³æ–¹æ¡ˆï¼š</p>
                        <ul style="margin: 4px 0 0 20px; padding: 0; color: #065f46; font-size: 10px;">
                            <li><strong>ä¿®æ­£ä¼ å€¼ï¼š</strong>æ”¹ä¸º <code>maxOrderSize: maxOrderSize Ã— 10</code>ï¼ˆ5Ã—10=50 USDTï¼‰</li>
                            <li><strong>é£æ§ç”Ÿæ•ˆï¼š</strong>å¦‚æœå°è¯•å¼€60 USDT â†’ <code>if 60 > 50: reject()</code> â†’ True âœ…</li>
                        </ul>
                    </div>
                    
                    <div style="background: #f0fdfa; padding: 10px; border-radius: 4px; border-left: 3px solid #14b8a6;">
                        <p style="margin: 0 0 6px 0; font-weight: 700; color: #0f766e; font-size: 11px;">ğŸ”’ å½“å‰é£æ§æœºåˆ¶ï¼ˆ2026-02-20 æ›´æ–°ï¼‰ï¼š</p>
                        <ul style="margin: 4px 0 0 20px; padding: 0; color: #0f766e; font-size: 10px;">
                            <li><strong>ä¿è¯é‡‘é™é¢ï¼š</strong>å•ç¬”ä¿è¯é‡‘â‰¤5 USDTï¼ˆå¯é…ç½®ï¼‰ï¼Œ10å€æ æ† = 50 USDTåˆçº¦ä»·å€¼</li>
                            <li><strong>å‰ç«¯éªŒè¯ï¼š</strong><code>marginPerCoin = Math.min(ä½™é¢Ã—1.5%, maxOrderSize)</code></li>
                            <li><strong>åç«¯éªŒè¯ï¼š</strong>æœåŠ¡å™¨æ£€æŸ¥ <code>sz</code>ï¼ˆåˆçº¦ä»·å€¼ï¼‰æ˜¯å¦è¶…è¿‡ <code>maxOrderSizeÃ—10</code></li>
                            <li><strong>âœ… å°æ•°å¼ æ•°æ”¯æŒï¼š</strong>OKXå…è®¸0.01å¼ èµ·æ­¥ï¼Œä¸å†å¼ºåˆ¶1å¼ ï¼Œé¿å…å¤§é¢å€¼åˆçº¦è¶…é¢</li>
                            <li><strong>âœ… ç²¾ç¡®ä¸‹å•ï¼š</strong>ä¿ç•™2ä½å°æ•°ï¼ˆå¦‚0.36å¼ ï¼‰ï¼Œå¼€ä»“é‡‘é¢è¯¯å·®æ§åˆ¶åœ¨Â±1%ä»¥å†…</li>
                            <li><strong>åŒé‡çŠ¶æ€æ§åˆ¶ï¼š</strong><code>enabled</code>ï¼ˆUIå¼€å…³ï¼‰+ <code>allowed</code>ï¼ˆJSONLæ‰§è¡Œè®¸å¯ï¼‰ï¼Œä¸¤è€…éƒ½ä¸ºtrueæ‰æ‰§è¡Œ</li>
                            <li><strong>é˜²é‡å¤æœºåˆ¶ï¼š</strong>æ‰§è¡Œåç«‹å³è®¾ç½® <code>allowed=false</code>ï¼Œå¿…é¡»æ‰‹åŠ¨é‡ç½®æ‰èƒ½å†æ¬¡æ‰§è¡Œ</li>
                        </ul>
                    </div>
                    
                    <p style="margin: 8px 0 0 0; font-size: 10px; color: #7f1d1d; font-weight: 600;">
                        âš ï¸ é‡è¦æç¤ºï¼šå¦‚é‡åˆ°é—®é¢˜ï¼Œè¯·ç¡¬åˆ·æ–°æµè§ˆå™¨ï¼ˆCtrl+Shift+Rï¼‰æ¸…é™¤ç¼“å­˜ï¼Œæˆ–ä½¿ç”¨éšèº«æ¨¡å¼è®¿é—®ã€‚<br>
                        ğŸ”´ <strong>å…³äºXRPç­‰å¸ç§ï¼š</strong>v2.6.5ï¼ˆ2026-02-20ï¼‰å·²ä¿®å¤XRP/DOGE/ADA/TRXç­‰å¤§é¢å€¼åˆçº¦è¶…é¢å¼€ä»“Bugï¼Œç°åœ¨å¼€ä»“é‡‘é¢ç²¾ç¡®æ§åˆ¶åœ¨Â±1%è¯¯å·®èŒƒå›´å†…ã€‚
                    </p>
                </div>
                
                <!-- ğŸ‰ v2.6.4 é‡å¤§ä¿®å¤é€šçŸ¥ -->
                <div style="background: #dbeafe; padding: 10px; border-radius: 6px; margin-bottom: 10px; border-left: 4px solid #3b82f6;">
                    <h4 style="margin: 0 0 8px 0; color: #1e40af; font-size: 12px;">ğŸ‰ v2.6.4 å¸‚åœºæƒ…ç»ªæ­¢ç›ˆå®Œæ•´åŠŸèƒ½ä¸Šçº¿ï¼ˆ2026-02-19 19:30ï¼‰</h4>
                    <div style="background: #eff6ff; padding: 10px; border-radius: 4px; border-left: 3px solid #3b82f6;">
                        <p style="margin: 0 0 6px 0; font-weight: 700; color: #1e40af;">ğŸ”§ ä¸‰å¤§æ ¸å¿ƒä¿®å¤ï¼š</p>
                        <ul style="margin: 4px 0 0 20px; padding: 0; color: #1e40af;">
                            <li><strong>é—®é¢˜1 - å¼€å…³ä¿å­˜å¤±è´¥ï¼š</strong>åç«¯APIæœªå¤„ç†sentimentTakeProfitEnabledå­—æ®µ â†’ å·²ä¿®å¤ï¼ˆapp.pyä¿å­˜/è¯»å–æ¥å£ï¼‰</li>
                            <li><strong>é—®é¢˜2 - æ‰§è¡Œé€»è¾‘ç¼ºå¤±ï¼š</strong>è§¦å‘ä»·æ ¼è®¡ç®—å¤±è´¥ï¼Œè¿”å›"æ— æ³•è®¡ç®—è§¦å‘ä»·æ ¼"é”™è¯¯ â†’ å·²ä¿®å¤ï¼ˆæ–°å¢å¸‚ä»·å¹³ä»“æ–¹æ³•ï¼‰</li>
                            <li><strong>é—®é¢˜3 - æŒä»“é™åˆ¶é˜»æ­¢ï¼š</strong>5Ué™åˆ¶å¯¼è‡´å¤§é¢æŒä»“è¢«è·³è¿‡ â†’ å·²ä¿®å¤ï¼ˆæå‰æ£€æŸ¥æƒ…ç»ªæ­¢ç›ˆï¼Œæ— è§†æŒä»“å¤§å°ï¼‰</li>
                        </ul>
                    </div>
                    <div style="background: #f0fdf4; padding: 10px; border-radius: 4px; border-left: 3px solid #10b981; margin-top: 8px;">
                        <p style="margin: 0 0 6px 0; font-weight: 700; color: #065f46;">âœ… éªŒè¯ç»“æœï¼ˆå®ç›˜æµ‹è¯•ï¼‰ï¼š</p>
                        <ul style="margin: 4px 0 0 20px; padding: 0; color: #065f46;">
                            <li><strong>è§¦å‘æ¡ä»¶ï¼š</strong>2026-02-19 19:15:03 è§é¡¶ä¿¡å·ï¼ˆRSIæ¶¨28.71% vs å¸ä»·æ¶¨0.94%ï¼Œ30.6å€è´ªå©ªï¼‰</li>
                            <li><strong>æ‰§è¡Œç»“æœï¼š</strong>8ä¸ªå¤šå•å…¨éƒ¨å¸‚ä»·å¹³ä»“æˆåŠŸï¼ˆLDOã€FILã€APTã€CRVã€TAOã€CROã€LINKã€SOLï¼‰</li>
                            <li><strong>å¤§å•éªŒè¯ï¼š</strong>TAO-USDT-SWAP 3805UæˆåŠŸå¹³ä»“ï¼ˆä¸å—5Ué™åˆ¶ï¼‰</li>
                            <li><strong>Telegramï¼š</strong>æ¯ä¸ªå¹³ä»“å•ç‹¬å‘é€é€šçŸ¥ï¼ŒåŒ…å«æƒ…ç»ªä¿¡å·è¯¦æƒ…</li>
                        </ul>
                    </div>
                    <div style="background: #fef2f2; padding: 10px; border-radius: 4px; border-left: 3px solid #ef4444; margin-top: 8px;">
                        <p style="margin: 0 0 6px 0; font-weight: 700; color: #991b1b;">âš ï¸ é‡è¦è¯´æ˜ï¼š</p>
                        <ul style="margin: 4px 0 0 20px; padding: 0; color: #991b1b; font-size: 11px;">
                            <li><strong>å¸‚ä»·å¹³ä»“ï¼š</strong>æƒ…ç»ªæ­¢ç›ˆç«‹å³å¸‚ä»·å¹³ä»“ï¼Œä¸è®¾ç½®æ¡ä»¶å•ï¼ˆä¸å¸¸è§„æ­¢ç›ˆä¸åŒï¼‰</li>
                            <li><strong>åªå¹³å¤šå•ï¼š</strong>ä»…å¹³pos_side='long'çš„æŒä»“ï¼Œä¸ä¼šè¯¯å¹³ç©ºå•</li>
                            <li><strong>æ— è§†é™åˆ¶ï¼š</strong>ä¸å—5Uå¼€ä»“é™åˆ¶å½±å“ï¼Œä»»ä½•å¤§å°çš„æŒä»“éƒ½ä¼šå¹³æ‰</li>
                            <li><strong>å¼€å…³ç‹¬ç«‹ï¼š</strong>æ¯ä¸ªè´¦æˆ·ç‹¬ç«‹é…ç½®ï¼ŒUIå¼€å…³çŠ¶æ€ä¼šæ­£ç¡®åŒæ­¥åˆ°åç«¯</li>
                        </ul>
                    </div>
                    <p style="margin: 8px 0 0 0; font-size: 10px; color: #1e40af; font-weight: 600;">
                        ğŸ“Œ ç›¸å…³æäº¤ï¼šd5d43f6(APIä¿®å¤) + 8e9eebb(å¸‚ä»·å¹³ä»“) + a51fa86(ç§»é™¤é™åˆ¶) + 1a6580c(æå‰æ£€æŸ¥)
                    </p>
                </div>
                
                <!-- ğŸ”¥ v2.6.2 æ–°åŠŸèƒ½é€šçŸ¥ -->
                <div style="background: #fef3c7; padding: 10px; border-radius: 6px; margin-bottom: 10px; border-left: 4px solid #f59e0b;">
                    <h4 style="margin: 0 0 8px 0; color: #92400e; font-size: 12px;">ğŸ”¥ v2.6.2 æ–°å¢åŠŸèƒ½ - å¸‚åœºæƒ…ç»ªæ­¢ç›ˆï¼ˆ2026-02-19 18:50ï¼‰</h4>
                    <div style="background: #fffbeb; padding: 10px; border-radius: 4px; border-left: 3px solid #f59e0b;">
                        <p style="margin: 0 0 6px 0; font-weight: 700; color: #92400e;">ğŸ¯ æ ¸å¿ƒåŠŸèƒ½ï¼š</p>
                        <ul style="margin: 4px 0 0 20px; padding: 0; color: #92400e;">
                            <li><strong>æ™ºèƒ½ç›‘æ§ï¼š</strong>æ¯60ç§’æ£€æŸ¥å¸‚åœºæƒ…ç»ªæœ€æ–°ä¿¡å·ï¼ˆæ¥è‡ªå¸‚åœºæƒ…ç»ªé‡‡é›†å™¨ï¼‰</li>
                            <li><strong>è§¦å‘æ¡ä»¶ï¼š</strong>å½“å‡ºç°"âš ï¸è§é¡¶ä¿¡å·"æˆ–"â›”é¡¶éƒ¨èƒŒç¦»"æ—¶è‡ªåŠ¨è§¦å‘</li>
                            <li><strong>æ‰§è¡ŒåŠ¨ä½œï¼š</strong>è‡ªåŠ¨å¹³æ‰æ‰€æœ‰å¤šå•æŒä»“ï¼ˆå¸‚ä»·å¹³ä»“ï¼‰</li>
                            <li><strong>é˜²é‡å¤ï¼š</strong>æ¯ä¸ªæŒä»“åªæ‰§è¡Œä¸€æ¬¡å¸‚åœºæƒ…ç»ªæ­¢ç›ˆ</li>
                            <li><strong>TGé€šçŸ¥ï¼š</strong>å‘é€åŒ…å«æƒ…ç»ªè¯¦æƒ…ï¼ˆä¿¡å·ã€ç†ç”±ã€å¸æ¶¨è·Œã€RSIå˜åŒ–ï¼‰çš„Telegramæ¶ˆæ¯</li>
                        </ul>
                    </div>
                    <div style="background: #fef2f2; padding: 10px; border-radius: 4px; border-left: 3px solid #dc2626; margin-top: 8px;">
                        <p style="margin: 0 0 6px 0; font-weight: 700; color: #991b1b;">ğŸ“Š å†å²éªŒè¯ï¼ˆä»Šæ—¥å®ç›˜ï¼‰ï¼š</p>
                        <ul style="margin: 4px 0 0 20px; padding: 0; color: #991b1b;">
                            <li><strong>16:00 é¡¶éƒ¨èƒŒç¦»ï¼š</strong>å¸ä»·+3.15% RSI-20.55% â†’ RSIè·Œå¹…æ˜¯å¸ä»·æ¶¨å¹…çš„6.5å€ï¼</li>
                            <li><strong>15åˆ†é’Ÿæš´è·Œï¼š</strong>ä»-55%è·Œåˆ°-87%ï¼Œè·Œå¹…è¾¾32ä¸ªç™¾åˆ†ç‚¹</li>
                            <li><strong>ä¿¡å·å‡†ç¡®ï¼š</strong>æå‰é¢„è­¦é¡¶éƒ¨ï¼Œé¿å…å¤§å¹…å›æ’¤</li>
                        </ul>
                    </div>
                    <p style="margin: 8px 0 0 0; font-size: 10px; color: #92400e; font-weight: 600;">
                        âœ… é…ç½®ä½ç½®ï¼šdata/okx_tpsl_settings/account_*_tpsl.jsonlï¼ˆsentiment_take_profit_enabled: trueï¼‰
                    </p>
                </div>
                
                <!-- 1. ç³»ç»Ÿæ¦‚è¿° -->
                <div style="background: white; padding: 10px; border-radius: 6px; margin-bottom: 10px; border-left: 4px solid #0ea5e9;">
                    <h4 style="margin: 0 0 8px 0; color: #0369a1; font-size: 12px;">ğŸ¯ ä¸€ã€ç³»ç»Ÿæ¦‚è¿°</h4>
                    <p style="margin: 4px 0;"><strong>ç³»ç»Ÿåç§°ï¼š</strong>OKX å®ç›˜äº¤æ˜“ç³»ç»Ÿ v2.6.5 âš¡ <span style="color: #16a34a; font-weight: bold;">æ€§èƒ½ä¼˜åŒ–V2.0ï¼šé¡µé¢åŠ è½½æå‡93.5%ï¼ˆ12.5sâ†’0.8sï¼‰</span></p>
                    <p style="margin: 4px 0;"><strong>æœ€æ–°æ›´æ–°ï¼š</strong>2026-02-20 - ğŸ”§ v2.6.5 <strong>è‡´å‘½Bugä¿®å¤ï¼š</strong>XRP/DOGE/ADA/TRXç­‰å¤§é¢å€¼åˆçº¦è¶…é¢å¼€ä»“ï¼ˆ2.8å€â†’1.01å€ï¼Œè¯¯å·®Â±1%ï¼‰</p>
                    <p style="margin: 4px 0;"><strong>å†å²æ›´æ–°ï¼š</strong></p>
                    <ul style="margin: 4px 0 0 20px; padding: 0; font-size: 11px;">
                        <li>2026-02-19 v2.6.4 - å¸‚åœºæƒ…ç»ªæ­¢ç›ˆå®Œæ•´åŠŸèƒ½ä¸Šçº¿ï¼ˆä¿å­˜ã€æ‰§è¡Œã€å¸‚ä»·å¹³ä»“ï¼‰</li>
                        <li>2026-02-19 v2.6.3 - ç§»é™¤æ­¢ç›ˆæ­¢æŸçš„5UæŒä»“é™åˆ¶</li>
                        <li>2026-02-19 v2.6.2 - æ–°å¢å¸‚åœºæƒ…ç»ªæ­¢ç›ˆåŠŸèƒ½</li>
                        <li>2026-02-19 v2.6.1 - ä¿®å¤æ‰¹é‡ä¸‹å•é‡‘é¢é”™è¯¯</li>
                        <li>2026-02-17 v2.6.0 - è‡ªåŠ¨æ­¢ç›ˆæ­¢æŸç³»ç»Ÿä¸Šçº¿</li>
                    </ul>
                    <p style="margin: 4px 0;"><strong>æ ¸å¿ƒåŠŸèƒ½ï¼š</strong></p>
                    <ul style="margin: 4px 0 0 20px; padding: 0;">
                        <li>å¤šè´¦æˆ·ç®¡ç†ï¼ˆä¸»è´¦æˆ·ã€fangfang12ã€poitã€marksï¼‰</li>
                        <li>âœ… <strong>è´¦æˆ·å®Œå…¨éš”ç¦»ï¼š</strong>æ¯ä¸ªè´¦æˆ·çš„ç­–ç•¥å¼€å…³ã€æ‰§è¡Œå†å²ã€é…ç½®æ–‡ä»¶å®Œå…¨ç‹¬ç«‹</li>
                        <li>å®æ—¶è¡Œæƒ…ç›‘æ§ï¼ˆ27ä¸ªUSDT-SWAPäº¤æ˜“å¯¹ï¼‰</li>
                        <li><strong>ğŸ†• BTCä»·æ ¼è§¦å‘ç­–ç•¥ï¼ˆ2ä¸ªï¼Œå·²åˆ†ç¦»JSONLï¼‰ï¼š</strong>
                            <ul style="margin: 2px 0 0 20px;">
                                <li>æ¶¨å¹…å8åç­–ç•¥ï¼šBTCä»·æ ¼ < è§¦å‘ä»·ï¼Œå¯¹å¸¸ç”¨å¸ä¸­æ¶¨å¹…å8åå¼€å¤šå•</li>
                                <li>æ¶¨å¹…å‰8åç­–ç•¥ï¼šBTCä»·æ ¼ > è§¦å‘ä»·ï¼Œå¯¹å¸¸ç”¨å¸ä¸­æ¶¨å¹…å‰8åå¼€å¤šå•</li>
                                <li>âœ… <strong>ç‹¬ç«‹JSONLæ–‡ä»¶ï¼š</strong>æ¯ä¸ªè´¦æˆ·æ¯ä¸ªç­–ç•¥ä½¿ç”¨ç‹¬ç«‹æ–‡ä»¶ï¼Œé¿å…å†²çª</li>
                            </ul>
                        </li>
                        <li><strong>ğŸ†• ä¸Šæ¶¨å æ¯”0è§¦å‘ç­–ç•¥ï¼ˆ2ä¸ªï¼Œå®æ—¶æ˜¾ç¤ºï¼‰ï¼š</strong>
                            <ul style="margin: 2px 0 0 20px;">
                                <li>ä¸Šæ¶¨å æ¯”0-æ¶¨å¹…å‰8åï¼šä¸Šæ¶¨å æ¯” = 0%æ—¶ï¼Œå¯¹å¸¸ç”¨å¸ä¸­æ¶¨å¹…å‰8åå¼€å¤šå•</li>
                                <li>ä¸Šæ¶¨å æ¯”0-æ¶¨å¹…å8åï¼šä¸Šæ¶¨å æ¯” = 0%æ—¶ï¼Œå¯¹å¸¸ç”¨å¸ä¸­æ¶¨å¹…å8åå¼€å¤šå•</li>
                                <li>âœ… <strong>å®æ—¶æ˜¾ç¤ºï¼š</strong>ä¸Šæ¶¨å æ¯”å§‹ç»ˆå¯è§ï¼Œ0%æ—¶çº¢è‰²é«˜äº®ï¼Œ60ç§’è‡ªåŠ¨æ›´æ–°</li>
                                <li>æ’é™¤æ—¶æ®µï¼šæ¯å¤©0:00-0:30ï¼ˆåŒ—äº¬æ—¶é—´ï¼‰ä¸æ‰§è¡Œ</li>
                            </ul>
                        </li>
                        <li><strong>ğŸ†• è‡ªåŠ¨æ­¢ç›ˆæ­¢æŸç³»ç»Ÿï¼ˆåå°ç›‘æ§ï¼‰ï¼š</strong>
                            <ul style="margin: 2px 0 0 20px;">
                                <li>âœ… <strong>æŒ‰è´¦æˆ·ç‹¬ç«‹é…ç½®ï¼š</strong>æ¯ä¸ªè´¦æˆ·ç‹¬ç«‹JSONLæ–‡ä»¶ï¼ˆ*_tpsl.jsonlï¼‰</li>
                                <li>âœ… <strong>æŒ‰æŒä»“ä»·æ ¼ç™¾åˆ†æ¯”ï¼š</strong>æ­¢ç›ˆ12%ï¼Œæ­¢æŸ-8%ï¼ˆå¯è‡ªå®šä¹‰ï¼‰</li>
                                <li>âœ… <strong>å¼€ä»“é‡‘é¢é™åˆ¶ï¼š</strong>5Ué™åˆ¶ä»…ç”¨äºå¼€ä»“é£æ§ï¼Œæ­¢ç›ˆæ­¢æŸä¸å—æ­¤é™åˆ¶</li>
                                <li>âœ… <strong>é˜²é‡å¤æ‰§è¡Œï¼š</strong>æ¯ä¸ªæŒä»“åªæ‰§è¡Œä¸€æ¬¡ï¼Œè®°å½•åœ¨*_execution.jsonl</li>
                                <li>âœ… <strong>Telegramé€šçŸ¥ï¼š</strong>è®¢å•è®¾ç½®æˆåŠŸ/å¤±è´¥/å¼‚å¸¸å¤§å•å‡å‘é€é€šçŸ¥</li>
                                <li>âœ… <strong>åå°è‡ªåŠ¨è¿è¡Œï¼š</strong>PM2å®ˆæŠ¤è¿›ç¨‹ï¼Œæ¯60ç§’æ£€æŸ¥ï¼Œæ— éœ€äººå·¥ç¡®è®¤</li>
                                <li>ğŸ“„ é…ç½®æ–‡ä»¶ï¼šdata/okx_tpsl_settings/account_*_tpsl.jsonl</li>
                                <li>ğŸ”§ æœåŠ¡åç§°ï¼šokx-tpsl-monitorï¼ˆéœ€æ‰‹åŠ¨å¯åŠ¨ï¼‰</li>
                            </ul>
                        </li>
                        <li><strong>ğŸ†• å¸‚åœºæƒ…ç»ªè§é¡¶/è§åº•ä¿¡å·ç›‘æ§ï¼ˆåå°è¿è¡Œï¼‰ï¼š</strong>
                            <ul style="margin: 2px 0 0 20px;">
                                <li>ğŸ”¥ <strong>è§åº•ä¿¡å·ï¼š</strong>å¸‚åœºä¸‹è·Œä¸­ï¼ŒRSIé™å¹… â‰¥ å¸ä»·è·Œå¹…Ã—10ï¼Œææ…Œè¿‡åº¦ï¼Œé˜¶æ®µæ€§åº•éƒ¨</li>
                                <li>âš ï¸ <strong>è§é¡¶ä¿¡å·ï¼š</strong>å¸‚åœºä¸Šæ¶¨ä¸­ï¼ŒRSIæ¶¨å¹… â‰¥ å¸ä»·æ¶¨å¹…Ã—10ï¼Œè´ªå©ªè¿‡åº¦ï¼Œå¯èƒ½è§é¡¶</li>
                                <li>ğŸ“± <strong>Telegramé€šçŸ¥ï¼š</strong>è§¦å‘ä¿¡å·æ—¶è‡ªåŠ¨å‘é€3æ¡é€šçŸ¥ï¼ˆé—´éš”1ç§’ï¼‰ï¼ŒåŒ…å«è¯¦ç»†å¸‚åœºæ•°æ®å’Œæ“ä½œå»ºè®®</li>
                                <li>â° <strong>é‡‡é›†é—´éš”ï¼š</strong>æ¯15åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡ï¼ˆæ•´ç‚¹:00, :15, :30, :45ï¼‰</li>
                                <li>ğŸ“Š <strong>æ•°æ®æ¥æºï¼š</strong>27å¸ç´¯è®¡æ¶¨è·Œå¹… + RSIæ€»å’Œï¼ˆcoin_change_tracker + rsi_trackerï¼‰</li>
                                <li>âœ… <strong>ç¡¬ç¼–ç é…ç½®ï¼š</strong>TG Bot Tokenå’ŒChat IDå·²å†™å…¥ç¨‹åºï¼Œæ— éœ€å¤–éƒ¨é…ç½®</li>
                                <li>ğŸ“„ æ•°æ®æ–‡ä»¶ï¼šdata/market_sentiment/market_sentiment_YYYYMMDD.jsonl</li>
                                <li>ğŸ”§ æœåŠ¡åç§°ï¼šmarket-sentiment-collectorï¼ˆå·²è‡ªåŠ¨è¿è¡Œï¼‰</li>
                            </ul>
                        </li>
                        <li>è´¦æˆ·çº§æ­¢ç›ˆæ­¢æŸï¼ˆåŸºäºæ€»æœªå®ç°ç›ˆäºï¼Œæ—§ç‰ˆé¢æ¿ï¼‰</li>
                        <li>æŒä»“ç®¡ç†ä¸å§”æ‰˜è®¢å•è·Ÿè¸ª</li>
                        <li>äº¤æ˜“æ—¥å¿—è®°å½•ä¸åˆ†æ</li>
                        <li>ä»·æ ¼æ¶¨è·Œå¹…è¿½è¸ªä¸é¢„è­¦</li>
                    </ul>
                    
                    <div style="margin: 10px 0; padding: 8px; background: #dcfce7; border-radius: 4px; border-left: 3px solid #16a34a;">
                        <p style="margin: 0; font-weight: 600; color: #15803d;">ğŸ¯ v2.6.1 ç´§æ€¥ä¿®å¤ï¼ˆ2026-02-19ï¼‰ï¼š</p>
                        <ul style="margin: 4px 0 0 20px; padding: 0; color: #166534;">
                            <li><strong>ä¿®å¤1ï¼š</strong>æ‰¹é‡å¼€ä»“é‡‘é¢é”™è¯¯ - szå‚æ•°æ”¹ç”¨marginPerCoinï¼ˆä¿è¯é‡‘ï¼‰è€ŒécontractValuePerCoinï¼ˆåˆçº¦ä»·å€¼ï¼‰</li>
                            <li><strong>ä¿®å¤2ï¼š</strong>é£æ§æ£€æŸ¥å¤±æ•ˆ - æ–°å¢maxOrderSizeå‚æ•°ä¼ é€’ï¼Œåç«¯å®ç°åŒé‡éªŒè¯</li>
                            <li><strong>ä¿®å¤3ï¼š</strong>å•ç¬”é™é¢ä¿éšœ - å‰ç«¯Math.minè®¡ç®— + åç«¯äºŒæ¬¡æ£€æŸ¥ï¼Œç¡®ä¿ä¸è¶…é™</li>
                            <li><strong>å½±å“ï¼š</strong>ä¿®å¤å‰å•ç¬”é‡‘é¢æ˜¯é¢„æœŸçš„10å€ï¼ˆå¦‚é…ç½®5Uå®é™…å¼€50Uåˆçº¦ä»·å€¼ï¼‰ï¼Œç°å·²ä¿®æ­£</li>
                            <li><strong>æ–°å¢4ï¼š</strong>ğŸ”¥âš ï¸ å¸‚åœºæƒ…ç»ªè§é¡¶/è§åº•ä¿¡å·ç›‘æ§ - è‡ªåŠ¨å‘é€TGé€šçŸ¥Ã—3ï¼Œ15åˆ†é’Ÿæ£€æŸ¥ä¸€æ¬¡</li>
                        </ul>
                        <p style="margin: 8px 0 0 0; font-weight: 600; color: #15803d;">ğŸ¯ v2.6 æ ¸å¿ƒå‡çº§äº®ç‚¹ï¼ˆ2026-02-17ï¼‰ï¼š</p>
                        <ul style="margin: 4px 0 0 20px; padding: 0; color: #166534;">
                            <li><strong>æ–°å¢1ï¼š</strong>è‡ªåŠ¨æ­¢ç›ˆæ­¢æŸç³»ç»Ÿ - åå°æ¯60ç§’è‡ªåŠ¨æ£€æŸ¥ï¼Œæ— éœ€äººå·¥ç¡®è®¤</li>
                            <li><strong>æ–°å¢2ï¼š</strong>æœ€å¤§æŒä»“ä»·å€¼ä¿æŠ¤ - é»˜è®¤5Ué™åˆ¶ï¼Œé˜²æ­¢é”™è¯¯å¼€å•è§¦å‘æ­¢ç›ˆæ­¢æŸ</li>
                            <li><strong>æ–°å¢3ï¼š</strong>Telegramé€šçŸ¥é›†æˆ - è®¢å•è®¾ç½®æˆåŠŸ/å¤±è´¥/å¼‚å¸¸å¤§å•å®æ—¶é€šçŸ¥</li>
                            <li><strong>æ–°å¢4ï¼š</strong>é˜²é‡å¤æ‰§è¡Œæœºåˆ¶ - æ¯ä¸ªæŒä»“åªæ‰§è¡Œä¸€æ¬¡ï¼Œè®°å½•åœ¨execution.jsonl</li>
                            <li><strong>æ–°å¢5ï¼š</strong>å…¨ç³»ç»Ÿç»Ÿä¸€Telegramé…ç½® - config/telegram_config.py</li>
                        </ul>
                        <p style="margin: 8px 0 0 0; font-weight: 600; color: #15803d;">ğŸ“š å†å²ç‰ˆæœ¬ï¼š</p>
                        <ul style="margin: 4px 0 0 20px; padding: 0; color: #166534;">
                            <li><strong>v2.3ï¼š</strong>ä¸Šæ¶¨å æ¯”æ˜¾ç¤º - å®æ—¶æ˜¾ç¤ºï¼Œ0ç§’å»¶è¿Ÿï¼Œ0%çº¢è‰²é«˜äº®</li>
                            <li><strong>v2.4ï¼š</strong>è´¦æˆ·ç‹¬ç«‹ç­–ç•¥å¼€å…³ - åˆ‡æ¢è´¦æˆ·è‡ªåŠ¨åŠ è½½å¯¹åº”ç­–ç•¥çŠ¶æ€</li>
                            <li><strong>v2.5ï¼š</strong>BTCç­–ç•¥JSONLåˆ†ç¦» - 4è´¦æˆ·Ã—4ç­–ç•¥=16ä¸ªç‹¬ç«‹æ–‡ä»¶</li>
                        </ul>
                    </div>
                </div>
                
                <!-- 2. è¿è¡Œæµç¨‹ -->
                <div style="background: white; padding: 10px; border-radius: 6px; margin-bottom: 10px; border-left: 4px solid #06b6d4;">
                    <h4 style="margin: 0 0 8px 0; color: #0369a1; font-size: 12px;">âš™ï¸ äºŒã€è¿è¡Œæµç¨‹</h4>
                    <p style="margin: 4px 0;"><strong>é¡µé¢åŠ è½½æµç¨‹ï¼š</strong></p>
                    <ol style="margin: 4px 0 0 20px; padding: 0;">
                        <li>ä»åç«¯APIåŠ è½½è´¦æˆ·åˆ—è¡¨ï¼ˆ/api/okx-accounts/list-with-credentialsï¼‰</li>
                        <li>æ¸²æŸ“è´¦æˆ·æ ‡ç­¾å¹¶è®¾ç½®é»˜è®¤è´¦æˆ·</li>
                        <li>åŠ è½½å¸¸ç”¨å¸åˆ—è¡¨ï¼ˆä»æœåŠ¡å™¨localStorageåŒæ­¥ï¼‰</li>
                        <li>åŠ è½½å®æ—¶è¡Œæƒ…æ•°æ®ï¼ˆ/api/okx-trading/market-tickersï¼‰</li>
                        <li>åŠ è½½è´¦æˆ·ä¿¡æ¯ï¼ˆä½™é¢ã€æœªå®ç°ç›ˆäºï¼‰</li>
                        <li>åŠ è½½æŒä»“ã€å§”æ‰˜è®¢å•ã€äº¤æ˜“æ—¥å¿—</li>
                        <li>åŠ è½½æ­¢ç›ˆæ­¢æŸè®¾ç½®å’Œè‡ªåŠ¨äº¤æ˜“ç­–ç•¥è®¾ç½®</li>
                    </ol>
                    <p style="margin: 8px 0 4px 0;"><strong>å®šæ—¶ä»»åŠ¡ï¼ˆæ¯60ç§’ï¼‰ï¼š</strong></p>
                    <ul style="margin: 4px 0 0 20px; padding: 0;">
                        <li>åˆ·æ–°è´¦æˆ·æ•°æ®ï¼ˆä½™é¢ã€æŒä»“ï¼‰</li>
                        <li>æ›´æ–°æ€»æ¶¨è·Œå¹…ç»Ÿè®¡</li>
                        <li>æ£€æŸ¥å¹¶æ‰§è¡ŒBTCä»·æ ¼è§¦å‘ç­–ç•¥ï¼ˆæ¶¨å¹…å‰8å/æ¶¨å¹…å8åï¼‰</li>
                        <li>ğŸ†• æ£€æŸ¥å¹¶æ‰§è¡Œä¸Šæ¶¨å æ¯”0è§¦å‘ç­–ç•¥ï¼ˆæ¶¨å¹…å‰8å/æ¶¨å¹…å8åï¼‰</li>
                        <li>æ£€æŸ¥æ­¢ç›ˆæ­¢æŸè§¦å‘æ¡ä»¶</li>
                    </ul>
                    
                    <p style="margin: 8px 0 4px 0; padding: 8px; background: #dbeafe; border-radius: 4px; border-left: 3px solid #3b82f6;"><strong>ğŸ“Œ ç­–ç•¥å¸ƒå±€é¡ºåºï¼š</strong>BTCä»·æ ¼è§¦å‘ç­–ç•¥ â†’ ä¸Šæ¶¨å æ¯”0è§¦å‘ç­–ç•¥ â†’ è´¦æˆ·é™é¢ â†’ æ¶¨è·Œé¢„è­¦</p>
                    
                    <p style="margin: 8px 0 4px 0;"><strong>BTCä»·æ ¼è§¦å‘ç­–ç•¥æ‰§è¡Œæµç¨‹ï¼š</strong></p>
                    <ol style="margin: 4px 0 0 20px; padding: 0;">
                        <li><strong>è§¦å‘æ£€æŸ¥ï¼š</strong>æ¯60ç§’æ£€æŸ¥ä¸€æ¬¡BTCä»·æ ¼</li>
                        <li><strong>è§¦å‘æ¡ä»¶ï¼š</strong>
                            <ul style="margin: 2px 0 0 20px;">
                                <li>æ¶¨å¹…å8åï¼šBTCä»·æ ¼ < è®¾å®šçš„è§¦å‘ä»·æ ¼ï¼ˆå¦‚68000ï¼‰</li>
                                <li>æ¶¨å¹…å‰8åï¼šBTCä»·æ ¼ > è®¾å®šçš„è§¦å‘ä»·æ ¼</li>
                            </ul>
                        </li>
                        <li><strong>è¯†åˆ«æ ‡çš„ï¼š</strong>è·å–å¸¸ç”¨å¸(15ä¸ª)çš„24hæ¶¨è·Œå¹…æ•°æ®</li>
                        <li><strong>æ’åºç­›é€‰ï¼š</strong>
                            <ul style="margin: 2px 0 0 20px;">
                                <li>æ¶¨å¹…å8åï¼šæŒ‰æ¶¨è·Œå¹…å‡åºæ’åˆ—ï¼Œå–å‰8åï¼ˆæ¶¨å¹…æœ€ä½çš„8ä¸ªï¼‰</li>
                                <li>æ¶¨å¹…å‰8åï¼šæŒ‰æ¶¨è·Œå¹…é™åºæ’åˆ—ï¼Œå–å‰8åï¼ˆæ¶¨å¹…æœ€é«˜çš„8ä¸ªï¼‰</li>
                            </ul>
                        </li>
                        <li><strong>ä»“ä½è®¡ç®—ï¼š</strong>æ¯ä¸ªå¸ç§ç”¨æ€»æƒç›Š Ã— positionSize%ï¼ˆé»˜è®¤1.5%ï¼Œä¸Šé™5 USDTï¼‰ï¼Œ10å€æ æ†
                            <ul style="margin: 2px 0 0 20px; font-size: 10px; color: #64748b;">
                                <li>ğŸ“ å¯åœ¨é…ç½®æ–‡ä»¶ä¸­è®¾ç½® <code>positionSize</code> å­—æ®µï¼ˆå¦‚ 0.5ã€1.5ã€3.0ï¼‰</li>
                                <li>ğŸ’° è®¡ç®—å…¬å¼ï¼šmin(æ€»æƒç›Š Ã— positionSize%, 5 USDT)</li>
                                <li>ğŸŸ¢ ä¿å®ˆï¼š0.5% | ğŸŸ¡ ç¨³å¥ï¼š1.5% | ğŸ”´ æ¿€è¿›ï¼š3.0%</li>
                                <li>ğŸ“Š ç¤ºä¾‹ï¼ˆæ€»æƒç›Š198.64 USDTï¼‰ï¼š1.5% â†’ 2.98 USDT/å¸ Ã— 8 = 23.84 USDT</li>
                            </ul>
                        </li>
                        <li><strong>æ‰¹é‡å¼€å•ï¼š</strong>å¯¹è¿™8ä¸ªå¸ç§é€ä¸ªä¸‹å¸‚ä»·å¤šå•</li>
                        <li><strong>å‘é€é€šçŸ¥ï¼š</strong>è§¦å‘æ—¶å‘é€TGæ¶ˆæ¯ï¼Œæ‰§è¡Œå®Œæˆåå‘é€TGæ¶ˆæ¯å’ŒAlertå¼¹çª—</li>
                        <li><strong>è‡ªåŠ¨å…³é—­ï¼š</strong>æ‰§è¡Œå®Œæˆåè‡ªåŠ¨å…³é—­ç­–ç•¥å¼€å…³ï¼ˆenabled=falseï¼‰</li>
                        <li><strong>è®°å½•æ—¥å¿—ï¼š</strong>è®°å½•æ‰§è¡Œæ—¶é—´ã€å¸ç§ã€ç»“æœåˆ°JSONLæ–‡ä»¶</li>
                    </ol>
                    
                    <p style="margin: 8px 0 4px 0;"><strong>ğŸ†• ä¸Šæ¶¨å æ¯”0è§¦å‘ç­–ç•¥æ‰§è¡Œæµç¨‹ï¼š</strong></p>
                    <ol style="margin: 4px 0 0 20px; padding: 0;">
                        <li><strong>è§¦å‘æ£€æŸ¥ï¼š</strong>æ¯60ç§’æ£€æŸ¥ä¸€æ¬¡ä¸Šæ¶¨å æ¯”</li>
                        <li><strong>è§¦å‘æ¡ä»¶ï¼š</strong>
                            <ul style="margin: 2px 0 0 20px;">
                                <li>ä¸Šæ¶¨å æ¯” = 0%ï¼ˆ27ä¸ªå¸ç§å…¨éƒ¨ä¸‹è·Œï¼‰</li>
                                <li>å½“å‰æ—¶é—´ä¸åœ¨0:00-0:30ï¼ˆåŒ—äº¬æ—¶é—´ï¼‰</li>
                                <li>JSONLå…è®¸çŠ¶æ€ä¸ºtrueï¼ˆé˜²é‡å¤æ‰§è¡Œï¼‰</li>
                            </ul>
                        </li>
                        <li><strong>è¯†åˆ«æ ‡çš„ï¼š</strong>è·å–å¸¸ç”¨å¸(15ä¸ª)çš„æ¶¨è·Œå¹…æ•°æ®</li>
                        <li><strong>æ’åºç­›é€‰ï¼š</strong>
                            <ul style="margin: 2px 0 0 20px;">
                                <li>æ¶¨å¹…å‰8åç­–ç•¥ï¼šæŒ‰æ¶¨è·Œå¹…é™åºæ’åˆ—ï¼Œå–å‰8åï¼ˆè·Œå¹…æœ€å°çš„8ä¸ªï¼‰</li>
                                <li>æ¶¨å¹…å8åç­–ç•¥ï¼šæŒ‰æ¶¨è·Œå¹…å‡åºæ’åˆ—ï¼Œå–å‰8åï¼ˆè·Œå¹…æœ€å¤§çš„8ä¸ªï¼‰</li>
                            </ul>
                        </li>
                        <li><strong>ä»“ä½è®¡ç®—ï¼š</strong>æ¯ä¸ªå¸ç§ç”¨æ€»æƒç›Š Ã— positionSize%ï¼ˆé»˜è®¤1.5%ï¼Œä¸Šé™5 USDTï¼‰ï¼Œ10å€æ æ†
                            <ul style="margin: 2px 0 0 20px; font-size: 10px; color: #64748b;">
                                <li>ğŸ“ å¯åœ¨é…ç½®æ–‡ä»¶ä¸­è®¾ç½® <code>positionSize</code> å­—æ®µï¼ˆå¦‚ 0.5ã€1.5ã€3.0ï¼‰</li>
                                <li>ğŸ’° è®¡ç®—å…¬å¼ï¼šmin(æ€»æƒç›Š Ã— positionSize%, 5 USDT)</li>
                                <li>ğŸŸ¢ ä¿å®ˆï¼š0.5% | ğŸŸ¡ ç¨³å¥ï¼š1.5% | ğŸ”´ æ¿€è¿›ï¼š3.0%</li>
                                <li>ğŸ“Š ç¤ºä¾‹ï¼ˆæ€»æƒç›Š198.64 USDTï¼‰ï¼š1.5% â†’ 2.98 USDT/å¸ Ã— 8 = 23.84 USDT</li>
                            </ul>
                        </li>
                        <li><strong>æ‰¹é‡å¼€å•ï¼š</strong>å¯¹è¿™8ä¸ªå¸ç§é€ä¸ªä¸‹å¸‚ä»·å¤šå•</li>
                        <li><strong>å‘é€é€šçŸ¥ï¼š</strong>æ‰§è¡Œå®Œæˆåå‘é€TGæ¶ˆæ¯å’ŒAlertå¼¹çª—</li>
                        <li><strong>å†™å…¥JSONLï¼š</strong>è®¾ç½®allowed=falseï¼Œé˜²æ­¢é‡å¤æ‰§è¡Œ</li>
                        <li><strong>è‡ªåŠ¨å…³é—­ï¼š</strong>æ‰§è¡Œå®Œæˆåè‡ªåŠ¨å…³é—­ç­–ç•¥å¼€å…³</li>
                        <li><strong>åˆ·æ–°æŒä»“ï¼š</strong>è‡ªåŠ¨åˆ·æ–°æŒä»“åˆ—è¡¨</li>
                    </ol>
                    <p style="margin: 8px 0 4px 0; padding: 8px; background: #fef3c7; border-radius: 4px;"><strong>âš ï¸ æ³¨æ„ï¼š</strong>è§¦å‘ä»·æ ¼/ä¸Šæ¶¨å æ¯”åªæ˜¯è§¦å‘æ¡ä»¶ï¼ŒçœŸæ­£å¼€å•çš„æ˜¯å¸¸ç”¨å¸ä¸­æ¶¨å¹…å‰8å/å8åçš„å¸ç§</p>
                </div>
                
                <!-- 2.5 ä»“ä½é…ç½®æŒ‡å— -->
                <div style="background: white; padding: 10px; border-radius: 6px; margin-bottom: 10px; border-left: 4px solid #10b981;">
                    <h4 style="margin: 0 0 8px 0; color: #0369a1; font-size: 12px;">ğŸ“Š äºŒ.äº”ã€ä»“ä½é…ç½®æŒ‡å—ï¼ˆpositionSizeï¼‰</h4>
                    
                    <p style="margin: 4px 0; font-size: 10px;"><strong>ğŸ¯ é…ç½®è¯´æ˜ï¼š</strong></p>
                    <ul style="margin: 2px 0 0 20px; padding: 0; font-size: 10px;">
                        <li><strong>positionSize</strong>ï¼šæ¯ä¸ªå¸ç§çš„å¼€ä»“é‡‘é¢å æ€»æƒç›Šçš„ç™¾åˆ†æ¯”ï¼ˆå¦‚ 1.5 è¡¨ç¤º 1.5%ï¼‰</li>
                        <li><strong>é»˜è®¤å€¼</strong>ï¼š1.5ï¼ˆå³ 1.5%ï¼‰ï¼Œå¦‚é…ç½®æ–‡ä»¶ä¸­æœªè®¾ç½®åˆ™ä½¿ç”¨æ­¤å€¼</li>
                        <li><strong>è®¡ç®—å…¬å¼</strong>ï¼šå¼€ä»“é‡‘é¢ = min(æ€»æƒç›Š Ã— positionSize%, 5 USDT)</li>
                        <li><strong>ä¸Šé™ä¿æŠ¤</strong>ï¼šå•ç¬”å¼€ä»“æœ€å¤š 5 USDTï¼ˆé˜²æ­¢é”™è¯¯é…ç½®ï¼‰</li>
                        <li><strong>ç”Ÿæ•ˆæ—¶æœº</strong>ï¼šä¿®æ”¹é…ç½®æ–‡ä»¶åï¼Œä¸‹æ¬¡ç­–ç•¥è§¦å‘æ—¶è‡ªåŠ¨ç”Ÿæ•ˆ</li>
                    </ul>
                    
                    <p style="margin: 8px 0 4px 0; font-size: 10px;"><strong>ğŸ’° æ¨èé…ç½®ï¼š</strong></p>
                    <table style="width: 100%; font-size: 9px; border-collapse: collapse; margin: 4px 0;">
                        <thead>
                            <tr style="background: #f1f5f9;">
                                <th style="padding: 4px; border: 1px solid #cbd5e1; text-align: left;">é£é™©ç­‰çº§</th>
                                <th style="padding: 4px; border: 1px solid #cbd5e1; text-align: center;">positionSize</th>
                                <th style="padding: 4px; border: 1px solid #cbd5e1; text-align: center;">æ¯å¸å¼€ä»“*</th>
                                <th style="padding: 4px; border: 1px solid #cbd5e1; text-align: center;">8å¸æ€»è®¡*</th>
                                <th style="padding: 4px; border: 1px solid #cbd5e1; text-align: center;">å æ€»æƒç›Š</th>
                                <th style="padding: 4px; border: 1px solid #cbd5e1; text-align: left;">é€‚ç”¨åœºæ™¯</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;">ğŸŸ¢ ä¿å®ˆ</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1; text-align: center;">0.5</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1; text-align: center;">0.99 U</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1; text-align: center;">7.95 U</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1; text-align: center;">4.0%</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;">ç­–ç•¥æµ‹è¯•ã€å°èµ„é‡‘</td>
                            </tr>
                            <tr style="background: #fef3c7;">
                                <td style="padding: 4px; border: 1px solid #cbd5e1;"><strong>ğŸŸ¡ ç¨³å¥ï¼ˆæ¨èï¼‰</strong></td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1; text-align: center;"><strong>1.5</strong></td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1; text-align: center;"><strong>2.98 U</strong></td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1; text-align: center;"><strong>23.84 U</strong></td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1; text-align: center;"><strong>12.0%</strong></td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;"><strong>æ—¥å¸¸è¿è¡Œã€å¹³è¡¡é£é™©</strong></td>
                            </tr>
                            <tr>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;">ğŸŸ  ä¸­ç­‰</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1; text-align: center;">2.0</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1; text-align: center;">3.97 U</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1; text-align: center;">31.78 U</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1; text-align: center;">16.0%</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;">è¾ƒæ¿€è¿›ç­–ç•¥</td>
                            </tr>
                            <tr>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;">ğŸ”´ æ¿€è¿›</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1; text-align: center;">3.0</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1; text-align: center;">5.00 U â¬†ï¸</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1; text-align: center;">40.00 U</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1; text-align: center;">20.1%</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;">é«˜é£é™©ï¼Œè§¦å‘ä¸Šé™</td>
                            </tr>
                        </tbody>
                    </table>
                    <p style="margin: 2px 0; font-size: 9px; color: #64748b;">*åŸºäºæ€»æƒç›Š 198.64 USDT è®¡ç®—ç¤ºä¾‹ï¼›â¬†ï¸ è¡¨ç¤ºè§¦å‘ 5 USDT ä¸Šé™</p>
                    
                    <p style="margin: 8px 0 4px 0; font-size: 10px;"><strong>ğŸ”§ é…ç½®æ–¹æ³•ï¼š</strong></p>
                    <pre style="background: #1e293b; color: #e2e8f0; padding: 8px; border-radius: 4px; overflow-x: auto; font-size: 9px; margin: 4px 0;"># ç¼–è¾‘é…ç½®æ–‡ä»¶
vim /home/user/webapp/data/okx_auto_strategy/account_poit_main.json

# ä¿®æ”¹ positionSize å’Œ maxOrderSize å­—æ®µ
{
  "enabled": true,
  "triggerPrice": 67000.0,
  "strategyType": "bottom_performers",
  "positionSize": 1.5,      â† æ¯å¸å æ¯”ï¼ˆå¦‚æ”¹ä¸º 2.0 è¡¨ç¤º2%ï¼‰
  "maxOrderSize": 5.0,      â† å•ç¬”ä¸Šé™ï¼ˆå¦‚æ”¹ä¸º 10.0 è¡¨ç¤º10Uï¼‰
  ...
}

# ä¿å­˜åä¸‹æ¬¡ç­–ç•¥è§¦å‘æ—¶ç”Ÿæ•ˆï¼ˆæ— éœ€é‡å¯ï¼‰</pre>
                    
                    <p style="margin: 8px 0 4px 0; font-size: 10px;"><strong>âœ… éªŒè¯é…ç½®ï¼š</strong></p>
                    <pre style="background: #1e293b; color: #e2e8f0; padding: 8px; border-radius: 4px; overflow-x: auto; font-size: 9px; margin: 4px 0;"># æŸ¥çœ‹æ‰§è¡Œæ—¥å¿—
pm2 logs flask-app --lines 20 | grep "å¼€ä»“é‡‘é¢"

# é¢„æœŸè¾“å‡ºç¤ºä¾‹ï¼š
ğŸ“Š æ¯ä¸ªå¸ç§å¼€ä»“é‡‘é¢: 2.98 USDT (å¯ç”¨ä½™é¢198.64 Ã— 1.5%, ä¸Šé™5.0U)</pre>
                    
                    <div style="margin: 8px 0; padding: 6px; background: #fee2e2; border-left: 3px solid #ef4444; border-radius: 4px; font-size: 9px;">
                        <p style="margin: 0 0 2px 0; font-weight: 600; color: #991b1b;">âš ï¸ é£é™©æç¤º</p>
                        <ul style="margin: 2px 0 0 16px; padding: 0; color: #7f1d1d;">
                            <li>positionSize è¿‡é«˜ä¼šå¢åŠ é£é™©ï¼Œå»ºè®®ä¸è¶…è¿‡ 3.0ï¼ˆæ€»æƒç›Šçš„3%ï¼‰</li>
                            <li>8ä¸ªå¸ç§åŒæ—¶å¼€ä»“ï¼Œæ€»ä»“ä½ = positionSize Ã— 8ï¼ˆå¦‚ 1.5% Ã— 8 = 12%ï¼‰</li>
                            <li>ä½¿ç”¨ 10 å€æ æ†ï¼Œå®é™…é£é™©æ•å£ = æ€»ä»“ä½ Ã— 10ï¼ˆå¦‚ 12% Ã— 10 = 120%ï¼‰</li>
                            <li>å»ºè®®å…ˆç”¨å°é‡‘é¢ï¼ˆ0.5%ï¼‰æµ‹è¯•ï¼Œç¡®è®¤æ— è¯¯åå†æé«˜</li>
                        </ul>
                    </div>
                </div>
                
                <!-- 2.6 ä»£ç è®¾è®¡ä¸å¤ç”¨é€»è¾‘ -->
                <div style="background: white; padding: 10px; border-radius: 6px; margin-bottom: 10px; border-left: 4px solid #8b5cf6;">
                    <h4 style="margin: 0 0 8px 0; color: #6d28d9; font-size: 12px;">ğŸ—ï¸ äºŒ.å…­ã€ä»£ç è®¾è®¡ä¸å¤ç”¨é€»è¾‘ï¼ˆé‡è¦ï¼‰</h4>
                    
                    <p style="margin: 4px 0; font-size: 10px;"><strong>ğŸ’¡ è®¾è®¡åŸåˆ™ï¼š</strong></p>
                    <div style="margin: 4px 0; padding: 8px; background: #f3e8ff; border-radius: 4px; border-left: 3px solid #8b5cf6;">
                        <p style="margin: 0 0 4px 0; font-weight: 600; color: #6d28d9; font-size: 10px;">æ ¸å¿ƒæ€æƒ³ï¼šè‡ªåŠ¨ç­–ç•¥ç›´æ¥è°ƒç”¨æ‰‹åŠ¨æ‰¹é‡å¼€ä»“å‡½æ•°ï¼Œé¿å…ä»£ç é‡å¤</p>
                        <ul style="margin: 2px 0 0 16px; padding: 0; font-size: 10px; color: #5b21b6;">
                            <li><strong>ä»£ç å¤ç”¨ï¼š</strong>æ‰€æœ‰è‡ªåŠ¨ç­–ç•¥é€šè¿‡è°ƒç”¨ <code>batchOrderTop8()</code> å’Œ <code>batchOrderBottom8()</code> å®ç°</li>
                            <li><strong>é€»è¾‘ç»Ÿä¸€ï¼š</strong>æ‰‹åŠ¨å’Œè‡ªåŠ¨ä½¿ç”¨ç›¸åŒçš„ä¸‹å•é€»è¾‘ã€5Uä¸Šé™ä¿æŠ¤ã€TGé€šçŸ¥</li>
                            <li><strong>æ˜“äºç»´æŠ¤ï¼š</strong>åªéœ€ç»´æŠ¤ä¸€å¥—ä¸‹å•ä»£ç ï¼Œä¿®æ”¹ä¸€å¤„å…¨å±€ç”Ÿæ•ˆ</li>
                            <li><strong>åŠŸèƒ½æ‰©å±•ï¼š</strong>æ·»åŠ æ–°çš„è‡ªåŠ¨æ¡ä»¶å•ç­–ç•¥æ—¶ï¼Œéµå¾ªæ­¤æ¨¡å¼å³å¯</li>
                        </ul>
                    </div>
                    
                    <p style="margin: 8px 0 4px 0; font-size: 10px;"><strong>ğŸ”§ å®ç°æ–¹å¼ï¼š</strong></p>
                    <div style="margin: 4px 0; padding: 8px; background: #f8fafc; border: 1px solid #cbd5e1; border-radius: 4px;">
                        <pre style="background: #1e293b; color: #e2e8f0; padding: 8px; border-radius: 4px; overflow-x: auto; font-size: 9px; margin: 4px 0; line-height: 1.6;">// 1ï¸âƒ£ æ‰‹åŠ¨æ‰¹é‡å¼€ä»“å‡½æ•°ï¼ˆæ ¸å¿ƒé€»è¾‘ï¼‰
async function batchOrderTop8(direction, percentPerCoin, skipConfirm = false) {
    // å‚æ•°è¯´æ˜ï¼š
    // - direction: 'long' æˆ– 'short'
    // - percentPerCoin: æ¯ä¸ªå¸çš„ä»“ä½ç™¾åˆ†æ¯”ï¼ˆå¦‚ 1.5 è¡¨ç¤º 1.5%ï¼‰
    // - skipConfirm: æ˜¯å¦è·³è¿‡ç¡®è®¤å¼¹çª—ï¼ˆè‡ªåŠ¨ç­–ç•¥ä¼  trueï¼‰
    
    // æ ¸å¿ƒåŠŸèƒ½ï¼š
    // âœ… 5Uä¸Šé™ä¿æŠ¤ï¼šMath.min(balance Ã— percent%, 5)
    // âœ… ç¡®è®¤å¼¹çª—æ§åˆ¶ï¼šif (!skipConfirm) { confirm(...) }
    // âœ… TGé€šçŸ¥ï¼šå¼€å§‹æ‰§è¡Œ + æ‰§è¡Œå®Œæˆ
    // âœ… ç»“æœå¼¹çª—ï¼šæ˜¾ç¤ºæˆåŠŸ/å¤±è´¥ç»Ÿè®¡
    // âœ… ä¸‹å•é€»è¾‘ï¼šå¾ªç¯8ä¸ªå¸ç§ï¼Œé€ä¸ªä¸‹å•
}

// 2ï¸âƒ£ è‡ªåŠ¨ç­–ç•¥è°ƒç”¨ï¼ˆä»£ç å¤ç”¨ï¼‰
async function executeUpRatio0Strategy(account, upRatio, strategyType) {
    const positionSizePercent = account.positionSize || 1.5;
    
    // ç›´æ¥è°ƒç”¨æ‰‹åŠ¨æ‰¹é‡å¼€ä»“ï¼ˆskipConfirm=true è·³è¿‡ç¡®è®¤ï¼‰
    if (strategyType === 'top_8') {
        return await batchOrderTop8('long', positionSizePercent, true);
    } else {
        return await batchOrderBottom8('long', positionSizePercent, true);
    }
}

// 3ï¸âƒ£ BTCä»·æ ¼è§¦å‘ç­–ç•¥ï¼ˆåŒæ ·å¤ç”¨ï¼‰
async function executeAutoTrade(account, btcPrice, triggerPrice, strategyType) {
    const positionSizePercent = account.positionSize || 1.5;
    
    // ç›´æ¥è°ƒç”¨æ‰‹åŠ¨æ‰¹é‡å¼€ä»“ï¼ˆskipConfirm=true è·³è¿‡ç¡®è®¤ï¼‰
    if (strategyType === 'top_performers') {
        return await batchOrderTop8('long', positionSizePercent, true);
    } else {
        return await batchOrderBottom8('long', positionSizePercent, true);
    }
}</pre>
                    </div>
                    
                    <p style="margin: 8px 0 4px 0; font-size: 10px;"><strong>ğŸ“‹ åŠŸèƒ½å¯¹æ¯”è¡¨ï¼š</strong></p>
                    <table style="width: 100%; font-size: 9px; border-collapse: collapse; margin: 4px 0;">
                        <thead>
                            <tr style="background: #f1f5f9;">
                                <th style="padding: 4px; border: 1px solid #cbd5e1; text-align: left;">åŠŸèƒ½</th>
                                <th style="padding: 4px; border: 1px solid #cbd5e1; text-align: center;">æ‰‹åŠ¨è§¦å‘</th>
                                <th style="padding: 4px; border: 1px solid #cbd5e1; text-align: center;">è‡ªåŠ¨è§¦å‘</th>
                                <th style="padding: 4px; border: 1px solid #cbd5e1; text-align: left;">è¯´æ˜</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;">ç¡®è®¤å¼¹çª—</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1; text-align: center; background: #dcfce7;">âœ… æ˜¾ç¤º</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1; text-align: center; background: #fee2e2;">âŒ è·³è¿‡</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;">æ‰‹åŠ¨éœ€ç¡®è®¤ï¼Œè‡ªåŠ¨æ— éœ€</td>
                            </tr>
                            <tr>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;">TGé€šçŸ¥ï¼ˆå¼€å§‹ï¼‰</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1; text-align: center; background: #dcfce7;">âœ… å‘é€</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1; text-align: center; background: #dcfce7;">âœ… å‘é€</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;">éƒ½å‘é€å¼€å§‹é€šçŸ¥</td>
                            </tr>
                            <tr>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;">TGé€šçŸ¥ï¼ˆå®Œæˆï¼‰</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1; text-align: center; background: #dcfce7;">âœ… å‘é€</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1; text-align: center; background: #dcfce7;">âœ… å‘é€</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;">éƒ½å‘é€å®Œæˆé€šçŸ¥</td>
                            </tr>
                            <tr>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;">ç»“æœå¼¹çª—</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1; text-align: center; background: #dcfce7;">âœ… æ˜¾ç¤º</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1; text-align: center; background: #dcfce7;">âœ… æ˜¾ç¤º</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;">éƒ½æ˜¾ç¤ºæˆåŠŸ/å¤±è´¥ç»Ÿè®¡</td>
                            </tr>
                            <tr>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;">5Uä¸Šé™ä¿æŠ¤</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1; text-align: center; background: #dcfce7;">âœ… ç”Ÿæ•ˆ</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1; text-align: center; background: #dcfce7;">âœ… ç”Ÿæ•ˆ</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;">æ‰€æœ‰åœºæ™¯éƒ½æœ‰ä¿æŠ¤</td>
                            </tr>
                            <tr>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;">ä¸‹å•é€»è¾‘</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1; text-align: center; background: #dbeafe;" colspan="2">âœ… å®Œå…¨ç›¸åŒï¼ˆåŒä¸€å¥—ä»£ç ï¼‰</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;">é€»è¾‘ç»Ÿä¸€ï¼Œæ˜“ç»´æŠ¤</td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <p style="margin: 8px 0 4px 0; font-size: 10px;"><strong>ğŸš€ æ‰©å±•æŒ‡å—ï¼šæ·»åŠ æ–°çš„è‡ªåŠ¨æ¡ä»¶å•ç­–ç•¥</strong></p>
                    <div style="margin: 4px 0; padding: 8px; background: #fef3c7; border-left: 3px solid #f59e0b; border-radius: 4px;">
                        <p style="margin: 0 0 4px 0; font-weight: 600; color: #92400e; font-size: 10px;">ç¤ºä¾‹ï¼šæ·»åŠ "RSIè¶…ä¹°è¶…å–ç­–ç•¥"</p>
                        <pre style="background: #1e293b; color: #e2e8f0; padding: 8px; border-radius: 4px; overflow-x: auto; font-size: 9px; margin: 4px 0; line-height: 1.6;">// æ­¥éª¤1ï¼šåˆ›å»ºç­–ç•¥ç›‘æ§å‡½æ•°
async function checkRsiStrategy(account) {
    // 1. è·å–RSIæ•°æ®
    const rsi = await getRsiData();
    
    // 2. åˆ¤æ–­è§¦å‘æ¡ä»¶
    if (rsi < 30) {  // RSI < 30 è¶…å–ï¼Œåšå¤š
        // 3. ç›´æ¥è°ƒç”¨æ‰‹åŠ¨æ‰¹é‡å¼€ä»“ï¼ˆskipConfirm=trueï¼‰
        const positionSizePercent = account.positionSize || 1.5;
        return await batchOrderBottom8('long', positionSizePercent, true);
    } else if (rsi > 70) {  // RSI > 70 è¶…ä¹°ï¼Œåšç©º
        const positionSizePercent = account.positionSize || 1.5;
        return await batchOrderBottom8('short', positionSizePercent, true);
    }
}

// æ­¥éª¤2ï¼šåœ¨å®šæ—¶ä»»åŠ¡ä¸­è°ƒç”¨ï¼ˆæ¯60ç§’ï¼‰
setInterval(() => {
    checkRsiStrategy(currentAccount);
}, 60000);

// âœ… å°±è¿™ä¹ˆç®€å•ï¼æ— éœ€é‡å†™ä¸‹å•é€»è¾‘</pre>
                    </div>
                    
                    <p style="margin: 8px 0 4px 0; font-size: 10px;"><strong>ğŸ“Š ä¼˜åŠ¿æ€»ç»“ï¼š</strong></p>
                    <ul style="margin: 2px 0 0 16px; padding: 0; font-size: 10px;">
                        <li><strong>ä»£ç é‡å‡å°‘ï¼š</strong>~240è¡Œé‡å¤ä»£ç è¢«æ¶ˆé™¤ï¼Œå‡€å‡å°‘çº¦70%</li>
                        <li><strong>ç»´æŠ¤æˆæœ¬é™ä½ï¼š</strong>ä¿®æ”¹ä¸‹å•é€»è¾‘åªéœ€æ”¹ä¸€å¤„ï¼Œè‡ªåŠ¨å…¨å±€ç”Ÿæ•ˆ</li>
                        <li><strong>Bugä¿®å¤æ•ˆç‡ï¼š</strong>ä¿®å¤ä¸€æ¬¡ï¼Œæ‰€æœ‰ç­–ç•¥åŒæ­¥ä¿®å¤</li>
                        <li><strong>æ‰©å±•æ€§å¼ºï¼š</strong>æ·»åŠ æ–°ç­–ç•¥åªéœ€10-20è¡Œä»£ç </li>
                        <li><strong>é€»è¾‘ä¸€è‡´ï¼š</strong>æ‰‹åŠ¨å’Œè‡ªåŠ¨ä½¿ç”¨ç›¸åŒçš„ä¿æŠ¤æœºåˆ¶</li>
                    </ul>
                    
                    <div style="margin: 8px 0; padding: 6px; background: #dcfce7; border-left: 3px solid #16a34a; border-radius: 4px; font-size: 9px;">
                        <p style="margin: 0 0 2px 0; font-weight: 600; color: #15803d;">âœ… æœ€ä½³å®è·µ</p>
                        <ul style="margin: 2px 0 0 16px; padding: 0; color: #166534;">
                            <li>æ‰€æœ‰è‡ªåŠ¨æ¡ä»¶å•ç­–ç•¥éƒ½åº”éµå¾ªæ­¤è®¾è®¡æ¨¡å¼</li>
                            <li>æ‰‹åŠ¨æ‰¹é‡å¼€ä»“å‡½æ•°ä½œä¸º"æ ¸å¿ƒå¼•æ“"ï¼Œä¸è¦ç›´æ¥ä¿®æ”¹</li>
                            <li>æ–°ç­–ç•¥åªéœ€å…³æ³¨"è§¦å‘æ¡ä»¶åˆ¤æ–­"ï¼Œä¸‹å•é€»è¾‘å¤ç”¨å³å¯</li>
                            <li>ä¿æŒ <code>skipConfirm</code> å‚æ•°çš„ä½¿ç”¨è§„èŒƒï¼šæ‰‹åŠ¨=falseï¼Œè‡ªåŠ¨=true</li>
                        </ul>
                    </div>
                </div>
                
                <!-- 3. æ•°æ®å­˜å‚¨ç»“æ„ -->
                <div style="background: white; padding: 10px; border-radius: 6px; margin-bottom: 10px; border-left: 4px solid #8b5cf6;">
                    <h4 style="margin: 0 0 8px 0; color: #0369a1; font-size: 12px;">ğŸ’¾ ä¸‰ã€æ•°æ®å­˜å‚¨ç»“æ„ï¼ˆJSONLæ ¼å¼ï¼‰</h4>
                    
                    <p style="margin: 8px 0 4px 0; font-weight: 600;">3.1 æ¶¨å¹…å8åç­–ç•¥è®¾ç½®</p>
                    <p style="margin: 2px 0;"><code style="background: #f1f5f9; padding: 2px 4px; border-radius: 3px;">data/okx_auto_strategy/account_main.json</code></p>
                    <pre style="background: #1e293b; color: #e2e8f0; padding: 8px; border-radius: 4px; overflow-x: auto; font-size: 10px; margin: 4px 0;">
{
  "enabled": false,                // æ˜¯å¦å¯ç”¨ç­–ç•¥
  "strategyType": "bottom_performers",  // ç­–ç•¥ç±»å‹
  "strategyName": "æ¶¨å¹…å8åç­–ç•¥",   // ç­–ç•¥åç§°
  "targetSymbols": "favorite_bottom_8", // ç›®æ ‡å¸ç§
  "triggerPrice": 68000.0,         // BTCè§¦å‘ä»·æ ¼ï¼ˆUSDï¼‰
  "orderType": "long",             // å¼€å•æ–¹å‘ï¼ˆåªå¼€å¤šï¼‰
  "leverage": 10,                  // æ æ†å€æ•°
  "positionSize": 1.5,             // æ¯å¸ä»“ä½ç™¾åˆ†æ¯”
  "lastExecutedTime": null,        // ä¸Šæ¬¡æ‰§è¡Œæ—¶é—´
  "executedCount": 0,              // æ‰§è¡Œæ¬¡æ•°
  "lastUpdated": "2026-02-13 13:10:00"  // æœ€åæ›´æ–°æ—¶é—´
}</pre>
                    <div style="margin: 8px 0; padding: 8px; background: #dbeafe; border-left: 3px solid #3b82f6; border-radius: 4px; font-size: 10px;">
                        <p style="margin: 0 0 4px 0; font-weight: 600; color: #1e40af;">ğŸ“Š positionSize å­—æ®µè¯´æ˜ï¼ˆv2.6æ–°å¢ï¼‰</p>
                        <ul style="margin: 2px 0 0 16px; padding: 0; color: #1e3a8a;">
                            <li><strong>ä½œç”¨ï¼š</strong>æ¯ä¸ªå¸ç§çš„å¼€ä»“é‡‘é¢å æ€»æƒç›Šçš„ç™¾åˆ†æ¯”</li>
                            <li><strong>é»˜è®¤å€¼ï¼š</strong>1.5ï¼ˆå³1.5%ï¼‰</li>
                            <li><strong>è®¡ç®—å…¬å¼ï¼š</strong>å¼€ä»“é‡‘é¢ = min(æ€»æƒç›Š Ã— positionSize%, 5 USDT)</li>
                            <li><strong>æ¨èé…ç½®ï¼š</strong>ğŸŸ¢ ä¿å®ˆ 0.5% | ğŸŸ¡ ç¨³å¥ 1.5% | ğŸ”´ æ¿€è¿› 3.0%</li>
                            <li><strong>ç¤ºä¾‹ï¼š</strong>æ€»æƒç›Š198.64 USDTï¼ŒpositionSize=1.5 â†’ æ¯å¸2.98 USDTï¼Œ8å¸æ€»è®¡23.84 USDT</li>
                            <li><strong>ä¿®æ”¹æ–¹å¼ï¼š</strong>ç›´æ¥ç¼–è¾‘JSONæ–‡ä»¶ï¼Œä¿å­˜åä¸‹æ¬¡è§¦å‘æ—¶ç”Ÿæ•ˆ</li>
                        </ul>
                    </div>
                    <p style="margin: 2px 0;"><code style="background: #f1f5f9; padding: 2px 4px; border-radius: 3px;">data/okx_auto_strategy/account_main_history.jsonl</code></p>
                    <pre style="background: #1e293b; color: #e2e8f0; padding: 8px; border-radius: 4px; overflow-x: auto; font-size: 10px; margin: 4px 0;">
{"enabled": true, "triggerPrice": 68000.0, "strategyType": "bottom_performers", "lastExecutedTime": null, "executedCount": 0, "timestamp": "2026-02-13T13:00:00"}
{"enabled": false, "triggerPrice": 68000.0, "strategyType": "bottom_performers", "lastExecutedTime": "2026-02-13 13:15:22", "executedCount": 1, "executedCoins": ["SOL", "XRP", "TAO", "LDO", "CFX", "CRV", "UNI", "CRO"], "timestamp": "2026-02-13T13:15:22"}</pre>
                    
                    <p style="margin: 8px 0 4px 0; font-weight: 600;">ğŸ†• 3.2 BTCç­–ç•¥æ‰§è¡Œè®¸å¯ï¼ˆç­–ç•¥ç±»å‹éš”ç¦»ï¼‰- v2.5æ–°å¢</p>
                    <p style="margin: 2px 0;"><code style="background: #f1f5f9; padding: 2px 4px; border-radius: 3px;">data/okx_auto_strategy/account_main_btc_top_performers_execution.jsonl</code></p>
                    <pre style="background: #1e293b; color: #e2e8f0; padding: 8px; border-radius: 4px; overflow-x: auto; font-size: 10px; margin: 4px 0;">
{"timestamp": 1771297200000, "time": "2026-02-17 12:30:00", "account_id": "main", "strategy_type": "top_performers", "allowed": true, "reason": "ç”¨æˆ·å¼€å¯ç­–ç•¥", "triggerPrice": 68000.0}
{"timestamp": 1771297260000, "time": "2026-02-17 12:31:00", "account_id": "main", "strategy_type": "top_performers", "allowed": false, "reason": "æ‰§è¡Œå®Œæˆåè‡ªåŠ¨å…³é—­", "triggerPrice": 68000.0}</pre>
                    <p style="margin: 2px 0; font-size: 10px; color: #64748b;">âœ… <strong>ç‹¬ç«‹æ–‡ä»¶ï¼š</strong>æ¶¨å¹…å‰8åå’Œæ¶¨å¹…å8åä½¿ç”¨ä¸åŒJSONLï¼Œå‘½åæ ¼å¼ï¼šaccount_{account_id}_btc_{strategy_type}_execution.jsonl</p>
                    
                    <p style="margin: 8px 0 4px 0; font-weight: 600;">ğŸ†• 3.3 ä¸Šæ¶¨å æ¯”0ç­–ç•¥æ‰§è¡Œè®¸å¯ï¼ˆè´¦æˆ·éš”ç¦»ï¼‰</p>
                    <p style="margin: 2px 0;"><code style="background: #f1f5f9; padding: 2px 4px; border-radius: 3px;">data/okx_auto_strategy/account_main_upratio0_top8_execution.jsonl</code></p>
                    <pre style="background: #1e293b; color: #e2e8f0; padding: 8px; border-radius: 4px; overflow-x: auto; font-size: 10px; margin: 4px 0;">
{"timestamp": 1771297200000, "time": "2026-02-17 12:30:00", "account_id": "main", "strategy_type": "upratio0_top8", "allowed": true, "reason": "ç”¨æˆ·å¼€å¯ç­–ç•¥"}
{"timestamp": 1771297260000, "time": "2026-02-17 12:31:00", "account_id": "main", "strategy_type": "upratio0_top8", "allowed": false, "reason": "æ‰§è¡Œå®Œæˆåè‡ªåŠ¨å…³é—­", "up_ratio": 0, "execution_details": {"success_count": 8, "total_count": 8}}</pre>
                    <p style="margin: 2px 0; font-size: 10px; color: #64748b;">âœ… <strong>è´¦æˆ·éš”ç¦»ï¼š</strong>æ¯ä¸ªè´¦æˆ·ç‹¬ç«‹ç®¡ç†ï¼Œæ–‡ä»¶å‘½åæ ¼å¼ï¼šaccount_{account_id}_upratio0_{top8|bottom8}_execution.jsonl</p>
                    
                    <p style="margin: 8px 0 4px 0; font-weight: 600;">3.4 æ­¢ç›ˆæ­¢æŸè®¾ç½®</p>
                    <p style="margin: 2px 0;"><code style="background: #f1f5f9; padding: 2px 4px; border-radius: 3px;">data/okx_tpsl_settings/account_main.json</code></p>
                    <pre style="background: #1e293b; color: #e2e8f0; padding: 8px; border-radius: 4px; overflow-x: auto; font-size: 10px; margin: 4px 0;">
{
  "takeProfitEnabled": true,       // æ­¢ç›ˆæ˜¯å¦å¯ç”¨
  "takeProfitThreshold": 100.0,    // æ­¢ç›ˆé˜ˆå€¼ï¼ˆUSDTï¼‰
  "stopLossEnabled": true,          // æ­¢æŸæ˜¯å¦å¯ç”¨
  "stopLossThreshold": -50.0,      // æ­¢æŸé˜ˆå€¼ï¼ˆUSDTï¼‰
  "lastUpdated": "2026-02-13 02:06:19"  // æœ€åæ›´æ–°æ—¶é—´
}</pre>
                    
                    <p style="margin: 8px 0 4px 0; font-weight: 600;">3.5 äº¤æ˜“æ—¥å¿—</p>
                    <p style="margin: 2px 0;"><code style="background: #f1f5f9; padding: 2px 4px; border-radius: 3px;">data/okx_trading_logs/trading_log_20260213.jsonl</code></p>
                    <pre style="background: #1e293b; color: #e2e8f0; padding: 8px; border-radius: 4px; overflow-x: auto; font-size: 10px; margin: 4px 0;">
{"timestamp": "2026-02-13T02:30:15", "account": "account_main", "action": "å¼€ä»“", "symbol": "BTC-USDT-SWAP", "side": "buy", "size": 10, "price": 64800, "lever": "10x", "orderId": "123456789"}</pre>
                    
                    <p style="margin: 8px 0 4px 0; font-weight: 600;">3.6 å¸ç§æ¶¨è·Œå¹…è¿½è¸ª</p>
                    <p style="margin: 2px 0;"><code style="background: #f1f5f9; padding: 2px 4px; border-radius: 3px;">data/coin_change_tracker/coin_change_20260213.jsonl</code></p>
                    <pre style="background: #1e293b; color: #e2e8f0; padding: 8px; border-radius: 4px; overflow-x: auto; font-size: 10px; margin: 4px 0;">
{"date": "20260213", "baseline_time": "2026-02-13 00:00:00", "total_change": -32.90, "changes": {"BTC": -2.48, "ETH": -1.85, ...}, "timestamp": "2026-02-13T02:41:35"}</pre>
                    
                    <p style="margin: 8px 0 4px 0; font-weight: 600;">3.7 SARæŠ€æœ¯æŒ‡æ ‡</p>
                    <p style="margin: 2px 0;"><code style="background: #f1f5f9; padding: 2px 4px; border-radius: 3px;">data/sar_jsonl/BTC.jsonl</code></p>
                    <pre style="background: #1e293b; color: #e2e8f0; padding: 8px; border-radius: 4px; overflow-x: auto; font-size: 10px; margin: 4px 0;">
{"time": "2026-02-13T02:00:00", "close": 66550, "sar": 65200, "signal": "åšå¤š", "bias": 2.07}</pre>
                    
                    <p style="margin: 8px 0 4px 0; font-weight: 600;">ğŸ†• 3.8 RSIæ­¢ç›ˆè®¾ç½®ä¸æ‰§è¡Œè®¸å¯ï¼ˆv2.7æ–°å¢ï¼‰</p>
                    <p style="margin: 2px 0;"><code style="background: #f1f5f9; padding: 2px 4px; border-radius: 3px;">data/okx_tpsl_settings/account_main_tpsl.jsonl</code></p>
                    <pre style="background: #1e293b; color: #e2e8f0; padding: 8px; border-radius: 4px; overflow-x: auto; font-size: 10px; margin: 4px 0;">
{
  "account_id": "main",
  "enabled": true,
  "take_profit_enabled": false,
  "take_profit_threshold": 50.0,
  "stop_loss_enabled": false,
  "stop_loss_threshold": -30.0,
  "rsi_take_profit_enabled": true,     // RSIæ­¢ç›ˆå¼€å…³
  "rsi_take_profit_threshold": 1900.0, // RSIé˜ˆå€¼ï¼ˆ810-2700ï¼‰
  "max_position_value_usdt": 5.0,
  "last_updated": "2026-02-19 12:00:00"
}</pre>
                    <p style="margin: 2px 0;"><code style="background: #f1f5f9; padding: 2px 4px; border-radius: 3px;">data/okx_auto_strategy/account_main_takeprofit_execution.jsonl</code></p>
                    <pre style="background: #1e293b; color: #e2e8f0; padding: 8px; border-radius: 4px; overflow-x: auto; font-size: 10px; margin: 4px 0;">
{"timestamp": "2026-02-19 12:30:00", "account_id": "main", "allowed": true, "reason": "å¼€å¯RSIæ­¢ç›ˆç›‘æ§ï¼Œé˜ˆå€¼1900", "takeprofit_type": "rsi", "rsiValue": 1900.0}
{"timestamp": "2026-02-19 12:35:22", "account_id": "main", "allowed": false, "reason": "RSIæ­¢ç›ˆå·²è§¦å‘å¹¶æ‰§è¡Œï¼ŒRSI=1920.45", "takeprofit_type": "rsi", "rsiValue": 1920.45}</pre>
                    <p style="margin: 2px 0; font-size: 10px; color: #64748b;">âœ… <strong>ç»Ÿä¸€è®¸å¯æœºåˆ¶ï¼š</strong>ä¸coin-change-trackerçš„RSIæ­¢ç›ˆå…±ç”¨JSONLæ–‡ä»¶ï¼Œä½†ç‹¬ç«‹æ§åˆ¶ï¼Œè§¦å‘å‰æ£€æŸ¥allowedçŠ¶æ€</p>
                    
                    <p style="margin: 12px 0 4px 0; font-weight: 600;">ğŸ”¥ 3.9 å¸‚åœºæƒ…ç»ªæ­¢ç›ˆï¼ˆv2.6.2æ–°å¢ï¼‰</p>
                    <p style="margin: 2px 0; font-size: 10px; color: #0ea5e9;"><strong>ğŸ¯ æ ¸å¿ƒåŠŸèƒ½ï¼š</strong>å½“å¸‚åœºæƒ…ç»ªæœ€æ–°ä¿¡å·ä¸º"è§é¡¶ä¿¡å·"æˆ–"é¡¶éƒ¨èƒŒç¦»"æ—¶ï¼Œè‡ªåŠ¨å¹³æ‰æ‰€æœ‰å¤šå•</p>
                    <p style="margin: 2px 0;"><code style="background: #f1f5f9; padding: 2px 4px; border-radius: 3px;">data/okx_tpsl_settings/account_main_tpsl.jsonl</code></p>
                    <pre style="background: #1e293b; color: #e2e8f0; padding: 8px; border-radius: 4px; overflow-x: auto; font-size: 10px; margin: 4px 0;">
{
  "account_id": "main",
  "enabled": true,
  ...
  "sentiment_take_profit_enabled": true,           // ğŸ”¥ å¸‚åœºæƒ…ç»ªæ­¢ç›ˆå¼€å…³
  "sentiment_signals": ["è§é¡¶ä¿¡å·", "é¡¶éƒ¨èƒŒç¦»"],    // è§¦å‘ä¿¡å·åˆ—è¡¨
  "sentiment_position_side": "long",               // å¹³ä»“æ–¹å‘ï¼ˆlong=å¤šå•ï¼Œshort=ç©ºå•ï¼‰
  "last_updated": "2026-02-19 18:50:00"
}</pre>
                    <p style="margin: 4px 0 2px 0; font-size: 10px; color: #64748b;"><strong>ğŸ“Š æ•°æ®æ¥æºï¼š</strong></p>
                    <p style="margin: 2px 0;"><code style="background: #f1f5f9; padding: 2px 4px; border-radius: 3px; font-size: 9px;">data/market_sentiment/market_sentiment_YYYYMMDD.jsonl</code></p>
                    <pre style="background: #1e293b; color: #e2e8f0; padding: 8px; border-radius: 4px; overflow-x: auto; font-size: 10px; margin: 4px 0;">
{"beijing_time": "2026-02-19 16:00:00", "sentiment": "â›”é¡¶éƒ¨èƒŒç¦»", "coin_data": {"change_pct": 3.15}, "rsi_data": {"change_pct": -20.55}, "reason": "ä¸Šæ¶¨ä¸­RSIåè·Œ(20.55%)ï¼Œé¡¶éƒ¨èƒŒç¦»ä¿¡å·â˜…â˜…â˜…"}</pre>
                    <p style="margin: 4px 0 2px 0; font-size: 10px; color: #64748b;"><strong>âš¡ è§¦å‘é€»è¾‘ï¼š</strong></p>
                    <ul style="margin: 2px 0 0 16px; padding: 0; font-size: 10px; color: #64748b;">
                        <li>âœ… <strong>ç›‘æ§é¢‘ç‡ï¼š</strong>æ¯60ç§’æ£€æŸ¥ä¸€æ¬¡å¸‚åœºæƒ…ç»ªæœ€æ–°ä¿¡å·</li>
                        <li>âœ… <strong>ä¿¡å·åˆ¤æ–­ï¼š</strong>å¦‚æœsentimentå­—æ®µåŒ…å«"è§é¡¶ä¿¡å·"æˆ–"é¡¶éƒ¨èƒŒç¦»"</li>
                        <li>âœ… <strong>æ‰§è¡ŒåŠ¨ä½œï¼š</strong>éå†æ‰€æœ‰å¤šå•æŒä»“ï¼Œé€ä¸ªå¸‚ä»·å¹³ä»“</li>
                        <li>âœ… <strong>é˜²é‡å¤ï¼š</strong>æ¯ä¸ªæŒä»“åªæ‰§è¡Œä¸€æ¬¡å¸‚åœºæƒ…ç»ªæ­¢ç›ˆ</li>
                        <li>âœ… <strong>TGé€šçŸ¥ï¼š</strong>å¹³ä»“æ—¶å‘é€åŒ…å«æƒ…ç»ªä¿¡å·è¯¦æƒ…çš„Telegramæ¶ˆæ¯</li>
                        <li>âš ï¸ <strong>ä¼˜å…ˆçº§ï¼š</strong>å¸‚åœºæƒ…ç»ªæ­¢ç›ˆä¼˜å…ˆäºå¸¸è§„æ­¢ç›ˆæ­¢æŸï¼ˆRSI/ä»·æ ¼ç™¾åˆ†æ¯”ï¼‰</li>
                    </ul>
                    <p style="margin: 4px 0 2px 0; font-size: 10px; color: #64748b;"><strong>ğŸ“ æ‰§è¡Œè®°å½•ï¼š</strong></p>
                    <p style="margin: 2px 0;"><code style="background: #f1f5f9; padding: 2px 4px; border-radius: 3px; font-size: 9px;">data/okx_tpsl_settings/account_main_tpsl_execution.jsonl</code></p>
                    <pre style="background: #1e293b; color: #e2e8f0; padding: 8px; border-radius: 4px; overflow-x: auto; font-size: 10px; margin: 4px 0;">
{"timestamp": "2026-02-19T18:50:15", "account_id": "account_main", "instId": "BTC-USDT-SWAP", "posSide": "long", "triggerType": "sentiment_take_profit", "success": true, "message": "å¸‚åœºæƒ…ç»ªæ­¢ç›ˆè®¾ç½®æˆåŠŸ"}</pre>
                    <p style="margin: 4px 0 2px 0; font-size: 10px;"><strong style="color: #dc2626;">ğŸ’¡ å†å²éªŒè¯ï¼ˆ2026-02-19ï¼‰ï¼š</strong></p>
                    <div style="background: #fef2f2; padding: 8px; border-left: 3px solid #dc2626; border-radius: 4px; margin: 4px 0;">
                        <p style="margin: 0 0 4px 0; font-size: 10px; color: #991b1b;">â€¢ <strong>16:00 é¡¶éƒ¨èƒŒç¦»ä¿¡å·ï¼š</strong>å¸ä»·+3.15% RSI-20.55%ï¼ˆRSIè·Œå¹…æ˜¯å¸ä»·æ¶¨å¹…çš„6.5å€ï¼‰</p>
                        <p style="margin: 0 0 4px 0; font-size: 10px; color: #991b1b;">â€¢ <strong>15åˆ†é’Ÿåæš´è·Œï¼š</strong>16:15è·Œåˆ°-67.37%ï¼Œ16:30è·Œåˆ°-75.58%ï¼Œ16:45æœ€ä½-87.54%</p>
                        <p style="margin: 0; font-size: 10px; color: #991b1b;">â€¢ <strong>è·Œå¹…32%+ï¼š</strong>ä»-55%è·Œåˆ°-87%ï¼Œä¿¡å·å‡†ç¡®åº¦æé«˜ï¼</p>
                    </div>
                </div>
                
                <!-- 3.5. JSONLæ–‡ä»¶å®Œæ•´æ¶æ„ -->
                <div style="background: white; padding: 10px; border-radius: 6px; margin-bottom: 10px; border-left: 4px solid #ec4899;">
                    <h4 style="margin: 0 0 8px 0; color: #be123c; font-size: 12px;">ğŸ—‚ï¸ ä¸‰.äº”ã€JSONLæ–‡ä»¶å®Œæ•´æ¶æ„ï¼ˆé‡è¦ï¼‰</h4>
                    
                    <div style="margin: 4px 0; padding: 8px; background: #fef2f2; border-left: 3px solid #dc2626; border-radius: 4px;">
                        <p style="margin: 0 0 4px 0; font-weight: 600; color: #991b1b; font-size: 10px;">ğŸ“Œ ä¸ºä»€ä¹ˆéœ€è¦è¯¦ç»†è®°å½•JSONLæ¶æ„ï¼Ÿ</p>
                        <ul style="margin: 2px 0 0 16px; padding: 0; font-size: 10px; color: #7f1d1d;">
                            <li><strong>å¤æ‚æ€§æœ€é«˜ï¼š</strong>OKXäº¤æ˜“ç³»ç»Ÿæ˜¯æ•´ä¸ªç³»ç»Ÿä¸­æœ€å¤æ‚çš„æ¨¡å—</li>
                            <li><strong>æ–‡ä»¶ä¼—å¤šï¼š</strong>4ä¸ªè´¦æˆ· Ã— å¤šç§ç­–ç•¥ = æ•°åä¸ªJSONLæ–‡ä»¶</li>
                            <li><strong>ä¾èµ–å…³ç³»å¤æ‚ï¼š</strong>åŠŸèƒ½ä¹‹é—´æœ‰è°ƒç”¨å…³ç³»ã€è®¸å¯å…³ç³»</li>
                            <li><strong>æ˜“å‡ºé”™ï¼š</strong>ä¸æ¸…æ¥šä¾èµ–å…³ç³»å®¹æ˜“å¯¼è‡´ä¿®æ”¹æ—¶å‡ºç°æ··ä¹±</li>
                            <li><strong>ç»´æŠ¤å›°éš¾ï¼š</strong>æ²¡æœ‰æ–‡æ¡£éš¾ä»¥ç†è§£æ¯ä¸ªæ–‡ä»¶çš„ä½œç”¨</li>
                        </ul>
                    </div>
                    
                    <p style="margin: 8px 0 4px 0; font-weight: 600; font-size: 11px;">ğŸ“Š JSONLæ–‡ä»¶åˆ†ç±»è¡¨</p>
                    <table style="width: 100%; font-size: 9px; border-collapse: collapse; margin: 4px 0;">
                        <thead>
                            <tr style="background: #f1f5f9;">
                                <th style="padding: 4px; border: 1px solid #cbd5e1; text-align: left;">åˆ†ç±»</th>
                                <th style="padding: 4px; border: 1px solid #cbd5e1; text-align: left;">æ–‡ä»¶å‘½åæ ¼å¼</th>
                                <th style="padding: 4px; border: 1px solid #cbd5e1; text-align: center;">æ•°é‡</th>
                                <th style="padding: 4px; border: 1px solid #cbd5e1; text-align: left;">åŠŸèƒ½è¯´æ˜</th>
                                <th style="padding: 4px; border: 1px solid #cbd5e1; text-align: left;">ç›¸å…³API</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr style="background: #dbeafe;">
                                <td style="padding: 4px; border: 1px solid #cbd5e1; font-weight: 600;">ç­–ç•¥é…ç½®</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;"><code>account_{id}.json</code><br><code>account_{id}_top.json</code></td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1; text-align: center;">8</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;">BTCä»·æ ¼è§¦å‘ç­–ç•¥é…ç½®ï¼ˆå‰8/å8ï¼‰<br>åŒ…å«ï¼šenabled, triggerPrice, positionSize, maxOrderSize</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;">/api/okx-trading/auto-strategy/{id}</td>
                            </tr>
                            <tr style="background: #dcfce7;">
                                <td style="padding: 4px; border: 1px solid #cbd5e1; font-weight: 600;">BTCç­–ç•¥è®¸å¯</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;"><code>account_{id}_btc_{type}_execution.jsonl</code></td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1; text-align: center;">8</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;">BTCä»·æ ¼è§¦å‘æ‰§è¡Œè®¸å¯ï¼ˆé˜²é‡å¤ï¼‰<br>type = top_performers / bottom_performers</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;">/api/okx-trading/check-allowed/{id}/{type}<br>/api/okx-trading/set-allowed/{id}/{type}</td>
                            </tr>
                            <tr style="background: #fef3c7;">
                                <td style="padding: 4px; border: 1px solid #cbd5e1; font-weight: 600;">ä¸Šæ¶¨å æ¯”0è®¸å¯</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;"><code>account_{id}_upratio0_{type}_execution.jsonl</code></td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1; text-align: center;">8</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;">ä¸Šæ¶¨å æ¯”0è§¦å‘æ‰§è¡Œè®¸å¯ï¼ˆé˜²é‡å¤ï¼‰<br>type = top8 / bottom8</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;">/api/okx-trading/check-allowed-upratio0/{id}/{type}<br>/api/okx-trading/set-allowed-upratio0/{id}/{type}</td>
                            </tr>
                            <tr style="background: #fed7aa;">
                                <td style="padding: 4px; border: 1px solid #cbd5e1; font-weight: 600;">RSIæ­¢ç›ˆè®¸å¯</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;"><code>account_{id}_takeprofit_execution.jsonl</code></td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1; text-align: center;">4</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;">RSIæ­¢ç›ˆæ‰§è¡Œè®¸å¯ï¼ˆé˜²é‡å¤ï¼‰<br>åŒ…å«ï¼šallowed, takeprofitType, rsiValue</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;">/api/okx-trading/check-allowed-takeprofit/{id}<br>/api/okx-trading/set-allowed-takeprofit/{id}</td>
                            </tr>
                            <tr style="background: #fce7f3;">
                                <td style="padding: 4px; border: 1px solid #cbd5e1; font-weight: 600;">æ­¢ç›ˆæ­¢æŸé…ç½®</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;"><code>account_{id}_tpsl.jsonl</code></td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1; text-align: center;">4</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;">æ­¢ç›ˆæ­¢æŸé˜ˆå€¼ä¸RSIæ­¢ç›ˆé…ç½®<br>åŒ…å«ï¼štake_profit_threshold, stop_loss_threshold, rsi_take_profit_threshold</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;">/api/okx-trading/tpsl-settings/{id}</td>
                            </tr>
                            <tr>
                                <td style="padding: 4px; border: 1px solid #cbd5e1; font-weight: 600;">ç­–ç•¥å†å²</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;"><code>account_{id}_history.jsonl</code><br><code>account_{id}_tpsl_history.jsonl</code></td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1; text-align: center;">8</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;">ç­–ç•¥é…ç½®ä¿®æ”¹å†å²è®°å½•<br>æ¯æ¬¡ä¿®æ”¹è¿½åŠ ä¸€æ¡è®°å½•</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;">-</td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <p style="margin: 8px 0 4px 0; font-weight: 600; font-size: 11px;">ğŸ”— åŠŸèƒ½ä¾èµ–å…³ç³»å›¾</p>
                    <pre style="background: #1e293b; color: #e2e8f0; padding: 8px; border-radius: 4px; overflow-x: auto; font-size: 9px; margin: 4px 0; line-height: 1.8;">
<span style="color: #22c55e;">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span style="color: #22c55e;">â”‚  1ï¸âƒ£ BTCä»·æ ¼è§¦å‘ç­–ç•¥ï¼ˆæ¶¨å¹…å‰8å/å8åï¼‰                              â”‚</span>
<span style="color: #22c55e;">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
   ğŸ“„ é…ç½®æ–‡ä»¶: account_{id}.json / account_{id}_top.json
   â”œâ”€ å­—æ®µ: enabled, triggerPrice, positionSize, maxOrderSize
   â”œâ”€ APIè¯»å–: GET /api/okx-trading/auto-strategy/{id}?strategy_type=...
   â””â”€ APIä¿å­˜: POST /api/okx-trading/auto-strategy/{id}
   
   ğŸ“ æ‰§è¡Œè®¸å¯: account_{id}_btc_{type}_execution.jsonl
   â”œâ”€ è¯»å–API: GET /api/okx-trading/check-allowed/{id}/{type}
   â”œâ”€ å†™å…¥API: POST /api/okx-trading/set-allowed/{id}/{type}
   â”œâ”€ è§¦å‘æ—¶æœº: å‰ç«¯æ¯60ç§’æ£€æŸ¥BTCä»·æ ¼
   â”œâ”€ æ‰§è¡Œå‡½æ•°: checkAndExecuteAutoStrategy()
   â””â”€ ä¸‹å•å¤ç”¨: batchOrderTop8() / batchOrderBottom8()

<span style="color: #f59e0b;">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span style="color: #f59e0b;">â”‚  2ï¸âƒ£ ä¸Šæ¶¨å æ¯”0è§¦å‘ç­–ç•¥ï¼ˆæ¶¨å¹…å‰8å/å8åï¼‰                            â”‚</span>
<span style="color: #f59e0b;">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
   ğŸ“ æ‰§è¡Œè®¸å¯: account_{id}_upratio0_{top8|bottom8}_execution.jsonl
   â”œâ”€ è¯»å–API: GET /api/okx-trading/check-allowed-upratio0/{id}/{type}
   â”œâ”€ å†™å…¥API: POST /api/okx-trading/set-allowed-upratio0/{id}/{type}
   â”œâ”€ è§¦å‘æ—¶æœº: å‰ç«¯æ¯60ç§’æ£€æŸ¥ä¸Šæ¶¨å æ¯”
   â”œâ”€ è§¦å‘æ¡ä»¶: ä¸Šæ¶¨å æ¯”=0% ä¸” ä¸åœ¨0:00-0:30
   â”œâ”€ æ‰§è¡Œå‡½æ•°: checkAndExecuteUpRatio0Top8() / checkAndExecuteUpRatio0Bottom8()
   â”œâ”€ ä¸‹å•å¤ç”¨: batchOrderTop8() / batchOrderBottom8()
   â””â”€ æ•°æ®æ¥æº: /api/coin-change-tracker/latest (total_change, changes)

<span style="color: #ec4899;">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span style="color: #ec4899;">â”‚  3ï¸âƒ£ RSIæ­¢ç›ˆåŠŸèƒ½ï¼ˆOKX Tradingé¡µé¢ï¼‰                                  â”‚</span>
<span style="color: #ec4899;">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
   ğŸ“„ é…ç½®æ–‡ä»¶: account_{id}_tpsl.jsonl
   â”œâ”€ å­—æ®µ: rsi_take_profit_enabled, rsi_take_profit_threshold
   â”œâ”€ APIè¯»å–: GET /api/okx-trading/tpsl-settings/{id}
   â””â”€ APIä¿å­˜: POST /api/okx-trading/tpsl-settings/{id}
   
   ğŸ“ æ‰§è¡Œè®¸å¯: account_{id}_takeprofit_execution.jsonl
   â”œâ”€ è¯»å–API: GET /api/okx-trading/check-allowed-takeprofit/{id}
   â”œâ”€ å†™å…¥API: POST /api/okx-trading/set-allowed-takeprofit/{id}
   â”œâ”€ è§¦å‘æ—¶æœº: å‰ç«¯æ¯60ç§’æ£€æŸ¥RSI
   â”œâ”€ æ‰§è¡Œå‡½æ•°: checkRSITakeProfit()
   â”œâ”€ å¹³ä»“å‡½æ•°: executeRSICloseAllPositions()
   â”œâ”€ å¹³ä»“API: POST /api/okx-trading/close-all-positions
   â””â”€ æ•°æ®æ¥æº: /api/coin-change-tracker/latest (total_rsi)

<span style="color: #a855f7;">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span style="color: #a855f7;">â”‚  4ï¸âƒ£ RSIæ­¢ç›ˆåŠŸèƒ½ï¼ˆCoin Change Trackeré¡µé¢ï¼‰                          â”‚</span>
<span style="color: #a855f7;">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
   ğŸ“ æ‰§è¡Œè®¸å¯: account_{id}_takeprofit_execution.jsonl (ä¸OKX Tradingå…±ç”¨)
   â”œâ”€ è¯»å–API: GET /api/okx-trading/check-allowed-takeprofit/{id}
   â”œâ”€ å†™å…¥API: POST /api/okx-trading/set-allowed-takeprofit/{id}
   â”œâ”€ é…ç½®å­˜å‚¨: localStorage (rsiTakeProfitConfig)
   â”œâ”€ è§¦å‘æ—¶æœº: å‰ç«¯æ¯10ç§’æ£€æŸ¥RSI
   â”œâ”€ æ‰§è¡Œå‡½æ•°: checkRSITakeProfit()
   â”œâ”€ å¹³ä»“API: POST /api/okx-trading/close-position (é€ä¸ªå¹³ä»“)
   â””â”€ æ•°æ®æ¥æº: é¡µé¢å†…éƒ¨è®¡ç®—çš„total_rsi

<span style="color: #06b6d4;">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span>
<span style="color: #06b6d4;">â”‚  5ï¸âƒ£ è´¦æˆ·çº§æ­¢ç›ˆæ­¢æŸï¼ˆæ—§ç‰ˆï¼ŒåŸºäºæ€»æœªå®ç°ç›ˆäºï¼‰                        â”‚</span>
<span style="color: #06b6d4;">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span>
   ğŸ“„ é…ç½®æ–‡ä»¶: account_{id}_tpsl.jsonl
   â”œâ”€ å­—æ®µ: take_profit_threshold, stop_loss_threshold
   â”œâ”€ è§¦å‘æ—¶æœº: å‰ç«¯åŠ è½½æŒä»“æ—¶æ£€æŸ¥
   â”œâ”€ æ‰§è¡Œå‡½æ•°: checkTakeProfitStopLoss(unrealizedPnl)
   â””â”€ å¹³ä»“å‡½æ•°: showTakeProfitAlert() / showStopLossAlert() â†’ closeAllPositions()
</pre>
                    
                    <p style="margin: 8px 0 4px 0; font-weight: 600; font-size: 11px;">ğŸ“‹ è´¦æˆ·ä¸æ–‡ä»¶å¯¹åº”è¡¨ï¼ˆ4ä¸ªè´¦æˆ·ï¼‰</p>
                    <table style="width: 100%; font-size: 9px; border-collapse: collapse; margin: 4px 0;">
                        <thead>
                            <tr style="background: #f1f5f9;">
                                <th style="padding: 4px; border: 1px solid #cbd5e1; text-align: left;">è´¦æˆ·ID</th>
                                <th style="padding: 4px; border: 1px solid #cbd5e1; text-align: left;">BTCç­–ç•¥é…ç½®</th>
                                <th style="padding: 4px; border: 1px solid #cbd5e1; text-align: left;">BTCæ‰§è¡Œè®¸å¯</th>
                                <th style="padding: 4px; border: 1px solid #cbd5e1; text-align: left;">ä¸Šæ¶¨å æ¯”0è®¸å¯</th>
                                <th style="padding: 4px; border: 1px solid #cbd5e1; text-align: left;">æ­¢ç›ˆæ­¢æŸé…ç½®</th>
                                <th style="padding: 4px; border: 1px solid #cbd5e1; text-align: left;">RSIæ­¢ç›ˆè®¸å¯</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;"><strong>main</strong></td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;">account_main.json<br>account_main_top.json</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;">*_btc_top_performers_execution.jsonl<br>*_btc_bottom_performers_execution.jsonl</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;">*_upratio0_top8_execution.jsonl<br>*_upratio0_bottom8_execution.jsonl</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;">account_main_tpsl.jsonl</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;">account_main_takeprofit_execution.jsonl</td>
                            </tr>
                            <tr>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;"><strong>fangfang12</strong></td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;">account_fangfang12.json<br>account_fangfang12_top.json</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;">account_fangfang12_btc_*_execution.jsonl</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;">account_fangfang12_upratio0_*_execution.jsonl</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;">account_fangfang12_tpsl.jsonl</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;">account_fangfang12_takeprofit_execution.jsonl</td>
                            </tr>
                            <tr>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;"><strong>poit</strong></td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;">account_poit.json<br>account_poit_top.json</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;">account_poit_btc_*_execution.jsonl</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;">account_poit_upratio0_*_execution.jsonl</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;">account_poit_tpsl.jsonl</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;">account_poit_takeprofit_execution.jsonl</td>
                            </tr>
                            <tr>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;"><strong>marks</strong></td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;">account_marks.json<br>account_marks_top.json</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;">account_marks_btc_*_execution.jsonl</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;">account_marks_upratio0_*_execution.jsonl</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;">account_marks_tpsl.jsonl</td>
                                <td style="padding: 4px; border: 1px solid #cbd5e1;">account_marks_takeprofit_execution.jsonl</td>
                            </tr>
                        </tbody>
                    </table>
                    <p style="margin: 2px 0; font-size: 9px; color: #64748b;">* è¡¨ç¤º account_å‰ç¼€ï¼Œå®Œæ•´æ–‡ä»¶åè§ä¸Šæ–¹è¯¦ç»†åˆ—è¡¨</p>
                    
                    <p style="margin: 8px 0 4px 0; font-weight: 600; font-size: 11px;">âš™ï¸ å‰ç«¯é¡µé¢å®šæ—¶ä»»åŠ¡æ±‡æ€»</p>
                    <pre style="background: #1e293b; color: #e2e8f0; padding: 8px; border-radius: 4px; overflow-x: auto; font-size: 9px; margin: 4px 0; line-height: 1.8;">
<span style="color: #fbbf24;">// OKX Trading é¡µé¢ (templates/okx_trading.html)</span>
setInterval(() => {
    refreshAccountData();              // åˆ·æ–°è´¦æˆ·ä½™é¢ä¸æŒä»“
    loadPendingOrders();               // åŠ è½½å§”æ‰˜è®¢å•
    loadTradingLogs();                 // åŠ è½½äº¤æ˜“æ—¥å¿—
    updateTotalChangeOKX();            // æ›´æ–°æ€»æ¶¨è·Œå¹…
    <span style="color: #22c55e;">checkAndExecuteAutoStrategy();</span>      // âœ… æ£€æŸ¥BTCä»·æ ¼è§¦å‘ç­–ç•¥
    <span style="color: #f59e0b;">checkAndExecuteUpRatio0Top8();</span>      // âœ… æ£€æŸ¥ä¸Šæ¶¨å æ¯”0-æ¶¨å¹…å‰8å
    <span style="color: #f59e0b;">checkAndExecuteUpRatio0Bottom8();</span>   // âœ… æ£€æŸ¥ä¸Šæ¶¨å æ¯”0-æ¶¨å¹…å8å
    <span style="color: #ec4899;">checkRSITakeProfit();</span>               // âœ… æ£€æŸ¥RSIæ­¢ç›ˆ
}, 60000);  // æ¯60ç§’æ‰§è¡Œä¸€æ¬¡

<span style="color: #a855f7;">// Coin Change Tracker é¡µé¢ (templates/coin_change_tracker.html)</span>
setInterval(() => {
    loadCoinChangeData();              // åŠ è½½27å¸æ¶¨è·Œå¹…æ•°æ®
    <span style="color: #ec4899;">checkRSITakeProfit();</span>               // âœ… æ£€æŸ¥RSIæ­¢ç›ˆï¼ˆä¸OKX Tradingç‹¬ç«‹ï¼‰
}, 10000);  // æ¯10ç§’æ‰§è¡Œä¸€æ¬¡
</pre>
                    
                    <div style="margin: 8px 0; padding: 6px; background: #fef2f2; border-left: 3px solid #dc2626; border-radius: 4px; font-size: 9px;">
                        <p style="margin: 0 0 2px 0; font-weight: 600; color: #991b1b;">âš ï¸ ä¿®æ”¹ä»£ç æ—¶çš„æ³¨æ„äº‹é¡¹</p>
                        <ul style="margin: 2px 0 0 16px; padding: 0; color: #7f1d1d;">
                            <li><strong>APIè·¯ç”±ä¿®æ”¹ï¼š</strong>å¦‚æœä¿®æ”¹APIè·¯å¾„ï¼Œéœ€åŒæ­¥ä¿®æ”¹å‰ç«¯è°ƒç”¨å’Œä¸Šè¡¨ä¸­çš„APIåˆ—</li>
                            <li><strong>JSONLæ–‡ä»¶é‡å‘½åï¼š</strong>éœ€åŒæ—¶ä¿®æ”¹åç«¯APIé€»è¾‘å’Œå‰ç«¯è°ƒç”¨</li>
                            <li><strong>æ–°å¢åŠŸèƒ½ï¼š</strong>ä¼˜å…ˆå¤ç”¨ç°æœ‰APIï¼Œé¿å…åˆ›å»ºé‡å¤åŠŸèƒ½</li>
                            <li><strong>ç­–ç•¥äº’æ–¥ï¼š</strong>ä¸åŒç­–ç•¥ä½¿ç”¨ä¸åŒçš„JSONLæ‰§è¡Œè®¸å¯æ–‡ä»¶ï¼Œé¿å…å†²çª</li>
                            <li><strong>è´¦æˆ·éš”ç¦»ï¼š</strong>æ‰€æœ‰é…ç½®å’Œæ‰§è¡Œè®¸å¯å¿…é¡»æŒ‰è´¦æˆ·IDç‹¬ç«‹å­˜å‚¨</li>
                            <li><strong>é˜²é‡å¤æœºåˆ¶ï¼š</strong>æ¯ä¸ªç­–ç•¥éƒ½å¿…é¡»æœ‰JSONLæ‰§è¡Œè®¸å¯æ£€æŸ¥ï¼Œé˜²æ­¢é‡å¤æ‰§è¡Œ</li>
                        </ul>
                    </div>
                </div>
                
                <!-- 4. APIæ¥å£ -->
                <div style="background: white; padding: 10px; border-radius: 6px; margin-bottom: 10px; border-left: 4px solid #f59e0b;">
                    <h4 style="margin: 0 0 8px 0; color: #0369a1; font-size: 12px;">ğŸ”Œ å››ã€APIæ¥å£åˆ—è¡¨</h4>
                    <table style="width: 100%; font-size: 10px; border-collapse: collapse;">
                        <thead>
                            <tr style="background: #f1f5f9;">
                                <th style="padding: 4px; text-align: left; border: 1px solid #cbd5e1;">æ¥å£è·¯å¾„</th>
                                <th style="padding: 4px; text-align: left; border: 1px solid #cbd5e1;">æ–¹æ³•</th>
                                <th style="padding: 4px; text-align: left; border: 1px solid #cbd5e1;">åŠŸèƒ½</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td style="padding: 4px; border: 1px solid #cbd5e1;">/api/okx-accounts/list-with-credentials</td><td style="padding: 4px; border: 1px solid #cbd5e1;">GET</td><td style="padding: 4px; border: 1px solid #cbd5e1;">è·å–è´¦æˆ·åˆ—è¡¨</td></tr>
                            <tr><td style="padding: 4px; border: 1px solid #cbd5e1;">/api/okx-trading/market-tickers</td><td style="padding: 4px; border: 1px solid #cbd5e1;">GET</td><td style="padding: 4px; border: 1px solid #cbd5e1;">è·å–å¸‚åœºè¡Œæƒ…</td></tr>
                            <tr><td style="padding: 4px; border: 1px solid #cbd5e1;">/api/okx-trading/account-balance</td><td style="padding: 4px; border: 1px solid #cbd5e1;">POST</td><td style="padding: 4px; border: 1px solid #cbd5e1;">è·å–è´¦æˆ·ä½™é¢</td></tr>
                            <tr><td style="padding: 4px; border: 1px solid #cbd5e1;">/api/okx-trading/account-info</td><td style="padding: 4px; border: 1px solid #cbd5e1;">POST</td><td style="padding: 4px; border: 1px solid #cbd5e1;">è·å–è´¦æˆ·è¯¦æƒ…</td></tr>
                            <tr><td style="padding: 4px; border: 1px solid #cbd5e1;">/api/okx-trading/positions</td><td style="padding: 4px; border: 1px solid #cbd5e1;">POST</td><td style="padding: 4px; border: 1px solid #cbd5e1;">è·å–æŒä»“ä¿¡æ¯</td></tr>
                            <tr><td style="padding: 4px; border: 1px solid #cbd5e1;">/api/okx-trading/place-order</td><td style="padding: 4px; border: 1px solid #cbd5e1;">POST</td><td style="padding: 4px; border: 1px solid #cbd5e1;">æ‰§è¡Œä¸‹å•</td></tr>
                            <tr><td style="padding: 4px; border: 1px solid #cbd5e1;">/api/okx-trading/logs</td><td style="padding: 4px; border: 1px solid #cbd5e1;">GET</td><td style="padding: 4px; border: 1px solid #cbd5e1;">è·å–äº¤æ˜“æ—¥å¿—</td></tr>
                            <tr><td style="padding: 4px; border: 1px solid #cbd5e1;">/api/okx-trading/auto-strategy/&lt;account_id&gt;</td><td style="padding: 4px; border: 1px solid #cbd5e1;">GET/POST</td><td style="padding: 4px; border: 1px solid #cbd5e1;">è‡ªåŠ¨ç­–ç•¥è®¾ç½®</td></tr>
                            <tr style="background: #dcfce7;"><td style="padding: 4px; border: 1px solid #cbd5e1;">ğŸ†• /api/okx-trading/check-allowed/&lt;account_id&gt;/&lt;strategy_type&gt;</td><td style="padding: 4px; border: 1px solid #cbd5e1;">GET</td><td style="padding: 4px; border: 1px solid #cbd5e1;">æ£€æŸ¥BTCç­–ç•¥æ‰§è¡Œè®¸å¯ï¼ˆv2.5æ–°å¢ç­–ç•¥ç±»å‹å‚æ•°ï¼‰</td></tr>
                            <tr style="background: #dcfce7;"><td style="padding: 4px; border: 1px solid #cbd5e1;">ğŸ†• /api/okx-trading/set-allowed/&lt;account_id&gt;/&lt;strategy_type&gt;</td><td style="padding: 4px; border: 1px solid #cbd5e1;">POST</td><td style="padding: 4px; border: 1px solid #cbd5e1;">è®¾ç½®BTCç­–ç•¥æ‰§è¡Œè®¸å¯ï¼ˆv2.5æ–°å¢ç­–ç•¥ç±»å‹å‚æ•°ï¼‰</td></tr>
                            <tr><td style="padding: 4px; border: 1px solid #cbd5e1;">ğŸ†• /api/okx-trading/check-allowed-upratio0/&lt;account_id&gt;/&lt;type&gt;</td><td style="padding: 4px; border: 1px solid #cbd5e1;">GET</td><td style="padding: 4px; border: 1px solid #cbd5e1;">æ£€æŸ¥ä¸Šæ¶¨å æ¯”0ç­–ç•¥æ‰§è¡Œè®¸å¯</td></tr>
                            <tr><td style="padding: 4px; border: 1px solid #cbd5e1;">ğŸ†• /api/okx-trading/set-allowed-upratio0/&lt;account_id&gt;/&lt;type&gt;</td><td style="padding: 4px; border: 1px solid #cbd5e1;">POST</td><td style="padding: 4px; border: 1px solid #cbd5e1;">è®¾ç½®ä¸Šæ¶¨å æ¯”0ç­–ç•¥æ‰§è¡Œè®¸å¯</td></tr>
                            <tr><td style="padding: 4px; border: 1px solid #cbd5e1;">/api/okx-trading/tpsl-settings/&lt;account_id&gt;</td><td style="padding: 4px; border: 1px solid #cbd5e1;">GET/POST</td><td style="padding: 4px; border: 1px solid #cbd5e1;">æ­¢ç›ˆæ­¢æŸè®¾ç½®</td></tr>
                            <tr><td style="padding: 4px; border: 1px solid #cbd5e1;">/api/coin-change-tracker/latest</td><td style="padding: 4px; border: 1px solid #cbd5e1;">GET</td><td style="padding: 4px; border: 1px solid #cbd5e1;">è·å–æ¶¨è·Œå¹…æ•°æ®</td></tr>
                        </tbody>
                    </table>
                </div>
                
                <!-- 5. PM2è¿›ç¨‹ -->
                <div style="background: white; padding: 10px; border-radius: 6px; margin-bottom: 10px; border-left: 4px solid #10b981;">
                    <h4 style="margin: 0 0 8px 0; color: #0369a1; font-size: 12px;">ğŸš€ äº”ã€PM2è¿›ç¨‹åˆ—è¡¨</h4>
                    <table style="width: 100%; font-size: 10px; border-collapse: collapse;">
                        <thead>
                            <tr style="background: #f1f5f9;">
                                <th style="padding: 4px; text-align: left; border: 1px solid #cbd5e1;">è¿›ç¨‹å</th>
                                <th style="padding: 4px; text-align: left; border: 1px solid #cbd5e1;">è„šæœ¬è·¯å¾„</th>
                                <th style="padding: 4px; text-align: left; border: 1px solid #cbd5e1;">åŠŸèƒ½è¯´æ˜</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td style="padding: 4px; border: 1px solid #cbd5e1;">flask-app</td><td style="padding: 4px; border: 1px solid #cbd5e1;">code/python/app.py</td><td style="padding: 4px; border: 1px solid #cbd5e1;">ä¸»FlaskæœåŠ¡ï¼ˆç«¯å£5000ï¼‰</td></tr>
                            <tr><td style="padding: 4px; border: 1px solid #cbd5e1;">coin-change-tracker</td><td style="padding: 4px; border: 1px solid #cbd5e1;">code/python/coin_change_collector.py</td><td style="padding: 4px; border: 1px solid #cbd5e1;">å¸ç§æ¶¨è·Œå¹…è¿½è¸ªé‡‡é›†å™¨</td></tr>
                            <tr><td style="padding: 4px; border: 1px solid #cbd5e1;">okx-trade-history</td><td style="padding: 4px; border: 1px solid #cbd5e1;">code/python/okx_trade_history.py</td><td style="padding: 4px; border: 1px solid #cbd5e1;">OKXäº¤æ˜“å†å²é‡‡é›†å™¨</td></tr>
                            <tr><td style="padding: 4px; border: 1px solid #cbd5e1;">okx-trading-marks</td><td style="padding: 4px; border: 1px solid #cbd5e1;">code/python/okx_trading_marks.py</td><td style="padding: 4px; border: 1px solid #cbd5e1;">OKXäº¤æ˜“æ ‡è®°é‡‡é›†å™¨</td></tr>
                            <tr><td style="padding: 4px; border: 1px solid #cbd5e1;">panic-collector</td><td style="padding: 4px; border: 1px solid #cbd5e1;">code/python/panic_index_collector.py</td><td style="padding: 4px; border: 1px solid #cbd5e1;">ææ…ŒæŒ‡æ•°é‡‡é›†å™¨</td></tr>
                            <tr><td style="padding: 4px; border: 1px solid #cbd5e1;">price-position-collector</td><td style="padding: 4px; border: 1px solid #cbd5e1;">price_position_v2/...py</td><td style="padding: 4px; border: 1px solid #cbd5e1;">ä»·æ ¼ä½ç½®é¢„è­¦é‡‡é›†å™¨</td></tr>
                            <tr><td style="padding: 4px; border: 1px solid #cbd5e1;">sar-bias-stats-collector</td><td style="padding: 4px; border: 1px solid #cbd5e1;">code/python/sar_bias_stats.py</td><td style="padding: 4px; border: 1px solid #cbd5e1;">SARåç¦»ç»Ÿè®¡é‡‡é›†å™¨</td></tr>
                            <tr><td style="padding: 4px; border: 1px solid #cbd5e1;">sar-jsonl-collector</td><td style="padding: 4px; border: 1px solid #cbd5e1;">code/python/sar_jsonl_collector.py</td><td style="padding: 4px; border: 1px solid #cbd5e1;">SARæŠ€æœ¯æŒ‡æ ‡é‡‡é›†å™¨</td></tr>
                        </tbody>
                    </table>
                </div>
                
                <!-- 6. Pythonä¾èµ–åŒ… -->
                <div style="background: white; padding: 10px; border-radius: 6px; margin-bottom: 10px; border-left: 4px solid #ef4444;">
                    <h4 style="margin: 0 0 8px 0; color: #0369a1; font-size: 12px;">ğŸ å…­ã€Pythonä¾èµ–åŒ…</h4>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 4px; font-size: 10px;">
                        <div><code style="background: #f1f5f9; padding: 2px 4px; border-radius: 3px;">Flask</code> - Webæ¡†æ¶</div>
                        <div><code style="background: #f1f5f9; padding: 2px 4px; border-radius: 3px;">requests</code> - HTTPè¯·æ±‚</div>
                        <div><code style="background: #f1f5f9; padding: 2px 4px; border-radius: 3px;">pandas</code> - æ•°æ®å¤„ç†</div>
                        <div><code style="background: #f1f5f9; padding: 2px 4px; border-radius: 3px;">numpy</code> - æ•°å€¼è®¡ç®—</div>
                        <div><code style="background: #f1f5f9; padding: 2px 4px; border-radius: 3px;">ccxt</code> - äº¤æ˜“æ‰€API</div>
                        <div><code style="background: #f1f5f9; padding: 2px 4px; border-radius: 3px;">hmac</code> - APIç­¾å</div>
                        <div><code style="background: #f1f5f9; padding: 2px 4px; border-radius: 3px;">base64</code> - ç¼–ç è§£ç </div>
                        <div><code style="background: #f1f5f9; padding: 2px 4px; border-radius: 3px;">datetime</code> - æ—¶é—´å¤„ç†</div>
                        <div><code style="background: #f1f5f9; padding: 2px 4px; border-radius: 3px;">json</code> - JSONå¤„ç†</div>
                        <div><code style="background: #f1f5f9; padding: 2px 4px; border-radius: 3px;">sqlite3</code> - æ•°æ®åº“</div>
                    </div>
                </div>
                
                <!-- 7. æ•°æ®ç›®å½•ç»“æ„ -->
                <div style="background: white; padding: 10px; border-radius: 6px; margin-bottom: 10px; border-left: 4px solid #a855f7;">
                    <h4 style="margin: 0 0 8px 0; color: #0369a1; font-size: 12px;">ğŸ“ ä¸ƒã€æ•°æ®ç›®å½•ç»“æ„</h4>
                    
                    <p style="margin: 8px 0 4px 0; font-weight: 600; font-size: 11px; color: #7c3aed;">7.1 ç›®å½•æ ‘ç»“æ„</p>
                    <pre style="background: #1e293b; color: #e2e8f0; padding: 8px; border-radius: 4px; overflow-x: auto; font-size: 10px; margin: 4px 0;">
data/
â”œâ”€â”€ okx_auto_strategy/           # è‡ªåŠ¨äº¤æ˜“ç­–ç•¥è®¾ç½®
â”‚   â”œâ”€â”€ account_main.json
â”‚   â”œâ”€â”€ account_main_history.jsonl
â”‚   â”œâ”€â”€ ğŸ†• account_main_btc_top_performers_execution.jsonl      # BTCç­–ç•¥-æ¶¨å¹…å‰8åæ‰§è¡Œè®¸å¯ (v2.5)
â”‚   â”œâ”€â”€ ğŸ†• account_main_btc_bottom_performers_execution.jsonl   # BTCç­–ç•¥-æ¶¨å¹…å8åæ‰§è¡Œè®¸å¯ (v2.5)
â”‚   â”œâ”€â”€ ğŸ†• account_main_upratio0_top8_execution.jsonl           # ä¸Šæ¶¨å æ¯”0-æ¶¨å¹…å‰8åæ‰§è¡Œè®¸å¯
â”‚   â”œâ”€â”€ ğŸ†• account_main_upratio0_bottom8_execution.jsonl        # ä¸Šæ¶¨å æ¯”0-æ¶¨å¹…å8åæ‰§è¡Œè®¸å¯
â”‚   â”œâ”€â”€ ğŸ†• account_fangfang12_btc_top_performers_execution.jsonl
â”‚   â”œâ”€â”€ ğŸ†• account_fangfang12_btc_bottom_performers_execution.jsonl
â”‚   â”œâ”€â”€ ğŸ†• account_fangfang12_upratio0_top8_execution.jsonl
â”‚   â”œâ”€â”€ ğŸ†• account_fangfang12_upratio0_bottom8_execution.jsonl
â”‚   â”œâ”€â”€ ğŸ†• account_poit_btc_top_performers_execution.jsonl
â”‚   â”œâ”€â”€ ğŸ†• account_poit_btc_bottom_performers_execution.jsonl
â”‚   â”œâ”€â”€ ğŸ†• account_poit_upratio0_top8_execution.jsonl
â”‚   â”œâ”€â”€ ğŸ†• account_poit_upratio0_bottom8_execution.jsonl
â”‚   â”œâ”€â”€ ğŸ†• account_marks_btc_top_performers_execution.jsonl
â”‚   â”œâ”€â”€ ğŸ†• account_marks_btc_bottom_performers_execution.jsonl
â”‚   â”œâ”€â”€ ğŸ†• account_marks_upratio0_top8_execution.jsonl
â”‚   â””â”€â”€ ğŸ†• account_marks_upratio0_bottom8_execution.jsonl
â”‚   # ğŸ“Š ç»Ÿè®¡: 4ä¸ªè´¦æˆ· Ã— 4ä¸ªç­–ç•¥ = 16ä¸ªç‹¬ç«‹JSONLæ–‡ä»¶ (v2.5æ¶æ„å‡çº§)
â”œâ”€â”€ okx_tpsl_settings/           # æ­¢ç›ˆæ­¢æŸè®¾ç½®
â”œâ”€â”€ okx_trading_logs/            # äº¤æ˜“æ—¥å¿—
â”œâ”€â”€ coin_change_tracker/         # å¸ç§æ¶¨è·Œå¹…è¿½è¸ª
â””â”€â”€ sar_jsonl/                   # SARæŠ€æœ¯æŒ‡æ ‡</pre>
                    
                    <p style="margin: 12px 0 4px 0; font-weight: 600; font-size: 11px; color: #7c3aed;">7.2 16ä¸ªç‹¬ç«‹JSONLæ–‡ä»¶è¯¦ç»†åˆ—è¡¨ï¼ˆv2.5æ¶æ„ï¼‰</p>
                    <div style="padding: 8px; background: #faf5ff; border-radius: 6px; border: 1px solid #a855f7;">
                        <p style="margin: 0 0 6px 0; font-size: 10px; color: #6b21a8; font-weight: 600;">ğŸ¯ è®¾è®¡åŸåˆ™ï¼š4ä¸ªè´¦æˆ· Ã— 4ä¸ªç­–ç•¥ = 16ä¸ªå®Œå…¨ç‹¬ç«‹çš„æ‰§è¡Œè®¸å¯æ–‡ä»¶</p>
                        
                        <table style="width: 100%; font-size: 9px; border-collapse: collapse; margin-top: 8px;">
                            <thead>
                                <tr style="background: #e9d5ff;">
                                    <th style="padding: 4px; text-align: left; border: 1px solid #c084fc;">åºå·</th>
                                    <th style="padding: 4px; text-align: left; border: 1px solid #c084fc;">è´¦æˆ·</th>
                                    <th style="padding: 4px; text-align: left; border: 1px solid #c084fc;">ç­–ç•¥ç±»å‹</th>
                                    <th style="padding: 4px; text-align: left; border: 1px solid #c084fc;">æ–‡ä»¶å</th>
                                    <th style="padding: 4px; text-align: left; border: 1px solid #c084fc;">è¯´æ˜</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- account_main -->
                                <tr><td style="padding: 3px; border: 1px solid #e9d5ff;">1</td><td style="padding: 3px; border: 1px solid #e9d5ff;">main</td><td style="padding: 3px; border: 1px solid #e9d5ff;">BTC-æ¶¨å¹…å‰8å</td><td style="padding: 3px; border: 1px solid #e9d5ff; font-family: monospace; font-size: 8px;"><code>account_main_btc_top_performers_execution.jsonl</code></td><td style="padding: 3px; border: 1px solid #e9d5ff;">BTCä»·æ ¼è§¦å‘ç­–ç•¥-æ¶¨å¹…å‰8å</td></tr>
                                <tr><td style="padding: 3px; border: 1px solid #e9d5ff;">2</td><td style="padding: 3px; border: 1px solid #e9d5ff;">main</td><td style="padding: 3px; border: 1px solid #e9d5ff;">BTC-æ¶¨å¹…å8å</td><td style="padding: 3px; border: 1px solid #e9d5ff; font-family: monospace; font-size: 8px;"><code>account_main_btc_bottom_performers_execution.jsonl</code></td><td style="padding: 3px; border: 1px solid #e9d5ff;">BTCä»·æ ¼è§¦å‘ç­–ç•¥-æ¶¨å¹…å8å</td></tr>
                                <tr><td style="padding: 3px; border: 1px solid #e9d5ff;">3</td><td style="padding: 3px; border: 1px solid #e9d5ff;">main</td><td style="padding: 3px; border: 1px solid #e9d5ff;">ä¸Šæ¶¨å æ¯”0-å‰8</td><td style="padding: 3px; border: 1px solid #e9d5ff; font-family: monospace; font-size: 8px;"><code>account_main_upratio0_top8_execution.jsonl</code></td><td style="padding: 3px; border: 1px solid #e9d5ff;">ä¸Šæ¶¨å æ¯”=0%è§¦å‘-æ¶¨å¹…å‰8å</td></tr>
                                <tr style="background: #faf5ff;"><td style="padding: 3px; border: 1px solid #e9d5ff;">4</td><td style="padding: 3px; border: 1px solid #e9d5ff;">main</td><td style="padding: 3px; border: 1px solid #e9d5ff;">ä¸Šæ¶¨å æ¯”0-å8</td><td style="padding: 3px; border: 1px solid #e9d5ff; font-family: monospace; font-size: 8px;"><code>account_main_upratio0_bottom8_execution.jsonl</code></td><td style="padding: 3px; border: 1px solid #e9d5ff;">ä¸Šæ¶¨å æ¯”=0%è§¦å‘-æ¶¨å¹…å8å</td></tr>
                                
                                <!-- account_fangfang12 -->
                                <tr><td style="padding: 3px; border: 1px solid #e9d5ff;">5</td><td style="padding: 3px; border: 1px solid #e9d5ff;">fangfang12</td><td style="padding: 3px; border: 1px solid #e9d5ff;">BTC-æ¶¨å¹…å‰8å</td><td style="padding: 3px; border: 1px solid #e9d5ff; font-family: monospace; font-size: 8px;"><code>account_fangfang12_btc_top_performers_execution.jsonl</code></td><td style="padding: 3px; border: 1px solid #e9d5ff;">BTCä»·æ ¼è§¦å‘ç­–ç•¥-æ¶¨å¹…å‰8å</td></tr>
                                <tr><td style="padding: 3px; border: 1px solid #e9d5ff;">6</td><td style="padding: 3px; border: 1px solid #e9d5ff;">fangfang12</td><td style="padding: 3px; border: 1px solid #e9d5ff;">BTC-æ¶¨å¹…å8å</td><td style="padding: 3px; border: 1px solid #e9d5ff; font-family: monospace; font-size: 8px;"><code>account_fangfang12_btc_bottom_performers_execution.jsonl</code></td><td style="padding: 3px; border: 1px solid #e9d5ff;">BTCä»·æ ¼è§¦å‘ç­–ç•¥-æ¶¨å¹…å8å</td></tr>
                                <tr><td style="padding: 3px; border: 1px solid #e9d5ff;">7</td><td style="padding: 3px; border: 1px solid #e9d5ff;">fangfang12</td><td style="padding: 3px; border: 1px solid #e9d5ff;">ä¸Šæ¶¨å æ¯”0-å‰8</td><td style="padding: 3px; border: 1px solid #e9d5ff; font-family: monospace; font-size: 8px;"><code>account_fangfang12_upratio0_top8_execution.jsonl</code></td><td style="padding: 3px; border: 1px solid #e9d5ff;">ä¸Šæ¶¨å æ¯”=0%è§¦å‘-æ¶¨å¹…å‰8å</td></tr>
                                <tr style="background: #faf5ff;"><td style="padding: 3px; border: 1px solid #e9d5ff;">8</td><td style="padding: 3px; border: 1px solid #e9d5ff;">fangfang12</td><td style="padding: 3px; border: 1px solid #e9d5ff;">ä¸Šæ¶¨å æ¯”0-å8</td><td style="padding: 3px; border: 1px solid #e9d5ff; font-family: monospace; font-size: 8px;"><code>account_fangfang12_upratio0_bottom8_execution.jsonl</code></td><td style="padding: 3px; border: 1px solid #e9d5ff;">ä¸Šæ¶¨å æ¯”=0%è§¦å‘-æ¶¨å¹…å8å</td></tr>
                                
                                <!-- account_poit -->
                                <tr><td style="padding: 3px; border: 1px solid #e9d5ff;">9</td><td style="padding: 3px; border: 1px solid #e9d5ff;">poit</td><td style="padding: 3px; border: 1px solid #e9d5ff;">BTC-æ¶¨å¹…å‰8å</td><td style="padding: 3px; border: 1px solid #e9d5ff; font-family: monospace; font-size: 8px;"><code>account_poit_btc_top_performers_execution.jsonl</code></td><td style="padding: 3px; border: 1px solid #e9d5ff;">BTCä»·æ ¼è§¦å‘ç­–ç•¥-æ¶¨å¹…å‰8å</td></tr>
                                <tr><td style="padding: 3px; border: 1px solid #e9d5ff;">10</td><td style="padding: 3px; border: 1px solid #e9d5ff;">poit</td><td style="padding: 3px; border: 1px solid #e9d5ff;">BTC-æ¶¨å¹…å8å</td><td style="padding: 3px; border: 1px solid #e9d5ff; font-family: monospace; font-size: 8px;"><code>account_poit_btc_bottom_performers_execution.jsonl</code></td><td style="padding: 3px; border: 1px solid #e9d5ff;">BTCä»·æ ¼è§¦å‘ç­–ç•¥-æ¶¨å¹…å8å</td></tr>
                                <tr><td style="padding: 3px; border: 1px solid #e9d5ff;">11</td><td style="padding: 3px; border: 1px solid #e9d5ff;">poit</td><td style="padding: 3px; border: 1px solid #e9d5ff;">ä¸Šæ¶¨å æ¯”0-å‰8</td><td style="padding: 3px; border: 1px solid #e9d5ff; font-family: monospace; font-size: 8px;"><code>account_poit_upratio0_top8_execution.jsonl</code></td><td style="padding: 3px; border: 1px solid #e9d5ff;">ä¸Šæ¶¨å æ¯”=0%è§¦å‘-æ¶¨å¹…å‰8å</td></tr>
                                <tr style="background: #faf5ff;"><td style="padding: 3px; border: 1px solid #e9d5ff;">12</td><td style="padding: 3px; border: 1px solid #e9d5ff;">poit</td><td style="padding: 3px; border: 1px solid #e9d5ff;">ä¸Šæ¶¨å æ¯”0-å8</td><td style="padding: 3px; border: 1px solid #e9d5ff; font-family: monospace; font-size: 8px;"><code>account_poit_upratio0_bottom8_execution.jsonl</code></td><td style="padding: 3px; border: 1px solid #e9d5ff;">ä¸Šæ¶¨å æ¯”=0%è§¦å‘-æ¶¨å¹…å8å</td></tr>
                                
                                <!-- account_marks -->
                                <tr><td style="padding: 3px; border: 1px solid #e9d5ff;">13</td><td style="padding: 3px; border: 1px solid #e9d5ff;">marks</td><td style="padding: 3px; border: 1px solid #e9d5ff;">BTC-æ¶¨å¹…å‰8å</td><td style="padding: 3px; border: 1px solid #e9d5ff; font-family: monospace; font-size: 8px;"><code>account_marks_btc_top_performers_execution.jsonl</code></td><td style="padding: 3px; border: 1px solid #e9d5ff;">BTCä»·æ ¼è§¦å‘ç­–ç•¥-æ¶¨å¹…å‰8å</td></tr>
                                <tr><td style="padding: 3px; border: 1px solid #e9d5ff;">14</td><td style="padding: 3px; border: 1px solid #e9d5ff;">marks</td><td style="padding: 3px; border: 1px solid #e9d5ff;">BTC-æ¶¨å¹…å8å</td><td style="padding: 3px; border: 1px solid #e9d5ff; font-family: monospace; font-size: 8px;"><code>account_marks_btc_bottom_performers_execution.jsonl</code></td><td style="padding: 3px; border: 1px solid #e9d5ff;">BTCä»·æ ¼è§¦å‘ç­–ç•¥-æ¶¨å¹…å8å</td></tr>
                                <tr><td style="padding: 3px; border: 1px solid #e9d5ff;">15</td><td style="padding: 3px; border: 1px solid #e9d5ff;">marks</td><td style="padding: 3px; border: 1px solid #e9d5ff;">ä¸Šæ¶¨å æ¯”0-å‰8</td><td style="padding: 3px; border: 1px solid #e9d5ff; font-family: monospace; font-size: 8px;"><code>account_marks_upratio0_top8_execution.jsonl</code></td><td style="padding: 3px; border: 1px solid #e9d5ff;">ä¸Šæ¶¨å æ¯”=0%è§¦å‘-æ¶¨å¹…å‰8å</td></tr>
                                <tr style="background: #faf5ff;"><td style="padding: 3px; border: 1px solid #e9d5ff;">16</td><td style="padding: 3px; border: 1px solid #e9d5ff;">marks</td><td style="padding: 3px; border: 1px solid #e9d5ff;">ä¸Šæ¶¨å æ¯”0-å8</td><td style="padding: 3px; border: 1px solid #e9d5ff; font-family: monospace; font-size: 8px;"><code>account_marks_upratio0_bottom8_execution.jsonl</code></td><td style="padding: 3px; border: 1px solid #e9d5ff;">ä¸Šæ¶¨å æ¯”=0%è§¦å‘-æ¶¨å¹…å8å</td></tr>
                            </tbody>
                        </table>
                        
                        <div style="margin-top: 8px; padding: 6px; background: #ddd6fe; border-radius: 4px;">
                            <p style="margin: 0; font-size: 9px; color: #5b21b6;"><strong>âœ… æ¶æ„ä¼˜åŠ¿ï¼š</strong></p>
                            <ul style="margin: 2px 0 0 16px; padding: 0; font-size: 9px; color: #5b21b6;">
                                <li>æ¯ä¸ªè´¦æˆ·çš„æ¯ä¸ªç­–ç•¥å®Œå…¨ç‹¬ç«‹ï¼Œä¸ä¼šç›¸äº’å½±å“</li>
                                <li>å¯åŠ¨/å…³é—­ä¸€ä¸ªç­–ç•¥ä¸ä¼šå½±å“å…¶ä»–ç­–ç•¥çš„æ‰§è¡Œè®¸å¯çŠ¶æ€</li>
                                <li>æ–‡ä»¶åæ¸…æ™°æ˜ç¡®ï¼Œæ˜“äºè¯†åˆ«å’Œç®¡ç†</li>
                                <li>æ”¯æŒæ¯ä¸ªè´¦æˆ·ç‹¬ç«‹é…ç½®ä¸åŒçš„ç­–ç•¥ç»„åˆ</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <!-- 8. v2.5æ¶æ„å‡çº§è¯´æ˜ -->
                <div style="background: white; padding: 10px; border-radius: 6px; margin-bottom: 10px; border-left: 4px solid #16a34a;">
                    <h4 style="margin: 0 0 8px 0; color: #0369a1; font-size: 12px;">ğŸ‰ å…«ã€v2.5æ¶æ„å‡çº§è¯´æ˜</h4>
                    
                    <div style="margin: 8px 0; padding: 8px; background: #fef3c7; border-radius: 4px; border-left: 3px solid #f59e0b;">
                        <p style="margin: 0; font-weight: 600; color: #92400e;">ğŸ“Œ å‡çº§äº®ç‚¹ï¼ˆ2026-02-17ï¼‰</p>
                        <p style="margin: 4px 0 0 0; font-size: 10px; color: #78350f;">æœ¬æ¬¡å‡çº§è§£å†³äº†ä¸‰ä¸ªå…³é”®é—®é¢˜ï¼Œç¡®ä¿ç­–ç•¥æ‰§è¡Œå®Œå…¨ç‹¬ç«‹ï¼Œé¿å…è¯¯è§¦å‘å’ŒçŠ¶æ€æ··ä¹±ã€‚</p>
                    </div>
                    
                    <div style="margin: 10px 0;">
                        <p style="margin: 4px 0; font-weight: 600; color: #15803d;">âœ… ä¿®å¤1: ä¸Šæ¶¨å æ¯”å®æ—¶æ˜¾ç¤º (v2.3)</p>
                        <ul style="margin: 2px 0 0 20px; padding: 0; font-size: 10px;">
                            <li><strong>é—®é¢˜ï¼š</strong>ä¸Šæ¶¨å æ¯”æ˜¾ç¤ºå»¶è¿Ÿæˆ–éšè—ï¼Œéœ€ç­‰å¾…60ç§’æˆ–å¼€å…³è§¦å‘æ‰æ˜¾ç¤º</li>
                            <li><strong>åŸå› ï¼š</strong>ä»£ç é€»è¾‘é”™è¯¯ï¼Œå°†æ•°æ®è·å–æ”¾åœ¨å¼€å…³æ£€æŸ¥ä¹‹å</li>
                            <li><strong>è§£å†³ï¼š</strong>å°†è·å–å¹¶æ˜¾ç¤ºä¸Šæ¶¨å æ¯”çš„ä»£ç æå‰ï¼Œç¡®ä¿ä¸è®ºå¼€å…³çŠ¶æ€å‡å®æ—¶æ˜¾ç¤º</li>
                            <li><strong>æ•ˆæœï¼š</strong>ä¸Šæ¶¨å æ¯”å§‹ç»ˆå¯è§ï¼Œ0%æ—¶çº¢è‰²é«˜äº®ï¼ˆ#ef4444ï¼‰ï¼Œ>0%æ—¶ç°è‰²æ˜¾ç¤ºï¼ˆ#6b7280ï¼‰ï¼Œ60ç§’è‡ªåŠ¨æ›´æ–°</li>
                        </ul>
                    </div>
                    
                    <div style="margin: 10px 0;">
                        <p style="margin: 4px 0; font-weight: 600; color: #15803d;">âœ… ä¿®å¤2: è´¦æˆ·ç‹¬ç«‹ç­–ç•¥å¼€å…³ (v2.4)</p>
                        <ul style="margin: 2px 0 0 20px; padding: 0; font-size: 10px;">
                            <li><strong>é—®é¢˜ï¼š</strong>4ä¸ªè´¦æˆ·ï¼ˆmain, fangfang12, poit, marksï¼‰å…±ç”¨åŒä¸€å¥—ç­–ç•¥å¼€å…³ï¼Œåˆ‡æ¢è´¦æˆ·åå¼€å…³çŠ¶æ€ä¸æ›´æ–°</li>
                            <li><strong>åŸå› ï¼š</strong>å‰ç«¯å¼€å…³æ˜¯å…¨å±€å•ä¸€DOMå…ƒç´ ï¼Œæœªå®ç°è´¦æˆ·åˆ‡æ¢æ—¶é‡æ–°åŠ è½½å¯¹åº”è´¦æˆ·çš„ç­–ç•¥çŠ¶æ€</li>
                            <li><strong>è§£å†³ï¼š</strong>æ–°å¢ <code>loadUpRatio0StrategySettings()</code> å‡½æ•°ï¼Œåœ¨è´¦æˆ·åˆ‡æ¢å’Œé¡µé¢åˆå§‹åŒ–æ—¶è°ƒç”¨ï¼Œä»APIåŠ è½½å½“å‰è´¦æˆ·çš„ç­–ç•¥çŠ¶æ€å¹¶æ›´æ–°å¼€å…³UI</li>
                            <li><strong>æ•ˆæœï¼š</strong>æ¯ä¸ªè´¦æˆ·çš„ç­–ç•¥å¼€å…³å®Œå…¨ç‹¬ç«‹ï¼Œåˆ‡æ¢è´¦æˆ·è‡ªåŠ¨åŠ è½½å¯¹åº”çŠ¶æ€ï¼ŒUIä¸JSONLæ–‡ä»¶ä¿æŒä¸€è‡´</li>
                        </ul>
                    </div>
                    
                    <div style="margin: 10px 0;">
                        <p style="margin: 4px 0; font-weight: 600; color: #15803d;">âœ… ä¿®å¤3: BTCç­–ç•¥JSONLåˆ†ç¦» (v2.5)</p>
                        <ul style="margin: 2px 0 0 20px; padding: 0; font-size: 10px;">
                            <li><strong>é—®é¢˜ï¼š</strong>BTCæ¶¨å¹…å‰8åå’Œæ¶¨å¹…å8åå…±ç”¨åŒä¸€ä¸ªJSONLæ–‡ä»¶ï¼Œå¯åŠ¨å…¶ä¸­ä¸€ä¸ªä¼šå½±å“å¦ä¸€ä¸ª</li>
                            <li><strong>åŸå› ï¼š</strong>åç«¯APIä½¿ç”¨ <code>{account_id}_execution.jsonl</code> ä½œä¸ºä¸¤ä¸ªç­–ç•¥çš„å…±äº«æ–‡ä»¶</li>
                            <li><strong>è§£å†³ï¼š</strong>å°†BTCç­–ç•¥APIä¿®æ”¹ä¸ºæ¥å— <code>strategy_type</code> å‚æ•°ï¼Œä½¿ç”¨ç‹¬ç«‹JSONLæ–‡ä»¶ï¼š<br>
                                <code>account_{account_id}_btc_top_performers_execution.jsonl</code><br>
                                <code>account_{account_id}_btc_bottom_performers_execution.jsonl</code>
                            </li>
                            <li><strong>æ•ˆæœï¼š</strong>4ä¸ªè´¦æˆ· Ã— 4ä¸ªç­–ç•¥ï¼ˆBTC-top8, BTC-bottom8, upratio0-top8, upratio0-bottom8ï¼‰= 16ä¸ªç‹¬ç«‹JSONLæ–‡ä»¶ï¼Œå®Œå…¨é¿å…å†²çª</li>
                        </ul>
                    </div>
                    
                    <div style="margin: 10px 0; padding: 8px; background: #dbeafe; border-radius: 4px;">
                        <p style="margin: 0; font-weight: 600; color: #1e40af;">ğŸ“Š æ¶æ„æ”¹è¿›ç»Ÿè®¡</p>
                        <ul style="margin: 4px 0 0 20px; padding: 0; font-size: 10px; color: #1e3a8a;">
                            <li>ä¿®æ”¹æ–‡ä»¶ï¼š105ä¸ªæ–‡ä»¶</li>
                            <li>ä»£ç å˜æ›´ï¼š+332è¡Œæ’å…¥ / -52è¡Œåˆ é™¤</li>
                            <li>Gitæäº¤ï¼š11æ¬¡æäº¤</li>
                            <li>æ–°å¢æ–‡æ¡£ï¼š7ä»½æ–‡æ¡£ï¼ˆæ€»è®¡41.2 KBï¼‰</li>
                            <li>ç‹¬ç«‹JSONLæ–‡ä»¶ï¼šä»2ä¸ªå¢åŠ åˆ°16ä¸ª</li>
                            <li>æ˜¾ç¤ºå»¶è¿Ÿï¼šä»60ç§’+é™è‡³0ç§’</li>
                        </ul>
                    </div>
                </div>
                
                <!-- 9. ç¯å¢ƒå˜é‡ -->
                <div style="background: white; padding: 10px; border-radius: 6px; margin-bottom: 10px; border-left: 4px solid #ec4899;">
                    <h4 style="margin: 0 0 8px 0; color: #0369a1; font-size: 12px;">ğŸ” ä¹ã€ç¯å¢ƒå˜é‡ä¸é…ç½®</h4>
                    <table style="width: 100%; font-size: 10px; border-collapse: collapse;">
                        <thead>
                            <tr style="background: #f1f5f9;">
                                <th style="padding: 4px; text-align: left; border: 1px solid #cbd5e1;">é…ç½®é¡¹</th>
                                <th style="padding: 4px; text-align: left; border: 1px solid #cbd5e1;">è¯´æ˜</th>
                                <th style="padding: 4px; text-align: left; border: 1px solid #cbd5e1;">é»˜è®¤å€¼</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td style="padding: 4px; border: 1px solid #cbd5e1;">FLASK_PORT</td><td style="padding: 4px; border: 1px solid #cbd5e1;">FlaskæœåŠ¡ç«¯å£</td><td style="padding: 4px; border: 1px solid #cbd5e1;">5000</td></tr>
                            <tr><td style="padding: 4px; border: 1px solid #cbd5e1;">OKX_API_KEY</td><td style="padding: 4px; border: 1px solid #cbd5e1;">OKX APIå¯†é’¥</td><td style="padding: 4px; border: 1px solid #cbd5e1;">ä»okx_accounts.jsonè¯»å–</td></tr>
                            <tr><td style="padding: 4px; border: 1px solid #cbd5e1;">OKX_API_SECRET</td><td style="padding: 4px; border: 1px solid #cbd5e1;">OKX APIå¯†é’¥å¯†ç </td><td style="padding: 4px; border: 1px solid #cbd5e1;">ä»okx_accounts.jsonè¯»å–</td></tr>
                            <tr><td style="padding: 4px; border: 1px solid #cbd5e1;">OKX_PASSPHRASE</td><td style="padding: 4px; border: 1px solid #cbd5e1;">OKX APIå£ä»¤</td><td style="padding: 4px; border: 1px solid #cbd5e1;">ä»okx_accounts.jsonè¯»å–</td></tr>
                            <tr><td style="padding: 4px; border: 1px solid #cbd5e1;">DATA_DIR</td><td style="padding: 4px; border: 1px solid #cbd5e1;">æ•°æ®å­˜å‚¨ç›®å½•</td><td style="padding: 4px; border: 1px solid #cbd5e1;">/home/user/webapp/data</td></tr>
                        </tbody>
                    </table>
                </div>
                
                <!-- 9. åŠŸèƒ½ç‰¹æ€§ -->
                <div style="background: white; padding: 10px; border-radius: 6px; border-left: 4px solid #14b8a6;">
                    <h4 style="margin: 0 0 8px 0; color: #0369a1; font-size: 12px;">âœ¨ ä¹ã€æ ¸å¿ƒåŠŸèƒ½ç‰¹æ€§</h4>
                    <ul style="margin: 4px 0 0 20px; padding: 0; font-size: 10px;">
                        <li><strong>å¤šè´¦æˆ·ç®¡ç†ï¼š</strong>æ”¯æŒ4ä¸ªç‹¬ç«‹è´¦æˆ·ï¼Œæ¯ä¸ªè´¦æˆ·ç‹¬ç«‹é…ç½®ç­–ç•¥å’Œæ­¢ç›ˆæ­¢æŸ</li>
                        <li><strong>å®æ—¶è¡Œæƒ…ï¼š</strong>27ä¸ªUSDT-SWAPäº¤æ˜“å¯¹ï¼Œ10ç§’åˆ·æ–°ä¸€æ¬¡</li>
                        <li><strong>ğŸ†• BTCä»·æ ¼è§¦å‘ç­–ç•¥ï¼ˆ2ä¸ªï¼‰ï¼š</strong>
                            <ul style="margin: 2px 0 0 20px;">
                                <li>æ¶¨å¹…å8åï¼šBTCä»·æ ¼ < è§¦å‘ä»·ï¼Œå¯¹å¸¸ç”¨å¸(15ä¸ª)ä¸­æ¶¨å¹…å8åå¼€å¤šå•ï¼Œ1.5% Ã— 10å€æ æ†</li>
                                <li>æ¶¨å¹…å‰8åï¼šBTCä»·æ ¼ > è§¦å‘ä»·ï¼Œå¯¹å¸¸ç”¨å¸(15ä¸ª)ä¸­æ¶¨å¹…å‰8åå¼€å¤šå•ï¼Œ1.5% Ã— 10å€æ æ†</li>
                                <li>è§¦å‘æ—¶å’Œå®Œæˆæ—¶å‡å‘é€TGæ¶ˆæ¯ï¼Œå®Œæˆæ—¶æ˜¾ç¤ºAlertå¼¹çª—</li>
                            </ul>
                        </li>
                        <li><strong>ğŸ†• ä¸Šæ¶¨å æ¯”0è§¦å‘ç­–ç•¥ï¼ˆ2ä¸ªï¼‰ï¼š</strong>
                            <ul style="margin: 2px 0 0 20px;">
                                <li>æ¶¨å¹…å‰8åï¼šä¸Šæ¶¨å æ¯” = 0%æ—¶ï¼Œå¯¹å¸¸ç”¨å¸ä¸­æ¶¨å¹…å‰8åå¼€å¤šå•ï¼Œ1.5% Ã— 10å€æ æ†</li>
                                <li>æ¶¨å¹…å8åï¼šä¸Šæ¶¨å æ¯” = 0%æ—¶ï¼Œå¯¹å¸¸ç”¨å¸ä¸­æ¶¨å¹…å8åå¼€å¤šå•ï¼Œ1.5% Ã— 10å€æ æ†</li>
                                <li>æ’é™¤æ—¶æ®µï¼š0:00-0:30ï¼ˆåŒ—äº¬æ—¶é—´ï¼‰</li>
                                <li>å®Œæˆæ—¶å‘é€TGæ¶ˆæ¯å’ŒAlertå¼¹çª—ï¼Œè‡ªåŠ¨åˆ·æ–°æŒä»“</li>
                                <li>è´¦æˆ·éš”ç¦»ï¼šæ¯ä¸ªè´¦æˆ·ç‹¬ç«‹çš„JSONLæ‰§è¡Œè®¸å¯æ–‡ä»¶</li>
                            </ul>
                        </li>
                        <li><strong>æ­¢ç›ˆæ­¢æŸï¼š</strong>åŸºäºè´¦æˆ·æ€»æœªå®ç°ç›ˆäºï¼Œæ”¯æŒUSDTé˜ˆå€¼è®¾ç½®</li>
                        <li><strong>æŒä»“è·Ÿè¸ªï¼š</strong>å®æ—¶æ˜¾ç¤ºæŒä»“ã€å§”æ‰˜è®¢å•ã€æµ®åŠ¨ç›ˆäº</li>
                        <li><strong>äº¤æ˜“æ—¥å¿—ï¼š</strong>å®Œæ•´è®°å½•æ¯ç¬”äº¤æ˜“ï¼Œæ”¯æŒæŒ‰æ—¥æœŸæŸ¥è¯¢</li>
                        <li><strong>æ¶¨è·Œå¹…ç»Ÿè®¡ï¼š</strong>27å¸ç§æ¶¨è·Œå¹…ä¹‹å’Œï¼Œä¸Šæ¶¨å æ¯”å®æ—¶è®¡ç®—</li>
                        <li><strong>æŠ€æœ¯æŒ‡æ ‡ï¼š</strong>SARæŠ›ç‰©çº¿ã€Biasåç¦»åº¦ã€24h/2hé€ƒé¡¶ä¿¡å·</li>
                        <li><strong>ææ…ŒæŒ‡æ•°ï¼š</strong>å¸‚åœºæƒ…ç»ªæŒ‡æ ‡ï¼Œæ´—ç›˜æŒ‡æ•°ç›‘æ§</li>
                        <li><strong>ä»·æ ¼é¢„è­¦ï¼š</strong>ä»·æ ¼ä½ç½®é¢„è­¦ç³»ç»Ÿï¼Œæ”¯æŒå¤šå¸ç§ç›‘æ§</li>
                        <li><strong>æ•°æ®æŒä¹…åŒ–ï¼š</strong>æ‰€æœ‰è®¾ç½®å’Œå†å²è®°å½•ä¿å­˜åˆ°JSONLæ–‡ä»¶</li>
                        <li><strong>è·¨è®¾å¤‡åŒæ­¥ï¼š</strong>æœåŠ¡å™¨ç«¯å­˜å‚¨ï¼Œæ”¯æŒå¤šè®¾å¤‡è®¿é—®</li>
                    </ul>
                </div>
                
                <!-- 10. é˜²é‡å¤ä¸‹å•æœºåˆ¶è¯´æ˜ -->
                <div style="background: white; padding: 10px; border-radius: 6px; border-left: 4px solid #fbbf24;">
                    <h4 style="margin: 0 0 8px 0; color: #0369a1; font-size: 12px;">ğŸ›¡ï¸ åã€é˜²é‡å¤ä¸‹å•æœºåˆ¶ï¼ˆä¸‰å±‚é˜²æŠ¤ï¼‰</h4>
                    <p style="margin: 4px 0;"><strong>ç³»ç»Ÿé‡‡ç”¨ä¸‰å±‚é˜²æŠ¤æœºåˆ¶ï¼Œç¡®ä¿å³ä½¿å¤šè®¾å¤‡/å¤šæµè§ˆå™¨åŒæ—¶è®¿é—®ï¼Œä¹Ÿåªæ‰§è¡Œä¸€æ¬¡å¼€å•æ“ä½œã€‚</strong></p>
                    
                    <p style="margin: 8px 0 4px 0; font-weight: 600; font-size: 10px;">10.1 ç¬¬ä¸€å±‚ï¼šJSONLæ–‡ä»¶é”ï¼ˆæ•°æ®å±‚ï¼‰- æœ€å¯é çš„é˜²æŠ¤</p>
                    <ul style="margin: 4px 0 0 20px; padding: 0; font-size: 10px;">
                        <li><strong>ğŸ†• BTCä»·æ ¼è§¦å‘ç­–ç•¥ï¼ˆv2.5ç‹¬ç«‹ï¼‰ï¼š</strong>æ¯ä¸ªè´¦å·ã€æ¯ä¸ªç­–ç•¥ç±»å‹ç‹¬ç«‹çš„æ‰§è¡Œè®¸å¯æ–‡ä»¶ï¼š
                            <ul style="margin: 2px 0 0 20px;">
                                <li><code style="background: #f1f5f9; padding: 2px 4px;">data/okx_auto_strategy/account_{account_id}_btc_top_performers_execution.jsonl</code></li>
                                <li><code style="background: #f1f5f9; padding: 2px 4px;">data/okx_auto_strategy/account_{account_id}_btc_bottom_performers_execution.jsonl</code></li>
                            </ul>
                        </li>
                        <li><strong>ğŸ†• ä¸Šæ¶¨å æ¯”0ç­–ç•¥ï¼š</strong>æ¯ä¸ªè´¦å·ã€æ¯ä¸ªç­–ç•¥ç‹¬ç«‹çš„æ‰§è¡Œè®¸å¯æ–‡ä»¶ï¼š
                            <ul style="margin: 2px 0 0 20px;">
                                <li><code style="background: #f1f5f9; padding: 2px 4px;">data/okx_auto_strategy/account_{account_id}_upratio0_top8_execution.jsonl</code></li>
                                <li><code style="background: #f1f5f9; padding: 2px 4px;">data/okx_auto_strategy/account_{account_id}_upratio0_bottom8_execution.jsonl</code></li>
                            </ul>
                        </li>
                        <li>è®°å½•æ ¼å¼ï¼š<code>{"allowed": true/false, "reason": "...", "timestamp": "...", "account_id": "...", "strategy_type": "..."}</code></li>
                        <li>æ‰§è¡Œå‰é€šè¿‡APIæ£€æŸ¥æ–‡ä»¶æœ€åä¸€æ¡è®°å½•çš„ <code>allowed</code> çŠ¶æ€</li>
                        <li>æ‰§è¡Œåç«‹å³é€šè¿‡APIå†™å…¥ <code>allowed: false</code>ï¼Œé˜»æ­¢é‡å¤è§¦å‘</li>
                        <li><strong>âœ… è·¨è®¾å¤‡ã€è·¨æµè§ˆå™¨ã€è·¨ä¼šè¯æœ‰æ•ˆ - è¿™æ˜¯å”¯ä¸€çœŸç›¸æº</strong></li>
                    </ul>
                    
                    <p style="margin: 8px 0 4px 0; font-weight: 600; font-size: 10px;">10.2 ç¬¬äºŒå±‚ï¼šå†·å´æœŸï¼ˆæ—¶é—´å±‚ï¼‰</p>
                    <ul style="margin: 4px 0 0 20px; padding: 0; font-size: 10px;">
                        <li>5åˆ†é’Ÿå¼ºåˆ¶å†·å´æœŸï¼Œé˜²æ­¢çŸ­æ—¶é—´å†…é‡å¤æ‰§è¡Œ</li>
                        <li>æ£€æŸ¥ <code>lastExecutedTime</code>ï¼Œè·ç¦»ä¸Šæ¬¡æ‰§è¡Œä¸è¶³5åˆ†é’Ÿåˆ™æ‹’ç»</li>
                    </ul>
                    
                    <p style="margin: 8px 0 4px 0; font-weight: 600; font-size: 10px;">10.3 ç¬¬ä¸‰å±‚ï¼šæ‰§è¡Œé”ï¼ˆè¿›ç¨‹å±‚ï¼‰</p>
                    <ul style="margin: 4px 0 0 20px; padding: 0; font-size: 10px;">
                        <li>å…¨å±€å˜é‡ <code>strategyExecuting</code> æ ‡è®°æ‰§è¡Œä¸­çŠ¶æ€</li>
                        <li>åŒä¸€æµè§ˆå™¨é¡µé¢å†…é˜²æ­¢å¹¶å‘æ‰§è¡Œ</li>
                    </ul>
                    
                    <p style="margin: 8px 0 4px 0; font-weight: 600; font-size: 10px;">10.4 å·¥ä½œæµç¨‹</p>
                    <ol style="margin: 4px 0 0 20px; padding: 0; font-size: 10px;">
                        <li>ç”¨æˆ·å¼€å¯å¼€å…³ â†’ <code>POST /api/okx-trading/set-allowed/{account_id}</code> å†™å…¥ <code>allowed: true</code></li>
                        <li>è§¦å‘æ¡ä»¶æ»¡è¶³ â†’ <code>GET /api/okx-trading/check-allowed/{account_id}</code> æ£€æŸ¥JSONL</li>
                        <li>æ£€æŸ¥å†·å´æœŸï¼ˆ5åˆ†é’Ÿï¼‰</li>
                        <li>è®¾ç½®å‰ç«¯æ‰§è¡Œé”</li>
                        <li>æ‰§è¡Œä¸‹å•æ“ä½œ</li>
                        <li>ä¸‹å•æˆåŠŸ â†’ <code>POST /api/okx-trading/set-allowed/{account_id}</code> å†™å…¥ <code>allowed: false</code></li>
                        <li>é‡Šæ”¾å‰ç«¯æ‰§è¡Œé”</li>
                    </ol>
                    
                    <p style="margin: 8px 0 4px 0; padding: 8px; background: #fef3c7; border-radius: 4px; font-size: 10px;"><strong>âš ï¸ é‡è¦ï¼š</strong>å³ä½¿å¤šä¸ªæµè§ˆå™¨/è®¾å¤‡åŒæ—¶æ‰“å¼€ï¼ŒJSONLæ–‡ä»¶é”ç¡®ä¿åªæœ‰ç¬¬ä¸€ä¸ªè§¦å‘çš„è¯·æ±‚èƒ½å¤Ÿæ‰§è¡Œã€‚è¿™æ˜¯æœ€å¯é çš„é˜²æŠ¤å±‚ã€‚</p>
                </div>
            </div>
        </div>

        <!-- è´¦æˆ·åˆ‡æ¢ -->
        <div class="account-switcher">
            <div class="account-switcher-label">
                ğŸ‘¤ é€‰æ‹©è´¦æˆ·
            </div>
            <div class="account-tabs" id="accountTabs">
                <!-- è´¦æˆ·æ ‡ç­¾å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
            </div>
            <div class="account-info">
                <span class="account-balance">
                    è´¦æˆ·ä½™é¢: <strong id="accountBalance">0.00 USDT</strong>
                </span>
                <button class="btn-manage-accounts" onclick="openAccountModal()">
                    âš™ï¸ ç®¡ç†è´¦æˆ·
                </button>
                <button class="btn-close-all-positions" onclick="closeAllAccountsPositions()" style="background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); color: white; border: none; padding: 12px 24px; border-radius: 10px; font-size: 16px; font-weight: 700; cursor: pointer; margin-left: 15px; box-shadow: 0 6px 16px rgba(239, 68, 68, 0.4); transition: all 0.3s;" onmouseover="this.style.transform='translateY(-3px)'; this.style.boxShadow='0 8px 20px rgba(239, 68, 68, 0.5)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 6px 16px rgba(239, 68, 68, 0.4)'">
                    ğŸš¨ ä¸€é”®å…¨å¹³
                </button>
            </div>
        </div>

        <!-- ä¸»è¦å¸ƒå±€ -->
        <div class="main-layout">
            <!-- å·¦ä¾§ï¼šäº¤æ˜“å¯¹åˆ—è¡¨ -->
            <div class="symbols-panel">
                <!-- å½“å‰è´¦æˆ·æ˜¾ç¤ºï¼ˆè¿·ä½ ç‰ˆï¼‰-->
                <div style="background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); color: white; padding: 10px 15px; border-radius: 8px; margin-bottom: 15px; cursor: pointer; font-size: 13px;" onclick="scrollToAccountSwitcher()">
                    <div style="font-weight: 600; margin-bottom: 4px;">
                        ğŸ‘¤ <span id="currentAccountName">ä¸»è´¦æˆ·</span>
                    </div>
                    <div style="font-size: 11px; opacity: 0.9;">
                        ä½™é¢: <span id="sidebarAccountBalance">0.00 USDT</span>
                    </div>
                    <div style="font-size: 10px; opacity: 0.7; margin-top: 4px;">
                        ç‚¹å‡»æŸ¥çœ‹è´¦æˆ·åˆ‡æ¢
                    </div>
                </div>
                <h3>ğŸ’° äº¤æ˜“å¯¹åˆ—è¡¨ (27)</h3>
                <input type="text" class="symbol-search" placeholder="æœç´¢äº¤æ˜“å¯¹..." id="symbolSearch">
                <div id="symbolsList">
                    <!-- äº¤æ˜“å¯¹åˆ—è¡¨å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
                </div>
            </div>

            <!-- ä¸­é—´ï¼šäº¤æ˜“é¢æ¿ -->
            <div class="trading-panel">
                <!-- å½“å‰äº¤æ˜“å¯¹ä¿¡æ¯ -->
                <div class="symbol-header">
                    <div class="symbol-info">
                        <div class="current-symbol" id="currentSymbol">BTC-USDT</div>
                        <div class="symbol-subtitle">æ°¸ç»­åˆçº¦</div>
                    </div>
                    <div class="current-price">
                        <div class="price-value" id="currentPrice">95650.00</div>
                        <span class="price-change down" id="priceChange">-0.96%</span>
                    </div>
                </div>

                <!-- äº¤æ˜“æ–¹å‘é€‰æ‹© -->
                <div class="direction-tabs">
                    <div class="direction-tab long active" onclick="selectDirection('long')">
                        â¬† åšå¤š
                    </div>
                    <div class="direction-tab short" onclick="selectDirection('short')">
                        â¬‡ åšç©º
                    </div>
                </div>

                <!-- äº¤æ˜“è¡¨å• -->
                <form class="trading-form" onsubmit="submitOrder(event)">
                    <!-- ä»·æ ¼ç±»å‹ -->
                    <div class="form-group">
                        <label class="form-label">ä»·æ ¼ç±»å‹</label>
                        <select class="form-control" id="priceType">
                            <option value="market">å¸‚ä»·å§”æ‰˜</option>
                            <option value="limit">é™ä»·å§”æ‰˜</option>
                        </select>
                    </div>

                    <!-- æ æ†å€æ•° -->
                    <div class="form-group">
                        <label class="form-label">æ æ†å€æ•°</label>
                        <div class="leverage-buttons">
                            <button type="button" class="leverage-btn" onclick="selectLeverage(3)">3x</button>
                            <button type="button" class="leverage-btn" onclick="selectLeverage(5)">5x</button>
                            <button type="button" class="leverage-btn active" onclick="selectLeverage(10)">10x</button>
                            <button type="button" class="leverage-btn" onclick="selectLeverage(20)">20x</button>
                        </div>
                    </div>

                    <!-- äº¤æ˜“æ•°é‡ -->
                    <div class="form-group">
                        <label class="form-label">å¼€ä»“é‡‘é¢ (USDT)</label>
                        <input type="number" class="form-control" id="orderAmount" placeholder="è¾“å…¥å¼€ä»“é‡‘é¢USDT" step="0.01" required>
                        <div style="margin-top: 8px; font-size: 12px; color: #718096;">
                            å¯ç”¨ä½™é¢: <span id="orderAvailableBalance">224.15 USDT</span>
                        </div>
                        <div style="margin-top: 4px; font-size: 11px; color: #a0aec0;">
                            ğŸ’¡ å®é™…å ç”¨ä¿è¯é‡‘ = å¼€ä»“é‡‘é¢ Ã· æ æ†å€æ•°
                        </div>
                    </div>

                    <!-- å¿«æ·é‡‘é¢ -->
                    <div class="form-group">
                        <div class="amount-presets">
                            <button type="button" class="preset-btn" onclick="setAmount(5)">5%</button>
                            <button type="button" class="preset-btn" onclick="setAmount(10)">10%</button>
                            <button type="button" class="preset-btn" onclick="setAmount(20)">20%</button>
                            <button type="button" class="preset-btn" onclick="setAmount(25)">25%</button>
                            <button type="button" class="preset-btn" onclick="setAmount(33)">33%</button>
                            <button type="button" class="preset-btn" onclick="setAmount(50)">50%</button>
                            <button type="button" class="preset-btn" onclick="setAmount(100)">100%</button>
                        </div>
                    </div>

                    <!-- æäº¤æŒ‰é’® -->
                    <button type="submit" class="submit-order long" id="submitBtn">
                        â¬† åšå¤š
                    </button>
                </form>

                <!-- æ‰¹é‡å¼€ä»“åŠŸèƒ½åŒº - æ¶¨å¹…å‰6åç­–ç•¥ -->
                <div class="batch-trading-section" style="margin-top: 24px; padding: 16px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 12px; box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3); max-width: 700px;">
                    <h3 style="color: white; margin-bottom: 12px; display: flex; align-items: center; gap: 8px; font-size: 16px;">
                        <span style="font-size: 18px;">âš¡</span>
                        æ¶¨å¹…å‰6åç­–ç•¥
                        <span style="background: rgba(255,255,255,0.2); padding: 3px 10px; border-radius: 12px; font-size: 12px; margin-left: auto;">å¸¸è§„ç­–ç•¥</span>
                    </h3>
                    
                    <!-- ç©ºå•ç­–ç•¥è¡Œ -->
                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px; margin-bottom: 8px;">
                        <button type="button" class="batch-btn short" onclick="batchOrder('short', 3)" data-strategy-code="TOP6_SHORT_A" style="padding: 8px;">
                            <div class="batch-btn-title" style="font-size: 13px;">ğŸ“‰ ç©ºå•ç­–ç•¥ A <span style="font-size: 9px; opacity: 0.7;">[TOP6_SHORT_A]</span></div>
                            <div class="batch-btn-desc" style="font-size: 11px;">æ¶¨å¹…å‰6 Â· 3% Â· 10x</div>
                        </button>
                        
                        <button type="button" class="batch-btn short" onclick="batchOrder('short', 5)" data-strategy-code="TOP6_SHORT_B" style="padding: 8px;">
                            <div class="batch-btn-title" style="font-size: 13px;">ğŸ“‰ ç©ºå•ç­–ç•¥ B <span style="font-size: 9px; opacity: 0.7;">[TOP6_SHORT_B]</span></div>
                            <div class="batch-btn-desc" style="font-size: 11px;">æ¶¨å¹…å‰6 Â· 5% Â· 10x</div>
                        </button>
                        
                        <button type="button" class="batch-btn short" onclick="batchOrder('short', 8)" data-strategy-code="TOP6_SHORT_C" style="padding: 8px;">
                            <div class="batch-btn-title" style="font-size: 13px;">ğŸ“‰ ç©ºå•ç­–ç•¥ C <span style="font-size: 9px; opacity: 0.7;">[TOP6_SHORT_C]</span></div>
                            <div class="batch-btn-desc" style="font-size: 11px;">æ¶¨å¹…å‰6 Â· 8% Â· 10x</div>
                        </button>
                    </div>
                    
                    <!-- å¤šå•ç­–ç•¥è¡Œ -->
                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px;">
                        <button type="button" class="batch-btn long" onclick="batchOrder('long', 3)" data-strategy-code="TOP6_LONG_A" style="padding: 8px;">
                            <div class="batch-btn-title" style="font-size: 13px;">ğŸ“ˆ å¤šå•ç­–ç•¥ A <span style="font-size: 9px; opacity: 0.7;">[TOP6_LONG_A]</span></div>
                            <div class="batch-btn-desc" style="font-size: 11px;">æ¶¨å¹…å‰6 Â· 3% Â· 10x</div>
                        </button>
                        
                        <button type="button" class="batch-btn long" onclick="batchOrder('long', 5)" data-strategy-code="TOP6_LONG_B" style="padding: 8px;">
                            <div class="batch-btn-title" style="font-size: 13px;">ğŸ“ˆ å¤šå•ç­–ç•¥ B <span style="font-size: 9px; opacity: 0.7;">[TOP6_LONG_B]</span></div>
                            <div class="batch-btn-desc" style="font-size: 11px;">æ¶¨å¹…å‰6 Â· 5% Â· 10x</div>
                        </button>
                        
                        <button type="button" class="batch-btn long" onclick="batchOrder('long', 8)" data-strategy-code="TOP6_LONG_C" style="padding: 8px;">
                            <div class="batch-btn-title" style="font-size: 13px;">ğŸ“ˆ å¤šå•ç­–ç•¥ C <span style="font-size: 9px; opacity: 0.7;">[TOP6_LONG_C]</span></div>
                            <div class="batch-btn-desc" style="font-size: 11px;">æ¶¨å¹…å‰6 Â· 8% Â· 10x</div>
                        </button>
                    </div>
                    
                    <div style="margin-top: 12px; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 6px; color: white; font-size: 12px;">
                        <div style="margin-bottom: 4px;">ğŸ’¡ <strong>ç­–ç•¥è¯´æ˜ï¼š</strong></div>
                        <div style="padding-left: 20px;">
                            â€¢ ä»â­<strong>å¸¸ç”¨å¸</strong>ä¸­é€‰æ‹©<strong>æ¶¨å¹…å‰6å</strong><br>
                            â€¢ æ¯ä¸ªå¸ç§å¹³å‡åˆ†é…å¼€ä»“é‡‘é¢<br>
                            â€¢ ç»Ÿä¸€ä½¿ç”¨10å€æ æ†ã€å¸‚ä»·å•<br>
                            â€¢ ç©ºå•ç­–ç•¥ï¼šåšç©ºæ¶¨å¹…é«˜çš„å¸ç§<br>
                            â€¢ å¤šå•ç­–ç•¥ï¼šåšå¤šæ¶¨å¹…é«˜çš„å¸ç§<br>
                            â€¢ <strong style="color: #10b981;">ğŸ”’ å•ç¬”é™é¢ï¼š<span id="maxOrderSizeDisplay1">5</span> USDT</strong> (è¶…å‡ºéƒ¨åˆ†è‡ªåŠ¨æˆªæ–­)<br>
                            â€¢ <span style="color: #fbbf24;">âš ï¸ è¯·å…ˆæ”¶è—è‡³å°‘6ä¸ªå¸¸ç”¨å¸</span>
                        </div>
                    </div>
                </div>

                <!-- æ‰¹é‡å¼€ä»“åŠŸèƒ½åŒº - æ¶¨å¹…å6åç­–ç•¥ (é«˜é£é™©) -->
                <div class="batch-trading-section" style="margin-top: 20px; padding: 16px; background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%); border-radius: 12px; box-shadow: 0 4px 12px rgba(220, 38, 38, 0.4); max-width: 700px; border: 3px solid #fbbf24;">
                    <h3 style="color: white; margin-bottom: 12px; display: flex; align-items: center; gap: 8px; font-size: 16px;">
                        <span style="font-size: 18px;">âš ï¸</span>
                        æ¶¨å¹…å6åç­–ç•¥
                        <span style="background: rgba(251,191,36,0.9); padding: 3px 10px; border-radius: 12px; font-size: 12px; margin-left: auto; color: #78350f; font-weight: bold;">âš ï¸ é«˜é£é™©åŒºåŸŸ</span>
                    </h3>
                    
                    <!-- è­¦å‘Šæç¤º -->
                    <div style="margin-bottom: 12px; padding: 10px; background: rgba(251,191,36,0.15); border: 2px solid rgba(251,191,36,0.5); border-radius: 6px; color: #fbbf24; font-size: 12px; font-weight: bold;">
                        âš ï¸ æ³¨æ„ï¼šæ­¤åŒºåŸŸé’ˆå¯¹è·Œå¹…æœ€å¤§çš„å¸ç§ï¼Œæ³¢åŠ¨æ€§æé«˜ï¼Œè¯·è°¨æ…æ“ä½œï¼
                    </div>
                    
                    <!-- å¤šå•ç­–ç•¥è¡Œ (é¢„æœŸåå¼¹) -->
                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px; margin-bottom: 8px;">
                        <button type="button" class="batch-btn long" onclick="batchOrder('long', 3, 'bottom')" data-strategy-code="BOTTOM6_LONG_D" style="padding: 8px; background: linear-gradient(135deg, #fb923c 0%, #ea580c 100%);">
                            <div class="batch-btn-title" style="font-size: 13px;">ğŸ“ˆ å¤šå•ç­–ç•¥ D <span style="font-size: 9px; opacity: 0.7;">[BOTTOM6_LONG_D]</span></div>
                            <div class="batch-btn-desc" style="font-size: 11px;">æ¶¨å¹…å6 Â· 3% Â· 10x</div>
                        </button>
                        
                        <button type="button" class="batch-btn long" onclick="batchOrder('long', 5, 'bottom')" data-strategy-code="BOTTOM6_LONG_E" style="padding: 8px; background: linear-gradient(135deg, #fb923c 0%, #ea580c 100%);">
                            <div class="batch-btn-title" style="font-size: 13px;">ğŸ“ˆ å¤šå•ç­–ç•¥ E <span style="font-size: 9px; opacity: 0.7;">[BOTTOM6_LONG_E]</span></div>
                            <div class="batch-btn-desc" style="font-size: 11px;">æ¶¨å¹…å6 Â· 5% Â· 10x</div>
                        </button>
                        
                        <button type="button" class="batch-btn long" onclick="batchOrder('long', 8, 'bottom')" data-strategy-code="BOTTOM6_LONG_F" style="padding: 8px; background: linear-gradient(135deg, #fb923c 0%, #ea580c 100%);">
                            <div class="batch-btn-title" style="font-size: 13px;">ğŸ“ˆ å¤šå•ç­–ç•¥ F <span style="font-size: 9px; opacity: 0.7;">[BOTTOM6_LONG_F]</span></div>
                            <div class="batch-btn-desc" style="font-size: 11px;">æ¶¨å¹…å6 Â· 8% Â· 10x</div>
                        </button>
                    </div>
                    
                    <!-- ç©ºå•ç­–ç•¥è¡Œ (è¶‹åŠ¿å»¶ç»­) -->
                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px;">
                        <button type="button" class="batch-btn short" onclick="batchOrder('short', 3, 'bottom')" data-strategy-code="BOTTOM6_SHORT_D" style="padding: 8px; background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);">
                            <div class="batch-btn-title" style="font-size: 13px;">ğŸ“‰ ç©ºå•ç­–ç•¥ D <span style="font-size: 9px; opacity: 0.7;">[BOTTOM6_SHORT_D]</span></div>
                            <div class="batch-btn-desc" style="font-size: 11px;">æ¶¨å¹…å6 Â· 3% Â· 10x</div>
                        </button>
                        
                        <button type="button" class="batch-btn short" onclick="batchOrder('short', 5, 'bottom')" data-strategy-code="BOTTOM6_SHORT_E" style="padding: 8px; background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);">
                            <div class="batch-btn-title" style="font-size: 13px;">ğŸ“‰ ç©ºå•ç­–ç•¥ E <span style="font-size: 9px; opacity: 0.7;">[BOTTOM6_SHORT_E]</span></div>
                            <div class="batch-btn-desc" style="font-size: 11px;">æ¶¨å¹…å6 Â· 5% Â· 10x</div>
                        </button>
                        
                        <button type="button" class="batch-btn short" onclick="batchOrder('short', 8, 'bottom')" data-strategy-code="BOTTOM6_SHORT_F" style="padding: 8px; background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);">
                            <div class="batch-btn-title" style="font-size: 13px;">ğŸ“‰ ç©ºå•ç­–ç•¥ F <span style="font-size: 9px; opacity: 0.7;">[BOTTOM6_SHORT_F]</span></div>
                            <div class="batch-btn-desc" style="font-size: 11px;">æ¶¨å¹…å6 Â· 8% Â· 10x</div>
                        </button>
                    </div>
                    
                    <div style="margin-top: 12px; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 6px; color: white; font-size: 12px;">
                        <div style="margin-bottom: 4px;">ğŸ’¡ <strong>ç­–ç•¥è¯´æ˜ï¼š</strong></div>
                        <div style="padding-left: 20px;">
                            â€¢ ä»â­<strong>å¸¸ç”¨å¸</strong>ä¸­é€‰æ‹©<strong>æ¶¨å¹…å6å</strong>ï¼ˆè·Œå¹…æœ€å¤§ï¼‰<br>
                            â€¢ <strong style="color: #fbbf24;">å¤šå•ç­–ç•¥ï¼š</strong>é¢„æœŸè¶…è·Œåå¼¹ï¼Œå¼€å¤šå•ç­‰å¾…å›å‡<br>
                            â€¢ <strong style="color: #fbbf24;">ç©ºå•ç­–ç•¥ï¼š</strong>é¢„æœŸè¶‹åŠ¿å»¶ç»­ï¼Œåšç©ºç»§ç»­ä¸‹è·Œ<br>
                            â€¢ ç»Ÿä¸€ä½¿ç”¨10å€æ æ†ã€å¸‚ä»·å•<br>
                            â€¢ <strong style="color: #10b981;">ğŸ”’ å•ç¬”é™é¢ï¼š<span id="maxOrderSizeDisplay2">5</span> USDT</strong> (è¶…å‡ºéƒ¨åˆ†è‡ªåŠ¨æˆªæ–­)<br>
                            â€¢ <span style="color: #fef3c7;">âš ï¸ è·Œå¹…å¤§çš„å¸ç§æ³¢åŠ¨æé«˜ï¼Œé£é™©æå¤§ï¼</span>
                        </div>
                    </div>
                </div>

                <!-- æ‰¹é‡å¼€ä»“åŠŸèƒ½åŒº - æ¶¨å¹…å‰8/å8åç­–ç•¥ -->
                <div class="batch-trading-section" style="margin-top: 20px; padding: 16px; background: linear-gradient(135deg, #f59e0b 0%, #ea580c 100%); border-radius: 12px; box-shadow: 0 4px 12px rgba(245, 158, 11, 0.4); max-width: 1450px;">
                    <h3 style="color: white; margin-bottom: 12px; display: flex; align-items: center; gap: 8px; font-size: 16px;">
                        <span style="font-size: 18px;">ğŸ¯</span>
                        æ¶¨å¹…å‰8/å8åç­–ç•¥
                        <span style="background: rgba(255,255,255,0.2); padding: 3px 10px; border-radius: 12px; font-size: 12px; margin-left: auto;">æ‰©å±•ç­–ç•¥</span>
                    </h3>
                    
                    <!-- æ¶¨å¹…å‰8åç­–ç•¥åŒºåŸŸ -->
                    <div style="margin-bottom: 16px; padding: 12px; background: rgba(102,126,234,0.2); border-radius: 8px; border: 2px solid rgba(102,126,234,0.4);">
                        <h4 style="color: white; font-size: 14px; margin-bottom: 8px; display: flex; align-items: center; gap: 6px;">
                            âš¡ æ¶¨å¹…å‰8åç­–ç•¥
                        </h4>
                        
                        <!-- å¤šå•ç­–ç•¥è¡Œ -->
                        <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 6px; margin-bottom: 8px;">
                            <button type="button" class="batch-btn long" onclick="batchOrderTop8('long', 1.5)" data-strategy-code="TOP8_LONG_1.5PCT" style="padding: 6px;">
                                <div class="batch-btn-title" style="font-size: 12px;">ğŸ“ˆ å¤šå• <span style="font-size: 9px; opacity: 0.7;">[TOP8_LONG_1.5PCT]</span></div>
                                <div class="batch-btn-desc" style="font-size: 10px;">å‰8Â·1.5%Â·10x</div>
                            </button>
                            
                            <button type="button" class="batch-btn long" onclick="batchOrderTop8('long', 3)" data-strategy-code="TOP8_LONG_3PCT" style="padding: 6px;">
                                <div class="batch-btn-title" style="font-size: 12px;">ğŸ“ˆ å¤šå• <span style="font-size: 9px; opacity: 0.7;">[TOP8_LONG_3PCT]</span></div>
                                <div class="batch-btn-desc" style="font-size: 10px;">å‰8Â·3%Â·10x</div>
                            </button>
                            
                            <button type="button" class="batch-btn long" onclick="batchOrderTop8('long', 5)" data-strategy-code="TOP8_LONG_5PCT" style="padding: 6px;">
                                <div class="batch-btn-title" style="font-size: 12px;">ğŸ“ˆ å¤šå• <span style="font-size: 9px; opacity: 0.7;">[TOP8_LONG_5PCT]</span></div>
                                <div class="batch-btn-desc" style="font-size: 10px;">å‰8Â·5%Â·10x</div>
                            </button>
                            
                            <button type="button" class="batch-btn long" onclick="batchOrderTop8('long', 8)" data-strategy-code="TOP8_LONG_8PCT" style="padding: 6px;">
                                <div class="batch-btn-title" style="font-size: 12px;">ğŸ“ˆ å¤šå• <span style="font-size: 9px; opacity: 0.7;">[TOP8_LONG_8PCT]</span></div>
                                <div class="batch-btn-desc" style="font-size: 10px;">å‰8Â·8%Â·10x</div>
                            </button>
                            
                            <button type="button" class="batch-btn long" onclick="executeBalStrategy('top8', 'long')" data-strategy-code="TOP8_LONG_BAL1PCT" style="padding: 6px; background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);">
                                <div class="batch-btn-title" style="font-size: 12px;">ğŸ’° å¤šå• <span style="font-size: 9px; opacity: 0.7;">[TOP8_LONG_BAL1PCT]</span></div>
                                <div class="batch-btn-desc" style="font-size: 10px;">å‰8Â·ä½™é¢1%</div>
                            </button>
                        </div>
                        
                        <!-- ç©ºå•ç­–ç•¥è¡Œ -->
                        <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 6px;">
                            <button type="button" class="batch-btn short" onclick="batchOrderTop8('short', 1.5)" data-strategy-code="TOP8_SHORT_1.5PCT" style="padding: 6px;">
                                <div class="batch-btn-title" style="font-size: 12px;">ğŸ“‰ ç©ºå• <span style="font-size: 9px; opacity: 0.7;">[TOP8_SHORT_1.5PCT]</span></div>
                                <div class="batch-btn-desc" style="font-size: 10px;">å‰8Â·1.5%Â·10x</div>
                            </button>
                            
                            <button type="button" class="batch-btn short" onclick="batchOrderTop8('short', 3)" data-strategy-code="TOP8_SHORT_3PCT" style="padding: 6px;">
                                <div class="batch-btn-title" style="font-size: 12px;">ğŸ“‰ ç©ºå• <span style="font-size: 9px; opacity: 0.7;">[TOP8_SHORT_3PCT]</span></div>
                                <div class="batch-btn-desc" style="font-size: 10px;">å‰8Â·3%Â·10x</div>
                            </button>
                            
                            <button type="button" class="batch-btn short" onclick="batchOrderTop8('short', 5)" data-strategy-code="TOP8_SHORT_5PCT" style="padding: 6px;">
                                <div class="batch-btn-title" style="font-size: 12px;">ğŸ“‰ ç©ºå• <span style="font-size: 9px; opacity: 0.7;">[TOP8_SHORT_5PCT]</span></div>
                                <div class="batch-btn-desc" style="font-size: 10px;">å‰8Â·5%Â·10x</div>
                            </button>
                            
                            <button type="button" class="batch-btn short" onclick="batchOrderTop8('short', 8)" data-strategy-code="TOP8_SHORT_8PCT" style="padding: 6px;">
                                <div class="batch-btn-title" style="font-size: 12px;">ğŸ“‰ ç©ºå• <span style="font-size: 9px; opacity: 0.7;">[TOP8_SHORT_8PCT]</span></div>
                                <div class="batch-btn-desc" style="font-size: 10px;">å‰8Â·8%Â·10x</div>
                            </button>
                            
                            <button type="button" class="batch-btn short" onclick="executeBalStrategy('top8', 'short')" data-strategy-code="TOP8_SHORT_BAL1PCT" style="padding: 6px; background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);">
                                <div class="batch-btn-title" style="font-size: 12px;">ğŸ’° ç©ºå• <span style="font-size: 9px; opacity: 0.7;">[TOP8_SHORT_BAL1PCT]</span></div>
                                <div class="batch-btn-desc" style="font-size: 10px;">å‰8Â·ä½™é¢1%</div>
                            </button>
                        </div>
                    </div>
                    
                    <!-- æ¶¨å¹…å8åç­–ç•¥åŒºåŸŸ -->
                    <div style="padding: 12px; background: rgba(220,38,38,0.2); border-radius: 8px; border: 2px solid rgba(220,38,38,0.4);">
                        <h4 style="color: white; font-size: 14px; margin-bottom: 8px; display: flex; align-items: center; gap: 6px;">
                            âš ï¸ æ¶¨å¹…å8åç­–ç•¥ <span style="color: #fbbf24; font-size: 11px; margin-left: auto;">(é«˜é£é™©)</span>
                        </h4>
                        
                        <!-- å¤šå•ç­–ç•¥è¡Œ -->
                        <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 6px; margin-bottom: 8px;">
                            <button type="button" class="batch-btn long" onclick="batchOrderBottom8('long', 1.5)" data-strategy-code="BOTTOM8_LONG_1.5PCT" style="padding: 6px; background: linear-gradient(135deg, #fb923c 0%, #ea580c 100%);">
                                <div class="batch-btn-title" style="font-size: 12px;">ğŸ“ˆ å¤šå• <span style="font-size: 9px; opacity: 0.7;">[BOTTOM8_LONG_1.5PCT]</span></div>
                                <div class="batch-btn-desc" style="font-size: 10px;">å8Â·1.5%Â·10x</div>
                            </button>
                            
                            <button type="button" class="batch-btn long" onclick="batchOrderBottom8('long', 3)" data-strategy-code="BOTTOM8_LONG_3PCT" style="padding: 6px; background: linear-gradient(135deg, #fb923c 0%, #ea580c 100%);">
                                <div class="batch-btn-title" style="font-size: 12px;">ğŸ“ˆ å¤šå• <span style="font-size: 9px; opacity: 0.7;">[BOTTOM8_LONG_3PCT]</span></div>
                                <div class="batch-btn-desc" style="font-size: 10px;">å8Â·3%Â·10x</div>
                            </button>
                            
                            <button type="button" class="batch-btn long" onclick="batchOrderBottom8('long', 5)" data-strategy-code="BOTTOM8_LONG_5PCT" style="padding: 6px; background: linear-gradient(135deg, #fb923c 0%, #ea580c 100%);">
                                <div class="batch-btn-title" style="font-size: 12px;">ğŸ“ˆ å¤šå• <span style="font-size: 9px; opacity: 0.7;">[BOTTOM8_LONG_5PCT]</span></div>
                                <div class="batch-btn-desc" style="font-size: 10px;">å8Â·5%Â·10x</div>
                            </button>
                            
                            <button type="button" class="batch-btn long" onclick="batchOrderBottom8('long', 8)" data-strategy-code="BOTTOM8_LONG_8PCT" style="padding: 6px; background: linear-gradient(135deg, #fb923c 0%, #ea580c 100%);">
                                <div class="batch-btn-title" style="font-size: 12px;">ğŸ“ˆ å¤šå• <span style="font-size: 9px; opacity: 0.7;">[BOTTOM8_LONG_8PCT]</span></div>
                                <div class="batch-btn-desc" style="font-size: 10px;">å8Â·8%Â·10x</div>
                            </button>
                            
                            <button type="button" class="batch-btn long" onclick="executeBalStrategy('bottom8', 'long')" data-strategy-code="BOTTOM8_LONG_BAL1PCT" style="padding: 6px; background: linear-gradient(135deg, #10b981 0%, #059669 100%);">
                                <div class="batch-btn-title" style="font-size: 12px;">ğŸ’° å¤šå• <span style="font-size: 9px; opacity: 0.7;">[BOTTOM8_LONG_BAL1PCT]</span></div>
                                <div class="batch-btn-desc" style="font-size: 10px;">å8Â·ä½™é¢1%</div>
                            </button>
                        </div>
                        
                        <!-- ç©ºå•ç­–ç•¥è¡Œ -->
                        <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 6px;">
                            <button type="button" class="batch-btn short" onclick="batchOrderBottom8('short', 1.5)" data-strategy-code="BOTTOM8_SHORT_1.5PCT" style="padding: 6px; background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);">
                                <div class="batch-btn-title" style="font-size: 12px;">ğŸ“‰ ç©ºå• <span style="font-size: 9px; opacity: 0.7;">[BOTTOM8_SHORT_1.5PCT]</span></div>
                                <div class="batch-btn-desc" style="font-size: 10px;">å8Â·1.5%Â·10x</div>
                            </button>
                            
                            <button type="button" class="batch-btn short" onclick="batchOrderBottom8('short', 3)" data-strategy-code="BOTTOM8_SHORT_3PCT" style="padding: 6px; background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);">
                                <div class="batch-btn-title" style="font-size: 12px;">ğŸ“‰ ç©ºå• <span style="font-size: 9px; opacity: 0.7;">[BOTTOM8_SHORT_3PCT]</span></div>
                                <div class="batch-btn-desc" style="font-size: 10px;">å8Â·3%Â·10x</div>
                            </button>
                            
                            <button type="button" class="batch-btn short" onclick="batchOrderBottom8('short', 5)" data-strategy-code="BOTTOM8_SHORT_5PCT" style="padding: 6px; background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);">
                                <div class="batch-btn-title" style="font-size: 12px;">ğŸ“‰ ç©ºå• <span style="font-size: 9px; opacity: 0.7;">[BOTTOM8_SHORT_5PCT]</span></div>
                                <div class="batch-btn-desc" style="font-size: 10px;">å8Â·5%Â·10x</div>
                            </button>
                            
                            <button type="button" class="batch-btn short" onclick="batchOrderBottom8('short', 8)" data-strategy-code="BOTTOM8_SHORT_8PCT" style="padding: 6px; background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);">
                                <div class="batch-btn-title" style="font-size: 12px;">ğŸ“‰ ç©ºå• <span style="font-size: 9px; opacity: 0.7;">[BOTTOM8_SHORT_8PCT]</span></div>
                                <div class="batch-btn-desc" style="font-size: 10px;">å8Â·8%Â·10x</div>
                            </button>
                            
                            <button type="button" class="batch-btn short" onclick="executeBalStrategy('bottom8', 'short')" data-strategy-code="BOTTOM8_SHORT_BAL1PCT" style="padding: 6px; background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%);">
                                <div class="batch-btn-title" style="font-size: 12px;">ğŸ’° ç©ºå• <span style="font-size: 9px; opacity: 0.7;">[BOTTOM8_SHORT_BAL1PCT]</span></div>
                                <div class="batch-btn-desc" style="font-size: 10px;">å8Â·ä½™é¢1%</div>
                            </button>
                        </div>
                    </div>
                    
                    <div style="margin-top: 12px; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 6px; color: white; font-size: 12px;">
                        <div style="margin-bottom: 4px;">ğŸ’¡ <strong>ç­–ç•¥è¯´æ˜ï¼š</strong></div>
                        <div style="padding-left: 20px;">
                            â€¢ ä»â­<strong>å¸¸ç”¨å¸</strong>ä¸­é€‰æ‹©<strong>æ¶¨å¹…å‰8å</strong>æˆ–<strong>æ¶¨å¹…å8å</strong><br>
                            â€¢ æ¯ä¸ªå¸ç§å¹³å‡åˆ†é…å¼€ä»“é‡‘é¢ï¼Œç»Ÿä¸€ä½¿ç”¨10å€æ æ†<br>
                            â€¢ <strong>æ¶¨å¹…å‰8ï¼š</strong>é’ˆå¯¹è¡¨ç°æœ€å¼ºçš„å¸ç§<br>
                            â€¢ <strong>æ¶¨å¹…å8ï¼š</strong>é’ˆå¯¹è·Œå¹…æœ€å¤§çš„å¸ç§ï¼ˆé«˜é£é™©ï¼‰<br>
                            â€¢ <strong style="color: #10b981;">ğŸ”’ å•ç¬”é™é¢ï¼š<span id="maxOrderSizeDisplay3">5</span> USDT</strong> (è¶…å‡ºéƒ¨åˆ†è‡ªåŠ¨æˆªæ–­)<br>
                            â€¢ <span style="color: #fbbf24;">âš ï¸ è¯·å…ˆæ”¶è—è‡³å°‘8ä¸ªå¸¸ç”¨å¸</span>
                        </div>
                    </div>
                </div>

                <!-- 1:1å¯¹å†²é…å¯¹ç­–ç•¥ -->
                <div class="batch-trading-section" style="margin-top: 24px; padding: 20px; background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); border-radius: 12px; box-shadow: 0 4px 12px rgba(245, 158, 11, 0.3);">
                    <h3 style="color: white; margin-bottom: 16px; display: flex; align-items: center; gap: 8px;">
                        <span style="font-size: 20px;">âš–ï¸</span>
                        1:1å¯¹å†²é…å¯¹ç­–ç•¥
                    </h3>
                    
                    <div class="batch-strategies" style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                        <!-- ç©ºå•é…å¤šå• -->
                        <button type="button" class="batch-btn" style="background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%); color: #78350f;" onclick="hedgePositions('short')" data-strategy-code="HEDGE_SHORT_TO_LONG">
                            <div class="batch-btn-title">âš–ï¸ ç©ºå•é…å¤šå• <span style="font-size: 9px; opacity: 0.7;">[HEDGE_SHORT_TO_LONG]</span></div>
                            <div class="batch-btn-desc">æŒä»“ç©ºå• 1:1 é…å¯¹å¤šå•</div>
                        </button>
                        
                        <!-- å¤šå•é…ç©ºå• -->
                        <button type="button" class="batch-btn" style="background: linear-gradient(135deg, #fb923c 0%, #ea580c 100%); color: #7c2d12;" onclick="hedgePositions('long')" data-strategy-code="HEDGE_LONG_TO_SHORT">
                            <div class="batch-btn-title">âš–ï¸ å¤šå•é…ç©ºå• <span style="font-size: 9px; opacity: 0.7;">[HEDGE_LONG_TO_SHORT]</span></div>
                            <div class="batch-btn-desc">æŒä»“å¤šå• 1:1 é…å¯¹ç©ºå•</div>
                        </button>
                    </div>
                    
                    <div style="margin-top: 12px; padding: 10px; background: rgba(255,255,255,0.1); border-radius: 6px; color: white; font-size: 12px;">
                        <div style="margin-bottom: 4px;">ğŸ’¡ <strong>å¯¹å†²è¯´æ˜ï¼š</strong></div>
                        <div style="padding-left: 20px;">
                            â€¢ <strong>ç©ºå•é…å¤šå•ï¼š</strong>æ ¹æ®ç°æœ‰ç©ºå•æŒä»“ï¼Œå¼€ç­‰é¢å¤šå•å¯¹å†²<br>
                            â€¢ <strong>å¤šå•é…ç©ºå•ï¼š</strong>æ ¹æ®ç°æœ‰å¤šå•æŒä»“ï¼Œå¼€ç­‰é¢ç©ºå•å¯¹å†²<br>
                            â€¢ è‡ªåŠ¨è®¡ç®—æ¯ä¸ªå¸ç§çš„æŒä»“é‡‘é¢<br>
                            â€¢ å¯¹å†²åé”å®šç›ˆäºï¼Œé™ä½é£é™©<br>
                            â€¢ ç¤ºä¾‹ï¼š6ä¸ªç©ºå•å„7U â†’ å¼€6ä¸ªå¤šå•å„7U<br>
                            â€¢ <span style="color: #fef3c7;">âš ï¸ éœ€è¦æœ‰å¯¹åº”æ–¹å‘çš„æŒä»“</span>
                        </div>
                    </div>
                </div>

                <!-- é£é™©æç¤º -->
                <div class="risk-warning">
                    <h4>âš ï¸ é£é™©æç¤º</h4>
                    <ul>
                        <li>åˆçº¦äº¤æ˜“å­˜åœ¨é«˜é£é™©ï¼Œè¯·è°¨æ…æ“ä½œ</li>
                        <li>æ æ†ä¼šæ”¾å¤§æ”¶ç›Šï¼Œä¹Ÿä¼šæ”¾å¤§äºæŸ</li>
                        <li>å»ºè®®è®¾ç½®æ­¢æŸï¼Œæ§åˆ¶é£é™©</li>
                    </ul>
                </div>
            </div>

            <!-- å³ä¾§ï¼šè´¦æˆ·ä¿¡æ¯ -->
            <div class="account-panel">
                <!-- APIé…ç½®æç¤º -->
                <div id="apiConfigNotice" style="display: none; background: #fef3c7; border: 1px solid #fbbf24; border-radius: 8px; padding: 12px; margin-bottom: 16px;">
                    <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                        <span style="font-size: 20px;">âš ï¸</span>
                        <strong style="color: #92400e;">éœ€è¦é…ç½®APIå‡­è¯</strong>
                    </div>
                    <p style="margin: 0 0 8px 28px; color: #78350f; font-size: 13px;">
                        å½“å‰è´¦æˆ·æœªé…ç½®OKX APIå‡­è¯ï¼Œæ— æ³•æŸ¥è¯¢è´¦æˆ·ä½™é¢å’ŒæŒä»“ä¿¡æ¯ã€‚
                    </p>
                    <p style="margin: 0 0 0 28px; color: #78350f; font-size: 13px;">
                        è¯·ç‚¹å‡»è´¦æˆ·æ ‡ç­¾ä¸Šçš„"ç¼–è¾‘"æŒ‰é’®ï¼Œå¡«å…¥æ‚¨çš„API Keyã€API Secretå’ŒPassphraseã€‚
                    </p>
                </div>
                
                <!-- è´¦æˆ·æ€»è§ˆ -->
                <div class="info-card">
                    <h3>ğŸ’° è´¦æˆ·ä¿¡æ¯ <button onclick="refreshAccountData()" style="background: #3b82f6; color: white; border: none; padding: 4px 8px; border-radius: 4px; cursor: pointer; font-size: 12px; margin-left: 10px;">ğŸ”„</button></h3>
                    <div class="info-row">
                        <span class="info-label">æ€»æƒç›Š</span>
                        <span class="info-value" style="color: #10b981;" id="totalEquity">-- USDT</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">å¯ç”¨ä½™é¢</span>
                        <span class="info-value" id="availableBalance">-- USDT</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">æŒä»“ä¿è¯é‡‘</span>
                        <span class="info-value" id="usedMargin">-- USDT</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">æœªå®ç°ç›ˆäº</span>
                        <span class="info-value" id="unrealizedPnl">-- USDT</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">å†»ç»“ä½™é¢</span>
                        <span class="info-value" id="frozenBalance">-- USDT</span>
                    </div>
                </div>

                <!-- RSIè‡ªåŠ¨å¼€ä»“ç­–ç•¥ï¼ˆç‹¬ç«‹å¡ç‰‡ï¼‰ -->
                <div class="info-card" style="margin-top: 16px; background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); border: 2px solid #f59e0b;">
                    <h3 style="color: #92400e; margin-bottom: 12px; display: flex; align-items: center; justify-content: space-between;">
                        <span style="display: flex; align-items: center; gap: 6px;">ğŸš€ RSIè‡ªåŠ¨å¼€ä»“ç­–ç•¥</span>
                        <button onclick="resetRsiStrategyExecution()" 
                                class="btn-reset-rsi"
                                style="padding: 4px 12px; background: #f59e0b; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 11px; font-weight: 600; transition: all 0.3s;">
                            ğŸ”„ é‡ç½®æ‰§è¡Œè®¸å¯
                        </button>
                    </h3>
                    
                    <div style="font-size: 11px; color: #92400e; margin-bottom: 12px; padding: 8px; background: rgba(255, 255, 255, 0.5); border-radius: 4px; border-left: 3px solid #f59e0b;">
                        ğŸ’¡ <strong>è¯´æ˜ï¼š</strong>åŸºäºå¸‚åœºæƒ…ç»ªä¿¡å·å’ŒRSIæŒ‡æ ‡è‡ªåŠ¨å¼€ä»“ï¼Œç‹¬ç«‹äºæ­¢ç›ˆæ­¢æŸç³»ç»Ÿ
                    </div>
                    
                    <!-- ç­–ç•¥çŠ¶æ€æ€»è§ˆçª—å£ -->
                    <div id="strategyStatusOverview" style="margin-bottom: 12px; padding: 10px; background: rgba(255, 255, 255, 0.8); border-radius: 6px; border: 1px solid #d97706;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                            <span style="font-size: 12px; font-weight: 600; color: #92400e;">ğŸ“Š å½“å‰è´¦æˆ·ç­–ç•¥çŠ¶æ€</span>
                            <div style="display: flex; gap: 4px;">
                                <button onclick="resetAllStrategiesExecution()" style="padding: 2px 8px; background: #10b981; color: white; border: none; border-radius: 3px; cursor: pointer; font-size: 10px;">ğŸ”“ é‡ç½®æ‰€æœ‰</button>
                                <button onclick="refreshStrategyStatus()" style="padding: 2px 8px; background: #f59e0b; color: white; border: none; border-radius: 3px; cursor: pointer; font-size: 10px;">ğŸ”„ åˆ·æ–°</button>
                            </div>
                        </div>
                        <div id="strategyStatusContent" style="font-size: 10px; color: #78350f; line-height: 1.6;">
                            <div style="text-align: center; padding: 10px; color: #a16207;">â³ æ­£åœ¨åŠ è½½ç­–ç•¥çŠ¶æ€...</div>
                        </div>
                    </div>
                    
                    <!-- è§é¡¶ä¿¡å·åšç©ºç­–ç•¥ - æ¶¨å¹…å‰8 -->
                    <div style="margin-top: 10px; padding: 10px; background: rgba(220, 38, 38, 0.1); border-radius: 8px; border: 1px solid #dc2626;">
                        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px;">
                            <span style="color: #991b1b; font-weight: 600; font-size: 13px;">âš ï¸ è§é¡¶ä¿¡å·+æ¶¨å¹…å‰8åšç©º</span>
                            <label class="switch" style="position: relative; display: inline-block; width: 44px; height: 24px;">
                                <input type="checkbox" id="topSignalTop8ShortSwitch" style="opacity: 0; width: 0; height: 0;">
                                <span class="slider slider-top-signal-top8-short" style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; transition: .4s; border-radius: 24px;"></span>
                            </label>
                        </div>
                        <div style="font-size: 11px; color: #991b1b; line-height: 1.5;">
                            <strong>è§¦å‘æ¡ä»¶ï¼š</strong>
                            <ul style="margin: 4px 0; padding-left: 16px;">
                                <li>å‡ºç°<strong>"âš ï¸è§é¡¶ä¿¡å·"</strong></li>
                                <li><strong>RSIæ€»å’Œ > <span id="topSignalTop8RsiThresholdDisplay">1800</span></strong></li>
                                <li>è‡ªåŠ¨å¯¹<strong>æ¶¨å¹…å‰8åå¸ç§</strong>å¼€ç©ºå•</li>
                            </ul>
                            <strong>å‚æ•°è®¾ç½®ï¼š</strong>
                            <div style="display: flex; gap: 10px; margin: 8px 0; align-items: center;">
                                <div style="flex: 1;">
                                    <label style="font-size: 10px; color: #991b1b;">RSIé˜ˆå€¼</label>
                                    <input type="number" id="topSignalTop8RsiThreshold" value="1800" step="50" min="1000" max="3000"
                                           style="width: 100%; padding: 4px 8px; border: 1px solid #b91c1c; border-radius: 4px; font-size: 12px;"
                                           onchange="updateTopSignalTop8Display()">
                                </div>
                                <div style="flex: 1;">
                                    <label style="font-size: 10px; color: #991b1b;">å•å¸é™é¢(USDT)</label>
                                    <input type="number" id="topSignalTop8MaxOrder" value="5" step="1" min="1" max="100"
                                           style="width: 100%; padding: 4px 8px; border: 1px solid #b91c1c; border-radius: 4px; font-size: 12px;">
                                </div>
                                <button onclick="saveTopSignalTop8Config()" 
                                        style="padding: 4px 10px; background: #b91c1c; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 10px; font-weight: 600; white-space: nowrap;">
                                    ğŸ’¾ ä¿å­˜
                                </button>
                            </div>
                            <strong>èµ„é‡‘é…ç½®ï¼š</strong>
                            <ul style="margin: 4px 0; padding-left: 16px;">
                                <li>æ€»æŠ•å…¥ï¼šå¯ç”¨ä½™é¢çš„ <strong>1.5%</strong></li>
                                <li>åˆ†é…æ–¹å¼ï¼šå¹³å‡åˆ†é…ç»™8ä¸ªå¸ç§</li>
                                <li>å•å¸é™é¢ï¼šæœ€é«˜ <strong><span id="topSignalTop8MaxOrderDisplay">5.0</span> USDT</strong></li>
                            </ul>
                            <strong>ç›‘æ§é¢‘ç‡ï¼š</strong>æ¯60ç§’æ£€æŸ¥ä¸€æ¬¡ï¼Œè§¦å‘å1å°æ—¶å†…ä¸é‡å¤æ‰§è¡Œ
                        </div>
                    </div>
                    
                    <!-- è§é¡¶ä¿¡å·åšç©ºç­–ç•¥ - æ¶¨å¹…å8 -->
                    <div style="margin-top: 10px; padding: 10px; background: rgba(185, 28, 28, 0.1); border-radius: 8px; border: 1px solid #b91c1c;">
                        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px;">
                            <span style="color: #7f1d1d; font-weight: 600; font-size: 13px;">âš ï¸ è§é¡¶ä¿¡å·+æ¶¨å¹…å8åšç©º</span>
                            <label class="switch" style="position: relative; display: inline-block; width: 44px; height: 24px;">
                                <input type="checkbox" id="topSignalBottom8ShortSwitch" style="opacity: 0; width: 0; height: 0;">
                                <span class="slider slider-top-signal-bottom8-short" style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; transition: .4s; border-radius: 24px;"></span>
                            </label>
                        </div>
                        <div style="font-size: 11px; color: #7f1d1d; line-height: 1.5;">
                            <strong>è§¦å‘æ¡ä»¶ï¼š</strong>
                            <ul style="margin: 4px 0; padding-left: 16px;">
                                <li>å‡ºç°<strong>"âš ï¸è§é¡¶ä¿¡å·"</strong></li>
                                <li><strong>RSIæ€»å’Œ > <span id="topSignalBottom8RsiThresholdDisplay">1800</span></strong></li>
                                <li>è‡ªåŠ¨å¯¹<strong>æ¶¨å¹…å8åå¸ç§</strong>å¼€ç©ºå•</li>
                            </ul>
                            <strong>å‚æ•°è®¾ç½®ï¼š</strong>
                            <div style="display: flex; gap: 10px; margin: 8px 0; align-items: center;">
                                <div style="flex: 1;">
                                    <label style="font-size: 10px; color: #7f1d1d;">RSIé˜ˆå€¼</label>
                                    <input type="number" id="topSignalBottom8RsiThreshold" value="1800" step="50" min="1000" max="3000"
                                           style="width: 100%; padding: 4px 8px; border: 1px solid #991b1b; border-radius: 4px; font-size: 12px;"
                                           onchange="updateTopSignalBottom8Display()">
                                </div>
                                <div style="flex: 1;">
                                    <label style="font-size: 10px; color: #7f1d1d;">å•å¸é™é¢(USDT)</label>
                                    <input type="number" id="topSignalBottom8MaxOrder" value="5" step="1" min="1" max="100"
                                           style="width: 100%; padding: 4px 8px; border: 1px solid #991b1b; border-radius: 4px; font-size: 12px;">
                                </div>
                                <button onclick="saveTopSignalBottom8Config()" 
                                        style="padding: 4px 10px; background: #991b1b; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 10px; font-weight: 600; white-space: nowrap;">
                                    ğŸ’¾ ä¿å­˜
                                </button>
                            </div>
                            <strong>èµ„é‡‘é…ç½®ï¼š</strong>
                            <ul style="margin: 4px 0; padding-left: 16px;">
                                <li>æ€»æŠ•å…¥ï¼šå¯ç”¨ä½™é¢çš„ <strong>1.5%</strong></li>
                                <li>åˆ†é…æ–¹å¼ï¼šå¹³å‡åˆ†é…ç»™8ä¸ªå¸ç§</li>
                                <li>å•å¸é™é¢ï¼šæœ€é«˜ <strong><span id="topSignalBottom8MaxOrderDisplay">5.0</span> USDT</strong></li>
                            </ul>
                            <strong>ç›‘æ§é¢‘ç‡ï¼š</strong>æ¯60ç§’æ£€æŸ¥ä¸€æ¬¡ï¼Œè§¦å‘å1å°æ—¶å†…ä¸é‡å¤æ‰§è¡Œ
                        </div>
                    </div>
                    
                    <!-- è§åº•ä¿¡å·åšå¤šç­–ç•¥ - æ¶¨å¹…å‰8 -->
                    <div style="margin-top: 10px; padding: 10px; background: rgba(34, 197, 94, 0.1); border-radius: 8px; border: 1px solid #22c55e;">
                        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px;">
                            <span style="color: #166534; font-weight: 600; font-size: 13px;">ğŸ¯ è§åº•ä¿¡å·+æ¶¨å¹…å‰8åšå¤š</span>
                            <label class="switch" style="position: relative; display: inline-block; width: 44px; height: 24px;">
                                <input type="checkbox" id="bottomSignalTop8LongSwitch" style="opacity: 0; width: 0; height: 0;">
                                <span class="slider slider-bottom-signal-top8-long" style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; transition: .4s; border-radius: 24px;"></span>
                            </label>
                        </div>
                        <div style="font-size: 11px; color: #166534; line-height: 1.5;">
                            <strong>è§¦å‘æ¡ä»¶ï¼š</strong>
                            <ul style="margin: 4px 0; padding-left: 16px;">
                                <li>å‡ºç°<strong>"ğŸ¯è§åº•ä¿¡å·"</strong>ï¼ˆåº•éƒ¨èƒŒç¦»ï¼‰</li>
                                <li><strong>RSIæ€»å’Œ < <span id="bottomSignalTop8RsiThresholdDisplay">800</span></strong></li>
                                <li>è‡ªåŠ¨å¯¹<strong>æ¶¨å¹…å‰8åå¸ç§</strong>å¼€å¤šå•ï¼ˆ10å€æ æ†ï¼‰</li>
                            </ul>
                            <strong>å‚æ•°è®¾ç½®ï¼š</strong>
                            <div style="display: flex; gap: 10px; margin: 8px 0; align-items: center;">
                                <div style="flex: 1;">
                                    <label style="font-size: 10px; color: #166534;">RSIé˜ˆå€¼</label>
                                    <input type="number" id="bottomSignalTop8RsiThreshold" value="800" step="10" min="300" max="1500"
                                           style="width: 100%; padding: 4px 8px; border: 1px solid #22c55e; border-radius: 4px; font-size: 12px;"
                                           onchange="updateBottomSignalTop8Display()">
                                </div>
                                <div style="flex: 1;">
                                    <label style="font-size: 10px; color: #166534;">å•å¸é™é¢(USDT)</label>
                                    <input type="number" id="bottomSignalTop8MaxOrder" value="5" step="1" min="1" max="100"
                                           style="width: 100%; padding: 4px 8px; border: 1px solid #22c55e; border-radius: 4px; font-size: 12px;">
                                </div>
                                <button onclick="saveBottomSignalTop8Config()" 
                                        style="padding: 4px 10px; background: #22c55e; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 10px; font-weight: 600; white-space: nowrap;">
                                    ğŸ’¾ ä¿å­˜
                                </button>
                            </div>
                            <strong>èµ„é‡‘é…ç½®ï¼š</strong>
                            <ul style="margin: 4px 0; padding-left: 16px;">
                                <li>æ€»æŠ•å…¥ï¼šå¯ç”¨ä½™é¢çš„ <strong>1.5%</strong></li>
                                <li>åˆ†é…æ–¹å¼ï¼šå¹³å‡åˆ†é…ç»™8ä¸ªå¸ç§</li>
                                <li>å•å¸é™é¢ï¼šæœ€é«˜ <strong><span id="bottomSignalTop8MaxOrderDisplay">5.0</span> USDT</strong></li>
                            </ul>
                            <strong>ç›‘æ§é¢‘ç‡ï¼š</strong>æ¯60ç§’æ£€æŸ¥ä¸€æ¬¡ï¼Œè§¦å‘å1å°æ—¶å†…ä¸é‡å¤æ‰§è¡Œ
                        </div>
                    </div>
                    
                    <!-- è§åº•ä¿¡å·åšå¤šç­–ç•¥ - æ¶¨å¹…å8 -->
                    <div style="margin-top: 10px; padding: 10px; background: rgba(16, 185, 129, 0.1); border-radius: 8px; border: 1px solid #10b981;">
                        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px;">
                            <span style="color: #065f46; font-weight: 600; font-size: 13px;">ğŸ¯ è§åº•ä¿¡å·+æ¶¨å¹…å8åšå¤š</span>
                            <label class="switch" style="position: relative; display: inline-block; width: 44px; height: 24px;">
                                <input type="checkbox" id="bottomSignalBottom8LongSwitch" style="opacity: 0; width: 0; height: 0;">
                                <span class="slider slider-bottom-signal-bottom8-long" style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; transition: .4s; border-radius: 24px;"></span>
                            </label>
                        </div>
                        <div style="font-size: 11px; color: #065f46; line-height: 1.5;">
                            <strong>è§¦å‘æ¡ä»¶ï¼š</strong>
                            <ul style="margin: 4px 0; padding-left: 16px;">
                                <li>å‡ºç°<strong>"ğŸ¯è§åº•ä¿¡å·"</strong>ï¼ˆåº•éƒ¨èƒŒç¦»ï¼‰</li>
                                <li><strong>RSIæ€»å’Œ < <span id="bottomSignalBottom8RsiThresholdDisplay">800</span></strong></li>
                                <li>è‡ªåŠ¨å¯¹<strong>æ¶¨å¹…å8åå¸ç§</strong>å¼€å¤šå•ï¼ˆ10å€æ æ†ï¼‰</li>
                            </ul>
                            <strong>å‚æ•°è®¾ç½®ï¼š</strong>
                            <div style="display: flex; gap: 10px; margin: 8px 0; align-items: center;">
                                <div style="flex: 1;">
                                    <label style="font-size: 10px; color: #065f46;">RSIé˜ˆå€¼</label>
                                    <input type="number" id="bottomSignalBottom8RsiThreshold" value="800" step="10" min="300" max="1500"
                                           style="width: 100%; padding: 4px 8px; border: 1px solid #10b981; border-radius: 4px; font-size: 12px;"
                                           onchange="updateBottomSignalBottom8Display()">
                                </div>
                                <div style="flex: 1;">
                                    <label style="font-size: 10px; color: #065f46;">å•å¸é™é¢(USDT)</label>
                                    <input type="number" id="bottomSignalBottom8MaxOrder" value="5" step="1" min="1" max="100"
                                           style="width: 100%; padding: 4px 8px; border: 1px solid #10b981; border-radius: 4px; font-size: 12px;">
                                </div>
                                <button onclick="saveBottomSignalBottom8Config()" 
                                        style="padding: 4px 10px; background: #10b981; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 10px; font-weight: 600; white-space: nowrap;">
                                    ğŸ’¾ ä¿å­˜
                                </button>
                            </div>
                            <strong>èµ„é‡‘é…ç½®ï¼š</strong>
                            <ul style="margin: 4px 0; padding-left: 16px;">
                                <li>æ€»æŠ•å…¥ï¼šå¯ç”¨ä½™é¢çš„ <strong>1.5%</strong></li>
                                <li>åˆ†é…æ–¹å¼ï¼šå¹³å‡åˆ†é…ç»™8ä¸ªå¸ç§</li>
                                <li>å•å¸é™é¢ï¼šæœ€é«˜ <strong><span id="bottomSignalBottom8MaxOrderDisplay">5.0</span> USDT</strong></li>
                            </ul>
                            <strong>ç›‘æ§é¢‘ç‡ï¼š</strong>æ¯60ç§’æ£€æŸ¥ä¸€æ¬¡ï¼Œè§¦å‘å1å°æ—¶å†…ä¸é‡å¤æ‰§è¡Œ
                        </div>
                    </div>
                </div>

                <!-- æ­¢ç›ˆæ­¢æŸè®¾ç½® -->
                <div class="info-card" style="margin-top: 16px; background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%); border: 2px solid #22c55e;">
                    <h3 style="color: #166534; margin-bottom: 12px; display: flex; align-items: center; justify-content: space-between;">
                        <span style="display: flex; align-items: center; gap: 6px;">ğŸ¯ æ­¢ç›ˆæ­¢æŸè®¾ç½®</span>
                        <button onclick="toggleAllAccountsOverview()" id="toggleAllAccountsBtn" style="background: #3b82f6; color: white; border: none; padding: 4px 12px; border-radius: 4px; cursor: pointer; font-size: 11px; font-weight: 600;">
                            ğŸ“Š æŸ¥çœ‹æ‰€æœ‰è´¦æˆ·çŠ¶æ€
                        </button>
                    </h3>
                    
                    <!-- æ‰€æœ‰è´¦æˆ·çŠ¶æ€æ€»è§ˆï¼ˆå¯æŠ˜å ï¼‰ -->
                    <div id="allAccountsOverview" style="display: none; margin-bottom: 12px; padding: 12px; background: rgba(59, 130, 246, 0.1); border-radius: 8px; border: 2px solid #3b82f6;">
                        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px;">
                            <h4 style="margin: 0; color: #1e40af; font-size: 13px; font-weight: 700;">ğŸ“Š æ‰€æœ‰è´¦æˆ·æ­¢ç›ˆæ­¢æŸçŠ¶æ€æ€»è§ˆ</h4>
                            <button onclick="refreshAllAccountsOverview()" style="background: #10b981; color: white; border: none; padding: 2px 8px; border-radius: 4px; cursor: pointer; font-size: 10px; font-weight: 600;">ğŸ”„ åˆ·æ–°</button>
                        </div>
                        <div style="font-size: 10px; color: #1e40af; margin-bottom: 8px; opacity: 0.8;">
                            ğŸ’¡ å¿«é€ŸæŸ¥çœ‹æ‰€æœ‰è´¦æˆ·çš„ç­–ç•¥å¼€å…³çŠ¶æ€ï¼Œé¿å…é—æ¼é…ç½®
                        </div>
                        <div id="allAccountsStatusList" style="display: grid; grid-template-columns: 1fr; gap: 8px;">
                            <div style="text-align: center; color: #6b7280; padding: 20px; font-size: 12px;">
                                â³ æ­£åœ¨åŠ è½½...
                            </div>
                        </div>
                    </div>
                    
                    <!-- å½“å‰æœªå®ç°ç›ˆäº -->
                    <div class="info-row" style="margin-bottom: 12px; padding: 10px; background: rgba(255,255,255,0.6); border-radius: 6px; border: 2px dashed #22c55e;">
                        <span class="info-label" style="color: #166534; font-weight: 600;">å½“å‰æœªå®ç°ç›ˆäº</span>
                        <span class="info-value" style="font-weight: bold; font-size: 18px;" id="currentUnrealizedPnl">-- USDT</span>
                    </div>
                    
                    <!-- æœåŠ¡å™¨æ‰§è¡Œçš„é˜ˆå€¼æ˜¾ç¤º -->
                    <div style="display: flex; gap: 10px; margin-bottom: 12px;">
                        <div style="flex: 1; padding: 8px; background: rgba(34, 197, 94, 0.1); border-radius: 6px; border: 1px solid #22c55e;">
                            <div style="font-size: 11px; color: #166534; margin-bottom: 3px;">ğŸ“ˆ æœåŠ¡å™¨æ­¢ç›ˆé˜ˆå€¼</div>
                            <div style="font-size: 14px; font-weight: 700; color: #166534;" id="serverTakeProfitThreshold">+50 USDT</div>
                            <div style="font-size: 10px; color: #166534; margin-top: 2px; opacity: 0.7;" id="takeProfitStatus">æœªå¯ç”¨</div>
                        </div>
                        <div style="flex: 1; padding: 8px; background: rgba(239, 68, 68, 0.1); border-radius: 6px; border: 1px solid #ef4444;">
                            <div style="font-size: 11px; color: #991b1b; margin-bottom: 3px;">ğŸ“‰ æœåŠ¡å™¨æ­¢æŸé˜ˆå€¼</div>
                            <div style="font-size: 14px; font-weight: 700; color: #991b1b;" id="serverStopLossThreshold">-30 USDT</div>
                            <div style="font-size: 10px; color: #991b1b; margin-top: 2px; opacity: 0.7;" id="stopLossStatus">æœªå¯ç”¨</div>
                        </div>
                    </div>
                    
                    <!-- æ­¢ç›ˆè®¾ç½® -->
                    <div style="padding: 10px; background: rgba(34, 197, 94, 0.1); border-radius: 8px; border: 1px solid #22c55e; margin-bottom: 10px;">
                        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px;">
                            <span style="color: #166534; font-weight: 600; font-size: 13px;">ğŸ“ˆ æ­¢ç›ˆè­¦æŠ¥</span>
                            <label class="switch" style="position: relative; display: inline-block; width: 44px; height: 24px;">
                                <input type="checkbox" id="takeProfitSwitch" style="opacity: 0; width: 0; height: 0;">
                                <span class="slider slider-takeprofit" style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 24px;"></span>
                            </label>
                        </div>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <input type="number" id="takeProfitThreshold" value="50" step="1" min="1" 
                                   style="flex: 1; padding: 6px 10px; border: 1px solid #22c55e; border-radius: 6px; font-size: 13px;"
                                   placeholder="æ­¢ç›ˆé‡‘é¢">
                            <span style="color: #166534; font-size: 13px; font-weight: 600;">USDT</span>
                        </div>
                        <div style="font-size: 11px; color: #166534; margin-top: 6px;">
                            æœªå®ç°ç›ˆäºè¾¾åˆ°æ­¤é‡‘é¢æ—¶è§¦å‘è­¦æŠ¥
                        </div>
                    </div>
                    
                    <!-- æ­¢æŸè®¾ç½® -->
                    <div style="padding: 10px; background: rgba(239, 68, 68, 0.1); border-radius: 8px; border: 1px solid #ef4444;">
                        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px;">
                            <span style="color: #991b1b; font-weight: 600; font-size: 13px;">ğŸ“‰ æ­¢æŸè­¦æŠ¥</span>
                            <label class="switch" style="position: relative; display: inline-block; width: 44px; height: 24px;">
                                <input type="checkbox" id="stopLossSwitch" style="opacity: 0; width: 0; height: 0;">
                                <span class="slider slider-stoploss" style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 24px;"></span>
                            </label>
                        </div>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <input type="number" id="stopLossThreshold" value="-30" step="1" max="-1" 
                                   style="flex: 1; padding: 6px 10px; border: 1px solid #ef4444; border-radius: 6px; font-size: 13px;"
                                   placeholder="æ­¢æŸé‡‘é¢">
                            <span style="color: #991b1b; font-size: 13px; font-weight: 600;">USDT</span>
                        </div>
                        <div style="font-size: 11px; color: #991b1b; margin-top: 6px;">
                            æœªå®ç°ç›ˆäºè¾¾åˆ°æ­¤è´Ÿå€¼æ—¶è§¦å‘è­¦æŠ¥ï¼ˆè¾“å…¥è´Ÿæ•°ï¼‰
                        </div>
                    </div>
                    
                    <!-- RSIå¤šå•æ­¢ç›ˆè®¾ç½® -->
                    <div style="margin-top: 10px; padding: 10px; background: rgba(251, 146, 60, 0.1); border-radius: 8px; border: 1px solid #fb923c;">
                        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px;">
                            <span style="color: #9a3412; font-weight: 600; font-size: 13px;">ğŸ¯ RSIå¤šå•æ­¢ç›ˆ</span>
                            <label class="switch" style="position: relative; display: inline-block; width: 44px; height: 24px;">
                                <input type="checkbox" id="rsiTakeProfitSwitch" style="opacity: 0; width: 0; height: 0;">
                                <span class="slider slider-rsi-takeprofit" style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 24px;"></span>
                            </label>
                        </div>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <input type="number" id="rsiTakeProfitThreshold" value="1900" step="10" min="810" max="2700" 
                                   style="flex: 1; padding: 6px 10px; border: 1px solid #fb923c; border-radius: 6px; font-size: 13px;"
                                   placeholder="RSIé˜ˆå€¼">
                            <span style="color: #9a3412; font-size: 13px; font-weight: 600;">RSI</span>
                        </div>
                        <div style="font-size: 11px; color: #9a3412; margin-top: 6px;">
                            RSIä¹‹å’Œè¾¾åˆ°æ­¤é˜ˆå€¼æ—¶è§¦å‘å¤šå•æ­¢ç›ˆ (èŒƒå›´: 810-2700)
                        </div>
                    </div>
                    
                    <!-- RSIç©ºå•æ­¢ç›ˆè®¾ç½® -->
                    <div style="margin-top: 10px; padding: 10px; background: rgba(16, 185, 129, 0.1); border-radius: 8px; border: 1px solid #10b981;">
                        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px;">
                            <span style="color: #065f46; font-weight: 600; font-size: 13px;">ğŸ“‰ RSIç©ºå•æ­¢ç›ˆ</span>
                            <label class="switch" style="position: relative; display: inline-block; width: 44px; height: 24px; cursor: pointer;">
                                <input type="checkbox" id="rsiShortTakeProfitSwitch" style="opacity: 0; width: 0; height: 0;">
                                <span class="slider slider-rsi-short-takeprofit"></span>
                            </label>
                        </div>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <input type="number" id="rsiShortTakeProfitThreshold" value="810" step="10" min="810" max="2700" 
                                   style="flex: 1; padding: 6px 10px; border: 1px solid #10b981; border-radius: 6px; font-size: 13px;"
                                   placeholder="RSIé˜ˆå€¼">
                            <span style="color: #065f46; font-size: 13px; font-weight: 600;">RSI</span>
                        </div>
                        <div style="font-size: 11px; color: #065f46; margin-top: 6px;">
                            RSIä¹‹å’Œè·Œç ´æ­¤é˜ˆå€¼æ—¶è§¦å‘ç©ºå•æ­¢ç›ˆ (èŒƒå›´: 810-2700)
                        </div>
                    </div>
                    
                    
                    <!-- ğŸ”¥ å¸‚åœºæƒ…ç»ªæ­¢ç›ˆè®¾ç½® -->
                    <div style="margin-top: 10px; padding: 10px; background: rgba(239, 68, 68, 0.1); border-radius: 8px; border: 1px solid #ef4444;">
                        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px;">
                            <span style="color: #991b1b; font-weight: 600; font-size: 13px;">ğŸ”¥ å¸‚åœºæƒ…ç»ªæ­¢ç›ˆ</span>
                            <label class="switch" style="position: relative; display: inline-block; width: 44px; height: 24px;">
                                <input type="checkbox" id="sentimentTakeProfitSwitch" style="opacity: 0; width: 0; height: 0;">
                                <span class="slider slider-sentiment-takeprofit" style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 24px;"></span>
                            </label>
                        </div>
                        <div style="font-size: 11px; color: #991b1b; line-height: 1.5;">
                            å½“å¸‚åœºæƒ…ç»ªå‡ºç°<strong>"âš ï¸è§é¡¶ä¿¡å·"</strong>æˆ–<strong>"â›”é¡¶éƒ¨èƒŒç¦»"</strong>æ—¶ï¼Œè‡ªåŠ¨å¹³æ‰æ‰€æœ‰å¤šå•æŒä»“ã€‚ç›‘æ§é¢‘ç‡ï¼šæ¯60ç§’æ£€æŸ¥ä¸€æ¬¡ã€‚
                        </div>
                        <!-- å½“å‰å¸‚åœºæƒ…ç»ªæ˜¾ç¤º -->
                        <div style="margin-top: 8px; padding: 8px; background: rgba(255, 255, 255, 0.6); border-radius: 4px; border-left: 3px solid #ef4444;">
                            <div style="display: flex; align-items: center; justify-content: space-between;">
                                <span style="font-size: 11px; color: #991b1b;">ğŸ“Š å½“å‰å¸‚åœºæƒ…ç»ªï¼š</span>
                                <span id="currentSentimentDisplay" style="font-size: 14px; font-weight: 700; color: #991b1b;">--</span>
                            </div>
                            <div style="margin-top: 4px; font-size: 10px; color: #991b1b; opacity: 0.8;" id="sentimentUpdateTime">æœ€åæ›´æ–°: --</div>
                        </div>
                    </div>
                    
                    <!-- RSIæ•°æ®è®°å½• -->
                    <div style="margin-top: 10px; padding: 10px; background: rgba(251, 191, 36, 0.1); border-radius: 8px; border: 1px solid #f59e0b;">
                        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px;">
                            <span style="color: #92400e; font-weight: 600; font-size: 13px;">ğŸ“Š RSIæ•°æ®è®°å½•</span>
                            <span style="font-size: 10px; color: #92400e; background: rgba(251, 191, 36, 0.2); padding: 2px 8px; border-radius: 4px;">ä»…å±•ç¤º</span>
                        </div>
                        
                        <!-- å½“å‰RSIæ˜¾ç¤º -->
                        <div style="margin-top: 8px; padding: 8px; background: rgba(251, 191, 36, 0.2); border-radius: 4px; border-left: 3px solid #f59e0b;">
                            <div style="display: flex; align-items: center; justify-content: space-between;">
                                <span style="font-size: 11px; color: #92400e;">ğŸ“ˆ å½“å‰RSIä¹‹å’Œï¼š</span>
                                <span id="currentRSIDisplay" style="font-size: 18px; font-weight: 700; color: #92400e;">--</span>
                            </div>
                            <div style="margin-top: 6px; height: 10px; background: rgba(251, 191, 36, 0.2); border-radius: 4px; overflow: hidden;">
                                <div id="rsiProgressBar" style="height: 100%; width: 0%; background: linear-gradient(90deg, #10b981 0%, #f59e0b 50%, #ef4444 100%); transition: width 0.3s ease;"></div>
                            </div>
                            <div style="display: flex; justify-content: space-between; font-size: 9px; color: #92400e; margin-top: 3px;">
                                <span>810 (è¶…å–)</span>
                                <span>1755 (ä¸­æ€§)</span>
                                <span>2700 (è¶…ä¹°)</span>
                            </div>
                            <!-- RSIçŠ¶æ€ -->
                            <div id="rsiStatusTag" style="margin-top: 6px; text-align: center; padding: 4px; border-radius: 4px; font-size: 11px; font-weight: 600;">
                                --
                            </div>
                        </div>
                        
                        <!-- å½“æ—¥RSIç»Ÿè®¡ -->
                        <div style="margin-top: 8px; display: grid; grid-template-columns: 1fr 1fr; gap: 6px;">
                            <div style="padding: 6px; background: rgba(239, 68, 68, 0.1); border-radius: 4px; border-left: 2px solid #ef4444;">
                                <div style="font-size: 9px; color: #991b1b; margin-bottom: 2px;">ğŸ“ˆ ä»Šæ—¥æœ€é«˜</div>
                                <div id="rsiTodayMax" style="font-size: 14px; font-weight: 700; color: #dc2626;">--</div>
                            </div>
                            <div style="padding: 6px; background: rgba(16, 185, 129, 0.1); border-radius: 4px; border-left: 2px solid #10b981;">
                                <div style="font-size: 9px; color: #065f46; margin-bottom: 2px;">ğŸ“‰ ä»Šæ—¥æœ€ä½</div>
                                <div id="rsiTodayMin" style="font-size: 14px; font-weight: 700; color: #059669;">--</div>
                            </div>
                        </div>
                        
                        <div style="margin-top: 8px; padding: 6px; background: rgba(251, 191, 36, 0.15); border-radius: 4px; font-size: 10px; color: #92400e;">
                            ğŸ’¡ <strong>è¯´æ˜ï¼š</strong>RSIæ•°æ®æ¥æºäºcoin-change-trackeré¡µé¢çš„27å¸RSIä¹‹å’Œã€‚æ¯5åˆ†é’Ÿæ›´æ–°ä¸€æ¬¡ã€‚æ•°æ®ä»…ä¾›å‚è€ƒï¼Œä¸è§¦å‘ä»»ä½•äº¤æ˜“æ“ä½œã€‚
                        </div>
                    </div>
                    
                    <!-- æœ€å¤§å¼€ä»“ä¿è¯é‡‘é™åˆ¶æ˜¾ç¤º -->
                    <div style="margin-top: 12px; padding: 10px; background: rgba(251, 191, 36, 0.1); border-radius: 8px; border: 1px solid #f59e0b;">
                        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px;">
                            <span style="color: #92400e; font-weight: 600; font-size: 13px;">ğŸ›¡ï¸ å•ç¬”æœ€å¤§å¼€ä»“ä¿è¯é‡‘</span>
                            <span style="font-size: 18px; font-weight: 700; color: #92400e;" id="maxPositionValueDisplay">5.0 USDT</span>
                        </div>
                        <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                            <input type="number" id="maxPositionValueInput" value="5.0" step="0.5" min="1" 
                                   style="flex: 1; padding: 6px 10px; border: 1px solid #f59e0b; border-radius: 6px; font-size: 13px;"
                                   placeholder="æœ€å¤§å¼€ä»“ä¿è¯é‡‘">
                            <span style="color: #92400e; font-size: 13px; font-weight: 600;">USDT</span>
                        </div>
                        <div style="font-size: 11px; color: #92400e; margin-top: 6px;">
                            âš ï¸ <strong>é‡è¦è¯´æ˜ï¼š</strong>æ­¤é™åˆ¶ä»…ç”¨äºå¼€ä»“é£æ§ï¼Œé™åˆ¶çš„æ˜¯<strong>å•ç¬”å¼€ä»“ä¿è¯é‡‘</strong>ï¼ˆä½ èŠ±çš„é’±ï¼‰ï¼Œä¸æ˜¯æŒä»“ä»·å€¼ã€‚<br>
                            ğŸ“Œ æ­¢ç›ˆæ­¢æŸæ“ä½œä¸å—æ­¤é™åˆ¶ï¼Œä»»ä½•å¤§å°çš„æŒä»“éƒ½å¯ä»¥æ­£å¸¸æ­¢ç›ˆæ­¢æŸã€‚<br>
                            ğŸ’¡ å»ºè®®è®¾ç½®ä¸ºè´¦æˆ·ä½™é¢Ã—1.5%Ã—1.5ï¼ˆä¾‹å¦‚300UÃ—1.5%Ã—1.5â‰ˆ6.75Uï¼‰
                        </div>
                    </div>
                    
                    <!-- è¯´æ˜ -->
                    <div style="margin-top: 10px; padding: 8px; background: rgba(34, 197, 94, 0.1); border-radius: 6px; border-left: 3px solid #22c55e;">
                        <p style="color: #166534; font-size: 11px; margin: 0; line-height: 1.5; margin-bottom: 8px;">
                            ğŸ’¡ <strong>æç¤ºï¼š</strong>æ­¢ç›ˆæ­¢æŸåŸºäºè´¦æˆ·æ€»çš„æœªå®ç°ç›ˆäºï¼ˆUSDTï¼‰æ¥è®¡ç®—ï¼Œä¸æ˜¯æŒ‰å¸ç§ç™¾åˆ†æ¯”ã€‚æ¯ä¸ªè´¦æˆ·çš„è®¾ç½®ç‹¬ç«‹ä¿å­˜åˆ°æœåŠ¡å™¨JSONLæ–‡ä»¶ï¼Œå¯è·¨è®¾å¤‡ä½¿ç”¨ã€‚è¾¾åˆ°é˜ˆå€¼æ—¶ä¼šå¼¹çª—è­¦æŠ¥å’Œæ’­æ”¾å£°éŸ³ã€‚
                        </p>
                        <p style="color: #0369a1; font-size: 11px; margin: 0; line-height: 1.5; background: rgba(14, 165, 233, 0.1); padding: 6px; border-radius: 4px;">
                            ğŸ“Š <strong>å¼€ä»“é‡‘é¢é™åˆ¶ï¼š</strong>è‡ªåŠ¨ç­–ç•¥ä¸‹å•é‡‘é¢ = æ€»æƒç›ŠÃ—1.5%ï¼Œä½†ä¸è¶…è¿‡5 USDTã€‚ä¾‹å¦‚ï¼šæ€»æƒç›Š200Uæ—¶ä¸‹å•3Uâœ…ï¼›æ€»æƒç›Š500Uæ—¶ä¸‹å•5Uâœ…ï¼ˆä¸æ˜¯7.5Uï¼‰ã€‚
                        </p>
                    </div>
                </div>

                <!-- ğŸ“‰ æ¶¨å¹…å8åç­–ç•¥ï¼ˆæŠ„åº•ï¼‰ -->
                <div class="info-card" style="margin-top: 16px; background: linear-gradient(135deg, #ede9fe 0%, #ddd6fe 100%); border: 2px solid #8b5cf6;">
                    <h3 style="color: #5b21b6; margin-bottom: 12px; display: flex; align-items: center; gap: 6px;">
                        ğŸ“‰ æ¶¨å¹…å8åç­–ç•¥ï¼ˆæŠ„åº•ï¼‰
                    </h3>
                    
                    <!-- ç­–ç•¥å¼€å…³ -->
                    <div style="padding: 10px; background: rgba(139, 92, 246, 0.1); border-radius: 8px; border: 1px solid #8b5cf6; margin-bottom: 10px;">
                        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px;">
                            <span style="color: #5b21b6; font-weight: 600; font-size: 13px;">ğŸš€ å¯ç”¨è‡ªåŠ¨å¼€å•</span>
                            <label class="switch" style="position: relative; display: inline-block; width: 44px; height: 24px;">
                                <input type="checkbox" id="autoTradeSwitch" style="opacity: 0; width: 0; height: 0;">
                                <span class="slider slider-autotrade" style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 24px;">
                                    <style>
                                        #autoTradeSwitch:checked + .slider-autotrade { background-color: #8b5cf6; }
                                        #autoTradeSwitch:checked + .slider-autotrade:before { transform: translateX(20px); }
                                        .slider-autotrade:before {
                                            position: absolute;
                                            content: "";
                                            height: 18px;
                                            width: 18px;
                                            left: 3px;
                                            bottom: 3px;
                                            background-color: white;
                                            transition: .4s;
                                            border-radius: 50%;
                                        }
                                    </style>
                                </span>
                            </label>
                        </div>
                        
                        <!-- åå°è®¾ç½®æ˜¾ç¤º -->
                        <div id="serverAutoTradeSettings" style="display: block; padding: 8px; background: rgba(139, 92, 246, 0.15); border-radius: 6px; margin-bottom: 8px; border: 1px solid #8b5cf6;">
                            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 4px;">
                                <span style="color: #5b21b6; font-size: 11px; font-weight: 600;">ğŸ“Œ æœåŠ¡å™¨è§¦å‘ä»·æ ¼</span>
                                <span id="serverTriggerPrice" style="color: #7c3aed; font-size: 13px; font-weight: bold;">$68000.00</span>
                            </div>
                            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 4px;">
                                <span style="color: #5b21b6; font-size: 11px;">ç­–ç•¥çŠ¶æ€</span>
                                <span id="serverAutoTradeStatusBadge" style="color: #10b981; font-size: 11px; font-weight: 600;">âœ… å·²å¯ç”¨</span>
                            </div>
                            <div style="display: flex; align-items: center; justify-content: space-between;">
                                <span style="color: #5b21b6; font-size: 11px;">ğŸ“„ JSONLæ‰§è¡Œè®¸å¯</span>
                                <div style="display: flex; align-items: center; gap: 8px;">
                                    <span id="jsonlAllowedStatus" style="color: #6b7280; font-size: 11px; font-weight: 600;">â³ æ£€æŸ¥ä¸­...</span>
                                    <button onclick="resetJsonlAllowed()" style="padding: 2px 8px; background: #10b981; color: white; border: none; border-radius: 4px; font-size: 10px; cursor: pointer; font-weight: 600;">ğŸ”„ é‡ç½®</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- è§¦å‘æ¡ä»¶è®¾ç½® -->
                    <div style="padding: 10px; background: rgba(139, 92, 246, 0.05); border-radius: 8px; margin-bottom: 10px;">
                        <div style="margin-bottom: 8px;">
                            <label style="color: #5b21b6; font-weight: 600; font-size: 13px; display: block; margin-bottom: 8px;">
                                âš™ï¸ BTCä»·æ ¼è§¦å‘æ¡ä»¶
                            </label>
                            <!-- å½“å‰BTCä»·æ ¼ - é«˜äº®æ˜¾ç¤º -->
                            <div style="padding: 12px; background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%); border-radius: 8px; margin-bottom: 12px; border: 2px solid #3b82f6; box-shadow: 0 2px 8px rgba(59, 130, 246, 0.15);">
                                <div style="display: flex; align-items: center; justify-content: space-between;">
                                    <span style="color: #1e40af; font-size: 12px; font-weight: 600;">ğŸ“Š å½“å‰BTCä»·æ ¼</span>
                                    <span id="currentBtcPrice" style="color: #1e3a8a; font-weight: 800; font-size: 18px; font-family: 'Courier New', monospace; text-shadow: 0 1px 2px rgba(0,0,0,0.1);">--</span>
                                </div>
                            </div>
                            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 12px;">
                                <label style="color: #5b21b6; font-size: 12px; white-space: nowrap;">è§¦å‘ä»·æ ¼ (USD)</label>
                                <input type="number" id="autoTriggerPrice" value="68000" 
                                       style="flex: 1; padding: 8px; border: 2px solid #8b5cf6; border-radius: 6px; font-size: 14px; font-weight: 600;"
                                       placeholder="ä¾‹å¦‚: 68000">
                            </div>
                            <!-- éšè—çš„ç­–ç•¥ç±»å‹ï¼ˆJavaScriptéœ€è¦ï¼‰ -->
                            <input type="hidden" id="autoStrategyType" value="bottom_performers">
                        </div>
                        
                        <!-- å•ç¬”ä¸Šé™é…ç½® -->
                        <div style="margin-top: 12px; padding: 10px; background: rgba(251, 191, 36, 0.1); border-radius: 8px; border: 1px solid #f59e0b;">
                            <label style="color: #92400e; font-weight: 600; font-size: 13px; display: block; margin-bottom: 8px;">
                                ğŸ›¡ï¸ å•ç¬”ä¸Šé™è®¾ç½®
                            </label>
                            
                            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                                <input type="number" id="maxOrderSizeInput" value="5" step="0.5" min="1" 
                                       style="flex: 1; padding: 8px 10px; border: 1px solid #f59e0b; border-radius: 6px; font-size: 14px; font-weight: 600;"
                                       placeholder="ä¾‹å¦‚: 5">
                                <span style="color: #92400e; font-size: 14px; font-weight: 700;">USDT</span>
                            </div>
                            
                            <div style="font-size: 10px; color: #92400e; padding: 6px; background: rgba(251, 191, 36, 0.15); border-radius: 4px; line-height: 1.5;">
                                ğŸ’¡ <strong>è¯´æ˜ï¼š</strong>æ¯å¸å¼€ä»“é‡‘é¢ = min(å¯ç”¨ä½™é¢ Ã— 1.5%, å•ç¬”ä¸Šé™)
                                <br>ä¾‹å¦‚ä½™é¢67000Uï¼Œä¸Šé™5U â†’ æ¯å¸ = min(67000Ã—1.5%, 5) = 5 USDTï¼Œ8å¸å…±40 USDT
                            </div>
                        </div>
                    </div>
                    
                    <!-- æ‰§è¡ŒçŠ¶æ€ -->
                    <div style="padding: 10px; background: rgba(139, 92, 246, 0.05); border-radius: 8px; margin-bottom: 10px;">
                        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 4px;">
                            <span style="color: #5b21b6; font-size: 12px; font-weight: 600;">ç­–ç•¥çŠ¶æ€</span>
                            <span id="autoTradeStatus" style="color: #6b7280; font-size: 12px; font-weight: 600;">æœªå¯ç”¨</span>
                        </div>
                        <div style="display: flex; align-items: center; justify-content: space-between;">
                            <span style="color: #5b21b6; font-size: 12px;">ä¸Šæ¬¡æ‰§è¡Œæ—¶é—´</span>
                            <span id="autoTradeLastTime" style="color: #6b7280; font-size: 11px;">--</span>
                        </div>
                    </div>
                    
                    <div style="padding: 8px; background: rgba(139, 92, 246, 0.05); border-radius: 6px; margin-top: 8px; text-align: center;">
                        <span style="color: #5b21b6; font-size: 10px;">ğŸ“š è¯¦ç»†è¯´æ˜è¯·æŸ¥çœ‹é¡µé¢é¡¶éƒ¨"ç³»ç»Ÿæ¶æ„ä¸è¿è¡Œè¯´æ˜"</span>
                    </div>
                    
                </div>

                <!-- ğŸ“ˆ æ¶¨å¹…å‰8åç­–ç•¥ï¼ˆè¿½æ¶¨ï¼‰ -->
                <div class="info-card" style="margin-top: 16px; background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); border: 2px solid #f59e0b;">
                    <h3 style="color: #92400e; margin-bottom: 12px; display: flex; align-items: center; gap: 6px;">
                        ğŸ“ˆ æ¶¨å¹…å‰8åç­–ç•¥ï¼ˆè¿½æ¶¨ï¼‰
                    </h3>
                    
                    <!-- ç­–ç•¥å¼€å…³ -->
                    <div style="padding: 10px; background: rgba(245, 158, 11, 0.1); border-radius: 8px; border: 1px solid #f59e0b; margin-bottom: 10px;">
                        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px;">
                            <span style="color: #92400e; font-weight: 600; font-size: 13px;">ğŸš€ å¯ç”¨è‡ªåŠ¨å¼€å•</span>
                            <label class="switch" style="position: relative; display: inline-block; width: 44px; height: 24px;">
                                <input type="checkbox" id="autoTradeSwitchTop" style="opacity: 0; width: 0; height: 0;">
                                <span class="slider slider-autotrade-top" style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 24px;">
                                    <style>
                                        #autoTradeSwitchTop:checked + .slider-autotrade-top { background-color: #f59e0b; }
                                        #autoTradeSwitchTop:checked + .slider-autotrade-top:before { transform: translateX(20px); }
                                        .slider-autotrade-top:before {
                                            position: absolute;
                                            content: "";
                                            height: 18px;
                                            width: 18px;
                                            left: 3px;
                                            bottom: 3px;
                                            background-color: white;
                                            transition: .4s;
                                            border-radius: 50%;
                                        }
                                    </style>
                                </span>
                            </label>
                        </div>
                        
                        <!-- åå°è®¾ç½®æ˜¾ç¤º -->
                        <div id="serverAutoTradeSettingsTop" style="display: none; padding: 8px; background: rgba(245, 158, 11, 0.15); border-radius: 6px; margin-bottom: 8px; border: 1px solid #f59e0b;">
                            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 4px;">
                                <span style="color: #92400e; font-size: 11px; font-weight: 600;">ğŸ“Œ æœåŠ¡å™¨è§¦å‘ä»·æ ¼</span>
                                <span id="serverTriggerPriceTop" style="color: #b45309; font-size: 13px; font-weight: bold;">$68000.00</span>
                            </div>
                            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 4px;">
                                <span style="color: #92400e; font-size: 11px;">ç­–ç•¥çŠ¶æ€</span>
                                <span id="serverAutoTradeStatusBadgeTop" style="color: #10b981; font-size: 11px; font-weight: 600;">âœ… å·²å¯ç”¨</span>
                            </div>
                            <div style="display: flex; align-items: center; justify-content: space-between;">
                                <span style="color: #92400e; font-size: 11px;">ğŸ“„ JSONLæ‰§è¡Œè®¸å¯</span>
                                <div style="display: flex; align-items: center; gap: 8px;">
                                    <span id="jsonlAllowedStatusTop" style="color: #6b7280; font-size: 11px; font-weight: 600;">â³ æ£€æŸ¥ä¸­...</span>
                                    <button onclick="resetJsonlAllowed('Top')" style="padding: 2px 8px; background: #10b981; color: white; border: none; border-radius: 4px; font-size: 10px; cursor: pointer; font-weight: 600;">ğŸ”„ é‡ç½®</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- è§¦å‘æ¡ä»¶è®¾ç½® -->
                    <div style="padding: 10px; background: rgba(245, 158, 11, 0.05); border-radius: 8px; margin-bottom: 10px;">
                        <div style="margin-bottom: 8px;">
                            <label style="color: #92400e; font-weight: 600; font-size: 13px; display: block; margin-bottom: 8px;">
                                âš™ï¸ BTCä»·æ ¼è§¦å‘æ¡ä»¶
                            </label>
                            <!-- å½“å‰BTCä»·æ ¼ - é«˜äº®æ˜¾ç¤º -->
                            <div style="padding: 12px; background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%); border-radius: 8px; margin-bottom: 12px; border: 2px solid #3b82f6; box-shadow: 0 2px 8px rgba(59, 130, 246, 0.15);">
                                <div style="display: flex; align-items: center; justify-content: space-between;">
                                    <span style="color: #1e40af; font-size: 12px; font-weight: 600;">ğŸ“Š å½“å‰BTCä»·æ ¼</span>
                                    <span id="currentBtcPriceTop" style="color: #1e3a8a; font-weight: 800; font-size: 18px; font-family: 'Courier New', monospace; text-shadow: 0 1px 2px rgba(0,0,0,0.1);">--</span>
                                </div>
                            </div>
                            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 12px;">
                                <label style="color: #92400e; font-size: 12px; white-space: nowrap;">è§¦å‘ä»·æ ¼ (USD)</label>
                                <input type="number" id="autoTriggerPriceTop" value="68000" 
                                       style="flex: 1; padding: 8px; border: 2px solid #f59e0b; border-radius: 6px; font-size: 14px; font-weight: 600;"
                                       placeholder="ä¾‹å¦‚: 68000">
                            </div>
                            <!-- éšè—çš„ç­–ç•¥ç±»å‹ï¼ˆJavaScriptéœ€è¦ï¼‰ -->
                            <input type="hidden" id="autoStrategyTypeTop" value="top_performers">
                        </div>
                        
                        <!-- å•ç¬”ä¸Šé™é…ç½® -->
                        <div style="margin-top: 12px; padding: 10px; background: rgba(251, 191, 36, 0.1); border-radius: 8px; border: 1px solid #f59e0b;">
                            <label style="color: #92400e; font-weight: 600; font-size: 13px; display: block; margin-bottom: 8px;">
                                ğŸ›¡ï¸ å•ç¬”ä¸Šé™è®¾ç½®
                            </label>
                            
                            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                                <input type="number" id="maxOrderSizeInputTop" value="5" step="0.5" min="1" 
                                       style="flex: 1; padding: 8px 10px; border: 1px solid #f59e0b; border-radius: 6px; font-size: 14px; font-weight: 600;"
                                       placeholder="ä¾‹å¦‚: 5">
                                <span style="color: #92400e; font-size: 14px; font-weight: 700;">USDT</span>
                            </div>
                            
                            <div style="font-size: 10px; color: #92400e; padding: 6px; background: rgba(251, 191, 36, 0.15); border-radius: 4px; line-height: 1.5;">
                                ğŸ’¡ <strong>è¯´æ˜ï¼š</strong>æ¯å¸å¼€ä»“é‡‘é¢ = min(å¯ç”¨ä½™é¢ Ã— 1.5%, å•ç¬”ä¸Šé™)
                                <br>ä¾‹å¦‚ä½™é¢67000Uï¼Œä¸Šé™5U â†’ æ¯å¸ = min(67000Ã—1.5%, 5) = 5 USDTï¼Œ8å¸å…±40 USDT
                            </div>
                        </div>
                    </div>
                    
                    <!-- æ‰§è¡ŒçŠ¶æ€ -->
                    <div style="padding: 10px; background: rgba(245, 158, 11, 0.05); border-radius: 8px; margin-bottom: 10px;">
                        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 4px;">
                            <span style="color: #92400e; font-size: 12px; font-weight: 600;">ç­–ç•¥çŠ¶æ€</span>
                            <span id="autoTradeStatusTop" style="color: #6b7280; font-size: 12px; font-weight: 600;">æœªå¯ç”¨</span>
                        </div>
                        <div style="display: flex; align-items: center; justify-content: space-between;">
                            <span style="color: #92400e; font-size: 12px;">ä¸Šæ¬¡æ‰§è¡Œæ—¶é—´</span>
                            <span id="autoTradeLastTimeTop" style="color: #6b7280; font-size: 11px;">--</span>
                        </div>
                    </div>
                    
                    <div style="padding: 8px; background: rgba(245, 158, 11, 0.05); border-radius: 6px; margin-top: 8px; text-align: center;">
                        <span style="color: #92400e; font-size: 10px;">ğŸ“š è¯¦ç»†è¯´æ˜è¯·æŸ¥çœ‹é¡µé¢é¡¶éƒ¨"ç³»ç»Ÿæ¶æ„ä¸è¿è¡Œè¯´æ˜"</span>
                    </div>
                    
                </div>
                <!-- ğŸ“ˆ ä¸Šæ¶¨å æ¯”0ç­–ç•¥Aï¼ˆæ¶¨å¹…å‰8åå¤šå•ï¼‰ -->
                <div class="info-card" style="margin-top: 16px; background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%); border: 2px solid #3b82f6;">
                    <h3 style="color: #1e40af; margin-bottom: 12px; display: flex; align-items: center; gap: 6px;">
                        ğŸ“ˆ ä¸Šæ¶¨å æ¯”0-æ¶¨å¹…å‰8å
                    </h3>
                    
                    <!-- ç­–ç•¥å¼€å…³ -->
                    <div style="padding: 10px; background: rgba(59, 130, 246, 0.1); border-radius: 8px; border: 1px solid #3b82f6; margin-bottom: 10px;">
                        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px;">
                            <div style="display: flex; flex-direction: column; gap: 4px;">
                                <span style="color: #1e40af; font-weight: 600; font-size: 13px;">ğŸš€ å¯ç”¨è‡ªåŠ¨å¼€å•</span>
                                <span id="switchStatusUpRatio0Top8" style="color: #6b7280; font-size: 11px; font-weight: 600;">ğŸ”´ æœªå¼€å¯</span>
                            </div>
                            <label class="switch" style="position: relative; display: inline-block; width: 44px; height: 24px;">
                                <input type="checkbox" id="autoTradeSwitchUpRatio0Top8" style="opacity: 0; width: 0; height: 0;">
                                <span class="slider slider-autotrade-upratio0-top8" style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 24px;">
                                    <style>
                                        #autoTradeSwitchUpRatio0Top8:checked + .slider-autotrade-upratio0-top8 { background-color: #3b82f6; }
                                        #autoTradeSwitchUpRatio0Top8:checked + .slider-autotrade-upratio0-top8:before { transform: translateX(20px); }
                                        .slider-autotrade-upratio0-top8:before {
                                            position: absolute;
                                            content: "";
                                            height: 18px;
                                            width: 18px;
                                            left: 3px;
                                            bottom: 3px;
                                            background-color: white;
                                            transition: .4s;
                                            border-radius: 50%;
                                        }
                                    </style>
                                </span>
                            </label>
                        </div>
                        
                        <!-- åå°è®¾ç½®æ˜¾ç¤º -->
                        <div id="serverAutoTradeSettingsUpRatio0Top8" style="display: none; padding: 8px; background: rgba(59, 130, 246, 0.15); border-radius: 6px; margin-bottom: 8px; border: 1px solid #3b82f6;">
                            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 4px;">
                                <span style="color: #1e40af; font-size: 11px; font-weight: 600;">ğŸ“Œ ç­–ç•¥çŠ¶æ€</span>
                                <span id="serverAutoTradeStatusBadgeUpRatio0Top8" style="color: #10b981; font-size: 11px; font-weight: 600;">âœ… å·²å¯ç”¨</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- è§¦å‘æ¡ä»¶ -->
                    <div style="padding: 10px; background: rgba(59, 130, 246, 0.05); border-radius: 8px; margin-bottom: 10px;">
                        <div style="margin-bottom: 8px;">
                            <label style="color: #1e40af; font-weight: 600; font-size: 13px; display: block; margin-bottom: 8px;">
                                âš™ï¸ è§¦å‘æ¡ä»¶
                            </label>
                            
                            <!-- JSONLæ‰§è¡Œè®¸å¯çŠ¶æ€ - æ”¾åœ¨é¡¶éƒ¨ -->
                            <div style="padding: 10px; background: rgba(59, 130, 246, 0.1); border-radius: 6px; margin-bottom: 12px; border: 1px solid #3b82f6;">
                                <div style="display: flex; align-items: center; justify-content: space-between;">
                                    <span style="color: #1e40af; font-size: 11px; font-weight: 600;">ğŸ“„ JSONLæ‰§è¡Œè®¸å¯</span>
                                    <div style="display: flex; align-items: center; gap: 8px;">
                                        <span id="jsonlAllowedStatusUpRatio0Top8" style="color: #6b7280; font-size: 11px; font-weight: 600;">â³ æ£€æŸ¥ä¸­...</span>
                                        <button onclick="resetJsonlAllowedUpRatio0Top8()" style="padding: 2px 8px; background: #10b981; color: white; border: none; border-radius: 4px; font-size: 10px; cursor: pointer; font-weight: 600;">ğŸ”„ é‡ç½®</button>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- å½“å‰ä¸Šæ¶¨å æ¯” -->
                            <div style="padding: 12px; background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); border-radius: 8px; margin-bottom: 12px; border: 2px solid #f59e0b; box-shadow: 0 2px 8px rgba(245, 158, 11, 0.15);">
                                <div style="display: flex; align-items: center; justify-content: space-between;">
                                    <span style="color: #92400e; font-size: 12px; font-weight: 600;">ğŸ“Š å½“å‰ä¸Šæ¶¨å æ¯”</span>
                                    <span id="currentUpRatioTop8" style="color: #92400e; font-weight: 800; font-size: 18px; font-family: 'Courier New', monospace; text-shadow: 0 1px 2px rgba(0,0,0,0.1);">--</span>
                                </div>
                            </div>
                            <div style="padding: 10px; background: rgba(251, 191, 36, 0.1); border-radius: 6px; border-left: 3px solid #f59e0b;">
                                <p style="color: #92400e; font-size: 11px; margin: 0; line-height: 1.5;">
                                    ğŸ“Œ <strong>è§¦å‘æ¡ä»¶ï¼š</strong>ä¸Šæ¶¨å æ¯” = 0% ä¸” å½“å‰æ—¶é—´ä¸åœ¨ 0:00-0:30<br>
                                    ğŸ“Œ <strong>å¼€å•ç­–ç•¥ï¼š</strong>ä»å¸¸ç”¨å¸15ä¸ªä¸­å–æ¶¨å¹…å‰8å<br>
                                    ğŸ“Œ <strong>ä»“ä½è®¾ç½®ï¼š</strong>æ¯å¸1.5%å¯ç”¨ä½™é¢ï¼Œ10å€æ æ†ï¼Œå¤šå•<br>
                                    ğŸ“Œ <strong>æ’é™¤æ—¶æ®µï¼š</strong>æ¯å¤©0:00-0:30ä¸æ‰§è¡Œ
                                </p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- æ‰§è¡ŒçŠ¶æ€ -->
                    <div style="padding: 10px; background: rgba(59, 130, 246, 0.05); border-radius: 8px; margin-bottom: 10px;">
                        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 4px;">
                            <span style="color: #1e40af; font-size: 12px; font-weight: 600;">ç­–ç•¥çŠ¶æ€</span>
                            <span id="autoTradeStatusUpRatio0Top8" style="color: #6b7280; font-size: 12px; font-weight: 600;">æœªå¯ç”¨</span>
                        </div>
                        <div style="display: flex; align-items: center; justify-content: space-between;">
                            <span style="color: #1e40af; font-size: 12px;">ä¸Šæ¬¡æ‰§è¡Œæ—¶é—´</span>
                            <span id="autoTradeLastTimeUpRatio0Top8" style="color: #6b7280; font-size: 11px;">--</span>
                        </div>
                    </div>
                </div>

                <!-- ğŸ“‰ ä¸Šæ¶¨å æ¯”0ç­–ç•¥Bï¼ˆæ¶¨å¹…å8åå¤šå•ï¼‰ -->
                <div class="info-card" style="margin-top: 16px; background: linear-gradient(135deg, #fecaca 0%, #fca5a5 100%); border: 2px solid #ef4444;">
                    <h3 style="color: #991b1b; margin-bottom: 12px; display: flex; align-items: center; gap: 6px;">
                        ğŸ“‰ ä¸Šæ¶¨å æ¯”0-æ¶¨å¹…å8å
                    </h3>
                    
                    <!-- ç­–ç•¥å¼€å…³ -->
                    <div style="padding: 10px; background: rgba(239, 68, 68, 0.1); border-radius: 8px; border: 1px solid #ef4444; margin-bottom: 10px;">
                        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px;">
                            <div style="display: flex; flex-direction: column; gap: 4px;">
                                <span style="color: #991b1b; font-weight: 600; font-size: 13px;">ğŸš€ å¯ç”¨è‡ªåŠ¨å¼€å•</span>
                                <span id="switchStatusUpRatio0Bottom8" style="color: #6b7280; font-size: 11px; font-weight: 600;">ğŸ”´ æœªå¼€å¯</span>
                            </div>
                            <label class="switch" style="position: relative; display: inline-block; width: 44px; height: 24px;">
                                <input type="checkbox" id="autoTradeSwitchUpRatio0Bottom8" style="opacity: 0; width: 0; height: 0;">
                                <span class="slider slider-autotrade-upratio0-bottom8" style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 24px;">
                                    <style>
                                        #autoTradeSwitchUpRatio0Bottom8:checked + .slider-autotrade-upratio0-bottom8 { background-color: #ef4444; }
                                        #autoTradeSwitchUpRatio0Bottom8:checked + .slider-autotrade-upratio0-bottom8:before { transform: translateX(20px); }
                                        .slider-autotrade-upratio0-bottom8:before {
                                            position: absolute;
                                            content: "";
                                            height: 18px;
                                            width: 18px;
                                            left: 3px;
                                            bottom: 3px;
                                            background-color: white;
                                            transition: .4s;
                                            border-radius: 50%;
                                        }
                                    </style>
                                </span>
                            </label>
                        </div>
                        
                        <!-- åå°è®¾ç½®æ˜¾ç¤º -->
                        <div id="serverAutoTradeSettingsUpRatio0Bottom8" style="display: none; padding: 8px; background: rgba(239, 68, 68, 0.15); border-radius: 6px; margin-bottom: 8px; border: 1px solid #ef4444;">
                            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 4px;">
                                <span style="color: #991b1b; font-size: 11px; font-weight: 600;">ğŸ“Œ ç­–ç•¥çŠ¶æ€</span>
                                <span id="serverAutoTradeStatusBadgeUpRatio0Bottom8" style="color: #10b981; font-size: 11px; font-weight: 600;">âœ… å·²å¯ç”¨</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- è§¦å‘æ¡ä»¶ -->
                    <div style="padding: 10px; background: rgba(239, 68, 68, 0.05); border-radius: 8px; margin-bottom: 10px;">
                        <div style="margin-bottom: 8px;">
                            <label style="color: #991b1b; font-weight: 600; font-size: 13px; display: block; margin-bottom: 8px;">
                                âš™ï¸ è§¦å‘æ¡ä»¶
                            </label>
                            
                            <!-- JSONLæ‰§è¡Œè®¸å¯çŠ¶æ€ - æ”¾åœ¨é¡¶éƒ¨ -->
                            <div style="padding: 10px; background: rgba(239, 68, 68, 0.1); border-radius: 6px; margin-bottom: 12px; border: 1px solid #ef4444;">
                                <div style="display: flex; align-items: center; justify-content: space-between;">
                                    <span style="color: #991b1b; font-size: 11px; font-weight: 600;">ğŸ“„ JSONLæ‰§è¡Œè®¸å¯</span>
                                    <div style="display: flex; align-items: center; gap: 8px;">
                                        <span id="jsonlAllowedStatusUpRatio0Bottom8" style="color: #6b7280; font-size: 11px; font-weight: 600;">â³ æ£€æŸ¥ä¸­...</span>
                                        <button onclick="resetJsonlAllowedUpRatio0Bottom8()" style="padding: 2px 8px; background: #10b981; color: white; border: none; border-radius: 4px; font-size: 10px; cursor: pointer; font-weight: 600;">ğŸ”„ é‡ç½®</button>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- å½“å‰ä¸Šæ¶¨å æ¯” -->
                            <div style="padding: 12px; background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); border-radius: 8px; margin-bottom: 12px; border: 2px solid #f59e0b; box-shadow: 0 2px 8px rgba(245, 158, 11, 0.15);">
                                <div style="display: flex; align-items: center; justify-content: space-between;">
                                    <span style="color: #92400e; font-size: 12px; font-weight: 600;">ğŸ“Š å½“å‰ä¸Šæ¶¨å æ¯”</span>
                                    <span id="currentUpRatioBottom8" style="color: #92400e; font-weight: 800; font-size: 18px; font-family: 'Courier New', monospace; text-shadow: 0 1px 2px rgba(0,0,0,0.1);">--</span>
                                </div>
                            </div>
                            <div style="padding: 10px; background: rgba(251, 191, 36, 0.1); border-radius: 6px; border-left: 3px solid #f59e0b;">
                                <p style="color: #92400e; font-size: 11px; margin: 0; line-height: 1.5;">
                                    ğŸ“Œ <strong>è§¦å‘æ¡ä»¶ï¼š</strong>ä¸Šæ¶¨å æ¯” = 0% ä¸” å½“å‰æ—¶é—´ä¸åœ¨ 0:00-0:30<br>
                                    ğŸ“Œ <strong>å¼€å•ç­–ç•¥ï¼š</strong>ä»å¸¸ç”¨å¸15ä¸ªä¸­å–æ¶¨å¹…å8å<br>
                                    ğŸ“Œ <strong>ä»“ä½è®¾ç½®ï¼š</strong>æ¯å¸1.5%å¯ç”¨ä½™é¢ï¼Œ10å€æ æ†ï¼Œå¤šå•<br>
                                    ğŸ“Œ <strong>æ’é™¤æ—¶æ®µï¼š</strong>æ¯å¤©0:00-0:30ä¸æ‰§è¡Œ
                                </p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- æ‰§è¡ŒçŠ¶æ€ -->
                    <div style="padding: 10px; background: rgba(239, 68, 68, 0.05); border-radius: 8px; margin-bottom: 10px;">
                        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 4px;">
                            <span style="color: #991b1b; font-size: 12px; font-weight: 600;">ç­–ç•¥çŠ¶æ€</span>
                            <span id="autoTradeStatusUpRatio0Bottom8" style="color: #6b7280; font-size: 12px; font-weight: 600;">æœªå¯ç”¨</span>
                        </div>
                        <div style="display: flex; align-items: center; justify-content: space-between;">
                            <span style="color: #991b1b; font-size: 12px;">ä¸Šæ¬¡æ‰§è¡Œæ—¶é—´</span>
                            <span id="autoTradeLastTimeUpRatio0Bottom8" style="color: #6b7280; font-size: 11px;">--</span>
                        </div>
                    </div>
                </div>


                <!-- è´¦æˆ·ä»“ä½é™é¢ -->
                <div class="info-card" style="margin-top: 16px; background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); border: 2px solid #fbbf24;">
                    <h3 style="color: #78350f; margin-bottom: 12px;">ğŸ“Š è´¦æˆ·ä»“ä½é™é¢</h3>
                    <div class="info-row">
                        <span class="info-label" style="color: #78350f;">è´¦æˆ·åç§°</span>
                        <span class="info-value" style="color: #78350f; font-weight: bold;" id="accountName">ä¸»è´¦æˆ·</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label" style="color: #78350f;">å¼€å§‹æ—¥æœŸ</span>
                        <span class="info-value" style="color: #78350f;" id="accountStartDate">--</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label" style="color: #78350f;">å·²è¿è¡Œå¤©æ•°</span>
                        <span class="info-value" style="color: #78350f;" id="accountDaysPassed">-- å¤©</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label" style="color: #78350f;">å½“å‰æœ€å¤§ä»“ä½</span>
                        <span class="info-value" style="color: #059669; font-weight: bold; font-size: 16px;" id="accountMaxLimit">-- USDT</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label" style="color: #78350f;">ä¸‹æ¬¡å¢åŠ æ—¥æœŸ</span>
                        <span class="info-value" style="color: #78350f;" id="accountNextIncreaseDate">--</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label" style="color: #78350f;">è·ç¦»ä¸‹æ¬¡å¢åŠ </span>
                        <span class="info-value" style="color: #78350f;" id="accountDaysUntilIncrease">-- å¤©</span>
                    </div>
                    <div style="margin-top: 10px; padding: 8px; background: rgba(251, 191, 36, 0.2); border-radius: 6px; border-left: 3px solid #fbbf24;">
                        <p style="color: #78350f; font-size: 11px; margin: 0; line-height: 1.5;">
                            ğŸ’¡ <strong>è§„åˆ™è¯´æ˜ï¼š</strong>è´¦æˆ·ä»å¼€å§‹æ—¥æœŸè®¡ç®—ï¼Œåˆå§‹é™é¢300 USDTï¼Œæ¯æ»¡30å¤©è‡ªåŠ¨å¢åŠ 300 USDTä»“ä½ä¸Šé™ã€‚æ­¤é™é¢ä¸ºç¡¬ç¼–ç è§„åˆ™ï¼Œä¸å¯ä¿®æ”¹ã€‚
                        </p>
                    </div>
                </div>

                <!-- æ¶¨è·Œé¢„è­¦è®¾ç½® -->
                <div class="info-card" style="margin-top: 16px; background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%); border: 2px solid #ef4444;">
                    <h3 style="color: #991b1b; margin-bottom: 12px; display: flex; align-items: center; gap: 6px;">
                        ğŸ”” æ¶¨è·Œé¢„è­¦
                        <button onclick="window.open('/coin-change-tracker', '_blank')" style="margin-left: auto; padding: 4px 10px; font-size: 11px; background: #3b82f6; color: white; border: none; border-radius: 6px; cursor: pointer;" title="æ‰“å¼€è¯¦ç»†é¡µé¢">
                            ğŸ“Š è¯¦æƒ…
                        </button>
                    </h3>


                    
                    <!-- å½“å‰æ¶¨è·Œå¹… -->
                    <div class="info-row" style="margin-bottom: 12px; padding: 10px; background: rgba(255,255,255,0.5); border-radius: 6px;">
                        <span class="info-label" style="color: #991b1b;">27å¸æ€»æ¶¨è·Œå¹…</span>
                        <span class="info-value" style="font-weight: bold; font-size: 18px;" id="totalChangePercent">--</span>
                    </div>
                    
                    <!-- ä¸Šæ¶¨é¢„è­¦ -->
                    <div style="padding: 10px; background: rgba(34, 197, 94, 0.1); border-radius: 8px; border: 1px solid #22c55e; margin-bottom: 10px;">
                        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px;">
                            <span style="color: #166534; font-weight: 600; font-size: 13px;">ğŸ“ˆ ä¸Šæ¶¨é¢„è­¦</span>
                            <label class="switch" style="position: relative; display: inline-block; width: 44px; height: 24px;">
                                <input type="checkbox" id="upperAlertSwitch" style="opacity: 0; width: 0; height: 0;">
                                <span class="slider" style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 24px;"></span>
                            </label>
                        </div>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <input type="number" id="upperThreshold" value="30" step="0.1" min="0" max="100" 
                                   style="flex: 1; padding: 6px 10px; border: 1px solid #22c55e; border-radius: 6px; font-size: 13px;">
                            <span style="color: #166534; font-size: 13px; font-weight: 600;">%</span>
                        </div>
                        <div style="font-size: 11px; color: #166534; margin-top: 6px;">
                            æ¶¨å¹…è¶…è¿‡æ­¤å€¼æ—¶è§¦å‘
                        </div>
                    </div>
                    
                    <!-- ä¸‹è·Œé¢„è­¦ -->
                    <div style="padding: 10px; background: rgba(239, 68, 68, 0.1); border-radius: 8px; border: 1px solid #ef4444; margin-bottom: 10px;">
                        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px;">
                            <span style="color: #991b1b; font-weight: 600; font-size: 13px;">ğŸ“‰ ä¸‹è·Œé¢„è­¦</span>
                            <label class="switch" style="position: relative; display: inline-block; width: 44px; height: 24px;">
                                <input type="checkbox" id="lowerAlertSwitch" style="opacity: 0; width: 0; height: 0;">
                                <span class="slider" style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 24px;"></span>
                            </label>
                        </div>
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <input type="number" id="lowerThreshold" value="-40" step="0.1" max="0" min="-100" 
                                   style="flex: 1; padding: 6px 10px; border: 1px solid #ef4444; border-radius: 6px; font-size: 13px;">
                            <span style="color: #991b1b; font-size: 13px; font-weight: 600;">%</span>
                        </div>
                        <div style="font-size: 11px; color: #991b1b; margin-top: 6px;">
                            è·Œå¹…å°äºæ­¤å€¼æ—¶è§¦å‘
                        </div>
                    </div>
                    
                    <!-- ä¿å­˜æŒ‰é’® -->
                    <button onclick="saveAlertSettingsOKX()" style="width: 100%; padding: 10px; background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white; border: none; border-radius: 8px; font-weight: 600; font-size: 13px; cursor: pointer; box-shadow: 0 2px 8px rgba(16, 185, 129, 0.3);">
                        ğŸ’¾ ä¿å­˜é¢„è­¦è®¾ç½®
                    </button>
                    
                    <!-- æç¤º -->
                    <div style="margin-top: 10px; padding: 8px; background: rgba(239, 68, 68, 0.1); border-radius: 6px; border-left: 3px solid #ef4444;">
                        <p style="color: #991b1b; font-size: 10px; margin: 0; line-height: 1.4;">
                            ğŸ’¡ è§¦å‘åå°†æ’­æ”¾éŸ³æ•ˆã€æ˜¾ç¤ºå¼¹çª—ï¼Œå¹¶è‡ªåŠ¨å…³é—­å¼€å…³ã€‚éœ€è¦é‡æ–°å¼€å¯æ‰èƒ½å†æ¬¡è§¦å‘ã€‚
                        </p>
                    </div>
                </div>
                <div class="info-card">
                    <h3 style="margin-bottom: 12px;">
                        ğŸ“Š æŒä»“ 
                        <span id="positionsCount" style="color: #888; font-size: 14px; font-weight: normal;">(0)</span>
                        <button onclick="loadPositions()" style="float: right; padding: 4px 12px; font-size: 12px; background: #3b82f6; color: white; border: none; border-radius: 6px; cursor: pointer;" title="åˆ·æ–°æŒä»“">
                            ğŸ”„ åˆ·æ–°
                        </button>
                    </h3>
                    
                    <!-- æ‰¹é‡å¹³ä»“æŒ‰é’®ç»„ -->
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px; margin-bottom: 16px;">
                        <button onclick="batchClosePositions('long', 0.5)" class="batch-close-btn batch-close-long-half" data-strategy-code="CLOSE_LONG_HALF">
                            ğŸ“‰ å¹³ä¸€åŠå¤šå• <span style="font-size: 9px; opacity: 0.7;">[CLOSE_LONG_HALF]</span>
                        </button>
                        <button onclick="batchClosePositions('short', 0.5)" class="batch-close-btn batch-close-short-half" data-strategy-code="CLOSE_SHORT_HALF">
                            ğŸ“ˆ å¹³ä¸€åŠç©ºå• <span style="font-size: 9px; opacity: 0.7;">[CLOSE_SHORT_HALF]</span>
                        </button>
                        <button onclick="batchClosePositions('long', 1)" class="batch-close-btn batch-close-long-all" data-strategy-code="CLOSE_LONG_ALL">
                            ğŸš« å¹³å…¨éƒ¨å¤šå• <span style="font-size: 9px; opacity: 0.7;">[CLOSE_LONG_ALL]</span>
                        </button>
                        <button onclick="batchClosePositions('short', 1)" class="batch-close-btn batch-close-short-all" data-strategy-code="CLOSE_SHORT_ALL">
                            â›” å¹³å…¨éƒ¨ç©ºå• <span style="font-size: 9px; opacity: 0.7;">[CLOSE_SHORT_ALL]</span>
                        </button>
                    </div>
                    
                    <div id="positionsList" class="no-positions">
                        æš‚æ— æŒä»“
                    </div>
                </div>

                <!-- å½“å‰å§”æ‰˜åˆ—è¡¨ -->
                <div class="info-card" style="margin-top: 24px;">
                    <h3>
                        ğŸ“‹ å½“å‰å§”æ‰˜ 
                        <span id="pendingOrdersCount" style="color: #888; font-size: 14px; font-weight: normal;">(0)</span>
                        <button onclick="loadPendingOrders()" style="float: right; padding: 4px 12px; font-size: 12px; background: #3b82f6; color: white; border: none; border-radius: 6px; cursor: pointer;" title="åˆ·æ–°å§”æ‰˜">
                            ğŸ”„ åˆ·æ–°
                        </button>
                    </h3>
                    <div id="pendingOrdersList" class="no-positions">
                        æš‚æ— å§”æ‰˜
                    </div>
                </div>
                
                <!-- äº¤æ˜“æ—¥å¿— -->
                <div class="info-card" style="margin-top: 24px;">
                    <h3>
                        ğŸ“œ äº¤æ˜“æ—¥å¿— 
                        <span id="logsCount" style="color: #888; font-size: 14px; font-weight: normal;">(0)</span>
                        <button onclick="loadTradingLogs()" style="float: right; padding: 4px 12px; font-size: 12px; background: #3b82f6; color: white; border: none; border-radius: 6px; cursor: pointer;" title="åˆ·æ–°æ—¥å¿—">
                            ğŸ”„ åˆ·æ–°
                        </button>
                    </h3>
                    <div style="margin-bottom: 12px; font-size: 12px; color: #64748b;">
                        ğŸ“ æ‰€æœ‰æ“ä½œå‡è‡ªåŠ¨è®°å½•ï¼Œä¸å¯ä¿®æ”¹ | æ•°æ®ä¿å­˜æ ¼å¼: JSONL
                    </div>
                    <div id="tradingLogsList" style="max-height: 400px; overflow-y: auto;">
                        <div style="text-align: center; padding: 20px; color: #94a3b8;">
                            æš‚æ— æ—¥å¿—
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ç¡®è®¤å¯¹è¯æ¡†
        let confirmDialogResolve = null;
        let confirmDialogTimer = null;
        let confirmDialogCountdown = null;

        function showConfirmDialog(message, title = 'âš ï¸ ç¡®è®¤æ“ä½œ') {
            return new Promise((resolve) => {
                // ğŸ†• å¦‚æœæœ‰æ—§çš„confirmå¼¹çª—ï¼Œå…ˆå…³é—­å®ƒï¼ˆé»˜è®¤å–æ¶ˆï¼‰
                if (confirmDialogResolve) {
                    closeConfirmDialog(false);
                }
                
                // ğŸ†• å¦‚æœæœ‰æ—§çš„alertå¼¹çª—ï¼Œä¹Ÿå…ˆå…³é—­å®ƒ
                if (customAlertResolve) {
                    closeCustomAlert();
                }
                
                confirmDialogResolve = resolve;
                document.getElementById('confirmDialogTitle').textContent = title;
                document.getElementById('confirmDialogMessage').textContent = message;
                document.getElementById('confirmDialog').classList.add('active');
                
                // å¼€å§‹10ç§’å€’è®¡æ—¶
                let secondsLeft = 10;
                const timerElement = document.getElementById('confirmDialogTimer');
                timerElement.textContent = `(${secondsLeft}ç§’åè‡ªåŠ¨å…³é—­)`;
                
                // æ¸…é™¤ä¹‹å‰çš„å®šæ—¶å™¨
                if (confirmDialogTimer) clearTimeout(confirmDialogTimer);
                if (confirmDialogCountdown) clearInterval(confirmDialogCountdown);
                
                // å€’è®¡æ—¶æ›´æ–°
                confirmDialogCountdown = setInterval(() => {
                    secondsLeft--;
                    if (secondsLeft > 0) {
                        timerElement.textContent = `(${secondsLeft}ç§’åè‡ªåŠ¨å…³é—­)`;
                    } else {
                        clearInterval(confirmDialogCountdown);
                        timerElement.textContent = '';
                    }
                }, 1000);
                
                // 10ç§’åè‡ªåŠ¨å…³é—­ï¼ˆå–æ¶ˆæ“ä½œï¼‰
                confirmDialogTimer = setTimeout(() => {
                    clearInterval(confirmDialogCountdown);
                    closeConfirmDialog(false);
                }, 10000);
            });
        }

        function closeConfirmDialog(result) {
            document.getElementById('confirmDialog').classList.remove('active');
            document.getElementById('confirmDialogTimer').textContent = '';
            
            // æ¸…é™¤å®šæ—¶å™¨
            if (confirmDialogTimer) {
                clearTimeout(confirmDialogTimer);
                confirmDialogTimer = null;
            }
            if (confirmDialogCountdown) {
                clearInterval(confirmDialogCountdown);
                confirmDialogCountdown = null;
            }
            
            if (confirmDialogResolve) {
                confirmDialogResolve(result);
                confirmDialogResolve = null;
            }
        }

        // è‡ªå®šä¹‰Alertå‡½æ•°
        let customAlertResolve = null;
        let customAlertTimer = null;
        let customAlertCountdown = null;

        function customAlert(message, title = 'ğŸ’¬ æç¤º') {
            return new Promise((resolve) => {
                // ğŸ†• å¦‚æœæœ‰æ—§çš„alertå¼¹çª—ï¼Œå…ˆå…³é—­å®ƒ
                if (customAlertResolve) {
                    closeCustomAlert();
                }
                
                // ğŸ†• å¦‚æœæœ‰æ—§çš„confirmå¼¹çª—ï¼Œä¹Ÿå…ˆå…³é—­å®ƒï¼ˆé»˜è®¤å–æ¶ˆï¼‰
                if (confirmDialogResolve) {
                    closeConfirmDialog(false);
                }
                
                customAlertResolve = resolve;
                document.getElementById('customAlertTitle').textContent = title;
                document.getElementById('customAlertMessage').textContent = message;
                document.getElementById('customAlertDialog').classList.add('active');
                
                // å¼€å§‹10ç§’å€’è®¡æ—¶
                let secondsLeft = 10;
                const timerElement = document.getElementById('customAlertTimer');
                timerElement.textContent = `(${secondsLeft}ç§’åè‡ªåŠ¨å…³é—­)`;
                
                // æ¸…é™¤ä¹‹å‰çš„å®šæ—¶å™¨
                if (customAlertTimer) clearTimeout(customAlertTimer);
                if (customAlertCountdown) clearInterval(customAlertCountdown);
                
                // å€’è®¡æ—¶æ›´æ–°
                customAlertCountdown = setInterval(() => {
                    secondsLeft--;
                    if (secondsLeft > 0) {
                        timerElement.textContent = `(${secondsLeft}ç§’åè‡ªåŠ¨å…³é—­)`;
                    } else {
                        clearInterval(customAlertCountdown);
                        timerElement.textContent = '';
                    }
                }, 1000);
                
                // 10ç§’åè‡ªåŠ¨å…³é—­
                customAlertTimer = setTimeout(() => {
                    clearInterval(customAlertCountdown);
                    closeCustomAlert();
                }, 10000);
            });
        }

        function closeCustomAlert() {
            document.getElementById('customAlertDialog').classList.remove('active');
            document.getElementById('customAlertTimer').textContent = '';
            
            // æ¸…é™¤å®šæ—¶å™¨
            if (customAlertTimer) {
                clearTimeout(customAlertTimer);
                customAlertTimer = null;
            }
            if (customAlertCountdown) {
                clearInterval(customAlertCountdown);
                customAlertCountdown = null;
            }
            
            if (customAlertResolve) {
                customAlertResolve(true);
                customAlertResolve = null;
            }
        }

        // é‡å†™å…¨å±€alertå‡½æ•°
        const originalAlert = window.alert;
        window.alert = function(message) {
            return customAlert(message);
        };

        // å½“å‰äº¤æ˜“æ–¹å‘
        let currentDirection = 'long';
        let currentLeverage = 10;
        let currentSymbol = 'BTC-USDT-SWAP';

        // å½“å‰è´¦æˆ·
        let currentAccount = 'account_poit_main';
        let isLoadingAccountSettings = false;  // é˜²æ­¢åŠ è½½è®¾ç½®æ—¶è§¦å‘ä¿å­˜
        
        // APIè¯·æ±‚è¶…æ—¶æ§åˆ¶
        async function fetchWithTimeout(url, options = {}, timeout = 5000) {
            const controller = new AbortController();
            const id = setTimeout(() => controller.abort(), timeout);
            
            try {
                const response = await fetch(url, {
                    ...options,
                    signal: controller.signal
                });
                clearTimeout(id);
                return response;
            } catch (error) {
                clearTimeout(id);
                if (error.name === 'AbortError') {
                    console.warn(`[fetchWithTimeout] è¯·æ±‚è¶…æ—¶: ${url}`);
                    throw new Error('è¯·æ±‚è¶…æ—¶');
                }
                throw error;
            }
        }
        
        // æ”¶è—çš„äº¤æ˜“å¯¹ï¼ˆä»æœåŠ¡å™¨APIè¯»å–ï¼Œå…¨å±€å…±äº«ï¼‰
        let favoriteSymbols = [];
        
        // ä»æœåŠ¡å™¨åŠ è½½å¸¸ç”¨å¸åˆ—è¡¨
        async function loadFavoriteSymbols() {
            try {
                const response = await fetchWithTimeout('/api/okx-trading/favorite-symbols', {}, 3000);
                const data = await response.json();
                
                if (data.success) {
                    favoriteSymbols = data.symbols || [];
                    console.log('âœ… å·²åŠ è½½å¸¸ç”¨å¸åˆ—è¡¨ (å…±' + favoriteSymbols.length + 'ä¸ª)');
                } else {
                    console.error('âŒ åŠ è½½å¸¸ç”¨å¸å¤±è´¥:', data.error);
                    // ä½¿ç”¨é»˜è®¤åˆ—è¡¨ï¼ˆç”¨æˆ·é…ç½®çš„15ä¸ªå¸ï¼‰
                    favoriteSymbols = [
                        "SOL-USDT-SWAP", "XRP-USDT-SWAP", "TAO-USDT-SWAP",
                        "LDO-USDT-SWAP", "CFX-USDT-SWAP", "CRV-USDT-SWAP",
                        "UNI-USDT-SWAP", "CRO-USDT-SWAP", "FIL-USDT-SWAP",
                        "APT-USDT-SWAP", "SUI-USDT-SWAP", "NEAR-USDT-SWAP",
                        "DOT-USDT-SWAP", "LINK-USDT-SWAP", "STX-USDT-SWAP"
                    ];
                }
            } catch (error) {
                console.error('âŒ åŠ è½½å¸¸ç”¨å¸å¼‚å¸¸:', error.message);
                // ä½¿ç”¨é»˜è®¤åˆ—è¡¨ï¼ˆç”¨æˆ·é…ç½®çš„15ä¸ªå¸ï¼‰
                favoriteSymbols = [
                    "SOL-USDT-SWAP", "XRP-USDT-SWAP", "TAO-USDT-SWAP",
                    "LDO-USDT-SWAP", "CFX-USDT-SWAP", "CRV-USDT-SWAP",
                    "UNI-USDT-SWAP", "CRO-USDT-SWAP", "FIL-USDT-SWAP",
                    "APT-USDT-SWAP", "SUI-USDT-SWAP", "NEAR-USDT-SWAP",
                    "DOT-USDT-SWAP", "LINK-USDT-SWAP", "STX-USDT-SWAP"
                ];
            }
        }
        
        // ä¿å­˜å¸¸ç”¨å¸åˆ—è¡¨åˆ°æœåŠ¡å™¨
        async function saveFavoriteSymbols() {
            try {
                const response = await fetch('/api/okx-trading/favorite-symbols', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ symbols: favoriteSymbols })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    console.log('âœ… å¸¸ç”¨å¸åˆ—è¡¨å·²ä¿å­˜åˆ°æœåŠ¡å™¨');
                } else {
                    console.error('âŒ ä¿å­˜å¸¸ç”¨å¸å¤±è´¥:', data.error);
                }
            } catch (error) {
                console.error('âŒ ä¿å­˜å¸¸ç”¨å¸å¼‚å¸¸:', error);
            }
        }
        
        // ä»localStorageåŠ è½½è´¦æˆ·åˆ—è¡¨ï¼Œå¦‚æœæ²¡æœ‰åˆ™ä½¿ç”¨é»˜è®¤è´¦æˆ·
        let accounts = JSON.parse(localStorage.getItem('okx_accounts') || JSON.stringify([
            { 
                id: 'account_main', 
                name: 'ä¸»è´¦æˆ·', 
                apiKey: 'b0c18f2d-e014-4ae8-9c3c-cb02161de4db',
                apiSecret: '92F864C599B2CE2EC5186AD14C8B4110',
                passphrase: 'Tencent@123',
                balance: 0 
            },
            { 
                id: 'account_fangfang12', 
                name: 'Fangfang12', 
                apiKey: 'e5867a9a-93b7-476f-81ce-093c3aacae0d',
                apiSecret: '4624EE63A9BF3F84250AC71C9A37F47D',
                passphrase: 'Tencent@123',
                balance: 0 
            },
            { 
                id: 'account_anchor', 
                name: 'é”šç‚¹è´¦å·', 
                apiKey: '0b05a729-40eb-4809-b3eb-eb2de75b7e9e',
                apiSecret: '4E4DA8BE3B18D01AA07185A006BF9F8E',
                passphrase: 'Tencent@123',
                balance: 0 
            },
            { 
                id: 'account_poit', 
                name: 'POIT', 
                apiKey: '8650e46c-059b-431d-93cf-55f8c79babdb',
                apiSecret: '4C2BD2AC6A08615EA7F36A6251857FCE',
                passphrase: 'Wu666666.',
                balance: 0 
            }
        ]));

        // äº¤æ˜“å¯¹æ•°æ®ï¼ˆåˆå§‹åŒ–ä¸ºç©ºï¼Œä»APIåŠ è½½ï¼‰
        let symbols = [];

        // åŠ è½½å®æ—¶è¡Œæƒ…æ•°æ®
        async function loadMarketTickers() {
            try {
                console.log('[loadMarketTickers] å¼€å§‹åŠ è½½è¡Œæƒ…æ•°æ®...');
                const response = await fetch('/api/okx-trading/market-tickers');
                const result = await response.json();
                
                if (result.success && result.data) {
                    symbols = result.data.map(ticker => ({
                        symbol: ticker.symbol,
                        name: ticker.name,
                        price: ticker.price,
                        change: ticker.change24h  // 24hæ¶¨è·Œå¹…
                    }));
                    console.log(`[loadMarketTickers] åŠ è½½æˆåŠŸï¼Œå…±${symbols.length}ä¸ªäº¤æ˜“å¯¹`);
                    
                    // é‡æ–°æ¸²æŸ“äº¤æ˜“å¯¹åˆ—è¡¨
                    renderSymbolsList();
                } else {
                    console.error('[loadMarketTickers] åŠ è½½å¤±è´¥:', result.error);
                    // ä½¿ç”¨é»˜è®¤æ•°æ®
                    symbols = [
                        { symbol: 'BTC-USDT-SWAP', name: 'BTC', price: 0, change: 0 },
                        { symbol: 'ETH-USDT-SWAP', name: 'ETH', price: 0, change: 0 }
                    ];
                    renderSymbolsList();
                }
            } catch (error) {
                console.error('[loadMarketTickers] åŠ è½½å¼‚å¸¸:', error);
                // ä½¿ç”¨é»˜è®¤æ•°æ®
                symbols = [
                    { symbol: 'BTC-USDT-SWAP', name: 'BTC', price: 0, change: 0 },
                    { symbol: 'ETH-USDT-SWAP', name: 'ETH', price: 0, change: 0 }
                ];
                renderSymbolsList();
            }
        }

        // åŠ è½½è´¦æˆ·ä¿¡æ¯
        async function loadAccountInfo() {
            const account = accounts.find(acc => acc.id === currentAccount);
            if (!account || !account.apiKey || !account.apiSecret || !account.passphrase) {
                // æ²¡æœ‰APIå‡­è¯ï¼Œæ˜¾ç¤ºé»˜è®¤å€¼å’Œæç¤º
                document.getElementById('totalEquity').textContent = 'æœªé…ç½®';
                document.getElementById('availableBalance').textContent = 'æœªé…ç½®';
                document.getElementById('usedMargin').textContent = 'æœªé…ç½®';
                document.getElementById('unrealizedPnl').textContent = 'æœªé…ç½®';
                document.getElementById('frozenBalance').textContent = 'æœªé…ç½®';
                
                // æ˜¾ç¤ºé…ç½®æç¤º
                showApiConfigNotice();
                return;
            }
            
            // éšè—é…ç½®æç¤º
            hideApiConfigNotice();

            try {
                const response = await fetch('/api/okx-trading/account-info', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        apiKey: account.apiKey,
                        apiSecret: account.apiSecret,
                        passphrase: account.passphrase
                    })
                });

                const result = await response.json();

                if (result.success && result.data) {
                    const data = result.data;
                    document.getElementById('totalEquity').textContent = data.totalEquity.toFixed(2) + ' USDT';
                    document.getElementById('availableBalance').textContent = data.availableBalance.toFixed(2) + ' USDT';
                    document.getElementById('usedMargin').textContent = data.usedMargin.toFixed(2) + ' USDT';
                    
                    // æ›´æ–°è´¦æˆ·å¯¹è±¡ä¸­çš„ä½™é¢ï¼ˆä½¿ç”¨å¯ç”¨ä½™é¢ï¼‰
                    account.balance = data.availableBalance;
                    localStorage.setItem('okx_accounts', JSON.stringify(accounts));
                    
                    // åŒæ—¶æ›´æ–°è®¢å•è¡¨å•ä¸­çš„å¯ç”¨ä½™é¢
                    const orderBalanceEl = document.getElementById('orderAvailableBalance');
                    if (orderBalanceEl) {
                        orderBalanceEl.textContent = data.availableBalance.toFixed(2) + ' USDT';
                    }
                    
                    // æ›´æ–°è´¦æˆ·æ ‡ç­¾å¤„çš„ä½™é¢
                    const accountBalanceEl = document.getElementById('accountBalance');
                    if (accountBalanceEl) {
                        accountBalanceEl.textContent = data.availableBalance.toFixed(2) + ' USDT';
                    }
                    
                    // æœªå®ç°ç›ˆäºå¸¦é¢œè‰²
                    const uplElement = document.getElementById('unrealizedPnl');
                    const upl = data.unrealizedPnl;
                    uplElement.textContent = (upl >= 0 ? '+' : '') + upl.toFixed(2) + ' USDT';
                    uplElement.style.color = upl >= 0 ? '#10b981' : '#ef4444';
                    
                    // æ›´æ–°æ­¢ç›ˆæ­¢æŸæ¨¡å—çš„å½“å‰æœªå®ç°ç›ˆäºæ˜¾ç¤º
                    const currentUplElement = document.getElementById('currentUnrealizedPnl');
                    if (currentUplElement) {
                        currentUplElement.textContent = (upl >= 0 ? '+' : '') + upl.toFixed(2) + ' USDT';
                        currentUplElement.style.color = upl >= 0 ? '#10b981' : '#ef4444';
                    }
                    
                    // æ£€æŸ¥æ­¢ç›ˆæ­¢æŸè§¦å‘
                    checkTakeProfitStopLoss(upl);
                    
                    document.getElementById('frozenBalance').textContent = data.frozenBalance.toFixed(2) + ' USDT';
                } else {
                    console.error('è·å–è´¦æˆ·ä¿¡æ¯å¤±è´¥:', result.error);
                }
            } catch (error) {
                console.error('åŠ è½½è´¦æˆ·ä¿¡æ¯å¼‚å¸¸:', error);
            }
        }

        // åŠ è½½æŒä»“åˆ—è¡¨
        async function loadPositions() {
            console.log('[loadPositions] å¼€å§‹åŠ è½½æŒä»“...');
            console.log('[loadPositions] currentAccount:', currentAccount);
            console.log('[loadPositions] accounts:', accounts);
            
            const account = accounts.find(acc => acc.id === currentAccount);
            console.log('[loadPositions] æ‰¾åˆ°çš„è´¦æˆ·:', account);
            
            if (!account) {
                console.error('[loadPositions] è´¦æˆ·ä¸å­˜åœ¨');
                document.getElementById('positionsList').innerHTML = '<div class="no-positions">è´¦æˆ·ä¸å­˜åœ¨</div>';
                document.getElementById('positionsCount').textContent = '(0)';
                return;
            }
            
            console.log('[loadPositions] APIå‡­è¯æ£€æŸ¥:', {
                hasApiKey: !!account.apiKey,
                hasApiSecret: !!account.apiSecret,
                hasPassphrase: !!account.passphrase
            });
            
            if (!account.apiKey || !account.apiSecret || !account.passphrase) {
                console.log('[loadPositions] æœªé…ç½®APIå‡­è¯');
                document.getElementById('positionsList').innerHTML = '<div class="no-positions">è¯·å…ˆé…ç½®è´¦æˆ·APIå‡­è¯</div>';
                document.getElementById('positionsCount').textContent = '(0)';
                return;
            }

            try {
                console.log('[loadPositions] è°ƒç”¨API...');
                const response = await fetch('/api/okx-trading/positions', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        apiKey: account.apiKey,
                        apiSecret: account.apiSecret,
                        passphrase: account.passphrase
                    })
                });

                const result = await response.json();
                console.log('[loadPositions] APIå“åº”:', result);

                if (result.success && result.data) {
                    const positions = result.data;
                    const positionsCount = positions.length;
                    
                    console.log('[loadPositions] æŒä»“æ•°é‡:', positionsCount);
                    console.log('[loadPositions] æŒä»“æ•°æ®:', positions);
                    
                    document.getElementById('positionsCount').textContent = `(${positionsCount})`;
                    
                    if (positionsCount === 0) {
                        document.getElementById('positionsList').innerHTML = '<div class="no-positions">æš‚æ— æŒä»“</div>';
                    } else {
                        // æ›´æ–°å·²ç”¨ä¿è¯é‡‘
                        if (result.summary) {
                            document.getElementById('usedMargin').textContent = result.summary.totalMargin.toFixed(2) + ' USDT';
                        }
                        
                        // æ¸²æŸ“æŒä»“åˆ—è¡¨
                        const html = positions.map(pos => {
                            const pnlColor = pos.unrealizedPnl >= 0 ? '#10b981' : '#ef4444';
                            const pnlSign = pos.unrealizedPnl >= 0 ? '+' : '';
                            const sideClass = pos.posSide === 'long' ? 'long' : 'short';
                            const sideName = pos.posSide === 'long' ? 'åšå¤š' : 'åšç©º';
                            
                            return `
                                <div class="position-item">
                                    <div class="position-header">
                                        <span class="position-symbol">${pos.instId}</span>
                                        <span class="position-side ${sideClass}">${sideName}</span>
                                        <button class="close-position-btn" onclick="closePosition('${pos.instId}', '${pos.posSide}')">
                                            å¹³ä»“
                                        </button>
                                    </div>
                                    <div class="position-details">
                                        <div class="position-detail-item">
                                            <span class="position-detail-label">æŒä»“é‡:</span>
                                            <span class="position-detail-value">${pos.posSize}</span>
                                        </div>
                                        <div class="position-detail-item">
                                            <span class="position-detail-label">æ æ†:</span>
                                            <span class="position-detail-value">${pos.leverage}x</span>
                                        </div>
                                        <div class="position-detail-item">
                                            <span class="position-detail-label">å¼€ä»“ä»·:</span>
                                            <span class="position-detail-value">$${pos.avgPrice.toFixed(2)}</span>
                                        </div>
                                        <div class="position-detail-item">
                                            <span class="position-detail-label">æ ‡è®°ä»·:</span>
                                            <span class="position-detail-value">$${pos.markPrice.toFixed(2)}</span>
                                        </div>
                                        <div class="position-detail-item">
                                            <span class="position-detail-label">ä¿è¯é‡‘:</span>
                                            <span class="position-detail-value">${pos.margin.toFixed(2)} USDT</span>
                                        </div>
                                    </div>
                                    <div class="position-pnl">
                                        <span>æœªå®ç°ç›ˆäº:</span>
                                        <span style="color: ${pnlColor};">
                                            ${pnlSign}${pos.unrealizedPnl.toFixed(2)} USDT 
                                            (${pnlSign}${pos.unrealizedPnlRatio.toFixed(2)}%)
                                        </span>
                                    </div>
                                </div>
                            `;
                        }).join('');
                        
                        document.getElementById('positionsList').innerHTML = html;
                    }
                } else {
                    console.error('[loadPositions] è·å–æŒä»“å¤±è´¥:', result.error);
                    console.error('[loadPositions] å®Œæ•´å“åº”:', result);
                    document.getElementById('positionsList').innerHTML = '<div class="no-positions">åŠ è½½å¤±è´¥: ' + (result.error || 'æœªçŸ¥é”™è¯¯') + '</div>';
                }
            } catch (error) {
                console.error('[loadPositions] åŠ è½½æŒä»“å¼‚å¸¸:', error);
                document.getElementById('positionsList').innerHTML = '<div class="no-positions">åŠ è½½å¼‚å¸¸</div>';
            }
        }

        // æ­¢ç›ˆæ­¢æŸçŠ¶æ€ï¼ˆé˜²æ­¢é‡å¤è§¦å‘ï¼‰
        let takeProfitTriggered = false;
        let stopLossTriggered = false;
        let lastTakeProfitTime = 0;
        let lastStopLossTime = 0;
        const ALERT_COOLDOWN = 5 * 60 * 1000; // 5åˆ†é’Ÿå†·å´æ—¶é—´

        // æ£€æŸ¥æ­¢ç›ˆæ­¢æŸ
        function checkTakeProfitStopLoss(unrealizedPnl) {
            const now = Date.now();
            
            // æ£€æŸ¥æ­¢ç›ˆ
            const takeProfitSwitch = document.getElementById('takeProfitSwitch');
            const takeProfitThreshold = parseFloat(document.getElementById('takeProfitThreshold').value);
            
            if (takeProfitSwitch && takeProfitSwitch.checked && !isNaN(takeProfitThreshold)) {
                if (unrealizedPnl >= takeProfitThreshold && now - lastTakeProfitTime > ALERT_COOLDOWN) {
                    lastTakeProfitTime = now;
                    showTakeProfitAlert(unrealizedPnl, takeProfitThreshold);
                    playAlertSound();
                }
            }
            
            // æ£€æŸ¥æ­¢æŸ
            const stopLossSwitch = document.getElementById('stopLossSwitch');
            const stopLossThreshold = parseFloat(document.getElementById('stopLossThreshold').value);
            
            if (stopLossSwitch && stopLossSwitch.checked && !isNaN(stopLossThreshold)) {
                // æ­¢æŸé˜ˆå€¼åº”è¯¥æ˜¯è´Ÿæ•°ï¼Œæœªå®ç°ç›ˆäºä¹Ÿæ˜¯è´Ÿæ•°ï¼Œå½“äºæŸè¾¾åˆ°æˆ–è¶…è¿‡é˜ˆå€¼æ—¶è§¦å‘
                if (unrealizedPnl <= stopLossThreshold && now - lastStopLossTime > ALERT_COOLDOWN) {
                    lastStopLossTime = now;
                    showStopLossAlert(unrealizedPnl, stopLossThreshold);
                    playAlertSound();
                }
            }
        }

        // æ˜¾ç¤ºæ­¢ç›ˆè­¦æŠ¥
        async function showTakeProfitAlert(currentPnl, threshold) {
            // è‡ªåŠ¨å…³é—­æ­¢ç›ˆå¼€å…³
            const takeProfitSwitch = document.getElementById('takeProfitSwitch');
            if (takeProfitSwitch) {
                takeProfitSwitch.checked = false;
                
                // é™é»˜ä¿å­˜è®¾ç½®åˆ°æœåŠ¡å™¨ï¼ˆä¸æ˜¾ç¤ºæç¤ºï¼‰
                await saveTakeProfitStopLossSettings(true);
                
                console.log('[æ­¢ç›ˆè­¦æŠ¥] æ­¢ç›ˆå·²è§¦å‘å¹¶è‡ªåŠ¨å…³é—­ï¼Œä¸‹æ¬¡éœ€è¦æ‰‹åŠ¨å¼€å¯');
            }
            
            // ç›´æ¥æ‰§è¡Œä¸€é”®å¹³ä»“ï¼Œä¸å†è¯¢é—®
            console.log('[æ­¢ç›ˆè­¦æŠ¥] è‡ªåŠ¨è§¦å‘ä¸€é”®å¹³ä»“');
            await closeAllPositions();
            
            // å‘é€æµè§ˆå™¨é€šçŸ¥ï¼ˆå¦‚æœç”¨æˆ·å…è®¸ï¼‰
            if ('Notification' in window && Notification.permission === 'granted') {
                new Notification('ğŸ‰ æ­¢ç›ˆè­¦æŠ¥', {
                    body: `å½“å‰ç›ˆåˆ©ï¼š+${currentPnl.toFixed(2)} USDTï¼Œå·²è¾¾æ­¢ç›ˆç›®æ ‡ï¼å·²è‡ªåŠ¨æ‰§è¡Œä¸€é”®å¹³ä»“ã€‚`,
                    icon: '/static/favicon.ico',
                    requireInteraction: true
                });
            }
        }

        // æ˜¾ç¤ºæ­¢æŸè­¦æŠ¥
        async function showStopLossAlert(currentPnl, threshold) {
            // è‡ªåŠ¨å…³é—­æ­¢æŸå¼€å…³
            const stopLossSwitch = document.getElementById('stopLossSwitch');
            if (stopLossSwitch) {
                stopLossSwitch.checked = false;
                
                // é™é»˜ä¿å­˜è®¾ç½®åˆ°æœåŠ¡å™¨ï¼ˆä¸æ˜¾ç¤ºæç¤ºï¼‰
                await saveTakeProfitStopLossSettings(true);
                
                console.log('[æ­¢æŸè­¦æŠ¥] æ­¢æŸå·²è§¦å‘å¹¶è‡ªåŠ¨å…³é—­ï¼Œä¸‹æ¬¡éœ€è¦æ‰‹åŠ¨å¼€å¯');
            }
            
            // ç›´æ¥æ‰§è¡Œä¸€é”®å¹³ä»“ï¼Œä¸å†è¯¢é—®
            console.log('[æ­¢æŸè­¦æŠ¥] è‡ªåŠ¨è§¦å‘ä¸€é”®å¹³ä»“');
            await closeAllPositions();
            
            // å‘é€æµè§ˆå™¨é€šçŸ¥ï¼ˆå¦‚æœç”¨æˆ·å…è®¸ï¼‰
            if ('Notification' in window && Notification.permission === 'granted') {
                new Notification('âš ï¸ æ­¢æŸè­¦æŠ¥', {
                    body: `å½“å‰äºæŸï¼š${currentPnl.toFixed(2)} USDTï¼Œå·²è¾¾æ­¢æŸçº¿ï¼å·²è‡ªåŠ¨æ‰§è¡Œä¸€é”®å¹³ä»“ã€‚`,
                    icon: '/static/favicon.ico',
                    requireInteraction: true
                });
            }
        }

        // RSIæ­¢ç›ˆç›‘æ§ï¼šæ£€æŸ¥RSIä¹‹å’Œå¹¶è§¦å‘å¹³ä»“
        let lastRSICheckValue = null;
        let lastRSITriggerTime = 0;
        const RSI_CHECK_COOLDOWN = 300000; // 5åˆ†é’Ÿå†·å´æ—¶é—´ï¼Œé˜²æ­¢é‡å¤è§¦å‘
        
        async function checkRSITakeProfit() {
            try {
                // è·å–RSIæ•°æ®ï¼ˆä»…ç”¨äºæ˜¾ç¤ºï¼‰
                const rsiResponse = await fetch('/api/coin-change-tracker/latest');
                const rsiResult = await rsiResponse.json();
                
                if (!rsiResult.success || !rsiResult.data) {
                    console.warn('è·å–RSIæ•°æ®å¤±è´¥');
                    return;
                }
                
                const totalRSI = rsiResult.data.total_rsi || 0;
                
                // æ›´æ–°UIæ˜¾ç¤ºå½“å‰RSI
                const rsiDisplay = document.getElementById('currentRSIDisplay');
                const rsiProgressBar = document.getElementById('rsiProgressBar');
                const rsiStatusTag = document.getElementById('rsiStatusTag');
                const rsiTodayMax = document.getElementById('rsiTodayMax');
                const rsiTodayMin = document.getElementById('rsiTodayMin');
                
                if (rsiDisplay) {
                    rsiDisplay.textContent = totalRSI.toFixed(2);
                    
                    // è®¡ç®—è¿›åº¦æ¡ç™¾åˆ†æ¯”ï¼ˆ810-2700èŒƒå›´ï¼‰
                    const percentage = ((totalRSI - 810) / (2700 - 810)) * 100;
                    if (rsiProgressBar) {
                        rsiProgressBar.style.width = `${Math.max(0, Math.min(100, percentage))}%`;
                    }
                    
                    // æ›´æ–°çŠ¶æ€æ ‡ç­¾
                    if (rsiStatusTag) {
                        let statusText = '';
                        let statusBg = '';
                        let statusColor = '';
                        
                        if (totalRSI > 1890) {
                            statusText = 'ğŸ”´ è¶…ä¹°åŒºåŸŸ';
                            statusBg = 'rgba(239, 68, 68, 0.15)';
                            statusColor = '#dc2626';
                        } else if (totalRSI < 810) {
                            statusText = 'ğŸŸ¢ è¶…å–åŒºåŸŸ';
                            statusBg = 'rgba(16, 185, 129, 0.15)';
                            statusColor = '#059669';
                        } else {
                            statusText = 'âšª ä¸­æ€§åŒºåŸŸ';
                            statusBg = 'rgba(107, 114, 128, 0.15)';
                            statusColor = '#6b7280';
                        }
                        
                        rsiStatusTag.textContent = statusText;
                        rsiStatusTag.style.background = statusBg;
                        rsiStatusTag.style.color = statusColor;
                    }
                    
                    // âš ï¸ æ›´æ–°è§é¡¶ä¿¡å·åšç©ºç­–ç•¥çš„RSIæ˜¾ç¤º
                    const topSignalRSIDisplay1 = document.getElementById('topSignalRSIDisplay1');
                    const topSignalRSIDisplay2 = document.getElementById('topSignalRSIDisplay2');
                    
                    if (topSignalRSIDisplay1) {
                        topSignalRSIDisplay1.textContent = totalRSI.toFixed(2);
                        // æ ¹æ®RSIè®¾ç½®é¢œè‰²
                        topSignalRSIDisplay1.style.color = totalRSI > 1800 ? '#dc2626' : '#991b1b';
                    }
                    
                    if (topSignalRSIDisplay2) {
                        topSignalRSIDisplay2.textContent = totalRSI.toFixed(2);
                        // æ ¹æ®RSIè®¾ç½®é¢œè‰²
                        topSignalRSIDisplay2.style.color = totalRSI > 1800 ? '#b91c1c' : '#7f1d1d';
                    }
                }
                
                // æ›´æ–°ä»Šæ—¥æœ€é«˜æœ€ä½ï¼ˆä»å†å²æ•°æ®ä¸­è·å–ï¼‰
                if (rsiResult.data.rsi_max !== undefined && rsiTodayMax) {
                    rsiTodayMax.textContent = rsiResult.data.rsi_max.toFixed(2);
                }
                if (rsiResult.data.rsi_min !== undefined && rsiTodayMin) {
                    rsiTodayMin.textContent = rsiResult.data.rsi_min.toFixed(2);
                }
                
            } catch (e) {
                console.error('âŒ RSIæ•°æ®æ›´æ–°å¤±è´¥', e);
            }
        }
        
        // ä¸€é”®å¹³ä»“æ‰€æœ‰æŒä»“
        async function closeAllPositions() {
            console.log('[closeAllPositions] å¼€å§‹ä¸€é”®å¹³ä»“æ‰€æœ‰æŒä»“');
            
            const account = accounts.find(acc => acc.id === currentAccount);
            if (!account) {
                alert('æœªæ‰¾åˆ°è´¦æˆ·ä¿¡æ¯');
                return;
            }
            
            try {
                const response = await fetch('/api/okx-trading/close-all-positions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        apiKey: account.apiKey,
                        apiSecret: account.apiSecret,
                        passphrase: account.passphrase,
                        accountId: account.id
                    })
                });
                
                const result = await response.json();
                console.log('[closeAllPositions] APIå“åº”:', result);
                
                if (result.success) {
                    let message = `âœ… ä¸€é”®å¹³ä»“å®Œæˆï¼\n\næ€»æŒä»“ï¼š${result.totalPositions} ä¸ª\næˆåŠŸå¹³ä»“ï¼š${result.closedCount} ä¸ª\nå¤±è´¥ï¼š${result.failedCount} ä¸ª`;
                    
                    // å¦‚æœæœ‰é‡è¯•ä¿¡æ¯ï¼Œæ˜¾ç¤ºé‡è¯•ç»“æœ
                    if (result.retryCount > 0) {
                        message += `\n\nç¬¬äºŒè½®é‡è¯•ï¼š${result.retrySuccess}/${result.retryCount} æˆåŠŸ`;
                    }
                    
                    // æ˜¾ç¤ºè¯¦ç»†çš„å¤±è´¥ä¿¡æ¯
                    if (result.failedCount > 0) {
                        message += '\n\nå¤±è´¥è¯¦æƒ…ï¼š';
                        result.results.filter(r => r.status === 'failed' || r.status === 'error').forEach(r => {
                            message += `\nâ€¢ ${r.instId}: ${r.message}`;
                        });
                    }
                    
                    alert(message);
                    
                    // åˆ·æ–°è´¦æˆ·æ•°æ®
                    await refreshAccountData();
                } else {
                    alert(`å¹³ä»“å¤±è´¥ï¼š${result.message || result.error || 'æœªçŸ¥é”™è¯¯'}`);
                }
            } catch (error) {
                console.error('[closeAllPositions] ä¸€é”®å¹³ä»“å¼‚å¸¸:', error);
                alert(`ä¸€é”®å¹³ä»“å¼‚å¸¸ï¼š${error.message}`);
            }
        }

        // åˆ·æ–°è´¦æˆ·æ•°æ®ï¼ˆè´¦æˆ·ä¿¡æ¯+æŒä»“ï¼‰
        async function refreshAccountData() {
            await Promise.all([
                loadAccountInfo(),
                loadPositions()
            ]);
        }

        // åŠ è½½è´¦æˆ·ä»“ä½é™é¢
        async function loadAccountLimit() {
            console.log('[loadAccountLimit] å¼€å§‹åŠ è½½è´¦æˆ·ä»“ä½é™é¢...');
            
            const account = accounts.find(acc => acc.id === currentAccount);
            const accountName = account ? account.name : 'ä¸»è´¦æˆ·';
            
            try {
                const response = await fetch(`/api/okx-trading/account-limit?account_name=${encodeURIComponent(accountName)}`);
                const result = await response.json();
                
                console.log('[loadAccountLimit] APIå“åº”:', result);
                
                if (result.success) {
                    const data = result.data;
                    
                    // æ›´æ–°é¡µé¢æ˜¾ç¤º
                    document.getElementById('accountName').textContent = data.account_name;
                    document.getElementById('accountStartDate').textContent = data.start_date;
                    document.getElementById('accountDaysPassed').textContent = `${data.days_passed} å¤©`;
                    document.getElementById('accountMaxLimit').textContent = `${data.current_max_limit} USDT`;
                    document.getElementById('accountNextIncreaseDate').textContent = data.next_increase_date;
                    document.getElementById('accountDaysUntilIncrease').textContent = `${data.days_until_next_increase} å¤©`;
                    
                    console.log(`âœ… è´¦æˆ·é™é¢å·²æ›´æ–°: ${data.current_max_limit} USDT`);
                } else {
                    console.error('[loadAccountLimit] åŠ è½½å¤±è´¥:', result.error);
                }
            } catch (error) {
                console.error('[loadAccountLimit] åŠ è½½å¼‚å¸¸:', error);
            }
        }

        // å¹³ä»“å‡½æ•°
        async function closePosition(instId, posSide) {
            const account = accounts.find(acc => acc.id === currentAccount);
            
            if (!account || !account.apiKey || !account.apiSecret || !account.passphrase) {
                alert('è¯·å…ˆé…ç½®è´¦æˆ·APIå‡­è¯ï¼');
                return;
            }
            
            const sideName = posSide === 'long' ? 'åšå¤š' : 'åšç©º';
            const confirmMsg = `ç¡®è®¤å¹³ä»“ ${instId} ${sideName} æŒä»“ï¼Ÿ`;
            
            // ä½¿ç”¨è‡ªå®šä¹‰ç¡®è®¤å¯¹è¯æ¡†
            const confirmed = await showConfirmDialog(confirmMsg, 'ğŸ”” æ‰¹é‡å¹³å…¨å•æç¤º');
            if (!confirmed) {
                return;
            }
            
            try {
                const response = await fetch('/api/okx-trading/close-position', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        apiKey: account.apiKey,
                        apiSecret: account.apiSecret,
                        passphrase: account.passphrase,
                        instId: instId,
                        posSide: posSide
                    })
                });
                
                const result = await response.json();
                console.log('å¹³ä»“å“åº”:', result);
                
                if (result.success) {
                    alert('âœ… å¹³ä»“æˆåŠŸï¼');
                    // å¹³ä»“æˆåŠŸååˆ·æ–°è´¦æˆ·ä¿¡æ¯å’ŒæŒä»“
                    await refreshAccountData();
                } else {
                    const errorMsg = result.error || 'æœªçŸ¥é”™è¯¯';
                    // ç‰¹æ®Šå¤„ç†"æ²¡æœ‰æŒä»“"é”™è¯¯
                    if (errorMsg.includes('æ²¡æœ‰') && errorMsg.includes('æŒä»“')) {
                        alert(`âš ï¸ ${errorMsg}\n\nå¯èƒ½åŸå› ï¼š\nâ€¢ æŒä»“å·²è¢«å…¶ä»–æ“ä½œå¹³ä»“\nâ€¢ è´¦æˆ·åˆ‡æ¢åæŒä»“æœªåŒæ­¥\nâ€¢ æŒä»“å·²è¿‡æœŸæˆ–è¢«æ¸…ç®—\n\nå»ºè®®ï¼šç‚¹å‡»"åˆ·æ–°"æŒ‰é’®æ›´æ–°æŒä»“ä¿¡æ¯`);
                        // è‡ªåŠ¨åˆ·æ–°æŒä»“åˆ—è¡¨
                        console.log('[closePosition] æŒä»“ä¸å­˜åœ¨ï¼Œè‡ªåŠ¨åˆ·æ–°æŒä»“åˆ—è¡¨');
                        await refreshAccountData();
                    } else {
                        alert(`âŒ å¹³ä»“å¤±è´¥: ${errorMsg}`);
                    }
                }
            } catch (error) {
                console.error('å¹³ä»“å¼‚å¸¸:', error);
                alert(`âŒ å¹³ä»“å¼‚å¸¸: ${error.message || error}`);
            }
        }

        // åŠ è½½å½“å‰å§”æ‰˜ï¼ˆæœªæˆäº¤è®¢å•ï¼‰
        async function loadPendingOrders() {
            console.log('[loadPendingOrders] å¼€å§‹åŠ è½½å§”æ‰˜è®¢å•...');
            
            const account = accounts.find(acc => acc.id === currentAccount);
            
            if (!account) {
                console.error('[loadPendingOrders] è´¦æˆ·ä¸å­˜åœ¨');
                document.getElementById('pendingOrdersList').innerHTML = '<div class="no-positions">è´¦æˆ·ä¸å­˜åœ¨</div>';
                document.getElementById('pendingOrdersCount').textContent = '(0)';
                return;
            }
            
            if (!account.apiKey || !account.apiSecret || !account.passphrase) {
                console.log('[loadPendingOrders] æœªé…ç½®APIå‡­è¯');
                document.getElementById('pendingOrdersList').innerHTML = '<div class="no-positions">è¯·å…ˆé…ç½®è´¦æˆ·APIå‡­è¯</div>';
                document.getElementById('pendingOrdersCount').textContent = '(0)';
                return;
            }

            try {
                console.log('[loadPendingOrders] è°ƒç”¨API...');
                const response = await fetch('/api/okx-trading/pending-orders', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        apiKey: account.apiKey,
                        apiSecret: account.apiSecret,
                        passphrase: account.passphrase
                    })
                });

                const result = await response.json();
                console.log('[loadPendingOrders] APIå“åº”:', result);

                if (result.success && result.data) {
                    const orders = result.data;
                    const ordersCount = orders.length;
                    
                    console.log('[loadPendingOrders] å§”æ‰˜æ•°é‡:', ordersCount);
                    
                    document.getElementById('pendingOrdersCount').textContent = `(${ordersCount})`;
                    
                    if (ordersCount === 0) {
                        document.getElementById('pendingOrdersList').innerHTML = '<div class="no-positions">æš‚æ— å§”æ‰˜</div>';
                    } else {
                        // æ¸²æŸ“å§”æ‰˜è®¢å•åˆ—è¡¨
                        const html = orders.map(order => {
                            const sideClass = order.posSide === 'long' ? 'long' : 'short';
                            const sideName = order.posSide === 'long' ? 'åšå¤š' : 'åšç©º';
                            const sideAction = order.side === 'buy' ? 'ä¹°å…¥' : 'å–å‡º';
                            
                            // æ ¼å¼åŒ–åˆ›å»ºæ—¶é—´
                            const createTime = new Date(parseInt(order.createTime)).toLocaleString('zh-CN');
                            
                            return `
                                <div class="position-item" style="border-left: 3px solid #f59e0b;">
                                    <div class="position-header">
                                        <span class="position-symbol">${order.instId}</span>
                                        <span class="position-side ${sideClass}">${sideName}</span>
                                        <button class="cancel-order-btn" onclick="cancelOrder('${order.ordId}', '${order.instId}')">
                                            æ’¤é”€
                                        </button>
                                    </div>
                                    <div class="position-details">
                                        <div class="position-detail-item">
                                            <span class="position-detail-label">çŠ¶æ€:</span>
                                            <span class="position-detail-value" style="color: #f59e0b;">${order.stateText}</span>
                                        </div>
                                        <div class="position-detail-item">
                                            <span class="position-detail-label">ç±»å‹:</span>
                                            <span class="position-detail-value">${order.ordTypeText}</span>
                                        </div>
                                        <div class="position-detail-item">
                                            <span class="position-detail-label">æ•°é‡:</span>
                                            <span class="position-detail-value">${order.size}</span>
                                        </div>
                                        <div class="position-detail-item">
                                            <span class="position-detail-label">ä»·æ ¼:</span>
                                            <span class="position-detail-value">$${parseFloat(order.price).toFixed(4)}</span>
                                        </div>
                                        <div class="position-detail-item">
                                            <span class="position-detail-label">å·²æˆäº¤:</span>
                                            <span class="position-detail-value">${order.filledSize}</span>
                                        </div>
                                        <div class="position-detail-item">
                                            <span class="position-detail-label">åˆ›å»ºæ—¶é—´:</span>
                                            <span class="position-detail-value" style="font-size: 11px;">${createTime}</span>
                                        </div>
                                    </div>
                                    <div style="margin-top: 8px; font-size: 11px; color: #888;">
                                        è®¢å•ID: ${order.ordId}
                                    </div>
                                </div>
                            `;
                        }).join('');
                        
                        document.getElementById('pendingOrdersList').innerHTML = html;
                    }
                } else {
                    console.error('[loadPendingOrders] è·å–å§”æ‰˜åˆ—è¡¨å¤±è´¥:', result.error);
                    document.getElementById('pendingOrdersList').innerHTML = '<div class="no-positions">åŠ è½½å¤±è´¥: ' + (result.error || 'æœªçŸ¥é”™è¯¯') + '</div>';
                }
            } catch (error) {
                console.error('[loadPendingOrders] åŠ è½½å§”æ‰˜å¼‚å¸¸:', error);
                document.getElementById('pendingOrdersList').innerHTML = '<div class="no-positions">åŠ è½½å¼‚å¸¸</div>';
            }
        }

        // æ’¤é”€è®¢å•å‡½æ•°
        async function cancelOrder(ordId, instId) {
            const account = accounts.find(acc => acc.id === currentAccount);
            
            if (!account || !account.apiKey || !account.apiSecret || !account.passphrase) {
                alert('è¯·å…ˆé…ç½®è´¦æˆ·APIå‡­è¯ï¼');
                return;
            }
            
            const confirmMsg = `ç¡®è®¤æ’¤é”€è®¢å•ï¼Ÿ\n\näº¤æ˜“å¯¹: ${instId}\nè®¢å•ID: ${ordId}`;
            
            if (!confirm(confirmMsg)) {
                return;
            }
            
            try {
                const response = await fetch('/api/okx-trading/cancel-order', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        apiKey: account.apiKey,
                        apiSecret: account.apiSecret,
                        passphrase: account.passphrase,
                        ordId: ordId,
                        instId: instId
                    })
                });
                
                const result = await response.json();
                console.log('æ’¤é”€å“åº”:', result);
                
                if (result.success) {
                    alert('âœ… è®¢å•å·²æ’¤é”€ï¼');
                    // æ’¤é”€æˆåŠŸååˆ·æ–°è´¦æˆ·ä¿¡æ¯ã€æŒä»“å’Œå§”æ‰˜åˆ—è¡¨
                    await refreshAccountData();
                    await loadPendingOrders();
                } else {
                    alert(`âŒ æ’¤é”€å¤±è´¥: ${result.error || 'æœªçŸ¥é”™è¯¯'}`);
                }
            } catch (error) {
                console.error('æ’¤é”€å¼‚å¸¸:', error);
                alert(`âŒ æ’¤é”€å¼‚å¸¸: ${error.message || error}`);
            }
        }


        // æ˜¾ç¤ºAPIé…ç½®æç¤º
        function showApiConfigNotice() {
            const notice = document.getElementById('apiConfigNotice');
            if (notice) {
                notice.style.display = 'block';
            }
        }

        // éšè—APIé…ç½®æç¤º
        function hideApiConfigNotice() {
            const notice = document.getElementById('apiConfigNotice');
            if (notice) {
                notice.style.display = 'none';
            }
        }

        // åŠ è½½äº¤æ˜“æ—¥å¿—
        async function loadTradingLogs() {
            console.log('[loadTradingLogs] å¼€å§‹åŠ è½½äº¤æ˜“æ—¥å¿—');
            
            try {
                const response = await fetch('/api/okx-trading/logs?limit=50');
                const result = await response.json();
                
                if (result.success && result.logs) {
                    const logs = result.logs;
                    const logsCount = document.getElementById('logsCount');
                    const logsContainer = document.getElementById('tradingLogsList');
                    
                    logsCount.textContent = `(${logs.length})`;
                    
                    if (logs.length === 0) {
                        logsContainer.innerHTML = `
                            <div style="text-align: center; padding: 20px; color: #94a3b8;">
                                æš‚æ— æ—¥å¿—
                            </div>
                        `;
                        return;
                    }
                    
                    // åè½¬é¡ºåºï¼Œæœ€æ–°çš„åœ¨ä¸Šé¢
                    const reversedLogs = [...logs].reverse();
                    
                    logsContainer.innerHTML = reversedLogs.map(log => {
                        const time = new Date(log.timestamp).toLocaleString('zh-CN');
                        const actionEmoji = {
                            'open_position': 'ğŸ“ˆ',
                            'close_position': 'ğŸ“‰',
                            'cancel_order': 'ğŸš«',
                            'batch_open': 'ğŸ¯',
                            'batch_close': 'âš¡'
                        }[log.action] || 'ğŸ“';
                        
                        const actionText = {
                            'open_position': 'å¼€ä»“',
                            'close_position': 'å¹³ä»“',
                            'cancel_order': 'æ’¤å•',
                            'batch_open': 'æ‰¹é‡å¼€ä»“',
                            'batch_close': 'æ‰¹é‡å¹³ä»“'
                        }[log.action] || log.action;
                        
                        const status = log.result.status;
                        const statusColor = status === 'success' ? '#10b981' : '#ef4444';
                        const statusText = status === 'success' ? 'æˆåŠŸ' : 'å¤±è´¥';
                        const statusEmoji = status === 'success' ? 'âœ…' : 'âŒ';
                        
                        // æ„å»ºè¯¦æƒ…æ–‡æœ¬
                        let detailsText = '';
                        if (log.details.instId) {
                            const coinName = log.details.instId.replace('-USDT-SWAP', '');
                            detailsText += `${coinName} `;
                        }
                        if (log.details.posSide) {
                            detailsText += log.details.posSide === 'long' ? 'åšå¤š' : 'åšç©º';
                            detailsText += ' ';
                        }
                        if (log.details.inputUsdt) {
                            detailsText += `${log.details.inputUsdt} USDT`;
                        }
                        if (log.details.contracts) {
                            detailsText += ` (${log.details.contracts}å¼ )`;
                        }
                        if (log.details.leverage) {
                            detailsText += ` ${log.details.leverage}x`;
                        }
                        
                        // é”™è¯¯ä¿¡æ¯
                        let errorText = '';
                        if (status === 'failed' && log.result.error) {
                            errorText = `<div style="margin-top: 4px; font-size: 11px; color: #ef4444;">é”™è¯¯: ${log.result.error}</div>`;
                        }
                        
                        return `
                            <div style="padding: 12px; border-bottom: 1px solid #e5e7eb; transition: background 0.2s;" onmouseover="this.style.background='#f9fafb'" onmouseout="this.style.background='transparent'">
                                <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 4px;">
                                    <div>
                                        <span style="font-size: 16px;">${actionEmoji}</span>
                                        <strong style="margin-left: 6px; color: #1e293b;">${actionText}</strong>
                                        <span style="margin-left: 8px; color: #64748b; font-size: 13px;">${detailsText}</span>
                                    </div>
                                    <div style="display: flex; align-items: center;">
                                        <span style="font-size: 14px;">${statusEmoji}</span>
                                        <span style="margin-left: 4px; color: ${statusColor}; font-weight: 600; font-size: 13px;">${statusText}</span>
                                    </div>
                                </div>
                                <div style="font-size: 11px; color: #94a3b8;">
                                    ${time}
                                </div>
                                ${errorText}
                            </div>
                        `;
                    }).join('');
                    
                    console.log(`[loadTradingLogs] åŠ è½½äº† ${logs.length} æ¡æ—¥å¿—`);
                } else {
                    console.error('[loadTradingLogs] åŠ è½½å¤±è´¥:', result.error);
                }
            } catch (error) {
                console.error('[loadTradingLogs] åŠ è½½å¼‚å¸¸:', error);
            }
        }

        // åˆå§‹åŒ–é¡µé¢
        // ä»åç«¯APIåŠ è½½è´¦æˆ·åˆ—è¡¨
        async function loadAccountsList() {
            console.log('[loadAccountsList] å¼€å§‹åŠ è½½è´¦æˆ·åˆ—è¡¨...');
            try {
                const response = await fetch('/api/okx-accounts/list-with-credentials');
                const result = await response.json();
                
                if (result.success && result.accounts) {
                    console.log('[loadAccountsList] ä»åç«¯åŠ è½½æˆåŠŸ:', result);
                    
                    // å°†åç«¯è´¦æˆ·è½¬æ¢ä¸ºå‰ç«¯æ ¼å¼
                    accounts = result.accounts.map(acc => ({
                        id: acc.id || acc.account_id,
                        name: acc.name || acc.account_name,
                        apiKey: acc.apiKey || acc.api_key,
                        apiSecret: acc.apiSecret || acc.api_secret,
                        passphrase: acc.passphrase,
                        balance: 0
                    }));
                    
                    // ä¿å­˜åˆ° localStorage
                    localStorage.setItem('okx_accounts', JSON.stringify(accounts));
                    
                    // è®¾ç½®é»˜è®¤è´¦æˆ·
                    if (result.default_account && accounts.length > 0) {
                        const defaultAcc = accounts.find(acc => acc.id === result.default_account);
                        if (defaultAcc) {
                            currentAccount = defaultAcc.id;
                        } else {
                            currentAccount = accounts[0].id;
                        }
                    }
                    
                    console.log('[loadAccountsList] è´¦æˆ·åˆ—è¡¨å·²æ›´æ–°:', accounts);
                    console.log('[loadAccountsList] å½“å‰è´¦æˆ·:', currentAccount);
                } else {
                    console.warn('[loadAccountsList] åç«¯APIè¿”å›å¤±è´¥ï¼Œä½¿ç”¨localStorageæ•°æ®');
                    // å¤‡ç”¨æ–¹æ¡ˆï¼šä»localStorageè¯»å–
                    loadAccountsFromLocalStorage();
                }
            } catch (error) {
                console.warn('[loadAccountsList] åç«¯APIè°ƒç”¨å¼‚å¸¸ï¼Œä½¿ç”¨localStorageæ•°æ®:', error);
                // å¤‡ç”¨æ–¹æ¡ˆï¼šä»localStorageè¯»å–
                loadAccountsFromLocalStorage();
            }
        }
        
        function loadAccountsFromLocalStorage() {
            const storedAccounts = localStorage.getItem('okx_accounts');
            if (storedAccounts) {
                try {
                    accounts = JSON.parse(storedAccounts);
                    console.log('[loadAccountsFromLocalStorage] ä»localStorageåŠ è½½è´¦æˆ·:', accounts);
                    
                    // è®¾ç½®é»˜è®¤è´¦æˆ·
                    if (accounts.length > 0) {
                        currentAccount = accounts[0].id;
                    }
                } catch (error) {
                    console.error('[loadAccountsFromLocalStorage] è§£ælocalStorageå¤±è´¥:', error);
                }
            } else {
                console.warn('[loadAccountsFromLocalStorage] localStorageä¸­æ²¡æœ‰è´¦æˆ·æ•°æ®');
            }
        }

        // è¿›åº¦è·Ÿè¸ª
        let loadingProgress = 0;
        const totalSteps = 6;

        function updateProgress(step, stepName, substepId) {
            loadingProgress++;
            const percentage = Math.round((loadingProgress / totalSteps) * 100);
            
            const progressBar = document.getElementById('progressBar');
            const progressText = document.getElementById('progressText');
            const loadingStep = document.getElementById('loadingStep');
            const substepEl = document.getElementById(substepId);
            
            if (progressBar) progressBar.style.width = percentage + '%';
            if (progressText) progressText.textContent = percentage + '%';
            if (loadingStep) loadingStep.textContent = stepName;
            if (substepEl) {
                substepEl.classList.remove('loading');
                substepEl.classList.add('completed');
            }
            
            console.log(`[è¿›åº¦] ${percentage}% - ${stepName}`);
        }

        function setLoadingStep(substepId) {
            const substepEl = document.getElementById(substepId);
            if (substepEl) {
                // ç§»é™¤æ‰€æœ‰loadingçŠ¶æ€
                document.querySelectorAll('.substep.loading').forEach(el => {
                    el.classList.remove('loading');
                });
                // æ·»åŠ å½“å‰loadingçŠ¶æ€
                substepEl.classList.add('loading');
            }
        }

        function hideLoadingOverlay() {
            const overlay = document.getElementById('loadingOverlay');
            const mainContent = document.getElementById('mainContent');
            
            if (overlay) {
                overlay.classList.add('fade-out');
                setTimeout(() => {
                    overlay.style.display = 'none';
                }, 500);
            }
            
            if (mainContent) {
                mainContent.style.opacity = '1';
            }
        }

        async function init() {
            const startTime = Date.now();
            console.log('[init] é¡µé¢åˆå§‹åŒ–å¼€å§‹...');
            
            try {
                // æ­¥éª¤1: åŠ è½½è´¦æˆ·åˆ—è¡¨
                setLoadingStep('step-accounts');
                await loadAccountsList();
                updateProgress(1, 'âœ“ è´¦æˆ·é…ç½®åŠ è½½å®Œæˆ', 'step-accounts');
                
                // ç¡®ä¿accountsæ•°ç»„ä¸ä¸ºç©º
                if (!accounts || accounts.length === 0) {
                    console.warn('[init] accountsä¸ºç©ºï¼Œä½¿ç”¨åˆå§‹åŒ–çš„é»˜è®¤å€¼');
                    if (!currentAccount && accounts.length > 0) {
                        currentAccount = accounts[0].id;
                    }
                }
                
                renderAccountTabs();
                
                // æ­¥éª¤2: åŠ è½½å¸¸ç”¨å¸åˆ—è¡¨ï¼ˆä¼˜å…ˆçº§é«˜ï¼Œå½±å“å…¶ä»–æ•°æ®ï¼‰
                setLoadingStep('step-favorites');
                await loadFavoriteSymbols();
                updateProgress(2, 'âœ“ å¸¸ç”¨å¸ç§åŠ è½½å®Œæˆ', 'step-favorites');
                
                // æ­¥éª¤3: åŠ è½½å®æ—¶è¡Œæƒ…ï¼ˆå¹¶è¡Œï¼Œä¸é˜»å¡ï¼‰
                setLoadingStep('step-tickers');
                loadMarketTickers();  // ä¸awaitï¼Œè®©å®ƒåœ¨åå°æ‰§è¡Œ
                updateProgress(3, 'âœ“ å®æ—¶è¡Œæƒ…åŠ è½½ä¸­...', 'step-tickers');
                
                // æ­¥éª¤4: åŠ è½½è´¦æˆ·æ•°æ®å’ŒæŒä»“ï¼ˆå…³é”®æ•°æ®ï¼‰
                setLoadingStep('step-positions');
                await Promise.all([
                    loadAccountData(),
                    refreshAccountData()
                ]);
                updateProgress(4, 'âœ“ è´¦æˆ·ä¸æŒä»“åŠ è½½å®Œæˆ', 'step-positions');
                
                // æ­¥éª¤5: åŠ è½½å§”æ‰˜è®¢å•ï¼ˆæ¬¡è¦æ•°æ®ï¼‰
                setLoadingStep('step-orders');
                loadPendingOrders();  // ä¸awaitï¼Œè®©å®ƒåœ¨åå°æ‰§è¡Œ
                updateProgress(5, 'âœ“ å§”æ‰˜è®¢å•åŠ è½½ä¸­...', 'step-orders');
                
                // æ­¥éª¤6: åŠ è½½äº¤æ˜“æ—¥å¿—å’Œè´¦æˆ·é™é¢ï¼ˆæ¬¡è¦æ•°æ®ï¼‰
                setLoadingStep('step-logs');
                Promise.all([
                    loadTradingLogs(),
                    loadAccountLimit(),
                    loadTopSignalConfig(),  // ğŸ†• åŠ è½½è§é¡¶ä¿¡å·ç­–ç•¥é…ç½®
                    loadBottomSignalConfig()  // ğŸ†• åŠ è½½è§åº•ä¿¡å·ç­–ç•¥é…ç½®
                ]);
                updateProgress(6, 'âœ“ æ‰€æœ‰æ•°æ®åŠ è½½å®Œæˆï¼', 'step-logs');
                
                // å»¶è¿Ÿéšè—åŠ è½½ç•Œé¢ï¼Œè®©ç”¨æˆ·çœ‹åˆ°å®ŒæˆçŠ¶æ€
                setTimeout(() => {
                    hideLoadingOverlay();
                    const loadTime = Date.now() - startTime;
                    console.log(`[init] é¡µé¢åŠ è½½å®Œæˆï¼Œè€—æ—¶ ${loadTime}ms`);
                }, 800);
                
            } catch (error) {
                console.error('[init] åˆå§‹åŒ–å¤±è´¥:', error);
                // å³ä½¿å¤±è´¥ä¹Ÿè¦éšè—åŠ è½½ç•Œé¢
                setTimeout(() => {
                    hideLoadingOverlay();
                    alert('ç³»ç»Ÿåˆå§‹åŒ–å¤±è´¥ï¼Œéƒ¨åˆ†åŠŸèƒ½å¯èƒ½ä¸å¯ç”¨');
                }, 1000);
            }
            
            // å¯åŠ¨å®šæ—¶åˆ·æ–°ä»»åŠ¡
            // æ¯60ç§’è‡ªåŠ¨åˆ·æ–°è´¦æˆ·ä¿¡æ¯ã€æŒä»“ã€å§”æ‰˜å’Œæ—¥å¿—ï¼ˆä¼˜åŒ–ï¼šä»30ç§’æ”¹ä¸º60ç§’ï¼Œå‡å°‘æœåŠ¡å™¨å‹åŠ›ï¼‰
            setInterval(() => {
                refreshAccountData();
                loadPendingOrders();
                loadTradingLogs();
                updateTotalChangeOKX(); // åŒæ—¶æ›´æ–°æ¶¨è·Œå¹…
                checkAndExecuteAutoStrategy(); // æ£€æŸ¥è‡ªåŠ¨äº¤æ˜“ç­–ç•¥
                checkAndExecuteUpRatio0Top8(); // æ£€æŸ¥ä¸Šæ¶¨å æ¯”0-æ¶¨å¹…å‰8åç­–ç•¥
                checkAndExecuteUpRatio0Bottom8(); // æ£€æŸ¥ä¸Šæ¶¨å æ¯”0-æ¶¨å¹…å8åç­–ç•¥
                checkRSITakeProfit(); // æ£€æŸ¥RSIæ­¢ç›ˆ
                loadCurrentMarketSentiment(); // ğŸ”¥ åˆ·æ–°å¸‚åœºæƒ…ç»ª
                
                // ğŸ†• åˆ·æ–°ç­–ç•¥çŠ¶æ€æ˜¾ç¤ºï¼ˆç¡®ä¿UIä¸åç«¯åŒæ­¥ï¼‰
                loadAutoStrategySettings(); // åˆ·æ–°æŠ„åº•ç­–ç•¥UI
                loadAutoStrategySettingsTop(); // åˆ·æ–°è¿½æ¶¨ç­–ç•¥UI
            }, 60000);
            
            // æ¯30ç§’è‡ªåŠ¨åˆ·æ–°è¡Œæƒ…æ•°æ®ï¼ˆä¼˜åŒ–ï¼šä»10ç§’æ”¹ä¸º30ç§’ï¼Œå‡å°‘é¢‘ç¹è¯·æ±‚ï¼‰
            setInterval(() => {
                loadMarketTickers();
            }, 30000);
            
            // æ·»åŠ æœ€å¤§æŒä»“é™åˆ¶è¾“å…¥æ¡†çš„å®æ—¶æ›´æ–°ç›‘å¬
            const maxPosInput = document.getElementById('maxPositionValueInput');
            if (maxPosInput) {
                maxPosInput.addEventListener('input', function() {
                    const value = parseFloat(this.value) || 5.0;
                    document.getElementById('maxPositionValueDisplay').textContent = value.toFixed(1) + ' USDT';
                });
            }
        }

        // æ¸²æŸ“è´¦æˆ·æ ‡ç­¾
        function renderAccountTabs() {
            console.log('[renderAccountTabs] å¼€å§‹æ¸²æŸ“è´¦æˆ·æ ‡ç­¾...');
            console.log('[renderAccountTabs] accounts:', accounts);
            console.log('[renderAccountTabs] currentAccount:', currentAccount);
            
            const tabsContainer = document.getElementById('accountTabs');
            if (!tabsContainer) {
                console.error('[renderAccountTabs] accountTabså…ƒç´ ä¸å­˜åœ¨ï¼');
                return;
            }
            
            if (!accounts || accounts.length === 0) {
                console.error('[renderAccountTabs] accountsæ•°ç»„ä¸ºç©ºï¼');
                tabsContainer.innerHTML = '<div class="text-gray-500">æš‚æ— è´¦æˆ·</div>';
                return;
            }
            
            tabsContainer.innerHTML = accounts.map(acc => `
                <div class="account-tab ${acc.id === currentAccount ? 'active' : ''}" onclick="selectAccount('${acc.id}')">
                    ${acc.name}
                </div>
            `).join('');
            
            console.log('[renderAccountTabs] æ¸²æŸ“å®Œæˆï¼Œå…±', accounts.length, 'ä¸ªè´¦æˆ·');
            
            // æ›´æ–°è´¦æˆ·ä½™é¢æ˜¾ç¤º
            updateAccountBalance();
        }

        // é€‰æ‹©è´¦æˆ·
        function selectAccount(accountId) {
            console.log(`[selectAccount] åˆ‡æ¢è´¦æˆ·: ${accountId}`);
            console.log(`[selectAccount] åˆ‡æ¢å‰ currentAccount: ${currentAccount}`);
            
            currentAccount = accountId;
            
            console.log(`[selectAccount] åˆ‡æ¢å currentAccount: ${currentAccount}`);
            console.log(`[selectAccount] å½“å‰è´¦æˆ·åˆ—è¡¨:`, accounts.map(a => ({id: a.id, name: a.name})));
            
            renderAccountTabs();
            loadAccountData();
            refreshAccountData();  // åˆ·æ–°è´¦æˆ·ä¿¡æ¯å’ŒæŒä»“
            loadTakeProfitStopLossSettings();  // åŠ è½½è¯¥è´¦æˆ·çš„æ­¢ç›ˆæ­¢æŸè®¾ç½®
            loadCurrentMarketSentiment();  // ğŸ”¥ åŠ è½½å½“å‰å¸‚åœºæƒ…ç»ª
            loadAutoStrategySettings();  // åŠ è½½è¯¥è´¦æˆ·çš„æŠ„åº•ç­–ç•¥è®¾ç½®
            loadAutoStrategySettingsTop();  // ğŸ†• åŠ è½½è¯¥è´¦æˆ·çš„è¿½æ¶¨ç­–ç•¥è®¾ç½®
            loadUpRatio0StrategySettings();  // ğŸ†• åŠ è½½è¯¥è´¦æˆ·çš„ä¸Šæ¶¨å æ¯”0ç­–ç•¥è®¾ç½®
            loadTopSignalConfig();  // ğŸ†• åŠ è½½è§é¡¶ä¿¡å·åšç©ºç­–ç•¥è®¾ç½®
            loadBottomSignalConfig();  // ğŸ†• åŠ è½½è§åº•ä¿¡å·åšå¤šç­–ç•¥è®¾ç½®
            refreshStrategyStatus();  // ğŸ†• åˆ·æ–°ç­–ç•¥çŠ¶æ€æ€»è§ˆ
            
            const account = accounts.find(acc => acc.id === accountId);
            console.log(`[selectAccount] å·²åˆ‡æ¢åˆ°è´¦æˆ·: ${account ? account.name : 'æœªæ‰¾åˆ°'} (${accountId})`);
        }

        // æ›´æ–°è´¦æˆ·ä½™é¢æ˜¾ç¤º
        function updateAccountBalance() {
            const account = accounts.find(acc => acc.id === currentAccount);
            if (account) {
                // æ›´æ–°è´¦æˆ·æ ‡ç­¾å¤„çš„ä½™é¢
                document.getElementById('accountBalance').textContent = account.balance.toFixed(2) + ' USDT';
                // æ›´æ–°ä¾§è¾¹æ è´¦æˆ·æ˜¾ç¤º
                const sidebarBalanceEl = document.getElementById('sidebarAccountBalance');
                if (sidebarBalanceEl) {
                    sidebarBalanceEl.textContent = account.balance.toFixed(2) + ' USDT';
                }
                const currentAccountNameEl = document.getElementById('currentAccountName');
                if (currentAccountNameEl) {
                    currentAccountNameEl.textContent = account.name;
                }
                // æ›´æ–°è®¢å•è¡¨å•ä¸­çš„å¯ç”¨ä½™é¢
                const orderBalanceEl = document.getElementById('orderAvailableBalance');
                if (orderBalanceEl) {
                    orderBalanceEl.textContent = account.balance.toFixed(2) + ' USDT';
                }
            }
        }
        
        // æ»šåŠ¨åˆ°è´¦æˆ·åˆ‡æ¢å™¨
        function scrollToAccountSwitcher() {
            const switcher = document.querySelector('.account-switcher');
            if (switcher) {
                switcher.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
        }

        // æ¸²æŸ“äº¤æ˜“å¯¹åˆ—è¡¨
        function renderSymbolsList() {
            const list = document.getElementById('symbolsList');
            
            // åˆ†ç»„ï¼šæ”¶è—çš„å’Œéæ”¶è—çš„
            const favorited = symbols.filter(s => favoriteSymbols.includes(s.symbol));
            const notFavorited = symbols.filter(s => !favoriteSymbols.includes(s.symbol));
            
            let html = '';
            
            // æ¸²æŸ“æ”¶è—åˆ†ç»„
            if (favorited.length > 0) {
                html += '<div class="favorite-section">';
                html += '<div class="favorite-section-title">â­ å¸¸ç”¨å¸ (' + favorited.length + ')</div>';
                html += favorited.map(s => renderSymbolItem(s, true)).join('');
                html += '</div>';
            }
            
            // æ¸²æŸ“éæ”¶è—åˆ†ç»„
            html += notFavorited.map(s => renderSymbolItem(s, false)).join('');
            
            list.innerHTML = html;
        }
        
        // æ¸²æŸ“å•ä¸ªäº¤æ˜“å¯¹é¡¹
        function renderSymbolItem(s, isFavorite) {
            const isActive = s.symbol === currentSymbol;
            const favoriteClass = isFavorite ? 'favorite' : '';
            const starIcon = isFavorite ? 'â­' : 'â˜†';
            
            return `
                <div class="symbol-item ${isActive ? 'active' : ''} ${favoriteClass}" onclick="selectSymbol('${s.symbol}')">
                    <div class="symbol-content">
                        <div class="symbol-name">
                            ${s.name}/USDT
                            ${isFavorite ? '<span class="favorite-badge">â­</span>' : ''}
                        </div>
                        <div class="symbol-price">
                            $${s.price.toFixed(s.price < 1 ? 4 : 2)} 
                            <span style="color: ${s.change >= 0 ? '#10b981' : '#ef4444'}">
                                ${s.change >= 0 ? '+' : ''}${s.change}%
                            </span>
                        </div>
                    </div>
                    <button class="favorite-btn ${isFavorite ? 'favorited' : ''}" 
                            onclick="event.stopPropagation(); toggleFavorite('${s.symbol}')"
                            title="${isFavorite ? 'å–æ¶ˆæ”¶è—' : 'æ”¶è—'}">
                        ${starIcon}
                    </button>
                </div>
            `;
        }
        
        // åˆ‡æ¢æ”¶è—çŠ¶æ€
        async function toggleFavorite(symbol) {
            const index = favoriteSymbols.indexOf(symbol);
            
            if (index > -1) {
                // å–æ¶ˆæ”¶è—
                favoriteSymbols.splice(index, 1);
            } else {
                // æ·»åŠ æ”¶è—
                favoriteSymbols.push(symbol);
            }
            
            // ä¿å­˜åˆ°æœåŠ¡å™¨ï¼ˆå…¨å±€å…±äº«ï¼‰
            await saveFavoriteSymbols();
            
            // é‡æ–°æ¸²æŸ“åˆ—è¡¨
            renderSymbolsList();
            
            console.log('æ”¶è—åˆ—è¡¨å·²æ›´æ–°:', favoriteSymbols);
        }

        // é€‰æ‹©äº¤æ˜“å¯¹
        function selectSymbol(symbol) {
            currentSymbol = symbol;
            const symbolData = symbols.find(s => s.symbol === symbol);
            
            document.getElementById('currentSymbol').textContent = symbolData.name + '-USDT';
            document.getElementById('currentPrice').textContent = symbolData.price.toFixed(2);
            
            const changeEl = document.getElementById('priceChange');
            changeEl.textContent = (symbolData.change >= 0 ? '+' : '') + symbolData.change + '%';
            changeEl.className = 'price-change ' + (symbolData.change >= 0 ? 'up' : 'down');
            
            renderSymbolsList();
        }

        // é€‰æ‹©äº¤æ˜“æ–¹å‘
        function selectDirection(direction) {
            currentDirection = direction;
            
            document.querySelectorAll('.direction-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelector('.direction-tab.' + direction).classList.add('active');
            
            const submitBtn = document.getElementById('submitBtn');
            submitBtn.className = 'submit-order ' + direction;
            submitBtn.innerHTML = direction === 'long' ? 'â¬† åšå¤š' : 'â¬‡ åšç©º';
        }

        // é€‰æ‹©æ æ†
        function selectLeverage(leverage) {
            currentLeverage = leverage;
            
            document.querySelectorAll('.leverage-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
        }

        // è®¾ç½®é‡‘é¢ç™¾åˆ†æ¯”
        function setAmount(percent) {
            // ä»DOMä¸­è·å–å®æ—¶çš„å¯ç”¨ä½™é¢
            const orderBalanceEl = document.getElementById('orderAvailableBalance');
            let balance = 0;
            
            if (orderBalanceEl && orderBalanceEl.textContent) {
                // æå–æ•°å­—éƒ¨åˆ†ï¼Œä¾‹å¦‚ "101.28 USDT" -> 101.28
                const balanceText = orderBalanceEl.textContent.trim();
                const balanceMatch = balanceText.match(/[\d.]+/);
                if (balanceMatch) {
                    balance = parseFloat(balanceMatch[0]);
                }
            }
            
            // å¦‚æœæ²¡æœ‰ä»DOMè·å–åˆ°ï¼Œå°è¯•ä»è´¦æˆ·å¯¹è±¡è·å–
            if (balance === 0) {
                const account = accounts.find(acc => acc.id === currentAccount);
                balance = account ? (account.balance || 0) : 0;
            }
            
            // è®¡ç®—ä»“ä½é‡‘é¢
            const amount = (balance * percent / 100).toFixed(2);
            const orderAmountInput = document.getElementById('orderAmount');
            if (orderAmountInput) {
                orderAmountInput.value = amount;
                console.log(`è®¾ç½®${percent}%ä»“ä½: å¯ç”¨ä½™é¢=${balance} USDT, ä»“ä½é‡‘é¢=${amount} USDT`);
            }
        }

        // æ‰¹é‡å¼€ä»“å‡½æ•°
        async function batchOrder(direction, percentPerCoin) {
            console.log(`[batchOrder] å¼€å§‹æ‰¹é‡å¼€ä»“: direction=${direction}, percentPerCoin=${percentPerCoin}%`);
            
            const account = accounts.find(acc => acc.id === currentAccount);
            
            if (!account || !account.apiKey || !account.apiSecret || !account.passphrase) {
                alert('âŒ è¯·å…ˆé…ç½®è´¦æˆ·APIå‡­è¯ï¼');
                return;
            }
            
            // è·å–å¯ç”¨ä½™é¢
            const balance = account.balance || 0;
            if (balance <= 0) {
                alert('âŒ è´¦æˆ·ä½™é¢ä¸è¶³ï¼');
                return;
            }
            
            // åªä»æ”¶è—çš„å¸ç§ä¸­é€‰æ‹©
            const favoriteSymbolsData = symbols.filter(s => favoriteSymbols.includes(s.symbol));
            
            if (favoriteSymbolsData.length === 0) {
                alert('âŒ è¯·å…ˆæ”¶è—ä¸€äº›å¸¸ç”¨å¸ç§ï¼\n\nåœ¨äº¤æ˜“å¯¹åˆ—è¡¨ä¸­ç‚¹å‡»â­æŒ‰é’®æ·»åŠ æ”¶è—ã€‚');
                return;
            }
            
            console.log('[batchOrder] å¸¸ç”¨å¸ç§æ•°é‡:', favoriteSymbolsData.length);
            console.log('[batchOrder] å¸¸ç”¨å¸ç§:', favoriteSymbolsData.map(s => s.name).join(', '));
            
            // ä»å¸¸ç”¨å¸ç§ä¸­æŒ‰æ¶¨è·Œå¹…æ’åºï¼Œè·å–å‰6å
            const sortedSymbols = [...favoriteSymbolsData].sort((a, b) => b.change - a.change);
            const top6Symbols = sortedSymbols.slice(0, 6);
            
            if (top6Symbols.length < 6) {
                alert(`âŒ å¸¸ç”¨å¸ç§ä¸è¶³6ä¸ªï¼\n\nå½“å‰å¸¸ç”¨å¸ç§ï¼š${favoriteSymbolsData.length}ä¸ª\nè¯·è‡³å°‘æ”¶è—6ä¸ªå¸ç§æ‰èƒ½ä½¿ç”¨æ‰¹é‡å¼€ä»“ã€‚`);
                return;
            }
            
            console.log('[batchOrder] å¸¸ç”¨å¸ç§æ¶¨å¹…å‰6:', top6Symbols.map(s => `${s.name} (${s.change}%)`));
            
            // è®¡ç®—æ¯ä¸ªå¸çš„ä¿è¯é‡‘å ç”¨ï¼ˆç”¨æˆ·è¾“å…¥çš„ç™¾åˆ†æ¯”æ˜¯æŒ‡ä¿è¯é‡‘å æ¯”ï¼‰
            const marginPerCoin = (balance * percentPerCoin / 100).toFixed(2);
            const totalMargin = (marginPerCoin * 6).toFixed(2);
            
            // âš ï¸ é‡è¦ï¼š10xæ æ†ä¸‹ï¼Œåˆçº¦ä»·å€¼ = ä¿è¯é‡‘ Ã— 10
            const contractValuePerCoin = (parseFloat(marginPerCoin) * 10).toFixed(2);
            const totalContractValue = (parseFloat(contractValuePerCoin) * 6).toFixed(2);
            
            console.log(`[batchOrder] ä½™é¢æ£€æŸ¥: å¯ç”¨=${balance.toFixed(2)}, æ¯å¸ä¿è¯é‡‘=${marginPerCoin}, æ¯å¸åˆçº¦ä»·å€¼=${contractValuePerCoin}, æ€»ä¿è¯é‡‘=${totalMargin}, æ€»åˆçº¦ä»·å€¼=${totalContractValue}`);
            
            // æ£€æŸ¥ä½™é¢æ˜¯å¦è¶³å¤Ÿï¼ˆä¿å®ˆæ£€æŸ¥ï¼šéœ€è¦æ€»ä¿è¯é‡‘çš„ 1.2 å€ä½œä¸ºç¼“å†²ï¼‰
            const requiredBalance = parseFloat(totalMargin) * 1.2;
            if (balance < requiredBalance) {
                alert(`âŒ ä½™é¢ä¸è¶³ï¼\n\n` +
                    `ã€èµ„é‡‘éœ€æ±‚ã€‘\n` +
                    `  â€¢ æ¯ä¸ªå¸ä¿è¯é‡‘: ${marginPerCoin} USDT (${percentPerCoin}%)\n` +
                    `  â€¢ æ¯ä¸ªå¸åˆçº¦ä»·å€¼: ${contractValuePerCoin} USDT (10xæ æ†)\n` +
                    `  â€¢ 6ä¸ªå¸æ€»ä¿è¯é‡‘: ${totalMargin} USDT\n` +
                    `  â€¢ å»ºè®®ä½™é¢: ${requiredBalance.toFixed(2)} USDT\n\n` +
                    `ã€å½“å‰çŠ¶æ€ã€‘\n` +
                    `  â€¢ å¯ç”¨ä½™é¢: ${balance.toFixed(2)} USDT\n` +
                    `  â€¢ ç¼ºå°‘: ${(requiredBalance - balance).toFixed(2)} USDT\n\n` +
                    `ğŸ’¡ å»ºè®®ï¼š\n` +
                    `  1. é™ä½å¼€ä»“æ¯”ä¾‹ (å½“å‰æ¯å¸${percentPerCoin}%)\n` +
                    `  2. å¢åŠ è´¦æˆ·ä½™é¢\n` +
                    `  3. å‡å°‘å¼€ä»“å¸ç§æ•°é‡`);
                return;
            }
            
            // ä½™é¢è­¦å‘Šæç¤ºï¼ˆæ‰‹åŠ¨æ‰§è¡Œéœ€è¦ç¡®è®¤ï¼‰
            if (balance < requiredBalance * 1.5) {
                const warningMsg = `âš ï¸ ä½™é¢åç´§\n\n` +
                    `å¯ç”¨ä½™é¢: ${balance.toFixed(2)} USDT\n` +
                    `é¢„è®¡å ç”¨ä¿è¯é‡‘: ${totalMargin} USDT\n` +
                    `å‰©ä½™: ${(balance - parseFloat(totalMargin)).toFixed(2)} USDT\n\n` +
                    `å»ºè®®å¢åŠ ä½™é¢æˆ–é™ä½å¼€ä»“æ¯”ä¾‹ï¼Œé¿å…å› ä½™é¢ä¸è¶³å¯¼è‡´éƒ¨åˆ†è®¢å•å¤±è´¥ã€‚\n\n` +
                    `æ˜¯å¦ç»§ç»­ï¼Ÿ`;
                if (!confirm(warningMsg)) {
                    console.log('[batchOrder] ç”¨æˆ·å› ä½™é¢ä¸è¶³å–æ¶ˆ');
                    return;
                }
            }
            
            // æ‰‹åŠ¨æ‰¹é‡å¼€ä»“ - ç¡®è®¤å¯¹è¯æ¡†
            const directionText = direction === 'long' ? 'åšå¤š' : 'åšç©º';
            const emoji = direction === 'long' ? 'ğŸ“ˆ' : 'ğŸ“‰';
            const strategyName = direction === 'long' ? 'å¤šå•' : 'ç©ºå•';
            
            const symbolsList = top6Symbols.map(s => 
                `  â€¢ ${s.name}: $${s.price.toFixed(2)} (${s.change >= 0 ? '+' : ''}${s.change}%)`
            ).join('\n');
            
            const confirmMsg = `${emoji} æ‰¹é‡${strategyName}ç­–ç•¥\n\n` +
                `ã€å¸¸ç”¨å¸æ¶¨å¹…å‰6ã€‘\n${symbolsList}\n\n` +
                `ã€å¼€ä»“å‚æ•°ã€‘\n` +
                `  â€¢ æ–¹å‘: ${directionText}\n` +
                `  â€¢ æ æ†: 10x\n` +
                `  â€¢ è®¢å•ç±»å‹: å¸‚ä»·å•\n\n` +
                `ã€èµ„é‡‘åˆ†é…ã€‘\n` +
                `  â€¢ æ¯ä¸ªå¸ä¿è¯é‡‘: ${marginPerCoin} USDT (${percentPerCoin}%)\n` +
                `  â€¢ æ¯ä¸ªå¸åˆçº¦ä»·å€¼: ${contractValuePerCoin} USDT\n` +
                `  â€¢ æ€»ä¿è¯é‡‘: ${totalMargin} USDT\n` +
                `  â€¢ æ€»åˆçº¦ä»·å€¼: ${totalContractValue} USDT\n` +
                `  â€¢ å¯ç”¨ä½™é¢: ${balance.toFixed(2)} USDT\n\n` +
                `ç¡®è®¤æ‰¹é‡å¼€ä»“ï¼Ÿ`;
            
            if (!confirm(confirmMsg)) {
                console.log('[batchOrder] ç”¨æˆ·å–æ¶ˆæ‰¹é‡å¼€ä»“');
                return;
            }
            
            // ğŸ”” å‘é€Telegramé€šçŸ¥ - æ‰¹é‡å¼€ä»“å¼€å§‹
            const startMsg = `${emoji} æ‰¹é‡${strategyName}ç­–ç•¥ - å¼€å§‹æ‰§è¡Œ\n\n` +
                `ã€å¸¸ç”¨å¸æ¶¨å¹…å‰6ã€‘\n${symbolsList}\n\n` +
                `ã€å¼€ä»“å‚æ•°ã€‘\n` +
                `  â€¢ æ–¹å‘: ${directionText}\n` +
                `  â€¢ æ æ†: 10x\n` +
                `  â€¢ è®¢å•ç±»å‹: å¸‚ä»·å•\n\n` +
                `ã€èµ„é‡‘åˆ†é…ã€‘\n` +
                `  â€¢ æ¯ä¸ªå¸ä¿è¯é‡‘: ${marginPerCoin} USDT (${percentPerCoin}%)\n` +
                `  â€¢ æ¯ä¸ªå¸åˆçº¦ä»·å€¼: ${contractValuePerCoin} USDT\n` +
                `  â€¢ æ€»ä¿è¯é‡‘: ${totalMargin} USDT\n` +
                `  â€¢ æ€»åˆçº¦ä»·å€¼: ${totalContractValue} USDT\n` +
                `  â€¢ å¯ç”¨ä½™é¢: ${balance.toFixed(2)} USDT`;
            
            console.log('[batchOrder] ğŸ“¢ å‘é€å¼€å§‹é€šçŸ¥...');
            await sendTelegramMessage(startMsg);
            
            // å¼€å§‹æ‰¹é‡ä¸‹å•
            console.log('[batchOrder] å¼€å§‹æ‰¹é‡ä¸‹å•...');
            let successCount = 0;
            let failCount = 0;
            const results = [];
            
            for (const symbolData of top6Symbols) {
                try {
                    console.log(`[batchOrder] æ­£åœ¨ä¸‹å•: ${symbolData.name}...`);
                    
                    // æ„å»ºè®¢å•æ•°æ®
                    // szä¼ é€’åˆçº¦ä»·å€¼ï¼Œåç«¯ä¼šæ ¹æ®å½“å‰ä»·æ ¼è®¡ç®—åˆçº¦å¼ æ•°
                    const orderData = {
                        instId: symbolData.symbol,
                        side: direction === 'long' ? 'buy' : 'sell',
                        posSide: direction,
                        ordType: 'market',
                        sz: contractValuePerCoin,  // âœ… ä¼ é€’åˆçº¦ä»·å€¼ï¼ˆä¿è¯é‡‘ Ã— æ æ†ï¼‰
                        maxOrderSize: contractValuePerCoin,  // âœ… é£æ§æ£€æŸ¥ä¹Ÿä½¿ç”¨åˆçº¦ä»·å€¼
                        lever: '10'
                    };
                    
                    // å‘é€è®¢å•è¯·æ±‚
                    const response = await fetch('/api/okx-trading/place-order', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            apiKey: account.apiKey,
                            apiSecret: account.apiSecret,
                            passphrase: account.passphrase,
                            ...orderData
                        })
                    });
                    
                    const result = await response.json();
                    
                    if (result.success) {
                        successCount++;
                        results.push(`âœ… ${symbolData.name}: æˆåŠŸ`);
                        console.log(`[batchOrder] ${symbolData.name} ä¸‹å•æˆåŠŸ`);
                    } else {
                        failCount++;
                        results.push(`âŒ ${symbolData.name}: ${result.error || 'å¤±è´¥'}`);
                        console.error(`[batchOrder] ${symbolData.name} ä¸‹å•å¤±è´¥:`, result.error);
                    }
                    
                    // å»¶è¿Ÿ100msï¼Œé¿å…è¯·æ±‚è¿‡å¿«
                    await new Promise(resolve => setTimeout(resolve, 100));
                    
                } catch (error) {
                    failCount++;
                    results.push(`âŒ ${symbolData.name}: ${error.message || 'å¼‚å¸¸'}`);
                    console.error(`[batchOrder] ${symbolData.name} ä¸‹å•å¼‚å¸¸:`, error);
                }
            }
            
            // æ˜¾ç¤ºç»“æœå¹¶å‘é€Telegramé€šçŸ¥
            const resultMsg = `${emoji} æ‰¹é‡å¼€ä»“å®Œæˆ\n\n` +
                `ã€ç»“æœç»Ÿè®¡ã€‘\n` +
                `  â€¢ æˆåŠŸ: ${successCount} ä¸ª\n` +
                `  â€¢ å¤±è´¥: ${failCount} ä¸ª\n\n` +
                `ã€è¯¦ç»†ç»“æœã€‘\n${results.join('\n')}`;
            
            alert(resultMsg);
            console.log('[batchOrder] ğŸ“¢ å‘é€å®Œæˆé€šçŸ¥...');
            await sendTelegramMessage(resultMsg);
            console.log('[batchOrder] âœ… æ‰¹é‡å¼€ä»“å®Œæˆ');
            
            // åˆ·æ–°è´¦æˆ·ä¿¡æ¯å’ŒæŒä»“
            await refreshAccountData();
            await loadPendingOrders();
        }

        // æ‰¹é‡å¼€ä»“ - æ¶¨å¹…å‰8åç­–ç•¥
        async function batchOrderTop8(direction, percentPerCoin, skipConfirm = false) {
            console.log(`[batchOrderTop8] å¼€å§‹æ‰¹é‡å¼€ä»“å‰8: direction=${direction}, percentPerCoin=${percentPerCoin}%, skipConfirm=${skipConfirm}`);
            
            const account = accounts.find(acc => acc.id === currentAccount);
            
            if (!account || !account.apiKey || !account.apiSecret || !account.passphrase) {
                alert('âŒ è¯·å…ˆé…ç½®è´¦æˆ·APIå‡­è¯ï¼');
                return;
            }
            
            // è·å–å¯ç”¨ä½™é¢
            const balance = account.balance || 0;
            if (balance <= 0) {
                alert('âŒ è´¦æˆ·ä½™é¢ä¸è¶³ï¼');
                return;
            }
            
            // åªä»æ”¶è—çš„å¸ç§ä¸­é€‰æ‹©
            const favoriteSymbolsData = symbols.filter(s => favoriteSymbols.includes(s.symbol));
            
            if (favoriteSymbolsData.length === 0) {
                alert('âŒ è¯·å…ˆæ”¶è—ä¸€äº›å¸¸ç”¨å¸ç§ï¼\n\nåœ¨äº¤æ˜“å¯¹åˆ—è¡¨ä¸­ç‚¹å‡»â­æŒ‰é’®æ·»åŠ æ”¶è—ã€‚');
                return;
            }
            
            console.log('[batchOrderTop8] å¸¸ç”¨å¸ç§æ•°é‡:', favoriteSymbolsData.length);
            
            // ä»å¸¸ç”¨å¸ç§ä¸­æŒ‰æ¶¨è·Œå¹…æ’åºï¼Œè·å–å‰8å
            const sortedSymbols = [...favoriteSymbolsData].sort((a, b) => b.change - a.change);
            const top8Symbols = sortedSymbols.slice(0, 8);
            
            if (top8Symbols.length < 8) {
                alert(`âŒ å¸¸ç”¨å¸ç§ä¸è¶³8ä¸ªï¼\n\nå½“å‰å¸¸ç”¨å¸ç§ï¼š${favoriteSymbolsData.length}ä¸ª\nè¯·è‡³å°‘æ”¶è—8ä¸ªå¸ç§æ‰èƒ½ä½¿ç”¨æ­¤ç­–ç•¥ã€‚`);
                return;
            }
            
            console.log('[batchOrderTop8] å¸¸ç”¨å¸ç§æ¶¨å¹…å‰8:', top8Symbols.map(s => `${s.name} (${s.change}%)`));
            
            // è®¡ç®—æ¯ä¸ªå¸çš„ä¿è¯é‡‘å ç”¨ï¼ˆä»è´¦æˆ·é…ç½®è¯»å–ä¸Šé™ï¼‰
            const maxOrderSize = account.maxOrderSize || 5; // å•ç¬”ä¿è¯é‡‘ä¸Šé™ï¼Œé»˜è®¤5 USDT
            const calculatedMargin = balance * percentPerCoin / 100;
            const marginPerCoin = Math.min(calculatedMargin, maxOrderSize).toFixed(2);
            const contractValuePerCoin = (parseFloat(marginPerCoin) * 10).toFixed(2);  // åˆçº¦ä»·å€¼ = ä¿è¯é‡‘ Ã— æ æ†
            const totalMargin = (marginPerCoin * 8).toFixed(2);
            const totalContractValue = (parseFloat(contractValuePerCoin) * 8).toFixed(2);
            
            console.log(`[batchOrderTop8] ğŸ’° ä¿è¯é‡‘è®¡ç®—è¯¦æƒ…:`);
            console.log(`  â€¢ å¯ç”¨ä½™é¢: ${balance.toFixed(2)} USDT`);
            console.log(`  â€¢ ç™¾åˆ†æ¯”: ${percentPerCoin}%`);
            console.log(`  â€¢ è®¡ç®—ä¿è¯é‡‘: ${balance.toFixed(2)} Ã— ${percentPerCoin}% = ${calculatedMargin.toFixed(2)} USDT`);
            console.log(`  â€¢ å•ç¬”ä¿è¯é‡‘ä¸Šé™: ${maxOrderSize} USDT`);
            console.log(`  â€¢ å®é™…ä¿è¯é‡‘: Math.min(${calculatedMargin.toFixed(2)}, ${maxOrderSize}) = ${marginPerCoin} USDT`);
            console.log(`  â€¢ åˆçº¦ä»·å€¼(10x): ${marginPerCoin} Ã— 10 = ${contractValuePerCoin} USDT`);
            console.log(`  â€¢ æ€»ä¿è¯é‡‘: ${marginPerCoin} Ã— 8 = ${totalMargin} USDT`);
            console.log(`  â€¢ æ€»åˆçº¦ä»·å€¼: ${contractValuePerCoin} Ã— 8 = ${totalContractValue} USDT`);
            
            // æ£€æŸ¥ä½™é¢æ˜¯å¦è¶³å¤Ÿ
            const requiredBalance = parseFloat(totalMargin) * 1.2;
            if (balance < requiredBalance) {
                alert(`âŒ ä½™é¢ä¸è¶³ï¼\n\n` +
                    `ã€èµ„é‡‘éœ€æ±‚ã€‘\n` +
                    `  â€¢ æ¯ä¸ªå¸ä¿è¯é‡‘: ${marginPerCoin} USDT (${percentPerCoin}%)\n` +
                    `  â€¢ æ¯ä¸ªå¸åˆçº¦ä»·å€¼: ${contractValuePerCoin} USDT (10xæ æ†)\n` +
                    `  â€¢ 8ä¸ªå¸æ€»ä¿è¯é‡‘: ${totalMargin} USDT\n` +
                    `  â€¢ å»ºè®®ä½™é¢: ${requiredBalance.toFixed(2)} USDT\n\n` +
                    `ã€å½“å‰çŠ¶æ€ã€‘\n` +
                    `  â€¢ å¯ç”¨ä½™é¢: ${balance.toFixed(2)} USDT\n` +
                    `  â€¢ ç¼ºå°‘: ${(requiredBalance - balance).toFixed(2)} USDT`);
                return;
            }
            
            // æ‰‹åŠ¨æ‰¹é‡å¼€ä»“ - ç¡®è®¤å¯¹è¯æ¡†
            const directionText = direction === 'long' ? 'åšå¤š' : 'åšç©º';
            const emoji = direction === 'long' ? 'ğŸ“ˆ' : 'ğŸ“‰';
            const strategyName = direction === 'long' ? 'å¤šå•' : 'ç©ºå•';
            
            const symbolsList = top8Symbols.map(s => 
                `  â€¢ ${s.name}: $${s.price.toFixed(2)} (${s.change >= 0 ? '+' : ''}${s.change}%)`
            ).join('\n');
            
            const confirmMsg = `${emoji} æ¶¨å¹…å‰8æ‰¹é‡${strategyName}ç­–ç•¥\n\n` +
                `ã€å¸¸ç”¨å¸æ¶¨å¹…å‰8ã€‘\n${symbolsList}\n\n` +
                `ã€å¼€ä»“å‚æ•°ã€‘\n` +
                `  â€¢ æ–¹å‘: ${directionText}\n` +
                `  â€¢ æ æ†: 10x\n` +
                `  â€¢ è®¢å•ç±»å‹: å¸‚ä»·å•\n\n` +
                `ã€èµ„é‡‘åˆ†é…ã€‘\n` +
                `  â€¢ æ¯ä¸ªå¸ä¿è¯é‡‘: ${marginPerCoin} USDT (${percentPerCoin}%)\n` +
                `  â€¢ ğŸ”’ å•ç¬”ä¸Šé™: ${maxOrderSize} USDT (è¶…å‡ºæˆªæ–­)\n` +
                `  â€¢ æ¯ä¸ªå¸åˆçº¦ä»·å€¼: ${contractValuePerCoin} USDT\n` +
                `  â€¢ æ€»ä¿è¯é‡‘: ${totalMargin} USDT\n` +
                `  â€¢ æ€»åˆçº¦ä»·å€¼: ${totalContractValue} USDT\n` +
                `  â€¢ å¯ç”¨ä½™é¢: ${balance.toFixed(2)} USDT\n\n` +
                `ç¡®è®¤æ‰¹é‡å¼€ä»“ï¼Ÿ`;
            
            // è‡ªåŠ¨ç­–ç•¥è§¦å‘æ—¶è·³è¿‡ç¡®è®¤å¼¹çª—
            if (!skipConfirm) {
                if (!confirm(confirmMsg)) {
                    console.log('[batchOrderTop8] ç”¨æˆ·å–æ¶ˆæ‰¹é‡å¼€ä»“');
                    return;
                }
            } else {
                console.log('[batchOrderTop8] è‡ªåŠ¨ç­–ç•¥è§¦å‘ï¼Œè·³è¿‡ç¡®è®¤å¼¹çª—');
            }
            
            // ğŸ”” å‘é€Telegramé€šçŸ¥ - æ‰¹é‡å¼€ä»“å¼€å§‹
            const startMsg = `${emoji} æ¶¨å¹…å‰8æ‰¹é‡${strategyName}ç­–ç•¥ - å¼€å§‹æ‰§è¡Œ\n\n` +
                `ã€å¸¸ç”¨å¸æ¶¨å¹…å‰8ã€‘\n${symbolsList}\n\n` +
                `ã€å¼€ä»“å‚æ•°ã€‘\n` +
                `  â€¢ æ–¹å‘: ${directionText}\n` +
                `  â€¢ æ æ†: 10x\n` +
                `  â€¢ è®¢å•ç±»å‹: å¸‚ä»·å•\n\n` +
                `ã€èµ„é‡‘åˆ†é…ã€‘\n` +
                `  â€¢ æ¯ä¸ªå¸ä¿è¯é‡‘: ${marginPerCoin} USDT (${percentPerCoin}%)\n` +
                `  â€¢ ğŸ”’ å•ç¬”ä¸Šé™: ${maxOrderSize} USDT (è¶…å‡ºæˆªæ–­)\n` +
                `  â€¢ æ¯ä¸ªå¸åˆçº¦ä»·å€¼: ${contractValuePerCoin} USDT\n` +
                `  â€¢ æ€»ä¿è¯é‡‘: ${totalMargin} USDT\n` +
                `  â€¢ æ€»åˆçº¦ä»·å€¼: ${totalContractValue} USDT\n` +
                `  â€¢ å¯ç”¨ä½™é¢: ${balance.toFixed(2)} USDT`;
            
            console.log('[batchOrderTop8] ğŸ“¢ å‘é€å¼€å§‹é€šçŸ¥...');
            await sendTelegramMessage(startMsg);
            
            // å¼€å§‹æ‰¹é‡ä¸‹å•
            console.log('[batchOrderTop8] å¼€å§‹æ‰¹é‡ä¸‹å•...');
            let successCount = 0;
            let failCount = 0;
            const results = [];
            
            for (const symbolData of top8Symbols) {
                try {
                    console.log(`[batchOrderTop8] æ­£åœ¨ä¸‹å•: ${symbolData.name}...`);
                    
                    const orderData = {
                        instId: symbolData.symbol,
                        side: direction === 'long' ? 'buy' : 'sell',
                        posSide: direction,
                        ordType: 'market',
                        sz: contractValuePerCoin,  // âœ… ä¼ é€’åˆçº¦ä»·å€¼ï¼ˆä¿è¯é‡‘ Ã— æ æ†ï¼‰
                        maxOrderSize: maxOrderSize * 10,  // âœ… é£æ§æ£€æŸ¥ï¼šä½¿ç”¨è´¦æˆ·é…ç½®çš„maxOrderSize Ã— æ æ†(åˆçº¦ä»·å€¼ä¸Šé™)
                        lever: '10'
                    };
                    
                    const response = await fetch('/api/okx-trading/place-order', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            apiKey: account.apiKey,
                            apiSecret: account.apiSecret,
                            passphrase: account.passphrase,
                            ...orderData
                        })
                    });
                    
                    const result = await response.json();
                    
                    if (result.success) {
                        successCount++;
                        results.push(`âœ… ${symbolData.name}: æˆåŠŸ`);
                        console.log(`[batchOrderTop8] ${symbolData.name} ä¸‹å•æˆåŠŸ`);
                    } else {
                        failCount++;
                        results.push(`âŒ ${symbolData.name}: ${result.message || 'å¤±è´¥'}`);
                        console.error(`[batchOrderTop8] ${symbolData.name} ä¸‹å•å¤±è´¥:`, result);
                    }
                    
                    // å»¶è¿Ÿ100msé¿å…è¯·æ±‚è¿‡å¿«
                    await new Promise(resolve => setTimeout(resolve, 100));
                    
                } catch (error) {
                    failCount++;
                    results.push(`âŒ ${symbolData.name}: ${error.message}`);
                    console.error(`[batchOrderTop8] ${symbolData.name} å¼‚å¸¸:`, error);
                }
            }
            
            // æ˜¾ç¤ºç»“æœå¹¶å‘é€Telegramé€šçŸ¥
            const resultMsg = `${emoji} æ‰¹é‡å¼€ä»“å®Œæˆ\n\n` +
                `æˆåŠŸ: ${successCount}/${top8Symbols.length}\n` +
                `å¤±è´¥: ${failCount}/${top8Symbols.length}\n\n` +
                `è¯¦ç»†ç»“æœ:\n${results.join('\n')}`;
            
            alert(resultMsg);
            console.log('[batchOrderTop8] ğŸ“¢ å‘é€å®Œæˆé€šçŸ¥...');
            await sendTelegramMessage(resultMsg);
            console.log('[batchOrderTop8] âœ… æ‰¹é‡å¼€ä»“å®Œæˆ:', { successCount, failCount });
            
            // åˆ·æ–°æ•°æ®
            await refreshAccountData();
        }

        // æ‰¹é‡å¼€ä»“ - æ¶¨å¹…å8åç­–ç•¥
        async function batchOrderBottom8(direction, percentPerCoin, skipConfirm = false) {
            console.log(`[batchOrderBottom8] å¼€å§‹æ‰¹é‡å¼€ä»“å8: direction=${direction}, percentPerCoin=${percentPerCoin}%, skipConfirm=${skipConfirm}`);
            
            const account = accounts.find(acc => acc.id === currentAccount);
            
            if (!account || !account.apiKey || !account.apiSecret || !account.passphrase) {
                alert('âŒ è¯·å…ˆé…ç½®è´¦æˆ·APIå‡­è¯ï¼');
                return;
            }
            
            // è·å–å¯ç”¨ä½™é¢
            const balance = account.balance || 0;
            if (balance <= 0) {
                alert('âŒ è´¦æˆ·ä½™é¢ä¸è¶³ï¼');
                return;
            }
            
            // åªä»æ”¶è—çš„å¸ç§ä¸­é€‰æ‹©
            const favoriteSymbolsData = symbols.filter(s => favoriteSymbols.includes(s.symbol));
            
            if (favoriteSymbolsData.length === 0) {
                alert('âŒ è¯·å…ˆæ”¶è—ä¸€äº›å¸¸ç”¨å¸ç§ï¼\n\nåœ¨äº¤æ˜“å¯¹åˆ—è¡¨ä¸­ç‚¹å‡»â­æŒ‰é’®æ·»åŠ æ”¶è—ã€‚');
                return;
            }
            
            console.log('[batchOrderBottom8] å¸¸ç”¨å¸ç§æ•°é‡:', favoriteSymbolsData.length);
            
            // ä»å¸¸ç”¨å¸ç§ä¸­æŒ‰æ¶¨è·Œå¹…æ’åºï¼Œè·å–å8åï¼ˆè·Œå¹…æœ€å¤§ï¼‰
            const sortedSymbols = [...favoriteSymbolsData].sort((a, b) => a.change - b.change);
            const bottom8Symbols = sortedSymbols.slice(0, 8);
            
            if (bottom8Symbols.length < 8) {
                alert(`âŒ å¸¸ç”¨å¸ç§ä¸è¶³8ä¸ªï¼\n\nå½“å‰å¸¸ç”¨å¸ç§ï¼š${favoriteSymbolsData.length}ä¸ª\nè¯·è‡³å°‘æ”¶è—8ä¸ªå¸ç§æ‰èƒ½ä½¿ç”¨æ­¤ç­–ç•¥ã€‚`);
                return;
            }
            
            console.log('[batchOrderBottom8] å¸¸ç”¨å¸ç§æ¶¨å¹…å8:', bottom8Symbols.map(s => `${s.name} (${s.change}%)`));
            
            // è®¡ç®—æ¯ä¸ªå¸çš„ä¿è¯é‡‘å ç”¨ï¼ˆä»è´¦æˆ·é…ç½®è¯»å–ä¸Šé™ï¼‰
            const maxOrderSize = account.maxOrderSize || 5; // å•ç¬”ä¿è¯é‡‘ä¸Šé™ï¼Œé»˜è®¤5 USDT
            const calculatedMargin = balance * percentPerCoin / 100;
            const marginPerCoin = Math.min(calculatedMargin, maxOrderSize).toFixed(2);
            const contractValuePerCoin = (parseFloat(marginPerCoin) * 10).toFixed(2);  // åˆçº¦ä»·å€¼ = ä¿è¯é‡‘ Ã— æ æ†
            const totalMargin = (marginPerCoin * 8).toFixed(2);
            const totalContractValue = (parseFloat(contractValuePerCoin) * 8).toFixed(2);
            
            console.log(`[batchOrderBottom8] ğŸ’° ä¿è¯é‡‘è®¡ç®—è¯¦æƒ…:`);
            console.log(`  â€¢ å¯ç”¨ä½™é¢: ${balance.toFixed(2)} USDT`);
            console.log(`  â€¢ ç™¾åˆ†æ¯”: ${percentPerCoin}%`);
            console.log(`  â€¢ è®¡ç®—ä¿è¯é‡‘: ${balance.toFixed(2)} Ã— ${percentPerCoin}% = ${calculatedMargin.toFixed(2)} USDT`);
            console.log(`  â€¢ å•ç¬”ä¿è¯é‡‘ä¸Šé™: ${maxOrderSize} USDT`);
            console.log(`  â€¢ å®é™…ä¿è¯é‡‘: Math.min(${calculatedMargin.toFixed(2)}, ${maxOrderSize}) = ${marginPerCoin} USDT`);
            console.log(`  â€¢ åˆçº¦ä»·å€¼(10x): ${marginPerCoin} Ã— 10 = ${contractValuePerCoin} USDT`);
            console.log(`  â€¢ æ€»ä¿è¯é‡‘: ${marginPerCoin} Ã— 8 = ${totalMargin} USDT`);
            console.log(`  â€¢ æ€»åˆçº¦ä»·å€¼: ${contractValuePerCoin} Ã— 8 = ${totalContractValue} USDT`);
            
            // æ£€æŸ¥ä½™é¢æ˜¯å¦è¶³å¤Ÿ
            const requiredBalance = parseFloat(totalMargin) * 1.2;
            if (balance < requiredBalance) {
                alert(`âŒ ä½™é¢ä¸è¶³ï¼\n\n` +
                    `ã€èµ„é‡‘éœ€æ±‚ã€‘\n` +
                    `  â€¢ æ¯ä¸ªå¸ä¿è¯é‡‘: ${marginPerCoin} USDT (${percentPerCoin}%)\n` +
                    `  â€¢ æ¯ä¸ªå¸åˆçº¦ä»·å€¼: ${contractValuePerCoin} USDT (10xæ æ†)\n` +
                    `  â€¢ 8ä¸ªå¸æ€»ä¿è¯é‡‘: ${totalMargin} USDT\n` +
                    `  â€¢ å»ºè®®ä½™é¢: ${requiredBalance.toFixed(2)} USDT\n\n` +
                    `ã€å½“å‰çŠ¶æ€ã€‘\n` +
                    `  â€¢ å¯ç”¨ä½™é¢: ${balance.toFixed(2)} USDT\n` +
                    `  â€¢ ç¼ºå°‘: ${(requiredBalance - balance).toFixed(2)} USDT`);
                return;
            }
            
            // é£é™©è­¦å‘Šï¼ˆæ‰‹åŠ¨æ‰§è¡Œéœ€è¦ç¡®è®¤ï¼Œè‡ªåŠ¨ç­–ç•¥è·³è¿‡ï¼‰
            const riskWarning = `âš ï¸ é«˜é£é™©ç­–ç•¥è­¦å‘Š\n\n` +
                `æ­¤ç­–ç•¥é’ˆå¯¹è·Œå¹…æœ€å¤§çš„å¸ç§ï¼Œæ³¢åŠ¨æ€§æé«˜ï¼\n\n` +
                `ã€æ¶¨å¹…å8å = è·Œå¹…æœ€å¤§ã€‘\n` +
                bottom8Symbols.map(s => 
                    `  â€¢ ${s.name}: ${s.change >= 0 ? '+' : ''}${s.change}%`
                ).join('\n') + '\n\n' +
                `âš ï¸ è¿™äº›å¸ç§å¯èƒ½ï¼š\n` +
                `  â€¢ ç»§ç»­ä¸‹è·Œï¼ˆç©ºå•è·åˆ©ï¼‰\n` +
                `  â€¢ è¶…è·Œåå¼¹ï¼ˆå¤šå•è·åˆ©ï¼‰\n` +
                `  â€¢ å‰§çƒˆæ³¢åŠ¨ï¼ˆé«˜é£é™©ï¼‰\n\n` +
                `ç¡®å®šè¦ç»§ç»­å—ï¼Ÿ`;
            
            if (!skipConfirm) {
                if (!confirm(riskWarning)) {
                    console.log('[batchOrderBottom8] ç”¨æˆ·å–æ¶ˆï¼ˆé£é™©è­¦å‘Šï¼‰');
                    return;
                }
            } else {
                console.log('[batchOrderBottom8] è‡ªåŠ¨ç­–ç•¥è§¦å‘ï¼Œè·³è¿‡é£é™©è­¦å‘Š');
            }
            
            // ç¡®è®¤å¯¹è¯æ¡†
            const directionText = direction === 'long' ? 'åšå¤šï¼ˆé¢„æœŸåå¼¹ï¼‰' : 'åšç©ºï¼ˆé¢„æœŸå»¶ç»­ï¼‰';
            const emoji = direction === 'long' ? 'ğŸ“ˆ' : 'ğŸ“‰';
            const strategyName = direction === 'long' ? 'å¤šå•' : 'ç©ºå•';
            
            const symbolsList = bottom8Symbols.map(s => 
                `  â€¢ ${s.name}: $${s.price.toFixed(2)} (${s.change >= 0 ? '+' : ''}${s.change}%)`
            ).join('\n');
            
            const confirmMsg = `${emoji} æ¶¨å¹…å8æ‰¹é‡${strategyName}ç­–ç•¥\n\n` +
                `ã€å¸¸ç”¨å¸æ¶¨å¹…å8ï¼ˆè·Œå¹…æœ€å¤§ï¼‰ã€‘\n${symbolsList}\n\n` +
                `ã€å¼€ä»“å‚æ•°ã€‘\n` +
                `  â€¢ æ–¹å‘: ${directionText}\n` +
                `  â€¢ æ æ†: 10x\n` +
                `  â€¢ è®¢å•ç±»å‹: å¸‚ä»·å•\n\n` +
                `ã€èµ„é‡‘åˆ†é…ã€‘\n` +
                `  â€¢ æ¯ä¸ªå¸ä¿è¯é‡‘: ${marginPerCoin} USDT (${percentPerCoin}%)\n` +
                `  â€¢ ğŸ”’ å•ç¬”ä¸Šé™: ${maxOrderSize} USDT (è¶…å‡ºæˆªæ–­)\n` +
                `  â€¢ æ¯ä¸ªå¸åˆçº¦ä»·å€¼: ${contractValuePerCoin} USDT\n` +
                `  â€¢ æ€»ä¿è¯é‡‘: ${totalMargin} USDT\n` +
                `  â€¢ æ€»åˆçº¦ä»·å€¼: ${totalContractValue} USDT\n` +
                `  â€¢ å¯ç”¨ä½™é¢: ${balance.toFixed(2)} USDT\n\n` +
                `âš ï¸ æœ€åç¡®è®¤ï¼šè¿™æ˜¯é«˜é£é™©ç­–ç•¥ï¼`;
            
            if (!skipConfirm) {
                if (!confirm(confirmMsg)) {
                    console.log('[batchOrderBottom8] ç”¨æˆ·å–æ¶ˆæ‰¹é‡å¼€ä»“');
                    return;
                }
            } else {
                console.log('[batchOrderBottom8] è‡ªåŠ¨ç­–ç•¥è§¦å‘ï¼Œè·³è¿‡ç¡®è®¤å¼¹çª—');
            }
            
            // ğŸ”” å‘é€Telegramé€šçŸ¥ - æ‰¹é‡å¼€ä»“å¼€å§‹
            const startMsg = `${emoji} æ¶¨å¹…å8æ‰¹é‡${strategyName}ç­–ç•¥ - å¼€å§‹æ‰§è¡Œ\n\n` +
                `ã€å¸¸ç”¨å¸æ¶¨å¹…å8ï¼ˆè·Œå¹…æœ€å¤§ï¼‰ã€‘\n${symbolsList}\n\n` +
                `ã€å¼€ä»“å‚æ•°ã€‘\n` +
                `  â€¢ æ–¹å‘: ${directionText}\n` +
                `  â€¢ æ æ†: 10x\n` +
                `  â€¢ è®¢å•ç±»å‹: å¸‚ä»·å•\n\n` +
                `ã€èµ„é‡‘åˆ†é…ã€‘\n` +
                `  â€¢ æ¯ä¸ªå¸ä¿è¯é‡‘: ${marginPerCoin} USDT (${percentPerCoin}%)\n` +
                `  â€¢ æ¯ä¸ªå¸åˆçº¦ä»·å€¼: ${contractValuePerCoin} USDT\n` +
                `  â€¢ æ€»ä¿è¯é‡‘: ${totalMargin} USDT\n` +
                `  â€¢ æ€»åˆçº¦ä»·å€¼: ${totalContractValue} USDT\n` +
                `  â€¢ å¯ç”¨ä½™é¢: ${balance.toFixed(2)} USDT\n\n` +
                `âš ï¸ æ³¨æ„ï¼šè¿™æ˜¯é«˜é£é™©ç­–ç•¥ï¼`;
            
            console.log('[batchOrderBottom8] ğŸ“¢ å‘é€å¼€å§‹é€šçŸ¥...');
            await sendTelegramMessage(startMsg);
            
            // å¼€å§‹æ‰¹é‡ä¸‹å•
            console.log('[batchOrderBottom8] å¼€å§‹æ‰¹é‡ä¸‹å•...');
            let successCount = 0;
            let failCount = 0;
            const results = [];
            
            for (const symbolData of bottom8Symbols) {
                try {
                    console.log(`[batchOrderBottom8] æ­£åœ¨ä¸‹å•: ${symbolData.name}...`);
                    
                    const orderData = {
                        instId: symbolData.symbol,
                        side: direction === 'long' ? 'buy' : 'sell',
                        posSide: direction,
                        ordType: 'market',
                        sz: contractValuePerCoin,  // âœ… ä¼ é€’åˆçº¦ä»·å€¼ï¼ˆä¿è¯é‡‘ Ã— æ æ†ï¼‰
                        maxOrderSize: maxOrderSize * 10,  // âœ… é£æ§æ£€æŸ¥ï¼šä½¿ç”¨è´¦æˆ·é…ç½®çš„maxOrderSize Ã— æ æ†(åˆçº¦ä»·å€¼ä¸Šé™)
                        lever: '10'
                    };
                    
                    const response = await fetch('/api/okx-trading/place-order', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            apiKey: account.apiKey,
                            apiSecret: account.apiSecret,
                            passphrase: account.passphrase,
                            ...orderData
                        })
                    });
                    
                    const result = await response.json();
                    
                    if (result.success) {
                        successCount++;
                        results.push(`âœ… ${symbolData.name}: æˆåŠŸ`);
                        console.log(`[batchOrderBottom8] ${symbolData.name} ä¸‹å•æˆåŠŸ`);
                    } else {
                        failCount++;
                        results.push(`âŒ ${symbolData.name}: ${result.message || 'å¤±è´¥'}`);
                        console.error(`[batchOrderBottom8] ${symbolData.name} ä¸‹å•å¤±è´¥:`, result);
                    }
                    
                    // å»¶è¿Ÿ100msé¿å…è¯·æ±‚è¿‡å¿«
                    await new Promise(resolve => setTimeout(resolve, 100));
                    
                } catch (error) {
                    failCount++;
                    results.push(`âŒ ${symbolData.name}: ${error.message}`);
                    console.error(`[batchOrderBottom8] ${symbolData.name} å¼‚å¸¸:`, error);
                }
            }
            
            // æ˜¾ç¤ºç»“æœå¹¶å‘é€Telegramé€šçŸ¥
            const resultMsg = `${emoji} æ‰¹é‡å¼€ä»“å®Œæˆ\n\n` +
                `æˆåŠŸ: ${successCount}/${bottom8Symbols.length}\n` +
                `å¤±è´¥: ${failCount}/${bottom8Symbols.length}\n\n` +
                `è¯¦ç»†ç»“æœ:\n${results.join('\n')}`;
            
            alert(resultMsg);
            console.log('[batchOrderBottom8] ğŸ“¢ å‘é€å®Œæˆé€šçŸ¥...');
            await sendTelegramMessage(resultMsg);
            console.log('[batchOrderBottom8] âœ… æ‰¹é‡å¼€ä»“å®Œæˆ:', { successCount, failCount });
            
            // åˆ·æ–°æ•°æ®
            await refreshAccountData();
        }

        // ä¸€é”®å…¨å¹³æ‰€æœ‰è´¦æˆ·çš„æ‰€æœ‰æŒä»“
        async function closeAllAccountsPositions() {
            console.log('[closeAllAccountsPositions] å¼€å§‹ä¸€é”®å…¨å¹³æ‰€æœ‰è´¦æˆ·æŒä»“');
            
            // è·å–æ‰€æœ‰è´¦æˆ·
            if (!accounts || accounts.length === 0) {
                alert('âŒ æ²¡æœ‰æ‰¾åˆ°ä»»ä½•è´¦æˆ·ï¼\n\nè¯·å…ˆåœ¨è´¦æˆ·ç®¡ç†ä¸­æ·»åŠ è´¦æˆ·ã€‚');
                return;
            }
            
            // ç­›é€‰å‡ºæœ‰APIå‡­è¯çš„è´¦æˆ·
            const validAccounts = accounts.filter(acc => 
                acc.apiKey && acc.apiSecret && acc.passphrase
            );
            
            if (validAccounts.length === 0) {
                alert('âŒ æ²¡æœ‰é…ç½®å®Œæ•´APIå‡­è¯çš„è´¦æˆ·ï¼\n\nè¯·åœ¨è´¦æˆ·ç®¡ç†ä¸­å®Œå–„è´¦æˆ·çš„APIé…ç½®ï¼š\n- API Key\n- API Secret\n- Passphrase');
                return;
            }
            
            console.log(`[closeAllAccountsPositions] æ‰¾åˆ° ${validAccounts.length} ä¸ªæœ‰æ•ˆè´¦æˆ·`);
            
            // ç›´æ¥æ‰§è¡Œå¹³ä»“ï¼Œä¸éœ€è¦ç¡®è®¤
            console.log('[closeAllAccountsPositions] ç›´æ¥æ‰§è¡Œä¸€é”®å¹³ä»“ï¼Œæ— éœ€ç¡®è®¤');
            
            // æ”¶é›†æ‰€æœ‰è´¦æˆ·çš„æ‰€æœ‰æŒä»“
            let totalPositionsCount = 0;
            let totalSuccess = 0;
            let totalFail = 0;
            const accountResults = [];
            
            for (const account of validAccounts) {
                console.log(`[closeAllAccountsPositions] å¤„ç†è´¦æˆ·: ${account.name || account.id}`);
                
                try {
                    // è·å–è´¦æˆ·æŒä»“
                    const response = await fetch('/api/okx-trading/positions', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            apiKey: account.apiKey,
                            apiSecret: account.apiSecret,
                            passphrase: account.passphrase
                        })
                    });
                    
                    const result = await response.json();
                    
                    if (!result.success || !result.data) {
                        console.error(`[closeAllAccountsPositions] è´¦æˆ· ${account.name} è·å–æŒä»“å¤±è´¥:`, result.error);
                        accountResults.push({
                            account: account.name || account.id,
                            success: 0,
                            fail: 0,
                            error: result.error || 'è·å–æŒä»“å¤±è´¥'
                        });
                        continue;
                    }
                    
                    const positions = result.data;
                    console.log(`[closeAllAccountsPositions] è´¦æˆ· ${account.name} æœ‰ ${positions.length} ä¸ªæŒä»“`);
                    
                    if (positions.length === 0) {
                        accountResults.push({
                            account: account.name || account.id,
                            success: 0,
                            fail: 0,
                            message: 'æ— æŒä»“'
                        });
                        continue;
                    }
                    
                    totalPositionsCount += positions.length;
                    
                    // é€ä¸ªå¹³ä»“
                    let accountSuccess = 0;
                    let accountFail = 0;
                    
                    for (const position of positions) {
                        try {
                            const coinName = position.instId.replace('-USDT-SWAP', '');
                            console.log(`[closeAllAccountsPositions] å¹³ä»“ ${account.name} - ${coinName} ${position.posSide}...`);
                            
                            const closeResponse = await fetch('/api/okx-trading/close-position', {
                                method: 'POST',
                                headers: { 'Content-Type': 'application/json' },
                                body: JSON.stringify({
                                    apiKey: account.apiKey,
                                    apiSecret: account.apiSecret,
                                    passphrase: account.passphrase,
                                    instId: position.instId,
                                    posSide: position.posSide,
                                    closeSize: position.posSize
                                })
                            });
                            
                            const closeResult = await closeResponse.json();
                            
                            if (closeResult.success) {
                                accountSuccess++;
                                totalSuccess++;
                                console.log(`[closeAllAccountsPositions] âœ… ${coinName} å¹³ä»“æˆåŠŸ`);
                            } else {
                                accountFail++;
                                totalFail++;
                                console.error(`[closeAllAccountsPositions] âŒ ${coinName} å¹³ä»“å¤±è´¥:`, closeResult.error);
                            }
                            
                            // æ·»åŠ å°å»¶è¿Ÿé¿å…è¯·æ±‚è¿‡å¿«
                            await new Promise(resolve => setTimeout(resolve, 200));
                            
                        } catch (error) {
                            accountFail++;
                            totalFail++;
                            console.error(`[closeAllAccountsPositions] å¹³ä»“å¼‚å¸¸:`, error);
                        }
                    }
                    
                    accountResults.push({
                        account: account.name || account.id,
                        success: accountSuccess,
                        fail: accountFail,
                        total: positions.length
                    });
                    
                    // è´¦æˆ·ä¹‹é—´æ·»åŠ 1ç§’å»¶è¿Ÿï¼Œé¿å…APIå†²çª
                    console.log(`[closeAllAccountsPositions] è´¦æˆ· ${account.name} å¤„ç†å®Œæˆï¼Œç­‰å¾…1ç§’åå¤„ç†ä¸‹ä¸€ä¸ªè´¦æˆ·...`);
                    await new Promise(resolve => setTimeout(resolve, 1000));
                    
                } catch (error) {
                    console.error(`[closeAllAccountsPositions] è´¦æˆ· ${account.name} å¤„ç†å¼‚å¸¸:`, error);
                    accountResults.push({
                        account: account.name || account.id,
                        success: 0,
                        fail: 0,
                        error: error.message || 'å¤„ç†å¼‚å¸¸'
                    });
                    
                    // å³ä½¿å‡ºé”™ä¹Ÿæ·»åŠ å»¶è¿Ÿ
                    await new Promise(resolve => setTimeout(resolve, 1000));
                }
            }
            
            // æ˜¾ç¤ºç»“æœ
            const resultLines = accountResults.map(r => {
                if (r.error) {
                    return `  âŒ ${r.account}: ${r.error}`;
                } else if (r.message) {
                    return `  âšª ${r.account}: ${r.message}`;
                } else {
                    const emoji = r.fail === 0 ? 'âœ…' : (r.success > 0 ? 'âš ï¸' : 'âŒ');
                    return `  ${emoji} ${r.account}: æˆåŠŸ${r.success}/${r.total}`;
                }
            }).join('\n');
            
            const resultMsg = `ğŸš¨ ä¸€é”®å…¨å¹³å®Œæˆ\n\n` +
                `ã€æ€»è®¡ã€‘\n` +
                `  â€¢ å¤„ç†è´¦æˆ·: ${validAccounts.length} ä¸ª\n` +
                `  â€¢ æ€»æŒä»“æ•°: ${totalPositionsCount} ä¸ª\n` +
                `  â€¢ æˆåŠŸå¹³ä»“: ${totalSuccess} ä¸ª\n` +
                `  â€¢ å¤±è´¥: ${totalFail} ä¸ª\n\n` +
                `ã€å„è´¦æˆ·è¯¦æƒ…ã€‘\n${resultLines}`;
            
            alert(resultMsg);
            
            // å‘é€Telegramé€šçŸ¥
            try {
                const tgResponse = await fetch('/api/telegram/send-message', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        message: resultMsg
                    })
                });
                const tgResult = await tgResponse.json();
                if (tgResult.success) {
                    console.log('âœ… Telegramé€šçŸ¥å·²å‘é€');
                } else {
                    console.warn('âš ï¸ Telegramé€šçŸ¥å‘é€å¤±è´¥:', tgResult.error);
                }
            } catch (e) {
                console.error('âŒ å‘é€Telegramé€šçŸ¥å¼‚å¸¸:', e);
            }
            
            // åˆ·æ–°å½“å‰è´¦æˆ·æ•°æ®
            await refreshAccountData();
            await loadPendingOrders();
            
            console.log('[closeAllAccountsPositions] ä¸€é”®å…¨å¹³å®Œæˆ');
        }

        // æ‰¹é‡å¹³ä»“å‡½æ•°
        async function batchClosePositions(posSide, ratio) {
            console.log(`========== [batchClosePositions] å¼€å§‹æ‰¹é‡å¹³ä»“ ==========`);
            console.log(`[batchClosePositions] å‚æ•°: posSide=${posSide}, ratio=${ratio}`);
            console.log(`[batchClosePositions] å…¨å±€å˜é‡ currentAccount=${currentAccount}`);
            console.log(`[batchClosePositions] å…¨å±€å˜é‡ accounts=`, accounts);
            console.log(`[batchClosePositions] accounts é•¿åº¦=${accounts.length}`);
            
            // è·å–å½“å‰è´¦æˆ·
            const account = accounts.find(acc => acc.id === currentAccount);
            console.log(`[batchClosePositions] æŸ¥æ‰¾è´¦æˆ·: currentAccount=${currentAccount}`);
            console.log(`[batchClosePositions] æ‰¾åˆ°çš„è´¦æˆ·=`, account);
            
            if (!account) {
                const availableAccounts = accounts.map(a => `${a.name}(${a.id})`).join(', ');
                alert(`âŒ æœªæ‰¾åˆ°è´¦æˆ·ï¼\n\nå½“å‰è´¦æˆ·ID: ${currentAccount}\nå¯ç”¨è´¦æˆ·: ${availableAccounts}\n\nè¯·åœ¨è´¦æˆ·ç®¡ç†ä¸­æ£€æŸ¥è´¦æˆ·é…ç½®ã€‚`);
                console.error(`[batchClosePositions] é”™è¯¯: æœªæ‰¾åˆ°è´¦æˆ· currentAccount=${currentAccount}`);
                return;
            }
            
            console.log(`[batchClosePositions] âœ… æˆåŠŸæ‰¾åˆ°è´¦æˆ·: ${account.name} (${account.id})`);
            console.log(`[batchClosePositions] APIå‡­è¯æ£€æŸ¥: hasApiKey=${!!account.apiKey}, hasApiSecret=${!!account.apiSecret}, hasPassphrase=${!!account.passphrase}`);
            
            if (!account.apiKey || !account.apiSecret || !account.passphrase) {
                alert(`âŒ è´¦æˆ· "${account.name || account.id}" æœªé…ç½®APIå‡­è¯ï¼\n\nè¯·åœ¨è´¦æˆ·ç®¡ç†ä¸­å®Œå–„APIé…ç½®ï¼š\n- API Key\n- API Secret\n- Passphrase`);
                console.error(`[batchClosePositions] é”™è¯¯: è´¦æˆ·å‡­è¯ä¸å®Œæ•´`);
                return;
            }
            
            // è·å–å½“å‰æŒä»“
            try {
                console.log(`[batchClosePositions] å‡†å¤‡è°ƒç”¨APIè·å–æŒä»“...`);
                console.log(`[batchClosePositions] APIè¯·æ±‚å‚æ•°:`, {
                    apiKey: account.apiKey.substring(0, 8) + '...',
                    hasApiSecret: !!account.apiSecret,
                    hasPassphrase: !!account.passphrase
                });
                
                const response = await fetch('/api/okx-trading/positions', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        apiKey: account.apiKey,
                        apiSecret: account.apiSecret,
                        passphrase: account.passphrase
                    })
                });
                
                console.log(`[batchClosePositions] APIå“åº”çŠ¶æ€: ${response.status}`);
                
                const result = await response.json();
                console.log(`[batchClosePositions] APIå“åº”æ•°æ®:`, result);
                
                if (!result.success || !result.data) {
                    console.error(`[batchClosePositions] APIè¿”å›å¤±è´¥:`, result);
                    alert(`âŒ è·å–æŒä»“å¤±è´¥: ${result.error || 'æœªçŸ¥é”™è¯¯'}`);
                    return;
                }
                
                console.log(`[batchClosePositions] è·å–åˆ°æŒä»“æ•°é‡: ${result.data.length}`);
                console.log(`[batchClosePositions] å…¨éƒ¨æŒä»“:`, result.data.map(p => ({
                    instId: p.instId,
                    posSide: p.posSide,
                    posSize: p.posSize
                })));
                
                // ç­›é€‰å‡ºæŒ‡å®šæ–¹å‘çš„æŒä»“
                // æ”¯æŒä¸¤ç§æŒä»“æ¨¡å¼ï¼š
                // 1. åŒå‘æŒä»“æ¨¡å¼ï¼šposSide = 'long' æˆ– 'short'
                // 2. å•å‘æŒä»“æ¨¡å¼ï¼šposSide = 'net'ï¼Œé€šè¿‡posSizeæ­£è´Ÿåˆ¤æ–­æ–¹å‘
                const targetPositions = result.data.filter(pos => {
                    if (pos.posSide === posSide) {
                        // åŒå‘æŒä»“æ¨¡å¼ï¼šç›´æ¥åŒ¹é…posSide
                        return true;
                    } else if (pos.posSide === 'net') {
                        // å•å‘æŒä»“æ¨¡å¼ï¼šé€šè¿‡posSizeæ­£è´Ÿåˆ¤æ–­
                        if (posSide === 'long' && pos.posSize > 0) {
                            return true;  // å¤šå•ï¼šposSize > 0
                        } else if (posSide === 'short' && pos.posSize < 0) {
                            return true;  // ç©ºå•ï¼šposSize < 0
                        }
                    }
                    return false;
                });
                console.log(`[batchClosePositions] ç­›é€‰ posSide=${posSide} åçš„æŒä»“æ•°é‡: ${targetPositions.length}`);
                
                if (targetPositions.length === 0) {
                    const directionText = posSide === 'long' ? 'å¤šå•' : 'ç©ºå•';
                    console.warn(`[batchClosePositions] æ²¡æœ‰æ‰¾åˆ°${directionText}æŒä»“`);
                    alert(`âš ï¸ å½“å‰æ²¡æœ‰${directionText}æŒä»“ï¼`);
                    return;
                }
                
                console.log(`[batchClosePositions] æ‰¾åˆ° ${targetPositions.length} ä¸ª${posSide}æŒä»“`);
                
                // æ„å»ºç¡®è®¤ä¿¡æ¯
                const directionText = posSide === 'long' ? 'å¤šå•' : 'ç©ºå•';
                const ratioText = ratio === 1 ? 'å…¨éƒ¨' : 'ä¸€åŠ';
                const emoji = posSide === 'long' ? 'ğŸ“‰' : 'ğŸ“ˆ';
                
                const positionsList = targetPositions.map(pos => {
                    // å•å‘æŒä»“æ¨¡å¼ä¸‹ç©ºå•çš„posSizeæ˜¯è´Ÿæ•°ï¼Œéœ€è¦å–ç»å¯¹å€¼
                    const absSize = Math.abs(pos.posSize);
                    const closeSize = ratio === 1 ? absSize : Math.floor(absSize / 2);
                    const unrealizedPnl = pos.unrealizedPnl || 0;
                    const pnlColor = unrealizedPnl >= 0 ? 'ğŸŸ¢' : 'ğŸ”´';
                    return `  ${pnlColor} ${pos.instId.replace('-USDT-SWAP', '')}: ${closeSize}å¼  (ç›ˆäº: ${unrealizedPnl >= 0 ? '+' : ''}${unrealizedPnl.toFixed(2)} USDT)`;
                }).join('\n');
                
                const totalUnrealizedPnl = targetPositions.reduce((sum, pos) => sum + (pos.unrealizedPnl || 0), 0);
                const totalMargin = targetPositions.reduce((sum, pos) => sum + (pos.margin || 0), 0);
                
                const confirmMsg = `${emoji} æ‰¹é‡å¹³${ratioText}${directionText}\n\n` +
                    `ã€æŒä»“åˆ—è¡¨ã€‘\n${positionsList}\n\n` +
                    `ã€ç»Ÿè®¡ä¿¡æ¯ã€‘\n` +
                    `  â€¢ æŒä»“æ•°é‡: ${targetPositions.length} ä¸ª\n` +
                    `  â€¢ æ€»ä¿è¯é‡‘: ${totalMargin.toFixed(2)} USDT\n` +
                    `  â€¢ æ€»æµ®åŠ¨ç›ˆäº: ${totalUnrealizedPnl >= 0 ? '+' : ''}${totalUnrealizedPnl.toFixed(2)} USDT\n` +
                    `  â€¢ å¹³ä»“æ¯”ä¾‹: ${ratio === 1 ? '100%' : '50%'}\n\n` +
                    `ç¡®è®¤æ‰¹é‡å¹³ä»“ï¼Ÿ`;
                
                // ä½¿ç”¨è‡ªå®šä¹‰ç¡®è®¤å¯¹è¯æ¡†
                const confirmed = await showConfirmDialog(confirmMsg, 'ğŸ”” æ‰¹é‡å¹³ä»“ç¡®è®¤');
                if (!confirmed) {
                    console.log('[batchClosePositions] ç”¨æˆ·å–æ¶ˆæ‰¹é‡å¹³ä»“');
                    return;
                }
                
                // å¼€å§‹æ‰¹é‡å¹³ä»“
                console.log('[batchClosePositions] å¼€å§‹æ‰¹é‡å¹³ä»“...');
                let successCount = 0;
                let failCount = 0;
                const results = [];
                
                for (const position of targetPositions) {
                    try {
                        const coinName = position.instId.replace('-USDT-SWAP', '');
                        console.log(`[batchClosePositions] æ­£åœ¨å¹³ä»“: ${coinName}...`);
                        
                        // è®¡ç®—å¹³ä»“æ•°é‡
                        // æ³¨æ„ï¼šå•å‘æŒä»“æ¨¡å¼ä¸‹ï¼Œç©ºå•çš„posSizeæ˜¯è´Ÿæ•°
                        let closeSize = Math.abs(position.posSize);  // å–ç»å¯¹å€¼
                        
                        if (ratio !== 1) {
                            // ğŸ”§ ä¿®å¤ï¼šæŒä»“æœ¬èº« < 1 å¼ æ—¶ï¼Œä¸æ”¯æŒå¹³ä¸€åŠ
                            // OKXæœ€å°ä¸‹å•æ•°é‡é€šå¸¸æ˜¯1å¼ ï¼Œå°æ•°æŒä»“åªèƒ½å…¨å¹³
                            if (closeSize < 1) {
                                // è®¾ç½®ä¸ºnullï¼Œåç«¯ä¼šè°ƒç”¨å…¨å¹³æ¥å£
                                closeSize = null;
                                console.log(`[å¹³åŠä»“ä¿®å¤] ${position.instId} æŒä»“å°äº1å¼ (${closeSize}å¼ )ï¼Œæ”¹ä¸ºå…¨å¹³`);
                            } else {
                                // æŒä»“ >= 1 å¼ æ—¶ï¼Œæ‰æ‰§è¡Œå¹³ä¸€åŠé€»è¾‘
                                closeSize = Math.floor(closeSize / 2);
                                // è‡³å°‘å¹³1å¼ 
                                if (closeSize < 1) {
                                    closeSize = 1;
                                }
                            }
                        }
                        
                        // è°ƒç”¨å¹³ä»“API
                        const closeResponse = await fetch('/api/okx-trading/close-position', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                apiKey: account.apiKey,
                                apiSecret: account.apiSecret,
                                passphrase: account.passphrase,
                                instId: position.instId,
                                posSide: position.posSide,
                                closeSize: closeSize  // æŒ‡å®šå¹³ä»“æ•°é‡
                            })
                        });
                        
                        const closeResult = await closeResponse.json();
                        
                        if (closeResult.success) {
                            successCount++;
                            const pnl = position.unrealizedPnl || 0;
                            results.push(`âœ… ${coinName}: ${closeSize}å¼  (${pnl >= 0 ? '+' : ''}${pnl.toFixed(2)} USDT)`);
                            console.log(`[batchClosePositions] ${coinName} å¹³ä»“æˆåŠŸ`);
                        } else {
                            failCount++;
                            results.push(`âŒ ${coinName}: ${closeResult.error || 'å¤±è´¥'}`);
                            console.error(`[batchClosePositions] ${coinName} å¹³ä»“å¤±è´¥:`, closeResult.error);
                        }
                        
                        // å»¶è¿Ÿ100msï¼Œé¿å…è¯·æ±‚è¿‡å¿«
                        await new Promise(resolve => setTimeout(resolve, 100));
                        
                    } catch (error) {
                        failCount++;
                        const coinName = position.instId.replace('-USDT-SWAP', '');
                        results.push(`âŒ ${coinName}: ${error.message || 'å¼‚å¸¸'}`);
                        console.error(`[batchClosePositions] ${coinName} å¹³ä»“å¼‚å¸¸:`, error);
                    }
                }
                
                // æ˜¾ç¤ºç»“æœ
                const resultMsg = `${emoji} æ‰¹é‡å¹³ä»“å®Œæˆ\n\n` +
                    `ã€ç»“æœç»Ÿè®¡ã€‘\n` +
                    `  â€¢ æˆåŠŸ: ${successCount} ä¸ª\n` +
                    `  â€¢ å¤±è´¥: ${failCount} ä¸ª\n\n` +
                    `ã€è¯¦ç»†ç»“æœã€‘\n${results.join('\n')}`;
                
                alert(resultMsg);
                
                // åˆ·æ–°è´¦æˆ·ä¿¡æ¯å’ŒæŒä»“
                await refreshAccountData();
                
            } catch (error) {
                console.error('[batchClosePositions] æ‰¹é‡å¹³ä»“å¼‚å¸¸:', error);
                alert(`âŒ æ‰¹é‡å¹³ä»“å¼‚å¸¸: ${error.message}`);
            }
        }

        // 1:1å¯¹å†²é…å¯¹å‡½æ•°
        async function hedgePositions(basePosSide) {
            console.log(`[hedgePositions] å¼€å§‹å¯¹å†²é…å¯¹: basePosSide=${basePosSide}`);
            
            // è·å–å½“å‰è´¦æˆ·
            const account = accounts.find(acc => acc.id === currentAccount);
            if (!account) {
                alert('âŒ è¯·å…ˆé€‰æ‹©è´¦æˆ·ï¼');
                return;
            }
            
            if (!account.apiKey || !account.apiSecret || !account.passphrase) {
                alert('âŒ è¯·å…ˆé…ç½®è´¦æˆ·APIå‡­è¯ï¼');
                return;
            }
            
            // è·å–å½“å‰æŒä»“
            try {
                const response = await fetch('/api/okx-trading/positions', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        apiKey: account.apiKey,
                        apiSecret: account.apiSecret,
                        passphrase: account.passphrase
                    })
                });
                
                const result = await response.json();
                
                if (!result.success || !result.data) {
                    alert(`âŒ è·å–æŒä»“å¤±è´¥: ${result.error || 'æœªçŸ¥é”™è¯¯'}`);
                    return;
                }
                
                // ç­›é€‰å‡ºæŒ‡å®šæ–¹å‘çš„æŒä»“
                const basePositions = result.data.filter(pos => pos.posSide === basePosSide);
                
                if (basePositions.length === 0) {
                    const directionText = basePosSide === 'long' ? 'å¤šå•' : 'ç©ºå•';
                    alert(`âš ï¸ å½“å‰æ²¡æœ‰${directionText}æŒä»“ï¼Œæ— æ³•è¿›è¡Œå¯¹å†²é…å¯¹ï¼`);
                    return;
                }
                
                console.log(`[hedgePositions] æ‰¾åˆ° ${basePositions.length} ä¸ª${basePosSide}æŒä»“`);
                
                // è·å–è´¦æˆ·ä½™é¢
                const balanceResponse = await fetch('/api/okx-trading/account', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        apiKey: account.apiKey,
                        apiSecret: account.apiSecret,
                        passphrase: account.passphrase
                    })
                });
                
                const balanceResult = await balanceResponse.json();
                let availableBalance = 0;
                if (balanceResult.success && balanceResult.data) {
                    availableBalance = parseFloat(balanceResult.data.availBal || 0);
                }
                
                // è®¡ç®—å¯¹å†²æ‰€éœ€çš„æ€»é‡‘é¢ï¼ˆå®é™…å ç”¨ä¿è¯é‡‘ï¼Œ10xæ æ†ï¼‰
                const totalMarginNeeded = basePositions.reduce((sum, pos) => sum + (pos.margin || 0), 0);
                
                // æ£€æŸ¥ä½™é¢æ˜¯å¦è¶³å¤Ÿï¼ˆç•™20%ç¼“å†²ï¼‰
                const requiredBalance = totalMarginNeeded * 1.2;
                if (availableBalance < requiredBalance) {
                    alert(`âŒ ä½™é¢ä¸è¶³ï¼\n\n` +
                        `ã€èµ„é‡‘éœ€æ±‚ã€‘\n` +
                        `  â€¢ å¯¹å†²æ‰€éœ€ä¿è¯é‡‘: ${totalMarginNeeded.toFixed(2)} USDT\n` +
                        `  â€¢ å»ºè®®ä½™é¢: ${requiredBalance.toFixed(2)} USDT\n\n` +
                        `ã€å½“å‰çŠ¶æ€ã€‘\n` +
                        `  â€¢ å¯ç”¨ä½™é¢: ${availableBalance.toFixed(2)} USDT\n` +
                        `  â€¢ ç¼ºå°‘: ${(requiredBalance - availableBalance).toFixed(2)} USDT\n\n` +
                        `ğŸ’¡ å»ºè®®ï¼šå¢åŠ è´¦æˆ·ä½™é¢æˆ–å…ˆå¹³æ‰éƒ¨åˆ†æŒä»“`);
                    return;
                }
                
                // æ„å»ºç¡®è®¤ä¿¡æ¯
                const baseDirectionText = basePosSide === 'long' ? 'å¤šå•' : 'ç©ºå•';
                const hedgeDirectionText = basePosSide === 'long' ? 'ç©ºå•' : 'å¤šå•';
                const emoji = basePosSide === 'long' ? 'âš–ï¸' : 'âš–ï¸';
                
                const positionsList = basePositions.map(pos => {
                    const coinName = pos.instId.replace('-USDT-SWAP', '');
                    // è®¡ç®—åˆçº¦ä»·å€¼ï¼ˆå¼ æ•° Ã— æ¯å¼ ä»·å€¼ï¼‰
                    const contractValue = pos.posSize * pos.avgPrice * (pos.instId.includes('BTC') ? 0.01 : pos.instId.includes('ETH') ? 0.1 : 1.0);
                    return `  â€¢ ${coinName}: ${pos.posSize}å¼  â‰ˆ ${contractValue.toFixed(2)} USDT (ä¿è¯é‡‘: ${pos.margin.toFixed(2)} USDT)`;
                }).join('\n');
                
                const totalContractValue = basePositions.reduce((sum, pos) => {
                    const contractValue = pos.posSize * pos.avgPrice * (pos.instId.includes('BTC') ? 0.01 : pos.instId.includes('ETH') ? 0.1 : 1.0);
                    return sum + contractValue;
                }, 0);
                
                const confirmMsg = `${emoji} 1:1å¯¹å†²é…å¯¹\n\n` +
                    `ã€ç°æœ‰${baseDirectionText}æŒä»“ã€‘\n${positionsList}\n\n` +
                    `ã€å¯¹å†²æ–¹æ¡ˆã€‘\n` +
                    `  â€¢ æŒä»“æ•°é‡: ${basePositions.length} ä¸ª\n` +
                    `  â€¢ åˆçº¦æ€»å€¼: ${totalContractValue.toFixed(2)} USDT\n` +
                    `  â€¢ éœ€è¦ä¿è¯é‡‘: ${totalMarginNeeded.toFixed(2)} USDT (10xæ æ†)\n` +
                    `  â€¢ å¯ç”¨ä½™é¢: ${availableBalance.toFixed(2)} USDT\n\n` +
                    `ã€å¯¹å†²æ“ä½œã€‘\n` +
                    `  å°†å¼€${basePositions.length}ä¸ª${hedgeDirectionText}ï¼Œæ¯ä¸ªå¸ç§å¼€ç­‰é¢å¯¹å†²ä»“ä½\n\n` +
                    `âš ï¸ å¯¹å†²åå°†é”å®šå½“å‰ç›ˆäºï¼ŒåŒå‘æŒä»“ï¼\n\n` +
                    `ç¡®è®¤æ‰§è¡Œå¯¹å†²é…å¯¹ï¼Ÿ`;
                
                if (!confirm(confirmMsg)) {
                    console.log('[hedgePositions] ç”¨æˆ·å–æ¶ˆå¯¹å†²é…å¯¹');
                    return;
                }
                
                // å¼€å§‹æ‰¹é‡å¯¹å†²å¼€ä»“
                console.log('[hedgePositions] å¼€å§‹æ‰¹é‡å¯¹å†²å¼€ä»“...');
                let successCount = 0;
                let failCount = 0;
                const results = [];
                
                // å¯¹å†²æ–¹å‘ï¼šå¤šå•é…ç©ºå•ï¼Œç©ºå•é…å¤šå•
                const hedgeDirection = basePosSide === 'long' ? 'short' : 'long';
                
                for (const position of basePositions) {
                    try {
                        const coinName = position.instId.replace('-USDT-SWAP', '');
                        console.log(`[hedgePositions] æ­£åœ¨å¯¹å†²: ${coinName}...`);
                        
                        // è®¡ç®—å¯¹å†²é‡‘é¢ï¼ˆä½¿ç”¨ç›¸åŒçš„ä¿è¯é‡‘ï¼‰
                        const hedgeAmount = position.margin.toFixed(2);
                        
                        // æ„å»ºè®¢å•æ•°æ®
                        const orderData = {
                            instId: position.instId,
                            side: hedgeDirection === 'long' ? 'buy' : 'sell',
                            posSide: hedgeDirection,
                            ordType: 'market',
                            sz: hedgeAmount,  // USDTé‡‘é¢
                            lever: '10'
                        };
                        
                        // å‘é€è®¢å•è¯·æ±‚
                        const orderResponse = await fetch('/api/okx-trading/place-order', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                apiKey: account.apiKey,
                                apiSecret: account.apiSecret,
                                passphrase: account.passphrase,
                                ...orderData
                            })
                        });
                        
                        const orderResult = await orderResponse.json();
                        
                        if (orderResult.success) {
                            successCount++;
                            results.push(`âœ… ${coinName}: ${hedgeAmount} USDT`);
                            console.log(`[hedgePositions] ${coinName} å¯¹å†²æˆåŠŸ`);
                        } else {
                            failCount++;
                            results.push(`âŒ ${coinName}: ${orderResult.error || 'å¤±è´¥'}`);
                            console.error(`[hedgePositions] ${coinName} å¯¹å†²å¤±è´¥:`, orderResult.error);
                        }
                        
                        // å»¶è¿Ÿ100msï¼Œé¿å…è¯·æ±‚è¿‡å¿«
                        await new Promise(resolve => setTimeout(resolve, 100));
                        
                    } catch (error) {
                        failCount++;
                        const coinName = position.instId.replace('-USDT-SWAP', '');
                        results.push(`âŒ ${coinName}: ${error.message || 'å¼‚å¸¸'}`);
                        console.error(`[hedgePositions] ${coinName} å¯¹å†²å¼‚å¸¸:`, error);
                    }
                }
                
                // æ˜¾ç¤ºç»“æœ
                const resultMsg = `${emoji} å¯¹å†²é…å¯¹å®Œæˆ\n\n` +
                    `ã€ç»“æœç»Ÿè®¡ã€‘\n` +
                    `  â€¢ æˆåŠŸ: ${successCount} ä¸ª\n` +
                    `  â€¢ å¤±è´¥: ${failCount} ä¸ª\n\n` +
                    `ã€è¯¦ç»†ç»“æœã€‘\n${results.join('\n')}\n\n` +
                    `âœ… å¯¹å†²åæŒä»“ï¼š${baseDirectionText} ${basePositions.length}ä¸ª + ${hedgeDirectionText} ${successCount}ä¸ª`;
                
                alert(resultMsg);
                
                // åˆ·æ–°è´¦æˆ·ä¿¡æ¯ã€æŒä»“å’Œæ—¥å¿—
                await refreshAccountData();
                await loadTradingLogs();
                
            } catch (error) {
                console.error('[hedgePositions] å¯¹å†²é…å¯¹å¼‚å¸¸:', error);
                alert(`âŒ å¯¹å†²é…å¯¹å¼‚å¸¸: ${error.message}`);
            }
        }

        // æäº¤è®¢å•
        // æäº¤è®¢å•
        async function submitOrder(event) {
            event.preventDefault();
            
            const amount = document.getElementById('orderAmount').value;
            const priceType = document.getElementById('priceType').value;
            
            if (!amount || parseFloat(amount) <= 0) {
                alert('è¯·è¾“å…¥æœ‰æ•ˆçš„äº¤æ˜“æ•°é‡');
                return;
            }
            
            const symbolData = symbols.find(s => s.symbol === currentSymbol);
            const account = accounts.find(acc => acc.id === currentAccount);
            
            if (!account || !account.apiKey || !account.apiSecret || !account.passphrase) {
                alert('è¯·å…ˆé…ç½®è´¦æˆ·APIå‡­è¯ï¼');
                return;
            }
            
            // æ„å»ºè®¢å•æ•°æ®
            const orderData = {
                instId: currentSymbol,  // äº¤æ˜“å¯¹
                side: currentDirection === 'long' ? 'buy' : 'sell',  // buy/sell
                posSide: currentDirection,  // long/short
                ordType: priceType,  // market/limit
                sz: parseFloat(amount),  // æ•°é‡ï¼ˆUSDTï¼‰
                lever: currentLeverage  // æ æ†å€æ•°
            };
            
            // é™ä»·å•éœ€è¦ä»·æ ¼
            if (priceType === 'limit') {
                orderData.px = symbolData.price;
            }
            
            console.log('å‡†å¤‡æäº¤è®¢å•:', orderData);
            
            const confirmMsg = `ç¡®è®¤${currentDirection === 'long' ? 'åšå¤š' : 'åšç©º'} ${symbolData.name}ï¼Ÿ
äº¤æ˜“å¯¹: ${currentSymbol}
å¼€ä»“é‡‘é¢: ${amount} USDT
æ æ†: ${currentLeverage}x
å ç”¨ä¿è¯é‡‘: ${(parseFloat(amount) / currentLeverage).toFixed(2)} USDT
${priceType === 'limit' ? 'ä»·æ ¼: ' + symbolData.price : 'å¸‚ä»·å•'}

âš ï¸ è¿™å°†åœ¨OKXçœŸå®ä¸‹å•ï¼Œè¯·ç¡®è®¤æ— è¯¯ï¼`;
            
            if (!confirm(confirmMsg)) {
                return;
            }
            
            try {
                // è°ƒç”¨çœŸå®ä¸‹å•API
                const response = await fetch('/api/okx-trading/place-order', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        apiKey: account.apiKey,
                        apiSecret: account.apiSecret,
                        passphrase: account.passphrase,
                        ...orderData
                    })
                });
                
                const result = await response.json();
                console.log('ä¸‹å•å“åº”:', result);
                
                if (result.success) {
                    const data = result.data;
                    alert(`âœ… è®¢å•æäº¤æˆåŠŸï¼

è®¢å•ID: ${data.ordId || ''}
åˆçº¦å¼ æ•°: ${data.contracts || ''} å¼ 
å¼€ä»“é‡‘é¢: ${data.inputUsdt} USDT
å ç”¨ä¿è¯é‡‘: ${data.actualUsdt || (data.inputUsdt / data.leverage).toFixed(2)} USDT
æ æ†å€æ•°: ${data.leverage || currentLeverage}x
å½“å‰ä»·æ ¼: ${data.price || ''}

${data.sMsg || result.message || ''}`);
                    
                    // ä¸‹å•æˆåŠŸååˆ·æ–°è´¦æˆ·ä¿¡æ¯å’ŒæŒä»“
                    await refreshAccountData();
                    
                    // æ¸…ç©ºè¾“å…¥æ¡†
                    document.getElementById('orderAmount').value = '';
                } else {
                    alert(`âŒ ä¸‹å•å¤±è´¥: ${result.error || 'æœªçŸ¥é”™è¯¯'}
é”™è¯¯ä»£ç : ${result.code || ''}`);
                }
            } catch (error) {
                console.error('ä¸‹å•å¼‚å¸¸:', error);
                alert(`âŒ ä¸‹å•å¼‚å¸¸: ${error.message || error}`);
            }
        }

        // åŠ è½½è´¦æˆ·æ•°æ®
        function loadAccountData() {
            // è¿™é‡Œåº”è¯¥ä»APIåŠ è½½çœŸå®æ•°æ®
            console.log('åŠ è½½è´¦æˆ·æ•°æ®...');
        }

        // åˆ·æ–°æ•°æ®
        function refreshData() {
            console.log('åˆ·æ–°æ•°æ®...');
            loadAccountData();
        }

        // æœç´¢äº¤æ˜“å¯¹
        document.getElementById('symbolSearch').addEventListener('input', function(e) {
            const search = e.target.value.toLowerCase();
            document.querySelectorAll('.symbol-item').forEach(item => {
                const text = item.textContent.toLowerCase();
                item.style.display = text.includes(search) ? 'block' : 'none';
            });
        });

        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        window.addEventListener('DOMContentLoaded', init);
    </script>

    <!-- è´¦æˆ·ç®¡ç†å¯¹è¯æ¡† -->
    <div class="modal" id="accountModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>âš™ï¸ è´¦æˆ·ç®¡ç†</h2>
                <button class="btn-close" onclick="closeAccountModal()">Ã—</button>
            </div>
            
            <div class="account-list" id="accountList">
                <!-- è´¦æˆ·åˆ—è¡¨å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
            </div>

            <button class="btn-add-account" onclick="showAddAccountForm()">
                â• æ·»åŠ æ–°è´¦æˆ·
            </button>
            
            <!-- å¿«é€Ÿé…ç½®POITè´¦æˆ·æŒ‰é’® -->
            <button class="btn-add-account" onclick="quickAddPoitAccount()" style="background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%); margin-top: 10px;">
                âš¡ å¿«é€Ÿé…ç½®POITå­è´¦æˆ·
            </button>

            <!-- æ·»åŠ /ç¼–è¾‘è´¦æˆ·è¡¨å• -->
            <div class="account-form" id="accountForm" style="display: none;">
                <h3 style="margin-bottom: 15px; color: #2d3748;" id="formTitle">æ·»åŠ è´¦æˆ·</h3>
                <form onsubmit="saveAccount(event)">
                    <input type="hidden" id="editAccountId">
                    <div class="form-group">
                        <label for="accountName">è´¦æˆ·åç§°</label>
                        <input type="text" id="accountName" required placeholder="ä¾‹å¦‚ï¼šä¸»è´¦æˆ·ã€å­è´¦æˆ·1">
                    </div>
                    <div class="form-group">
                        <label for="apiKey">API Key</label>
                        <input type="text" id="apiKey" placeholder="è¾“å…¥OKX API Key">
                    </div>
                    <div class="form-group">
                        <label for="apiSecret">API Secret</label>
                        <input type="password" id="apiSecret" placeholder="è¾“å…¥OKX API Secret">
                    </div>
                    <div class="form-group">
                        <label for="passphrase">Passphrase</label>
                        <input type="password" id="passphrase" placeholder="è¾“å…¥OKX Passphrase">
                    </div>
                    <div class="form-group">
                        <label for="accountBalance">è´¦æˆ·ä½™é¢ (USDT) <small style="color: #888;">[å¯é€‰ï¼Œé…ç½®APIåè‡ªåŠ¨è·å–]</small></label>
                        <input type="number" id="accountBalance" placeholder="é…ç½®APIå‡­è¯åå°†è‡ªåŠ¨è·å–ä½™é¢" step="0.01" min="0" style="background-color: #f7fafc;">
                        <small style="color: #888; display: block; margin-top: 5px;">
                            ğŸ’¡ æç¤ºï¼šå¡«å†™API Keyã€Secretå’ŒPassphraseåï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨ä»OKXè·å–æœ€æ–°ä½™é¢
                        </small>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn-secondary" onclick="hideAccountForm()">å–æ¶ˆ</button>
                        <button type="submit" class="btn-primary">ä¿å­˜</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- è‡ªå®šä¹‰ç¡®è®¤å¯¹è¯æ¡† -->
    <div class="modal" id="confirmDialog">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header" style="border-bottom: none; padding-bottom: 10px;">
                <h2 id="confirmDialogTitle" style="font-size: 18px;">âš ï¸ ç¡®è®¤æ“ä½œ</h2>
                <span id="confirmDialogTimer" style="font-size: 12px; color: #999; margin-left: 10px;"></span>
            </div>
            <div id="confirmDialogMessage" style="white-space: pre-wrap; line-height: 1.8; color: #2d3748; margin: 20px 0; font-size: 14px;">
                <!-- æ¶ˆæ¯å†…å®¹ -->
            </div>
            <div class="form-actions" style="margin-top: 25px; gap: 10px;">
                <button type="button" class="btn-secondary" onclick="closeConfirmDialog(false)" style="flex: 1;">å–æ¶ˆ</button>
                <button type="button" class="btn-primary" onclick="closeConfirmDialog(true)" style="flex: 1;">ç¡®å®š</button>
            </div>
        </div>
    </div>

    <!-- è‡ªå®šä¹‰Alertå¯¹è¯æ¡† -->
    <div class="modal" id="customAlertDialog">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header" style="border-bottom: none; padding-bottom: 10px;">
                <h2 id="customAlertTitle" style="font-size: 18px;">ğŸ’¬ æç¤º</h2>
                <span id="customAlertTimer" style="font-size: 12px; color: #999; margin-left: 10px;"></span>
            </div>
            <div id="customAlertMessage" style="white-space: pre-wrap; line-height: 1.8; color: #2d3748; margin: 20px 0; font-size: 14px;">
                <!-- æ¶ˆæ¯å†…å®¹ -->
            </div>
            <div class="form-actions" style="margin-top: 25px;">
                <button type="button" class="btn-primary" onclick="closeCustomAlert()" style="width: 100%;">ç¡®å®š</button>
            </div>
        </div>
    </div>

    <script>
        // ç‚¹å‡»å¯¹è¯æ¡†å¤–éƒ¨å…³é—­
        document.getElementById('confirmDialog').addEventListener('click', function(e) {
            if (e.target === this) {
                closeConfirmDialog(false);
            }
        });
        
        // ç‚¹å‡»Alertå¯¹è¯æ¡†å¤–éƒ¨å…³é—­
        document.getElementById('customAlertDialog').addEventListener('click', function(e) {
            if (e.target === this) {
                closeCustomAlert();
            }
        });
        
        // æ‰“å¼€è´¦æˆ·ç®¡ç†å¯¹è¯æ¡†
        function openAccountModal() {
            document.getElementById('accountModal').classList.add('active');
            renderAccountList();
        }

        // å…³é—­è´¦æˆ·ç®¡ç†å¯¹è¯æ¡†
        function closeAccountModal() {
            document.getElementById('accountModal').classList.remove('active');
            hideAccountForm();
        }

        // åˆ·æ–°è´¦æˆ·ä½™é¢
        async function refreshAccountBalance(accountId) {
            const account = accounts.find(a => a.id === accountId);
            if (!account) {
                alert('è´¦æˆ·ä¸å­˜åœ¨ï¼');
                return;
            }
            
            if (!account.apiKey || !account.apiSecret || !account.passphrase) {
                alert('è¯¥è´¦æˆ·æœªé…ç½®APIå‡­è¯ï¼Œæ— æ³•è‡ªåŠ¨è·å–ä½™é¢ï¼');
                return;
            }
            
            const balance = await fetchAccountBalance(account.apiKey, account.apiSecret, account.passphrase);
            
            if (balance > 0) {
                account.balance = balance;
                localStorage.setItem('okx_accounts', JSON.stringify(accounts));
                renderAccountList();
                renderAccountTabs();
                
                // å¦‚æœæ˜¯å½“å‰è´¦æˆ·ï¼Œæ›´æ–°ä½™é¢æ˜¾ç¤º
                if (accountId === currentAccount) {
                    updateAccountBalance();
                }
                
                alert(`ä½™é¢åˆ·æ–°æˆåŠŸï¼å½“å‰ä½™é¢: ${balance.toFixed(2)} USDT`);
            } else {
                alert('è·å–ä½™é¢å¤±è´¥ï¼Œè¯·æ£€æŸ¥APIå‡­è¯æ˜¯å¦æ­£ç¡®ï¼');
            }
        }

        // æ¸²æŸ“è´¦æˆ·åˆ—è¡¨
        function renderAccountList() {
            const accountList = document.getElementById('accountList');
            accountList.innerHTML = accounts.map((account, index) => {
                const hasApi = account.apiKey && account.apiSecret && account.passphrase;
                const apiStatus = hasApi ? 
                    '<span style="color: #10b981; font-size: 12px;">âœ“ APIå·²é…ç½®</span>' : 
                    '<span style="color: #ef4444; font-size: 12px;">âœ— APIæœªé…ç½®</span>';
                return `
                <div class="account-item">
                    <div class="account-item-info">
                        <div class="account-item-name">${account.name}</div>
                        <div class="account-item-balance">${account.balance.toFixed(2)} USDT</div>
                        <div style="margin-top: 4px;">${apiStatus}</div>
                    </div>
                    <div class="account-item-actions">
                        ${hasApi ? `<button class="btn-small" onclick="refreshAccountBalance('${account.id}')" style="background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); margin-bottom: 5px;">ğŸ”„ åˆ·æ–°ä½™é¢</button>` : ''}
                        <button class="btn-small btn-edit" onclick="editAccount('${account.id}')">ç¼–è¾‘</button>
                        ${accounts.length > 1 ? `<button class="btn-small btn-delete" onclick="deleteAccount('${account.id}')">åˆ é™¤</button>` : ''}
                    </div>
                </div>
            `}).join('');
        }

        // æ˜¾ç¤ºæ·»åŠ è´¦æˆ·è¡¨å•
        function showAddAccountForm() {
            document.getElementById('formTitle').textContent = 'æ·»åŠ è´¦æˆ·';
            document.getElementById('editAccountId').value = '';
            document.getElementById('accountName').value = '';
            document.getElementById('apiKey').value = '';
            document.getElementById('apiSecret').value = '';
            document.getElementById('passphrase').value = '';
            document.getElementById('accountBalance').value = '';
            document.getElementById('accountForm').style.display = 'block';
        }

        // éšè—è´¦æˆ·è¡¨å•
        function hideAccountForm() {
            document.getElementById('accountForm').style.display = 'none';
        }

        // ç¼–è¾‘è´¦æˆ·
        function editAccount(accountId) {
            const account = accounts.find(a => a.id === accountId);
            if (!account) return;

            document.getElementById('formTitle').textContent = 'ç¼–è¾‘è´¦æˆ·';
            document.getElementById('editAccountId').value = accountId;
            document.getElementById('accountName').value = account.name;
            document.getElementById('apiKey').value = account.apiKey || '';
            document.getElementById('apiSecret').value = account.apiSecret || '';
            document.getElementById('passphrase').value = account.passphrase || '';
            document.getElementById('accountBalance').value = account.balance;
            document.getElementById('accountForm').style.display = 'block';
        }

        // åˆ é™¤è´¦æˆ·
        function deleteAccount(accountId) {
            if (accounts.length <= 1) {
                alert('è‡³å°‘éœ€è¦ä¿ç•™ä¸€ä¸ªè´¦æˆ·ï¼');
                return;
            }

            if (!confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªè´¦æˆ·å—ï¼Ÿ')) return;

            accounts = accounts.filter(a => a.id !== accountId);
            
            // å¦‚æœåˆ é™¤çš„æ˜¯å½“å‰è´¦æˆ·ï¼Œåˆ‡æ¢åˆ°ç¬¬ä¸€ä¸ªè´¦æˆ·
            if (currentAccount === accountId) {
                currentAccount = accounts[0].id;
                selectAccount(currentAccount);
            }

            localStorage.setItem('okx_accounts', JSON.stringify(accounts));
            renderAccountList();
            renderAccountTabs();
        }

        // ä»APIè·å–è´¦æˆ·ä½™é¢
        async function fetchAccountBalance(apiKey, apiSecret, passphrase) {
            try {
                const response = await fetch('/api/okx-trading/account-balance', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        apiKey: apiKey,
                        apiSecret: apiSecret,
                        passphrase: passphrase
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    return result.balance;
                } else {
                    console.error('è·å–ä½™é¢å¤±è´¥:', result.error);
                    return 0;
                }
            } catch (error) {
                console.error('è·å–ä½™é¢å¼‚å¸¸:', error);
                return 0;
            }
        }

        // ä¿å­˜è´¦æˆ·
        async function saveAccount(event) {
            event.preventDefault();

            const accountId = document.getElementById('editAccountId').value;
            const name = document.getElementById('accountName').value.trim();
            const apiKey = document.getElementById('apiKey').value.trim();
            const apiSecret = document.getElementById('apiSecret').value.trim();
            const passphrase = document.getElementById('passphrase').value.trim();

            if (!name) {
                alert('è¯·å¡«å†™è´¦æˆ·åç§°ï¼');
                return;
            }

            // å¦‚æœæä¾›äº†APIå‡­è¯ï¼Œè‡ªåŠ¨è·å–ä½™é¢
            let balance = 0;
            if (apiKey && apiSecret && passphrase) {
                // æ˜¾ç¤ºåŠ è½½æç¤º
                const submitBtn = event.target.querySelector('button[type="submit"]');
                const originalText = submitBtn.textContent;
                submitBtn.textContent = 'æ­£åœ¨è·å–ä½™é¢...';
                submitBtn.disabled = true;
                
                balance = await fetchAccountBalance(apiKey, apiSecret, passphrase);
                
                submitBtn.textContent = originalText;
                submitBtn.disabled = false;
                
                if (balance === 0) {
                    const confirm = window.confirm('æ— æ³•è·å–è´¦æˆ·ä½™é¢ï¼Œå¯èƒ½æ˜¯APIå‡­è¯é”™è¯¯ã€‚æ˜¯å¦ç»§ç»­ä¿å­˜ï¼Ÿ');
                    if (!confirm) {
                        return;
                    }
                }
            } else {
                // å¦‚æœæ²¡æœ‰APIå‡­è¯ï¼Œä½¿ç”¨æ‰‹åŠ¨è¾“å…¥çš„ä½™é¢ï¼ˆå¦‚æœæœ‰ï¼‰
                const balanceInput = document.getElementById('accountBalance');
                if (balanceInput && balanceInput.value) {
                    balance = parseFloat(balanceInput.value);
                }
            }

            if (accountId) {
                // ç¼–è¾‘ç°æœ‰è´¦æˆ·
                const account = accounts.find(a => a.id === accountId);
                if (account) {
                    account.name = name;
                    account.apiKey = apiKey;
                    account.apiSecret = apiSecret;
                    account.passphrase = passphrase;
                    account.balance = balance;
                }
            } else {
                // æ·»åŠ æ–°è´¦æˆ·
                const newId = 'account_' + Date.now();
                accounts.push({
                    id: newId,
                    name: name,
                    apiKey: apiKey,
                    apiSecret: apiSecret,
                    passphrase: passphrase,
                    balance: balance
                });
            }

            localStorage.setItem('okx_accounts', JSON.stringify(accounts));
            renderAccountList();
            renderAccountTabs();
            hideAccountForm();
            
            // å¦‚æœç¼–è¾‘çš„æ˜¯å½“å‰è´¦æˆ·ï¼Œæ›´æ–°ä½™é¢æ˜¾ç¤º
            if (accountId === currentAccount) {
                updateAccountBalance();
            }
            
            alert(`è´¦æˆ·ä¿å­˜æˆåŠŸï¼${balance > 0 ? `å½“å‰ä½™é¢: ${balance.toFixed(2)} USDT` : 'æœªè·å–åˆ°ä½™é¢'}`);
        }

        // å¿«é€Ÿé…ç½®POITå­è´¦æˆ·
        async function quickAddPoitAccount() {
            const confirmed = confirm('ç¡®è®¤è¦å¿«é€Ÿé…ç½®POITå­è´¦æˆ·å—ï¼Ÿ\n\nè´¦æˆ·ä¿¡æ¯ï¼š\n- è´¦æˆ·åç§°: POIT (å­è´¦æˆ·)\n- API Key: 8650e46c-***\n- ç³»ç»Ÿå°†è‡ªåŠ¨ä»OKXè·å–è´¦æˆ·ä½™é¢');
            
            if (!confirmed) return;
            
            // POITè´¦æˆ·é…ç½®
            const poitAccount = {
                id: 'account_poit_' + Date.now(),
                name: 'POIT (å­è´¦æˆ·)',
                apiKey: '8650e46c-059b-431d-93cf-55f8c79babdb',
                apiSecret: '4C2BD2AC6A08615EA7F36A6251857FCE',
                passphrase: 'Wu666666.',
                balance: 0
            };
            
            // æ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨
            const existingIndex = accounts.findIndex(acc => 
                acc.apiKey === poitAccount.apiKey || acc.name === poitAccount.name
            );
            
            if (existingIndex > -1) {
                const update = confirm('æ£€æµ‹åˆ°åŒåæˆ–ç›¸åŒAPI Keyçš„è´¦æˆ·ï¼Œæ˜¯å¦æ›´æ–°ï¼Ÿ');
                if (!update) return;
                
                accounts[existingIndex] = poitAccount;
                console.log('âœ… POITè´¦æˆ·å·²æ›´æ–°');
            } else {
                accounts.push(poitAccount);
                console.log('âœ… POITè´¦æˆ·å·²æ·»åŠ ');
            }
            
            // è·å–è´¦æˆ·ä½™é¢
            alert('æ­£åœ¨ä»OKXè·å–è´¦æˆ·ä½™é¢ï¼Œè¯·ç¨å€™...');
            const balance = await fetchAccountBalance(
                poitAccount.apiKey,
                poitAccount.apiSecret,
                poitAccount.passphrase
            );
            
            if (balance > 0) {
                poitAccount.balance = balance;
                alert(`âœ… POITå­è´¦æˆ·é…ç½®æˆåŠŸï¼\n\nè´¦æˆ·ä½™é¢: ${balance.toFixed(2)} USDT`);
            } else {
                alert('âš ï¸ POITå­è´¦æˆ·å·²æ·»åŠ ï¼Œä½†æ— æ³•è·å–ä½™é¢ã€‚\nè¯·æ£€æŸ¥APIæƒé™è®¾ç½®ã€‚\n\nè´¦æˆ·å·²ä¿å­˜ï¼Œæ‚¨å¯ä»¥ç¨åæ‰‹åŠ¨åˆ·æ–°ä½™é¢ã€‚');
            }
            
            // ä¿å­˜å¹¶åˆ·æ–°
            localStorage.setItem('okx_accounts', JSON.stringify(accounts));
            renderAccountList();
            renderAccountTabs();
            
            // åˆ‡æ¢åˆ°POITè´¦æˆ·
            if (existingIndex > -1) {
                selectAccount(accounts[existingIndex].id);
            } else {
                selectAccount(accounts[accounts.length - 1].id);
            }
            
            // å…³é—­å¯¹è¯æ¡†
            closeAccountModal();
        }
        
        // ç‚¹å‡»å¯¹è¯æ¡†å¤–éƒ¨å…³é—­
        document.getElementById('accountModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeAccountModal();
            }
        });

        // ==================== é¢„è­¦åŠŸèƒ½ ====================
        
        // åŠ è½½é¢„è­¦è®¾ç½®
        async function loadAlertSettingsOKX() {
            try {
                const response = await fetch('/api/coin-tracker/alert-settings');
                if (response.ok) {
                    const result = await response.json();
                    if (result.success && result.settings) {
                        const settings = result.settings;
                        
                        // æ›´æ–°UI
                        document.getElementById('upperThreshold').value = settings.upperThreshold || 30;
                        document.getElementById('lowerThreshold').value = settings.lowerThreshold || -40;
                        document.getElementById('upperAlertSwitch').checked = settings.upperEnabled || false;
                        document.getElementById('lowerAlertSwitch').checked = settings.lowerEnabled || false;
                        
                        console.log('âœ… OKXé¡µé¢ï¼šé¢„è­¦è®¾ç½®å·²åŠ è½½', settings);
                    }
                }
            } catch (e) {
                console.warn('âš ï¸ OKXé¡µé¢ï¼šåŠ è½½é¢„è­¦è®¾ç½®å¤±è´¥', e);
            }
        }
        
        // ä¿å­˜é¢„è­¦è®¾ç½®
        async function saveAlertSettingsOKX() {
            try {
                const settings = {
                    upperThreshold: parseFloat(document.getElementById('upperThreshold').value),
                    lowerThreshold: parseFloat(document.getElementById('lowerThreshold').value),
                    upperEnabled: document.getElementById('upperAlertSwitch').checked,
                    lowerEnabled: document.getElementById('lowerAlertSwitch').checked,
                    tgEnabled: false, // OKXé¡µé¢é»˜è®¤ä¸å¯ç”¨TGé€šçŸ¥
                    upperTriggered: false,
                    lowerTriggered: false,
                    lastCheckTime: null
                };
                
                const response = await fetch('/api/coin-tracker/alert-settings', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(settings)
                });
                
                if (response.ok) {
                    const result = await response.json();
                    if (result.success) {
                        alert('âœ… é¢„è­¦è®¾ç½®å·²ä¿å­˜ï¼');
                        console.log('âœ… OKXé¡µé¢ï¼šé¢„è­¦è®¾ç½®å·²ä¿å­˜', settings);
                    }
                }
            } catch (e) {
                console.error('âŒ OKXé¡µé¢ï¼šä¿å­˜é¢„è­¦è®¾ç½®å¤±è´¥', e);
                alert('âŒ ä¿å­˜å¤±è´¥ï¼Œè¯·é‡è¯•');
            }
        }
        
        // æ›´æ–°æœåŠ¡å™¨é˜ˆå€¼æ˜¾ç¤º
        function updateServerThresholdDisplay(settings) {
            // æ›´æ–°æ­¢ç›ˆé˜ˆå€¼æ˜¾ç¤º
            const takeProfitThreshold = settings.takeProfitThreshold || 50;
            const takeProfitEnabled = settings.takeProfitEnabled || false;
            document.getElementById('serverTakeProfitThreshold').textContent = 
                (takeProfitThreshold >= 0 ? '+' : '') + takeProfitThreshold + ' USDT';
            document.getElementById('takeProfitStatus').textContent = 
                takeProfitEnabled ? 'âœ… å·²å¯ç”¨' : 'âšª æœªå¯ç”¨';
            document.getElementById('takeProfitStatus').style.color = 
                takeProfitEnabled ? '#166534' : '#6b7280';
            
            // æ›´æ–°æ­¢æŸé˜ˆå€¼æ˜¾ç¤º
            const stopLossThreshold = settings.stopLossThreshold || -30;
            const stopLossEnabled = settings.stopLossEnabled || false;
            document.getElementById('serverStopLossThreshold').textContent = 
                stopLossThreshold + ' USDT';
            document.getElementById('stopLossStatus').textContent = 
                stopLossEnabled ? 'âœ… å·²å¯ç”¨' : 'âšª æœªå¯ç”¨';
            document.getElementById('stopLossStatus').style.color = 
                stopLossEnabled ? '#991b1b' : '#6b7280';
        }
        
        // åŠ è½½æ­¢ç›ˆæ­¢æŸè®¾ç½®ï¼ˆä» localStorageï¼ŒæŒ‰è´¦æˆ·å­˜å‚¨ï¼‰
        // åŠ è½½æ­¢ç›ˆæ­¢æŸè®¾ç½®ï¼ˆä»æœåŠ¡å™¨APIï¼ŒæŒ‰è´¦æˆ·ç‹¬ç«‹å­˜å‚¨ï¼‰
        async function loadTakeProfitStopLossSettings() {
            const account = accounts.find(acc => acc.id === currentAccount);
            if (!account) return;
            
            try {
                const response = await fetch(`/api/okx-trading/tpsl-settings/${account.id}`);
                const result = await response.json();
                
                if (result.success && result.settings) {
                    const settings = result.settings;
                    document.getElementById('takeProfitThreshold').value = settings.takeProfitThreshold || 50;
                    document.getElementById('stopLossThreshold').value = settings.stopLossThreshold || -30;
                    document.getElementById('takeProfitSwitch').checked = settings.takeProfitEnabled || false;
                    document.getElementById('stopLossSwitch').checked = settings.stopLossEnabled || false;
                    
                    // åŠ è½½RSIæ­¢ç›ˆè®¾ç½®
                    document.getElementById('rsiTakeProfitThreshold').value = settings.rsiTakeProfitThreshold || 1900;
                    document.getElementById('rsiTakeProfitSwitch').checked = settings.rsiTakeProfitEnabled || false;
                    
                    // åŠ è½½RSIç©ºå•æ­¢ç›ˆè®¾ç½®
                    const rsiShortThresholdInput = document.getElementById('rsiShortTakeProfitThreshold');
                    const rsiShortSwitch = document.getElementById('rsiShortTakeProfitSwitch');
                    
                    if (rsiShortThresholdInput && rsiShortSwitch) {
                        rsiShortThresholdInput.value = settings.rsiShortTakeProfitThreshold || 810;
                        rsiShortSwitch.checked = settings.rsiShortTakeProfitEnabled || false;
                        console.log(`ğŸ“‰ [RSIç©ºå•æ­¢ç›ˆ] å·²åŠ è½½: é˜ˆå€¼=${rsiShortThresholdInput.value}, å¯ç”¨=${rsiShortSwitch.checked}`);
                    } else {
                        console.error('âŒ [RSIç©ºå•æ­¢ç›ˆ] DOMå…ƒç´ æœªæ‰¾åˆ°!', {
                            threshold: rsiShortThresholdInput,
                            switch: rsiShortSwitch
                        });
                    }
                    
                    // ğŸ”¥ åŠ è½½å¸‚åœºæƒ…ç»ªæ­¢ç›ˆè®¾ç½®
                    document.getElementById('sentimentTakeProfitSwitch').checked = settings.sentimentTakeProfitEnabled || false;
                    
                    // âš ï¸ åŠ è½½è§é¡¶ä¿¡å·åšç©ºç­–ç•¥è®¾ç½®ï¼ˆä»ç‹¬ç«‹çš„execution.jsonlæ–‡ä»¶è¯»å–ï¼‰
                    const topSignalTop8ShortSwitch = document.getElementById('topSignalTop8ShortSwitch');
                    const topSignalBottom8ShortSwitch = document.getElementById('topSignalBottom8ShortSwitch');
                    
                    if (topSignalTop8ShortSwitch && topSignalBottom8ShortSwitch) {
                        // ğŸ”§ ä¿®å¤ï¼šä»ç‹¬ç«‹çš„execution.jsonlæ–‡ä»¶è¯»å–çŠ¶æ€ï¼Œè€Œä¸æ˜¯ä»æ­¢ç›ˆæ­¢æŸé…ç½®è¯»å–
                        try {
                            // åŠ è½½è§é¡¶ä¿¡å·å‰8çŠ¶æ€
                            const top8Response = await fetch(`/api/okx-trading/check-top-signal-status/${account.id}/top8_short`);
                            const top8Data = await top8Response.json();
                            if (top8Data.success) {
                                topSignalTop8ShortSwitch.checked = top8Data.allowed || false;
                            } else {
                                topSignalTop8ShortSwitch.checked = false;
                            }
                            
                            // åŠ è½½è§é¡¶ä¿¡å·å8çŠ¶æ€
                            const bottom8Response = await fetch(`/api/okx-trading/check-top-signal-status/${account.id}/bottom8_short`);
                            const bottom8Data = await bottom8Response.json();
                            if (bottom8Data.success) {
                                topSignalBottom8ShortSwitch.checked = bottom8Data.allowed || false;
                            } else {
                                topSignalBottom8ShortSwitch.checked = false;
                            }
                            
                            console.log(`âš ï¸ [è§é¡¶ä¿¡å·åšç©º] å·²ä»ç‹¬ç«‹é…ç½®æ–‡ä»¶åŠ è½½: å‰8=${topSignalTop8ShortSwitch.checked}, å8=${topSignalBottom8ShortSwitch.checked}`);
                        } catch (e) {
                            console.error('âŒ [è§é¡¶ä¿¡å·åšç©º] åŠ è½½ç‹¬ç«‹é…ç½®å¤±è´¥:', e);
                            // é™çº§ï¼šä½¿ç”¨æ­¢ç›ˆæ­¢æŸé…ç½®ä¸­çš„å€¼ï¼ˆå‘åå…¼å®¹ï¼‰
                            topSignalTop8ShortSwitch.checked = settings.top_signal_top8_short_enabled || false;
                            topSignalBottom8ShortSwitch.checked = settings.top_signal_bottom8_short_enabled || false;
                        }
                    } else {
                        console.error('âŒ [è§é¡¶ä¿¡å·åšç©º] DOMå…ƒç´ æœªæ‰¾åˆ°!');
                    }
                    
                    // åŠ è½½æœ€å¤§æŒä»“é™åˆ¶
                    const maxPosValue = settings.maxPositionValueUsdt || 5.0;
                    document.getElementById('maxPositionValueInput').value = maxPosValue;
                    document.getElementById('maxPositionValueDisplay').textContent = maxPosValue.toFixed(1) + ' USDT';
                    
                    // æ›´æ–°æœåŠ¡å™¨é˜ˆå€¼æ˜¾ç¤º
                    updateServerThresholdDisplay(settings);
                    
                    console.log(`âœ… å·²ä»æœåŠ¡å™¨åŠ è½½è´¦æˆ· ${account.name} çš„æ­¢ç›ˆæ­¢æŸè®¾ç½®`, settings);
                } else {
                    console.warn('âš ï¸ åŠ è½½æ­¢ç›ˆæ­¢æŸè®¾ç½®å¤±è´¥:', result.error);
                }
            } catch (e) {
                console.warn('âš ï¸ åŠ è½½æ­¢ç›ˆæ­¢æŸè®¾ç½®å¼‚å¸¸', e);
            }
        }
        
        // ğŸ”¥ åŠ è½½å¹¶æ˜¾ç¤ºå½“å‰å¸‚åœºæƒ…ç»ª
        async function loadCurrentMarketSentiment() {
            try {
                const response = await fetch('/api/market-sentiment/latest?limit=1&_t=' + Date.now());
                const result = await response.json();
                
                if (result.success && result.data && result.data.length > 0) {
                    const latest = result.data[0];
                    const sentimentDisplay = document.getElementById('currentSentimentDisplay');
                    const timeDisplay = document.getElementById('sentimentUpdateTime');
                    
                    if (sentimentDisplay) {
                        sentimentDisplay.textContent = latest.sentiment || '--';
                        
                        // æ ¹æ®æƒ…ç»ªè®¾ç½®é¢œè‰²
                        if (latest.sentiment.includes('è§é¡¶') || latest.sentiment.includes('é¡¶éƒ¨èƒŒç¦»')) {
                            sentimentDisplay.style.color = '#dc2626';  // çº¢è‰²
                        } else if (latest.sentiment.includes('è§åº•') || latest.sentiment.includes('åº•éƒ¨èƒŒç¦»')) {
                            sentimentDisplay.style.color = '#f59e0b';  // æ©™è‰²
                        } else {
                            sentimentDisplay.style.color = '#16a34a';  // ç»¿è‰²
                        }
                    }
                    
                    if (timeDisplay) {
                        timeDisplay.textContent = `æœ€åæ›´æ–°: ${latest.beijing_time || '--'}`;
                    }
                    
                    // âš ï¸ æ›´æ–°è§é¡¶ä¿¡å·åšç©ºç­–ç•¥çš„å¸‚åœºæƒ…ç»ªæ˜¾ç¤º
                    const topSignalDisplay1 = document.getElementById('topSignalSentimentDisplay1');
                    const topSignalDisplay2 = document.getElementById('topSignalSentimentDisplay2');
                    const topSignalTime1 = document.getElementById('topSignalUpdateTime1');
                    const topSignalTime2 = document.getElementById('topSignalUpdateTime2');
                    
                    if (topSignalDisplay1 && topSignalDisplay2) {
                        const sentimentText = latest.sentiment || '--';
                        topSignalDisplay1.textContent = sentimentText;
                        topSignalDisplay2.textContent = sentimentText;
                        
                        // æ ¹æ®æƒ…ç»ªè®¾ç½®é¢œè‰²
                        const color = (sentimentText.includes('è§é¡¶') || sentimentText.includes('é¡¶éƒ¨èƒŒç¦»')) ? '#dc2626' : 
                                     (sentimentText.includes('è§åº•') || sentimentText.includes('åº•éƒ¨èƒŒç¦»')) ? '#f59e0b' : '#16a34a';
                        topSignalDisplay1.style.color = color;
                        topSignalDisplay2.style.color = color;
                        
                        if (topSignalTime1) topSignalTime1.textContent = `æœ€åæ›´æ–°: ${latest.beijing_time || '--'}`;
                        if (topSignalTime2) topSignalTime2.textContent = `æœ€åæ›´æ–°: ${latest.beijing_time || '--'}`;
                    }
                }
            } catch (e) {
                console.warn('âš ï¸ åŠ è½½å¸‚åœºæƒ…ç»ªå¤±è´¥', e);
            }
        }
        
        // ä¿å­˜æ­¢ç›ˆæ­¢æŸè®¾ç½®ï¼ˆåˆ°æœåŠ¡å™¨APIå’ŒJSONLæ–‡ä»¶ï¼ŒæŒ‰è´¦æˆ·ç‹¬ç«‹å­˜å‚¨ï¼‰
        async function saveTakeProfitStopLossSettings(silent = false) {
            const account = accounts.find(acc => acc.id === currentAccount);
            if (!account) {
                if (!silent) alert('âš ï¸ è¯·å…ˆé€‰æ‹©è´¦æˆ·');
                return;
            }
            
            const settings = {
                takeProfitThreshold: parseFloat(document.getElementById('takeProfitThreshold').value),
                stopLossThreshold: parseFloat(document.getElementById('stopLossThreshold').value),
                takeProfitEnabled: document.getElementById('takeProfitSwitch').checked,
                stopLossEnabled: document.getElementById('stopLossSwitch').checked,
                rsiTakeProfitThreshold: parseFloat(document.getElementById('rsiTakeProfitThreshold').value),
                rsiTakeProfitEnabled: document.getElementById('rsiTakeProfitSwitch').checked,
                rsiShortTakeProfitThreshold: parseFloat(document.getElementById('rsiShortTakeProfitThreshold').value),
                rsiShortTakeProfitEnabled: document.getElementById('rsiShortTakeProfitSwitch').checked,
                top_signal_top8_short_enabled: document.getElementById('topSignalTop8ShortSwitch').checked,  // âš ï¸ è§é¡¶ä¿¡å·+æ¶¨å¹…å‰8åšç©º
                top_signal_bottom8_short_enabled: document.getElementById('topSignalBottom8ShortSwitch').checked,  // âš ï¸ è§é¡¶ä¿¡å·+æ¶¨å¹…å8åšç©º
                sentimentTakeProfitEnabled: document.getElementById('sentimentTakeProfitSwitch').checked,  // ğŸ”¥ å¸‚åœºæƒ…ç»ªæ­¢ç›ˆ
                maxPositionValueUsdt: parseFloat(document.getElementById('maxPositionValueInput').value)
            };
            
            console.log('ğŸ’¾ [ä¿å­˜è®¾ç½®] RSIç©ºå•æ­¢ç›ˆé…ç½®:', {
                threshold: settings.rsiShortTakeProfitThreshold,
                enabled: settings.rsiShortTakeProfitEnabled
            });
            
            try {
                // 1. ä¿å­˜æ­¢ç›ˆæ­¢æŸè®¾ç½®
                const response = await fetch(`/api/okx-trading/tpsl-settings/${account.id}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(settings)
                });
                
                const result = await response.json();
                
                if (result.success) {
                    // 2. åŒæ—¶ä¿å­˜APIå‡­è¯ï¼ˆç”¨äºæ­¢ç›ˆæ­¢æŸç›‘æ§ï¼‰
                    if (account.apiKey && account.apiSecret && account.passphrase) {
                        try {
                            const credResponse = await fetch(`/api/okx-trading/save-account-credentials/${account.id}`, {
                                method: 'POST',
                                headers: {
                                    'Content-Type': 'application/json'
                                },
                                body: JSON.stringify({
                                    apiKey: account.apiKey,
                                    apiSecret: account.apiSecret,
                                    passphrase: account.passphrase
                                })
                            });
                            
                            const credResult = await credResponse.json();
                            if (credResult.success) {
                                console.log(`âœ… è´¦æˆ· ${account.name} APIå‡­è¯å·²ä¿å­˜åˆ°æœåŠ¡å™¨`);
                            } else {
                                console.warn(`âš ï¸ ä¿å­˜APIå‡­è¯å¤±è´¥: ${credResult.error}`);
                            }
                        } catch (e) {
                            console.warn('âš ï¸ ä¿å­˜APIå‡­è¯å¼‚å¸¸', e);
                        }
                    }
                    
                    // åªæœ‰åœ¨éé™é»˜æ¨¡å¼ä¸‹æ‰æ˜¾ç¤ºæç¤º
                    if (!silent) {
                        alert(`âœ… è´¦æˆ·ã€Œ${account.name}ã€çš„æ­¢ç›ˆæ­¢æŸè®¾ç½®å·²ä¿å­˜åˆ°æœåŠ¡å™¨ï¼`);
                    }
                    console.log(`âœ… å·²ä¿å­˜è´¦æˆ· ${account.name} çš„æ­¢ç›ˆæ­¢æŸè®¾ç½®åˆ°æœåŠ¡å™¨`, settings);
                    
                    // æ›´æ–°æœ€å¤§æŒä»“é™åˆ¶æ˜¾ç¤º
                    document.getElementById('maxPositionValueDisplay').textContent = settings.maxPositionValueUsdt.toFixed(1) + ' USDT';
                    
                    // æ›´æ–°æœåŠ¡å™¨é˜ˆå€¼æ˜¾ç¤º
                    updateServerThresholdDisplay(settings);
                } else {
                    if (!silent) alert(`âŒ ä¿å­˜å¤±è´¥ï¼š${result.error}`);
                    console.error('âŒ ä¿å­˜æ­¢ç›ˆæ­¢æŸè®¾ç½®å¤±è´¥:', result.error);
                }
            } catch (e) {
                if (!silent) alert('âŒ ä¿å­˜å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥');
                console.error('âŒ ä¿å­˜æ­¢ç›ˆæ­¢æŸè®¾ç½®å¼‚å¸¸', e);
            }
        }
        
        // åŠ è½½è‡ªåŠ¨äº¤æ˜“ç­–ç•¥è®¾ç½®ï¼ˆä»æœåŠ¡å™¨APIï¼ŒæŒ‰è´¦æˆ·ç‹¬ç«‹å­˜å‚¨ï¼‰
        async function loadAutoStrategySettings() {
            const account = accounts.find(acc => acc.id === currentAccount);
            if (!account) return;
            
            // è®¾ç½®åŠ è½½æ ‡å¿—ï¼Œé˜²æ­¢è§¦å‘ä¿å­˜
            isLoadingAccountSettings = true;
            
            try {
                const response = await fetch(`/api/okx-trading/auto-strategy/${account.id}`);
                const result = await response.json();
                
                if (result.success && result.settings) {
                    const settings = result.settings;
                    document.getElementById('autoTriggerPrice').value = settings.triggerPrice || 65000;
                    
                    // åŠ è½½å•ç¬”ä¸Šé™é…ç½®
                    const maxOrderSizeEl = document.getElementById('maxOrderSizeInput');
                    if (maxOrderSizeEl) {
                        maxOrderSizeEl.value = settings.maxOrderSize || 5;
                    }
                    
                    // åŒæ­¥é…ç½®åˆ°è´¦æˆ·å¯¹è±¡ï¼Œä¾›æ‰¹é‡å¼€ä»“å‡½æ•°ä½¿ç”¨
                    account.positionSize = 1.5;  // å›ºå®šä¸º1.5%
                    account.maxOrderSize = settings.maxOrderSize || 5;
                    console.log(`âœ… è´¦æˆ·é…ç½®å·²åŒæ­¥: positionSize=1.5% (å›ºå®š), maxOrderSize=${account.maxOrderSize}U`);
                    
                    // ğŸ†• æ›´æ–°é¡µé¢ä¸Šçš„å•ç¬”é™é¢æ˜¾ç¤º
                    const maxOrderSizeValue = settings.maxOrderSize || 5;
                    ['maxOrderSizeDisplay1', 'maxOrderSizeDisplay2', 'maxOrderSizeDisplay3'].forEach(id => {
                        const el = document.getElementById(id);
                        if (el) el.textContent = maxOrderSizeValue;
                    });
                    console.log(`âœ… å•ç¬”é™é¢æ˜¾ç¤ºå·²æ›´æ–°: ${maxOrderSizeValue} USDT`);
                    
                    const switchEl = document.getElementById('autoTradeSwitch');
                    if (switchEl) {
                        // å¼ºåˆ¶æ›´æ–°å¼€å…³çŠ¶æ€
                        switchEl.checked = Boolean(settings.enabled);
                        console.log(`âœ… [æŠ„åº•ç­–ç•¥] æ›´æ–°å¼€å…³çŠ¶æ€: ${switchEl.checked} (åŸå§‹å€¼: ${settings.enabled})`);
                        
                        // è§¦å‘UIé‡ç»˜ï¼Œç¡®ä¿è§†è§‰çŠ¶æ€åŒæ­¥
                        setTimeout(() => {
                            switchEl.checked = Boolean(settings.enabled);
                            console.log(`ğŸ”„ [æŠ„åº•ç­–ç•¥] äºŒæ¬¡ç¡®è®¤å¼€å…³çŠ¶æ€: ${switchEl.checked}`);
                        }, 100);
                    }
                    
                    // åŠ è½½ç­–ç•¥ç±»å‹
                    const strategyTypeEl = document.getElementById('autoStrategyType');
                    if (strategyTypeEl) {
                        strategyTypeEl.value = settings.strategyType || 'bottom_performers';
                        // æ›´æ–°ç­–ç•¥æè¿°
                        const strategyTarget = document.getElementById('strategyTarget');
                        if (strategyTarget) {
                            strategyTarget.textContent = settings.strategyType === 'top_performers' ? 'æ¶¨å¹…å‰8å' : 'æ¶¨å¹…å8å';
                        }
                    }
                    
                    // æ›´æ–°çŠ¶æ€æ˜¾ç¤º
                    updateAutoTradeStatus(settings.enabled, settings.lastExecutedTime);
                    
                    // æ›´æ–°æœåŠ¡å™¨è®¾ç½®æ˜¾ç¤º
                    updateServerAutoTradeDisplay(settings);
                    
                    // åŠ è½½å¹¶æ˜¾ç¤ºå½“å‰BTCä»·æ ¼
                    const btcPrice = await getBTCPrice();
                    if (btcPrice) {
                        const priceEl = document.getElementById('currentBtcPrice');
                        if (priceEl) {
                            priceEl.textContent = `$${btcPrice.toFixed(2)}`;
                            priceEl.style.color = btcPrice < settings.triggerPrice ? '#ef4444' : '#10b981';
                        }
                    }
                    
                    console.log(`âœ… å·²ä»æœåŠ¡å™¨åŠ è½½è´¦æˆ· ${account.name} çš„è‡ªåŠ¨äº¤æ˜“ç­–ç•¥è®¾ç½®`, settings);
                } else {
                    console.warn('âš ï¸ åŠ è½½è‡ªåŠ¨äº¤æ˜“ç­–ç•¥è®¾ç½®å¤±è´¥:', result.error);
                }
            } catch (e) {
                console.warn('âš ï¸ åŠ è½½è‡ªåŠ¨äº¤æ˜“ç­–ç•¥è®¾ç½®å¼‚å¸¸', e);
            } finally {
                // æ¢å¤æ ‡å¿—ï¼Œå…è®¸åç»­çš„ç”¨æˆ·æ“ä½œä¿å­˜
                isLoadingAccountSettings = false;
            }
        }
        
        // åŠ è½½è¿½æ¶¨ç­–ç•¥è®¾ç½®ï¼ˆæ¶¨å¹…å‰8åï¼‰
        async function loadAutoStrategySettingsTop() {
            const account = accounts.find(acc => acc.id === currentAccount);
            if (!account) {
                console.warn('âš ï¸ loadAutoStrategySettingsTop: æœªæ‰¾åˆ°å½“å‰è´¦æˆ·');
                return;
            }
            
            console.log(`ğŸ”„ å¼€å§‹åŠ è½½è´¦æˆ· ${account.name} (${account.id}) çš„è¿½æ¶¨ç­–ç•¥é…ç½®`);
            
            // è®¾ç½®åŠ è½½æ ‡å¿—ï¼Œé˜²æ­¢è§¦å‘ä¿å­˜
            isLoadingAccountSettings = true;
            
            try {
                const url = `/api/okx-trading/auto-strategy/${account.id}?strategy_type=top_performers`;
                console.log(`ğŸ“¡ è¯·æ±‚URL: ${url}`);
                
                const response = await fetch(url);
                const result = await response.json();
                
                console.log(`ğŸ“¦ APIå“åº”:`, result);
                
                if (result.success && result.settings) {
                    const settings = result.settings;
                    
                    console.log(`ğŸ“‹ é…ç½®è¯¦æƒ…:`, {
                        enabled: settings.enabled,
                        enabledType: typeof settings.enabled,
                        triggerPrice: settings.triggerPrice,
                        strategyType: settings.strategyType
                    });
                    
                    // æ›´æ–°UIå…ƒç´ 
                    const priceEl = document.getElementById('autoTriggerPriceTop');
                    const switchEl = document.getElementById('autoTradeSwitchTop');
                    const typeEl = document.getElementById('autoStrategyTypeTop');
                    
                    // åŠ è½½å•ç¬”ä¸Šé™é…ç½®
                    const maxOrderSizeEl = document.getElementById('maxOrderSizeInputTop');
                    if (maxOrderSizeEl) {
                        maxOrderSizeEl.value = settings.maxOrderSize || 5;
                        console.log(`âœ… æ›´æ–°å•ç¬”ä¸Šé™: ${maxOrderSizeEl.value} USDT`);
                    }
                    
                    // åŒæ­¥é…ç½®åˆ°è´¦æˆ·å¯¹è±¡ï¼Œä¾›æ‰¹é‡å¼€ä»“å‡½æ•°ä½¿ç”¨
                    account.positionSize = 1.5;  // å›ºå®šä¸º1.5%
                    account.maxOrderSize = settings.maxOrderSize || 5;
                    console.log(`âœ… è´¦æˆ·é…ç½®å·²åŒæ­¥(Top): positionSize=1.5% (å›ºå®š), maxOrderSize=${account.maxOrderSize}U`);
                    
                    if (priceEl) {
                        priceEl.value = settings.triggerPrice || 68000;
                        console.log(`âœ… æ›´æ–°è§¦å‘ä»·æ ¼: ${priceEl.value}`);
                    }
                    
                    if (switchEl) {
                        // å¼ºåˆ¶æ›´æ–°å¼€å…³çŠ¶æ€
                        switchEl.checked = Boolean(settings.enabled);
                        console.log(`âœ… æ›´æ–°å¼€å…³çŠ¶æ€: ${switchEl.checked} (åŸå§‹å€¼: ${settings.enabled}, ç±»å‹: ${typeof settings.enabled})`);
                        
                        // è§¦å‘UIé‡ç»˜ï¼Œç¡®ä¿è§†è§‰çŠ¶æ€åŒæ­¥
                        setTimeout(() => {
                            switchEl.checked = Boolean(settings.enabled);
                            console.log(`ğŸ”„ äºŒæ¬¡ç¡®è®¤å¼€å…³çŠ¶æ€: ${switchEl.checked}`);
                        }, 100);
                    }
                    
                    if (typeEl) {
                        typeEl.value = settings.strategyType || 'top_performers';
                        console.log(`âœ… æ›´æ–°ç­–ç•¥ç±»å‹: ${typeEl.value}`);
                    }
                    
                    // æ›´æ–°çŠ¶æ€æ˜¾ç¤º
                    updateAutoTradeStatus(settings.enabled, settings.lastExecutedTime, 'Top');
                    updateServerAutoTradeDisplay(settings, 'Top');
                    
                    // åŠ è½½å¹¶æ˜¾ç¤ºå½“å‰BTCä»·æ ¼
                    const btcPrice = await getBTCPrice();
                    if (btcPrice) {
                        const priceDisplayEl = document.getElementById('currentBtcPriceTop');
                        if (priceDisplayEl) {
                            priceDisplayEl.textContent = `$${btcPrice.toFixed(2)}`;
                            priceDisplayEl.style.color = btcPrice > settings.triggerPrice ? '#10b981' : '#ef4444';
                        }
                    }
                    
                    console.log(`âœ… å·²ä»æœåŠ¡å™¨åŠ è½½è´¦æˆ· ${account.name} çš„è¿½æ¶¨ç­–ç•¥è®¾ç½®`, settings);
                } else {
                    console.warn('âš ï¸ åŠ è½½è¿½æ¶¨ç­–ç•¥è®¾ç½®å¤±è´¥:', result.error);
                }
            } catch (e) {
                console.error('âŒ åŠ è½½è¿½æ¶¨ç­–ç•¥è®¾ç½®å¼‚å¸¸', e);
            } finally {
                // æ¢å¤æ ‡å¿—ï¼Œå…è®¸åç»­çš„ç”¨æˆ·æ“ä½œä¿å­˜
                isLoadingAccountSettings = false;
                console.log('âœ… è´¦æˆ·è®¾ç½®åŠ è½½å®Œæˆï¼Œæ¢å¤ä¿å­˜åŠŸèƒ½');
            }
        }
        
        // ğŸ†• åŠ è½½ä¸Šæ¶¨å æ¯”0ç­–ç•¥çš„å¼€å…³çŠ¶æ€ï¼ˆæŒ‰è´¦æˆ·ç‹¬ç«‹åŠ è½½ï¼‰
        async function loadUpRatio0StrategySettings() {
            const account = accounts.find(acc => acc.id === currentAccount);
            if (!account) return;
            
            try {
                // åŠ è½½æ¶¨å¹…å‰8åç­–ç•¥çŠ¶æ€
                const top8Response = await fetch(`/api/okx-trading/check-allowed-upratio0/${account.id}/top8`);
                const top8Result = await top8Response.json();
                
                const top8SwitchEl = document.getElementById('autoTradeSwitchUpRatio0Top8');
                const top8StatusEl = document.getElementById('autoTradeStatusUpRatio0Top8');
                const top8SwitchStatusEl = document.getElementById('switchStatusUpRatio0Top8');
                
                if (top8Result.success) {
                    const isEnabled = top8Result.allowed || false;
                    if (top8SwitchEl) top8SwitchEl.checked = isEnabled;
                    if (top8StatusEl) top8StatusEl.textContent = isEnabled ? 'ç›‘æ§ä¸­' : 'æœªå¯ç”¨';
                    if (top8SwitchStatusEl) {
                        top8SwitchStatusEl.textContent = isEnabled ? 'ğŸŸ¢ å·²å¼€å¯' : 'ğŸ”´ æœªå¼€å¯';
                        top8SwitchStatusEl.style.color = isEnabled ? '#10b981' : '#6b7280';
                    }
                    
                    // ğŸ†• æ›´æ–°JSONLæ‰§è¡Œè®¸å¯çŠ¶æ€æ˜¾ç¤º
                    const top8JsonlStatusEl = document.getElementById('jsonlAllowedStatusUpRatio0Top8');
                    if (top8JsonlStatusEl) {
                        if (isEnabled) {
                            top8JsonlStatusEl.textContent = 'âœ… å…è®¸æ‰§è¡Œ';
                            top8JsonlStatusEl.style.color = '#10b981';
                        } else {
                            top8JsonlStatusEl.textContent = 'ğŸš« ç¦æ­¢æ‰§è¡Œ';
                            top8JsonlStatusEl.style.color = '#ef4444';
                        }
                    }
                    
                    console.log(`âœ… å·²åŠ è½½è´¦æˆ· ${account.name} çš„æ¶¨å¹…å‰8åç­–ç•¥çŠ¶æ€: ${isEnabled ? 'å¼€å¯' : 'å…³é—­'}, JSONL allowed: ${isEnabled}`);
                }
                
                // åŠ è½½æ¶¨å¹…å8åç­–ç•¥çŠ¶æ€
                const bottom8Response = await fetch(`/api/okx-trading/check-allowed-upratio0/${account.id}/bottom8`);
                const bottom8Result = await bottom8Response.json();
                
                const bottom8SwitchEl = document.getElementById('autoTradeSwitchUpRatio0Bottom8');
                const bottom8StatusEl = document.getElementById('autoTradeStatusUpRatio0Bottom8');
                const bottom8SwitchStatusEl = document.getElementById('switchStatusUpRatio0Bottom8');
                
                if (bottom8Result.success) {
                    const isEnabled = bottom8Result.allowed || false;
                    if (bottom8SwitchEl) bottom8SwitchEl.checked = isEnabled;
                    if (bottom8StatusEl) bottom8StatusEl.textContent = isEnabled ? 'ç›‘æ§ä¸­' : 'æœªå¯ç”¨';
                    if (bottom8SwitchStatusEl) {
                        bottom8SwitchStatusEl.textContent = isEnabled ? 'ğŸŸ¢ å·²å¼€å¯' : 'ğŸ”´ æœªå¼€å¯';
                        bottom8SwitchStatusEl.style.color = isEnabled ? '#10b981' : '#6b7280';
                    }
                    
                    // ğŸ†• æ›´æ–°JSONLæ‰§è¡Œè®¸å¯çŠ¶æ€æ˜¾ç¤º
                    const bottom8JsonlStatusEl = document.getElementById('jsonlAllowedStatusUpRatio0Bottom8');
                    if (bottom8JsonlStatusEl) {
                        if (isEnabled) {
                            bottom8JsonlStatusEl.textContent = 'âœ… å…è®¸æ‰§è¡Œ';
                            bottom8JsonlStatusEl.style.color = '#10b981';
                        } else {
                            bottom8JsonlStatusEl.textContent = 'ğŸš« ç¦æ­¢æ‰§è¡Œ';
                            bottom8JsonlStatusEl.style.color = '#ef4444';
                        }
                    }
                    
                    console.log(`âœ… å·²åŠ è½½è´¦æˆ· ${account.name} çš„æ¶¨å¹…å8åç­–ç•¥çŠ¶æ€: ${isEnabled ? 'å¼€å¯' : 'å…³é—­'}, JSONL allowed: ${isEnabled}`);
                }
                
            } catch (e) {
                console.warn('âš ï¸ åŠ è½½ä¸Šæ¶¨å æ¯”0ç­–ç•¥è®¾ç½®å¼‚å¸¸', e);
            }
        }
        
        // ä¿å­˜è‡ªåŠ¨äº¤æ˜“ç­–ç•¥è®¾ç½®ï¼ˆåˆ°æœåŠ¡å™¨APIå’ŒJSONLæ–‡ä»¶ï¼ŒæŒ‰è´¦æˆ·ç‹¬ç«‹å­˜å‚¨ï¼‰
        // å‚æ•°ï¼šsuffix - ç­–ç•¥åç¼€ï¼ˆç©ºå­—ç¬¦ä¸²è¡¨ç¤ºé»˜è®¤ç­–ç•¥ï¼Œ'Top'è¡¨ç¤ºè¿½æ¶¨ç­–ç•¥ï¼‰
        async function saveAutoStrategySettings(suffix = '') {
            console.log(`ğŸ”” saveAutoStrategySettings${suffix ? `(${suffix})` : ''} å‡½æ•°è¢«è°ƒç”¨`);
            
            // å¦‚æœæ­£åœ¨åŠ è½½è´¦æˆ·è®¾ç½®ï¼Œä¸æ‰§è¡Œä¿å­˜ï¼ˆé˜²æ­¢è‡ªåŠ¨è§¦å‘ï¼‰
            if (isLoadingAccountSettings) {
                console.log('â¸ï¸ æ­£åœ¨åŠ è½½è´¦æˆ·è®¾ç½®ï¼Œè·³è¿‡ä¿å­˜æ“ä½œ');
                return;
            }
            
            const account = accounts.find(acc => acc.id === currentAccount);
            console.log('ğŸ“‹ å½“å‰è´¦æˆ·:', account ? account.name : 'æœªé€‰æ‹©');
            
            if (!account) {
                alert('âš ï¸ è¯·å…ˆé€‰æ‹©è´¦æˆ·');
                return;
            }
            
            // æ ¹æ®suffixç¡®å®šå…ƒç´ ID
            const switchId = suffix ? `autoTradeSwitch${suffix}` : 'autoTradeSwitch';
            const priceId = suffix ? `autoTriggerPrice${suffix}` : 'autoTriggerPrice';
            const typeId = suffix ? `autoStrategyType${suffix}` : 'autoStrategyType';
            
            console.log(`ğŸ“ ä½¿ç”¨çš„å…ƒç´ ID: switch=${switchId}, price=${priceId}, type=${typeId}`);
            
            // è¯»å–å½“å‰è®¾ç½®
            const currentSettings = await loadAutoStrategySettingsData(suffix);
            console.log('ğŸ“¥ å·²åŠ è½½å½“å‰è®¾ç½®:', currentSettings);
            
            const switchEl = document.getElementById(switchId);
            const priceEl = document.getElementById(priceId);
            const typeEl = document.getElementById(typeId);
            // è·å–å•ç¬”ä¸Šé™é…ç½®å…ƒç´ 
            const maxOrderSizeId = suffix ? `maxOrderSizeInput${suffix}` : 'maxOrderSizeInput';
            const maxOrderSizeEl = document.getElementById(maxOrderSizeId);
            
            if (!switchEl || !priceEl || !typeEl) {
                console.error('âŒ æ‰¾ä¸åˆ°ç­–ç•¥é…ç½®å…ƒç´ ', {switchEl, priceEl, typeEl});
                return;
            }
            
            const settings = {
                enabled: switchEl.checked,
                triggerPrice: parseFloat(priceEl.value),
                strategyType: typeEl.value,
                positionSize: 1.5,  // å›ºå®šä¸º1.5%
                maxOrderSize: maxOrderSizeEl ? parseFloat(maxOrderSizeEl.value) : 5,
                lastExecutedTime: currentSettings?.lastExecutedTime || null,
                executedCount: currentSettings?.executedCount || 0
            };
            
            console.log('ğŸ’¾ å‡†å¤‡ä¿å­˜çš„è®¾ç½®:', settings);
            
            try {
                console.log('ğŸŒ æ­£åœ¨å‘é€è¯·æ±‚åˆ°API:', `/api/okx-trading/auto-strategy/${account.id}`);
                
                const response = await fetch(`/api/okx-trading/auto-strategy/${account.id}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(settings)
                });
                
                console.log('ğŸ“¡ APIå“åº”çŠ¶æ€:', response.status);
                
                const result = await response.json();
                console.log('ğŸ“¦ APIå“åº”ç»“æœ:', result);
                
                if (result.success) {
                    console.log(`âœ… å·²ä¿å­˜è´¦æˆ· ${account.name} çš„è‡ªåŠ¨äº¤æ˜“ç­–ç•¥è®¾ç½®åˆ°æœåŠ¡å™¨`, settings);
                    
                    // âš ï¸ æ³¨æ„ï¼šä¸è¦åœ¨æ‰“å¼€å¼€å…³æ—¶è‡ªåŠ¨å†™å…¥allowed=true
                    // allowedçŠ¶æ€åªåº”è¯¥ç”±ä»¥ä¸‹æ–¹å¼ä¿®æ”¹ï¼š
                    // 1. ç­–ç•¥æ‰§è¡ŒæˆåŠŸåè‡ªåŠ¨è®¾ç½®ä¸ºfalse
                    // 2. ç”¨æˆ·æ‰‹åŠ¨ç‚¹å‡»"é‡ç½®æ‰§è¡Œè®¸å¯"æŒ‰é’®è®¾ç½®ä¸ºtrue
                    // å¦‚æœåœ¨æ‰“å¼€å¼€å…³æ—¶å°±å†™å…¥allowed=trueï¼Œä¼šå¯¼è‡´ç­–ç•¥åå¤è§¦å‘ï¼
                    
                    // æ›´æ–°å¯¹åº”çš„çŠ¶æ€æ˜¾ç¤º
                    updateAutoTradeStatus(settings.enabled, settings.lastExecutedTime, suffix);
                    updateServerAutoTradeDisplay(settings, suffix);
                } else {
                    alert(`âŒ ä¿å­˜å¤±è´¥ï¼š${result.error}`);
                    console.error('âŒ ä¿å­˜è‡ªåŠ¨äº¤æ˜“ç­–ç•¥è®¾ç½®å¤±è´¥:', result.error);
                }
            } catch (e) {
                alert('âŒ ä¿å­˜å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥');
                console.error('âŒ ä¿å­˜è‡ªåŠ¨äº¤æ˜“ç­–ç•¥è®¾ç½®å¼‚å¸¸', e);
            }
        }
        
        // ä»…ç”¨äºè¯»å–æ•°æ®ï¼Œä¸æ›´æ–°UI
        async function loadAutoStrategySettingsData(suffix = '') {
            const account = accounts.find(acc => acc.id === currentAccount);
            if (!account) return null;
            
            // ç¡®å®šç­–ç•¥ç±»å‹
            const typeId = suffix ? `autoStrategyType${suffix}` : 'autoStrategyType';
            const typeEl = document.getElementById(typeId);
            const strategyType = typeEl ? typeEl.value : 'bottom_performers';
            
            try {
                const response = await fetch(`/api/okx-trading/auto-strategy/${account.id}?strategy_type=${strategyType}`);
                const result = await response.json();
                if (result.success && result.settings) {
                    return result.settings;
                }
            } catch (e) {
                console.error('è¯»å–è®¾ç½®æ•°æ®å¤±è´¥:', e);
            }
            return null;
        }
        
        // é‡ç½®RSIç­–ç•¥æ‰§è¡Œè®¸å¯
        async function resetRsiStrategyExecution() {
            const account = accounts.find(acc => acc.id === currentAccount);
            if (!account) {
                alert('âŒ è¯·å…ˆé€‰æ‹©è´¦æˆ·');
                return;
            }
            
            // ç¡®è®¤æ“ä½œ
            if (!confirm('ç¡®è®¤é‡ç½®æ‰§è¡Œè®¸å¯å—ï¼Ÿ\n\né‡ç½®åï¼Œå·²è§¦å‘çš„ç­–ç•¥å°†å¯ä»¥å†æ¬¡æ‰§è¡Œã€‚')) {
                return;
            }
            
            try {
                // é‡ç½®ä¸¤ä¸ªç­–ç•¥çš„æ‰§è¡Œè®¸å¯
                const strategies = ['top8_short', 'bottom8_short'];
                let successCount = 0;
                let errors = [];
                
                for (const strategy of strategies) {
                    try {
                        const response = await fetch(`/api/okx-trading/set-allowed-top-signal/${account.id}/${strategy}`, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify({
                                allowed: true,
                                reason: 'ç”¨æˆ·æ‰‹åŠ¨é‡ç½®æ‰§è¡Œè®¸å¯'
                            })
                        });
                        
                        const result = await response.json();
                        if (result.success) {
                            successCount++;
                        } else {
                            errors.push(`${strategy}: ${result.error || 'æœªçŸ¥é”™è¯¯'}`);
                        }
                    } catch (e) {
                        errors.push(`${strategy}: ${e.message}`);
                    }
                }
                
                // æ˜¾ç¤ºç»“æœ
                if (successCount === strategies.length) {
                    alert(`âœ… é‡ç½®æˆåŠŸï¼\n\nè´¦æˆ·ï¼š${account.name}\nå·²é‡ç½® ${successCount} ä¸ªç­–ç•¥çš„æ‰§è¡Œè®¸å¯`);
                } else if (successCount > 0) {
                    alert(`âš ï¸ éƒ¨åˆ†æˆåŠŸ\n\næˆåŠŸï¼š${successCount} ä¸ª\nå¤±è´¥ï¼š${errors.length} ä¸ª\n\né”™è¯¯ï¼š\n${errors.join('\n')}`);
                } else {
                    alert(`âŒ é‡ç½®å¤±è´¥\n\n${errors.join('\n')}`);
                }
                
            } catch (e) {
                alert(`âŒ é‡ç½®å¤±è´¥: ${e.message}`);
            }
        }
        
        // ==================== è§åº•ä¿¡å·åšå¤šç­–ç•¥å‡½æ•° ====================
        
        // æ›´æ–°è§åº•ä¿¡å·Top8ç­–ç•¥æ˜¾ç¤º
        function updateBottomSignalTop8Display() {
            const rsiThreshold = document.getElementById('bottomSignalTop8RsiThreshold').value;
            const maxOrder = document.getElementById('bottomSignalTop8MaxOrder').value;
            document.getElementById('bottomSignalTop8RsiThresholdDisplay').textContent = rsiThreshold;
            document.getElementById('bottomSignalTop8MaxOrderDisplay').textContent = parseFloat(maxOrder).toFixed(1);
        }
        
        // æ›´æ–°è§é¡¶ä¿¡å·Top8ç­–ç•¥æ˜¾ç¤º
        function updateTopSignalTop8Display() {
            const rsiThreshold = document.getElementById('topSignalTop8RsiThreshold').value;
            const maxOrder = document.getElementById('topSignalTop8MaxOrder').value;
            document.getElementById('topSignalTop8RsiThresholdDisplay').textContent = rsiThreshold;
            document.getElementById('topSignalTop8MaxOrderDisplay').textContent = parseFloat(maxOrder).toFixed(1);
        }
        
        // æ›´æ–°è§é¡¶ä¿¡å·Bottom8ç­–ç•¥æ˜¾ç¤º
        function updateTopSignalBottom8Display() {
            const rsiThreshold = document.getElementById('topSignalBottom8RsiThreshold').value;
            const maxOrder = document.getElementById('topSignalBottom8MaxOrder').value;
            document.getElementById('topSignalBottom8RsiThresholdDisplay').textContent = rsiThreshold;
            document.getElementById('topSignalBottom8MaxOrderDisplay').textContent = parseFloat(maxOrder).toFixed(1);
        }
        
        // æ›´æ–°è§åº•ä¿¡å·Bottom8ç­–ç•¥æ˜¾ç¤º
        function updateBottomSignalBottom8Display() {
            const rsiThreshold = document.getElementById('bottomSignalBottom8RsiThreshold').value;
            const maxOrder = document.getElementById('bottomSignalBottom8MaxOrder').value;
            document.getElementById('bottomSignalBottom8RsiThresholdDisplay').textContent = rsiThreshold;
            document.getElementById('bottomSignalBottom8MaxOrderDisplay').textContent = parseFloat(maxOrder).toFixed(1);
        }
        
        // ä¿å­˜è§åº•ä¿¡å·Top8ç­–ç•¥é…ç½®
        async function saveBottomSignalTop8Config() {
            const account = accounts.find(acc => acc.id === currentAccount);
            if (!account) {
                alert('âŒ è¯·å…ˆé€‰æ‹©è´¦æˆ·');
                return;
            }
            
            const rsiThreshold = parseInt(document.getElementById('bottomSignalTop8RsiThreshold').value);
            const maxOrder = parseFloat(document.getElementById('bottomSignalTop8MaxOrder').value);
            
            // éªŒè¯è¾“å…¥
            if (rsiThreshold < 300 || rsiThreshold > 1500) {
                alert('âŒ RSIé˜ˆå€¼å¿…é¡»åœ¨300-1500ä¹‹é—´');
                return;
            }
            
            if (maxOrder < 1 || maxOrder > 100) {
                alert('âŒ å•å¸é™é¢å¿…é¡»åœ¨1-100 USDTä¹‹é—´');
                return;
            }
            
            try {
                const response = await fetch(`/api/okx-trading/save-bottom-signal-config/${account.id}/top8_long`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        enabled: document.getElementById('bottomSignalTop8LongSwitch').checked,
                        rsi_threshold: rsiThreshold,
                        max_order_usdt: maxOrder,
                        position_percent: 1.5,
                        leverage: 10
                    })
                });
                
                const result = await response.json();
                if (result.success) {
                    updateBottomSignalTop8Display();
                    alert(`âœ… é…ç½®ä¿å­˜æˆåŠŸï¼\n\nè´¦æˆ·ï¼š${account.name}\nRSIé˜ˆå€¼ï¼š${rsiThreshold}\nå•å¸é™é¢ï¼š${maxOrder} USDT`);
                } else {
                    alert(`âŒ ä¿å­˜å¤±è´¥ï¼š${result.error || 'æœªçŸ¥é”™è¯¯'}`);
                }
            } catch (e) {
                console.error('Save bottom signal top8 config error:', e);
                alert(`âŒ ä¿å­˜å¤±è´¥: ${e.message}`);
            }
        }
        
        // ä¿å­˜è§åº•ä¿¡å·Bottom8ç­–ç•¥é…ç½®
        async function saveBottomSignalBottom8Config() {
            const account = accounts.find(acc => acc.id === currentAccount);
            if (!account) {
                alert('âŒ è¯·å…ˆé€‰æ‹©è´¦æˆ·');
                return;
            }
            
            const rsiThreshold = parseInt(document.getElementById('bottomSignalBottom8RsiThreshold').value);
            const maxOrder = parseFloat(document.getElementById('bottomSignalBottom8MaxOrder').value);
            
            // éªŒè¯è¾“å…¥
            if (rsiThreshold < 300 || rsiThreshold > 1500) {
                alert('âŒ RSIé˜ˆå€¼å¿…é¡»åœ¨300-1500ä¹‹é—´');
                return;
            }
            
            if (maxOrder < 1 || maxOrder > 100) {
                alert('âŒ å•å¸é™é¢å¿…é¡»åœ¨1-100 USDTä¹‹é—´');
                return;
            }
            
            try {
                const response = await fetch(`/api/okx-trading/save-bottom-signal-config/${account.id}/bottom8_long`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        enabled: document.getElementById('bottomSignalBottom8LongSwitch').checked,
                        rsi_threshold: rsiThreshold,
                        max_order_usdt: maxOrder,
                        position_percent: 1.5,
                        leverage: 10
                    })
                });
                
                const result = await response.json();
                if (result.success) {
                    updateBottomSignalBottom8Display();
                    alert(`âœ… é…ç½®ä¿å­˜æˆåŠŸï¼\n\nè´¦æˆ·ï¼š${account.name}\nRSIé˜ˆå€¼ï¼š${rsiThreshold}\nå•å¸é™é¢ï¼š${maxOrder} USDT`);
                } else {
                    alert(`âŒ ä¿å­˜å¤±è´¥ï¼š${result.error || 'æœªçŸ¥é”™è¯¯'}`);
                }
            } catch (e) {
                console.error('Save bottom signal bottom8 config error:', e);
                alert(`âŒ ä¿å­˜å¤±è´¥: ${e.message}`);
            }
        }
        
        // ä¿å­˜è§é¡¶ä¿¡å·Top8ç­–ç•¥é…ç½®
        async function saveTopSignalTop8Config() {
            const account = accounts.find(acc => acc.id === currentAccount);
            if (!account) {
                alert('âŒ è¯·å…ˆé€‰æ‹©è´¦æˆ·');
                return;
            }
            
            const rsiThreshold = parseInt(document.getElementById('topSignalTop8RsiThreshold').value);
            const maxOrder = parseFloat(document.getElementById('topSignalTop8MaxOrder').value);
            
            // éªŒè¯è¾“å…¥
            if (rsiThreshold < 1000 || rsiThreshold > 3000) {
                alert('âŒ RSIé˜ˆå€¼å¿…é¡»åœ¨1000-3000ä¹‹é—´');
                return;
            }
            
            if (maxOrder < 1 || maxOrder > 100) {
                alert('âŒ å•å¸é™é¢å¿…é¡»åœ¨1-100 USDTä¹‹é—´');
                return;
            }
            
            try {
                console.log(`[saveTopSignalTop8Config] å¼€å§‹ä¿å­˜é…ç½®:`, {
                    accountId: account.id,
                    accountName: account.name,
                    rsiThreshold,
                    maxOrder
                });
                
                const requestBody = {
                    enabled: document.getElementById('topSignalTop8ShortSwitch').checked,
                    rsi_threshold: rsiThreshold,
                    max_order_usdt: maxOrder,
                    position_percent: 1.5,
                    leverage: 10
                };
                
                console.log('[saveTopSignalTop8Config] Request body:', requestBody);
                
                const response = await fetch(`/api/okx-trading/save-top-signal-config/${account.id}/top8_short`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(requestBody)
                });
                
                console.log('[saveTopSignalTop8Config] Response status:', response.status);
                
                // æ£€æŸ¥å“åº”æ˜¯å¦ä¸ºJSON
                const contentType = response.headers.get('content-type');
                if (!contentType || !contentType.includes('application/json')) {
                    const text = await response.text();
                    console.error('[saveTopSignalTop8Config] åç«¯è¿”å›éJSONå“åº”:', text);
                    alert(`âŒ ä¿å­˜å¤±è´¥ï¼šæœåŠ¡å™¨è¿”å›æ ¼å¼é”™è¯¯\n\n${text.substring(0, 200)}`);
                    return;
                }
                
                const result = await response.json();
                console.log('[saveTopSignalTop8Config] Response result:', result);
                
                if (result.success) {
                    updateTopSignalTop8Display();
                    alert(`âœ… é…ç½®ä¿å­˜æˆåŠŸï¼\n\nè´¦æˆ·ï¼š${account.name}\nç­–ç•¥ï¼šè§é¡¶ä¿¡å·+æ¶¨å¹…å‰8åšç©º\nRSIé˜ˆå€¼ï¼š${rsiThreshold}\nå•å¸é™é¢ï¼š${maxOrder} USDT`);
                } else {
                    alert(`âŒ ä¿å­˜å¤±è´¥ï¼š${result.error || 'æœªçŸ¥é”™è¯¯'}`);
                }
            } catch (e) {
                console.error('[saveTopSignalTop8Config] æ•è·å¼‚å¸¸:', e);
                console.error('[saveTopSignalTop8Config] Stack:', e.stack);
                alert(`âŒ ä¿å­˜å¤±è´¥: ${e.message}`);
            }
        }
        
        // ä¿å­˜è§é¡¶ä¿¡å·Bottom8ç­–ç•¥é…ç½®
        async function saveTopSignalBottom8Config() {
            const account = accounts.find(acc => acc.id === currentAccount);
            if (!account) {
                alert('âŒ è¯·å…ˆé€‰æ‹©è´¦æˆ·');
                return;
            }
            
            const rsiThreshold = parseInt(document.getElementById('topSignalBottom8RsiThreshold').value);
            const maxOrder = parseFloat(document.getElementById('topSignalBottom8MaxOrder').value);
            
            // éªŒè¯è¾“å…¥
            if (rsiThreshold < 1000 || rsiThreshold > 3000) {
                alert('âŒ RSIé˜ˆå€¼å¿…é¡»åœ¨1000-3000ä¹‹é—´');
                return;
            }
            
            if (maxOrder < 1 || maxOrder > 100) {
                alert('âŒ å•å¸é™é¢å¿…é¡»åœ¨1-100 USDTä¹‹é—´');
                return;
            }
            
            try {
                console.log(`[saveTopSignalBottom8Config] å¼€å§‹ä¿å­˜é…ç½®:`, {
                    accountId: account.id,
                    accountName: account.name,
                    rsiThreshold,
                    maxOrder
                });
                
                const requestBody = {
                    enabled: document.getElementById('topSignalBottom8ShortSwitch').checked,
                    rsi_threshold: rsiThreshold,
                    max_order_usdt: maxOrder,
                    position_percent: 1.5,
                    leverage: 10
                };
                
                console.log('[saveTopSignalBottom8Config] Request body:', requestBody);
                
                const response = await fetch(`/api/okx-trading/save-top-signal-config/${account.id}/bottom8_short`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(requestBody)
                });
                
                console.log('[saveTopSignalBottom8Config] Response status:', response.status);
                
                // æ£€æŸ¥å“åº”æ˜¯å¦ä¸ºJSON
                const contentType = response.headers.get('content-type');
                if (!contentType || !contentType.includes('application/json')) {
                    const text = await response.text();
                    console.error('[saveTopSignalBottom8Config] åç«¯è¿”å›éJSONå“åº”:', text);
                    alert(`âŒ ä¿å­˜å¤±è´¥ï¼šæœåŠ¡å™¨è¿”å›æ ¼å¼é”™è¯¯\n\n${text.substring(0, 200)}`);
                    return;
                }
                
                const result = await response.json();
                console.log('[saveTopSignalBottom8Config] Response result:', result);
                
                if (result.success) {
                    updateTopSignalBottom8Display();
                    alert(`âœ… é…ç½®ä¿å­˜æˆåŠŸï¼\n\nè´¦æˆ·ï¼š${account.name}\nç­–ç•¥ï¼šè§é¡¶ä¿¡å·+æ¶¨å¹…å8åšç©º\nRSIé˜ˆå€¼ï¼š${rsiThreshold}\nå•å¸é™é¢ï¼š${maxOrder} USDT`);
                } else {
                    alert(`âŒ ä¿å­˜å¤±è´¥ï¼š${result.error || 'æœªçŸ¥é”™è¯¯'}`);
                }
            } catch (e) {
                console.error('[saveTopSignalBottom8Config] æ•è·å¼‚å¸¸:', e);
                console.error('[saveTopSignalBottom8Config] Stack:', e.stack);
                alert(`âŒ ä¿å­˜å¤±è´¥: ${e.message}`);
            }
        }
        
        // åŠ è½½è§é¡¶ä¿¡å·ç­–ç•¥é…ç½®
        async function loadTopSignalConfig() {
            const account = accounts.find(acc => acc.id === currentAccount);
            if (!account) {
                console.log('No account selected, skip loading top signal config');
                return;
            }
            
            try {
                // åŠ è½½Top8åšç©ºç­–ç•¥é…ç½®ï¼ˆåŒ…æ‹¬å¼€å…³çŠ¶æ€ã€RSIé˜ˆå€¼ã€å•å¸é™é¢ï¼‰
                const top8ConfigResponse = await fetch(`/api/okx-trading/get-top-signal-config/${account.id}/top8_short`);
                const top8ConfigResult = await top8ConfigResponse.json();
                
                console.log('ğŸ” [loadTopSignalConfig] Top8åšç©ºé…ç½®:', top8ConfigResult);
                
                if (top8ConfigResult.success && top8ConfigResult.config) {
                    // è®¾ç½®å¼€å…³çŠ¶æ€ï¼ˆä»é…ç½®æ–‡ä»¶çš„enabledå­—æ®µè¯»å–ï¼‰
                    const top8Switch = document.getElementById('topSignalTop8ShortSwitch');
                    if (top8Switch) {
                        top8Switch.checked = top8ConfigResult.config.enabled === true;
                        console.log('ğŸ” [loadTopSignalConfig] è®¾ç½®Top8åšç©ºå¼€å…³:', {
                            enabled: top8ConfigResult.config.enabled,
                            checked: top8Switch.checked
                        });
                    }
                    
                    // è®¾ç½®RSIé˜ˆå€¼å’Œå•å¸é™é¢
                    document.getElementById('topSignalTop8RsiThreshold').value = top8ConfigResult.config.rsi_threshold || 1800;
                    document.getElementById('topSignalTop8MaxOrder').value = top8ConfigResult.config.max_order_usdt || 5;
                    updateTopSignalTop8Display();
                }
                
                // åŠ è½½Bottom8åšç©ºç­–ç•¥é…ç½®ï¼ˆåŒ…æ‹¬å¼€å…³çŠ¶æ€ã€RSIé˜ˆå€¼ã€å•å¸é™é¢ï¼‰
                const bottom8ConfigResponse = await fetch(`/api/okx-trading/get-top-signal-config/${account.id}/bottom8_short`);
                const bottom8ConfigResult = await bottom8ConfigResponse.json();
                
                console.log('ğŸ” [loadTopSignalConfig] Bottom8åšç©ºé…ç½®:', bottom8ConfigResult);
                
                if (bottom8ConfigResult.success && bottom8ConfigResult.config) {
                    // è®¾ç½®å¼€å…³çŠ¶æ€ï¼ˆä»é…ç½®æ–‡ä»¶çš„enabledå­—æ®µè¯»å–ï¼‰
                    const bottom8Switch = document.getElementById('topSignalBottom8ShortSwitch');
                    if (bottom8Switch) {
                        bottom8Switch.checked = bottom8ConfigResult.config.enabled === true;
                        console.log('ğŸ” [loadTopSignalConfig] è®¾ç½®Bottom8åšç©ºå¼€å…³:', {
                            enabled: bottom8ConfigResult.config.enabled,
                            checked: bottom8Switch.checked
                        });
                    }
                    
                    // è®¾ç½®RSIé˜ˆå€¼å’Œå•å¸é™é¢
                    document.getElementById('topSignalBottom8RsiThreshold').value = bottom8ConfigResult.config.rsi_threshold || 1800;
                    document.getElementById('topSignalBottom8MaxOrder').value = bottom8ConfigResult.config.max_order_usdt || 5;
                    updateTopSignalBottom8Display();
                }
                
                console.log(`âœ… Loaded top signal config for ${account.name}`, {
                    top8_enabled: top8ConfigResult.config?.enabled,
                    bottom8_enabled: bottom8ConfigResult.config?.enabled
                });
            } catch (e) {
                console.error('Load top signal config error:', e);
            }
        }
        
        // åŠ è½½è§åº•ä¿¡å·ç­–ç•¥é…ç½®
        async function loadBottomSignalConfig() {
            const account = accounts.find(acc => acc.id === currentAccount);
            if (!account) {
                console.log('No account selected, skip loading bottom signal config');
                return;
            }
            
            try {
                // åŠ è½½Top8ç­–ç•¥é…ç½®
                const top8Response = await fetch(`/api/okx-trading/get-bottom-signal-config/${account.id}/top8_long`);
                const top8Result = await top8Response.json();
                
                if (top8Result.success && top8Result.config) {
                    document.getElementById('bottomSignalTop8LongSwitch').checked = top8Result.config.enabled || false;
                    document.getElementById('bottomSignalTop8RsiThreshold').value = top8Result.config.rsi_threshold || 800;
                    document.getElementById('bottomSignalTop8MaxOrder').value = top8Result.config.max_order_usdt || 5;
                    updateBottomSignalTop8Display();
                }
                
                // åŠ è½½Bottom8ç­–ç•¥é…ç½®
                const bottom8Response = await fetch(`/api/okx-trading/get-bottom-signal-config/${account.id}/bottom8_long`);
                const bottom8Result = await bottom8Response.json();
                
                if (bottom8Result.success && bottom8Result.config) {
                    document.getElementById('bottomSignalBottom8LongSwitch').checked = bottom8Result.config.enabled || false;
                    document.getElementById('bottomSignalBottom8RsiThreshold').value = bottom8Result.config.rsi_threshold || 800;
                    document.getElementById('bottomSignalBottom8MaxOrder').value = bottom8Result.config.max_order_usdt || 5;
                    updateBottomSignalBottom8Display();
                }
                
                console.log(`âœ… Loaded bottom signal config for ${account.name}`);
            } catch (e) {
                console.error('Load bottom signal config error:', e);
            }
        }
        
        // åˆ·æ–°ç­–ç•¥çŠ¶æ€æ€»è§ˆ
        // é‡ç½®æ‰€æœ‰ç­–ç•¥çš„æ‰§è¡Œè®¸å¯
        async function resetAllStrategiesExecution() {
            const account = accounts.find(acc => acc.id === currentAccount);
            if (!account) {
                alert('è¯·å…ˆé€‰æ‹©è´¦æˆ·');
                return;
            }
            
            const confirmed = confirm(`ç¡®è®¤è¦é‡ç½® ${account.name} çš„æ‰€æœ‰ç­–ç•¥æ‰§è¡Œè®¸å¯å—ï¼Ÿ\n\nè¿™å°†å…è®¸æ‰€æœ‰ç­–ç•¥é‡æ–°æ‰§è¡Œï¼ˆè§£é™¤1å°æ—¶å†·å´é™åˆ¶ï¼‰ã€‚`);
            if (!confirmed) {
                return;
            }
            
            try {
                const strategies = [
                    { type: 'top8_short', api: 'top-signal', name: 'è§é¡¶+å‰8ç©º' },
                    { type: 'bottom8_short', api: 'top-signal', name: 'è§é¡¶+å8ç©º' },
                    { type: 'top8_long', api: 'bottom-signal', name: 'è§åº•+å‰8å¤š' },
                    { type: 'bottom8_long', api: 'bottom-signal', name: 'è§åº•+å8å¤š' }
                ];
                
                let successCount = 0;
                let failedList = [];
                
                for (const strategy of strategies) {
                    try {
                        const endpoint = strategy.api === 'top-signal' 
                            ? `/api/okx-trading/set-allowed-top-signal/${account.id}/${strategy.type}`
                            : `/api/okx-trading/set-allowed-bottom-signal/${account.id}/${strategy.type}`;
                        
                        const response = await fetch(endpoint, {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify({
                                allowed: true,
                                reason: 'ç”¨æˆ·æ‰‹åŠ¨é‡ç½®æ‰€æœ‰ç­–ç•¥æ‰§è¡Œè®¸å¯'
                            })
                        });
                        
                        if (response.ok) {
                            successCount++;
                        } else {
                            failedList.push(strategy.name);
                        }
                    } catch (e) {
                        console.error(`é‡ç½® ${strategy.name} å¤±è´¥:`, e);
                        failedList.push(strategy.name);
                    }
                }
                
                // åˆ·æ–°çŠ¶æ€æ˜¾ç¤º
                await refreshStrategyStatus();
                
                // æ˜¾ç¤ºç»“æœ
                if (successCount === strategies.length) {
                    alert(`âœ… æˆåŠŸé‡ç½®æ‰€æœ‰ ${successCount} ä¸ªç­–ç•¥çš„æ‰§è¡Œè®¸å¯ï¼`);
                } else if (successCount > 0) {
                    alert(`âš ï¸ éƒ¨åˆ†æˆåŠŸï¼š\næˆåŠŸé‡ç½® ${successCount} ä¸ªç­–ç•¥\nå¤±è´¥ ${failedList.length} ä¸ªï¼š${failedList.join(', ')}`);
                } else {
                    alert(`âŒ å…¨éƒ¨å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–è”ç³»ç®¡ç†å‘˜`);
                }
                
            } catch (error) {
                console.error('é‡ç½®ç­–ç•¥æ‰§è¡Œè®¸å¯å¤±è´¥:', error);
                alert('âŒ é‡ç½®å¤±è´¥ï¼Œè¯·é‡è¯•');
            }
        }
        
        async function refreshStrategyStatus() {
            console.log('ğŸ”„ [refreshStrategyStatus] å¼€å§‹åˆ·æ–°ç­–ç•¥çŠ¶æ€');
            
            const statusElement = document.getElementById('strategyStatusContent');
            if (!statusElement) {
                console.error('âŒ [refreshStrategyStatus] æœªæ‰¾åˆ°strategyStatusContentå…ƒç´ ');
                return;
            }
            
            const account = accounts.find(acc => acc.id === currentAccount);
            if (!account) {
                console.warn('âš ï¸ [refreshStrategyStatus] æœªé€‰æ‹©è´¦æˆ·');
                statusElement.innerHTML = 
                    '<div style="text-align: center; padding: 10px; color: #dc2626;">âŒ è¯·å…ˆé€‰æ‹©è´¦æˆ·</div>';
                return;
            }
            
            console.log('ğŸ“‹ [refreshStrategyStatus] å½“å‰è´¦æˆ·:', account.id);
            statusElement.innerHTML = 
                '<div style="text-align: center; padding: 10px; color: #a16207;">â³ æ­£åœ¨åŠ è½½ç­–ç•¥çŠ¶æ€...</div>';
            
            try {
                // è·å–4ä¸ªç­–ç•¥çš„çŠ¶æ€
                const strategies = [
                    { type: 'top8_short', name: 'âš ï¸ è§é¡¶+å‰8ç©º', api: 'top-signal', color: '#dc2626' },
                    { type: 'bottom8_short', name: 'âš ï¸ è§é¡¶+å8ç©º', api: 'top-signal', color: '#b91c1c' },
                    { type: 'top8_long', name: 'ğŸ¯ è§åº•+å‰8å¤š', api: 'bottom-signal', color: '#22c55e' },
                    { type: 'bottom8_long', name: 'ğŸ¯ è§åº•+å8å¤š', api: 'bottom-signal', color: '#10b981' }
                ];
                
                let statusHTML = '<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 6px;">';
                
                for (const strategy of strategies) {
                    console.log(`ğŸ” [refreshStrategyStatus] æ£€æŸ¥ç­–ç•¥: ${strategy.type}`);
                    
                    // è·å–é…ç½®çŠ¶æ€
                    let enabled = false;
                    let allowed = true;
                    
                    try {
                        if (strategy.api === 'top-signal') {
                            // è§é¡¶ä¿¡å·ç­–ç•¥ - ä»UIå…ƒç´ è·å–enabledçŠ¶æ€
                            if (strategy.type === 'top8_short') {
                                enabled = document.getElementById('topSignalTop8ShortSwitch')?.checked || false;
                            } else if (strategy.type === 'bottom8_short') {
                                enabled = document.getElementById('topSignalBottom8ShortSwitch')?.checked || false;
                            }
                            console.log(`  ğŸ“Š ${strategy.type} enabled from UI:`, enabled);
                            
                            // æ£€æŸ¥executionæ–‡ä»¶ï¼Œè®¾ç½®5ç§’è¶…æ—¶
                            try {
                                const controller = new AbortController();
                                const timeoutId = setTimeout(() => controller.abort(), 5000);
                                
                                const execResponse = await fetch(`/api/okx-trading/check-top-signal-status/${account.id}/${strategy.type}`, {
                                    signal: controller.signal
                                });
                                clearTimeout(timeoutId);
                                
                                if (execResponse.ok) {
                                    const execData = await execResponse.json();
                                    allowed = execData.allowed !== false;
                                    console.log(`  âœ… ${strategy.type} allowed from API:`, allowed);
                                } else {
                                    console.warn(`  âš ï¸ ${strategy.type} APIè¿”å›é200:`, execResponse.status);
                                }
                            } catch (e) {
                                if (e.name === 'AbortError') {
                                    console.error(`  â±ï¸ ${strategy.type} APIè¶…æ—¶`);
                                } else {
                                    console.error(`  âŒ ${strategy.type} APIé”™è¯¯:`, e.message);
                                }
                                allowed = true;  // é»˜è®¤å…è®¸
                            }
                        } else {
                            // è§åº•ä¿¡å·ç­–ç•¥ - ä»configè·å–
                            try {
                                const controller = new AbortController();
                                const timeoutId = setTimeout(() => controller.abort(), 5000);
                                
                                const configResponse = await fetch(`/api/okx-trading/get-bottom-signal-config/${account.id}/${strategy.type}`, {
                                    signal: controller.signal
                                });
                                clearTimeout(timeoutId);
                                
                                if (configResponse.ok) {
                                    const configData = await configResponse.json();
                                    enabled = configData.config?.enabled || false;
                                    console.log(`  ğŸ“Š ${strategy.type} enabled from config:`, enabled);
                                }
                            } catch (e) {
                                if (e.name === 'AbortError') {
                                    console.error(`  â±ï¸ ${strategy.type} é…ç½®APIè¶…æ—¶`);
                                } else {
                                    console.error(`  âŒ ${strategy.type} é…ç½®APIé”™è¯¯:`, e.message);
                                }
                            }
                            
                            // æ£€æŸ¥executionçŠ¶æ€ï¼Œè®¾ç½®5ç§’è¶…æ—¶
                            try {
                                const controller = new AbortController();
                                const timeoutId = setTimeout(() => controller.abort(), 5000);
                                
                                const execResponse = await fetch(`/api/okx-trading/check-bottom-signal-status/${account.id}/${strategy.type}`, {
                                    signal: controller.signal
                                });
                                clearTimeout(timeoutId);
                                
                                if (execResponse.ok) {
                                    const execData = await execResponse.json();
                                    allowed = execData.allowed !== false;
                                    console.log(`  âœ… ${strategy.type} allowed from API:`, allowed);
                                }
                            } catch (e) {
                                if (e.name === 'AbortError') {
                                    console.error(`  â±ï¸ ${strategy.type} æ‰§è¡ŒAPIè¶…æ—¶`);
                                } else {
                                    console.error(`  âŒ ${strategy.type} æ‰§è¡ŒAPIé”™è¯¯:`, e.message);
                                }
                                allowed = true;  // é»˜è®¤å…è®¸
                            }
                        }
                    } catch (e) {
                        console.error(`âŒ åŠ è½½ ${strategy.type} çŠ¶æ€å¤±è´¥:`, e);
                    }
                    
                    // ç”ŸæˆçŠ¶æ€å¡ç‰‡
                    const enabledIcon = enabled ? 'âœ…' : 'âšª';
                    const allowedIcon = allowed ? 'âœ…' : 'ğŸš«';
                    const bgColor = enabled ? 'rgba(34, 197, 94, 0.1)' : 'rgba(156, 163, 175, 0.1)';
                    
                    statusHTML += `
                        <div style="padding: 6px; background: ${bgColor}; border-radius: 4px; border: 1px solid ${strategy.color};">
                            <div style="font-size: 10px; font-weight: 600; color: ${strategy.color}; margin-bottom: 2px;">${strategy.name}</div>
                            <div style="font-size: 9px; color: #78350f;">
                                ${enabledIcon} å¼€å…³ | ${allowedIcon} è®¸å¯
                            </div>
                        </div>
                    `;
                }
                
                statusHTML += '</div>';
                statusHTML += '<div style="font-size: 9px; color: #92400e; margin-top: 6px; text-align: center;">âœ…=å·²å¼€å¯/å…è®¸ | âšª=å·²å…³é—­ | ğŸš«=å†·å´ä¸­</div>';
                
                statusElement.innerHTML = statusHTML;
                console.log('âœ… [refreshStrategyStatus] ç­–ç•¥çŠ¶æ€åˆ·æ–°å®Œæˆ');
                
            } catch (error) {
                console.error('âŒ [refreshStrategyStatus] åˆ·æ–°ç­–ç•¥çŠ¶æ€å¤±è´¥:', error);
                statusElement.innerHTML = 
                    '<div style="text-align: center; padding: 10px; color: #dc2626;">âŒ åŠ è½½å¤±è´¥ï¼Œè¯·é‡è¯•</div>';
            }
        }
        
        // ==================== è§åº•ä¿¡å·åšå¤šç­–ç•¥å‡½æ•°ç»“æŸ ====================
        
        // æ›´æ–°è‡ªåŠ¨äº¤æ˜“çŠ¶æ€æ˜¾ç¤º
        function updateAutoTradeStatus(enabled, lastExecutedTime, suffix = '') {
            const statusId = suffix ? `autoTradeStatus${suffix}` : 'autoTradeStatus';
            const timeId = suffix ? `autoTradeLastTime${suffix}` : 'autoTradeLastTime';
            
            const statusEl = document.getElementById(statusId);
            const timeEl = document.getElementById(timeId);
            
            if (statusEl) {
                if (enabled) {
                    statusEl.textContent = 'ğŸŸ¢ å·²å¯ç”¨ï¼ˆç›‘æ§ä¸­ï¼‰';
                    statusEl.style.color = '#10b981';
                } else {
                    statusEl.textContent = 'âšª æœªå¯ç”¨';
                    statusEl.style.color = '#6b7280';
                }
            }
            
            if (timeEl) {
                if (lastExecutedTime) {
                    timeEl.textContent = lastExecutedTime;
                } else {
                    timeEl.textContent = '--';
                }
            }
        }
        
        // æ›´æ–°æœåŠ¡å™¨è‡ªåŠ¨äº¤æ˜“è®¾ç½®æ˜¾ç¤º
        function updateServerAutoTradeDisplay(settings, suffix = '') {
            const settingsBoxId = suffix ? `serverAutoTradeSettings${suffix}` : 'serverAutoTradeSettings';
            const triggerPriceId = suffix ? `serverTriggerPrice${suffix}` : 'serverTriggerPrice';
            const statusBadgeId = suffix ? `serverAutoTradeStatusBadge${suffix}` : 'serverAutoTradeStatusBadge';
            
            const settingsBox = document.getElementById(settingsBoxId);
            const triggerPriceEl = document.getElementById(triggerPriceId);
            const statusBadgeEl = document.getElementById(statusBadgeId);
            
            if (!settingsBox || !triggerPriceEl || !statusBadgeEl) return;
            
            // å§‹ç»ˆæ˜¾ç¤ºæœåŠ¡å™¨è®¾ç½®ï¼ˆåŒ…æ‹¬JSONLæ‰§è¡Œè®¸å¯å’Œé‡ç½®æŒ‰é’®ï¼‰
            settingsBox.style.display = 'block';
            triggerPriceEl.textContent = `$${(settings.triggerPrice || 68000).toFixed(2)}`;
            
            if (settings.enabled) {
                statusBadgeEl.textContent = 'âœ… å·²å¯ç”¨';
                statusBadgeEl.style.color = '#10b981';
            } else {
                statusBadgeEl.textContent = 'âšª æœªå¯ç”¨';
                statusBadgeEl.style.color = '#6b7280';
            }
            
            // å§‹ç»ˆæ£€æŸ¥JSONLçŠ¶æ€ï¼ˆæ— è®ºenabledæ˜¯å¦ä¸ºtrueï¼‰
            updateJsonlAllowedStatus(settings.strategyType, suffix);
            
            console.log('âœ… å·²æ›´æ–°æœåŠ¡å™¨è‡ªåŠ¨äº¤æ˜“è®¾ç½®æ˜¾ç¤º:', settings);
        }
        
        // æ£€æŸ¥å¹¶æ›´æ–°JSONLæ‰§è¡Œè®¸å¯çŠ¶æ€
        async function updateJsonlAllowedStatus(strategyType = 'bottom_performers', suffix = '') {
            const account = accounts.find(acc => acc.id === currentAccount);
            if (!account) return;
            
            // æ ¹æ®suffixç¡®å®šå…ƒç´ ID
            const jsonlStatusId = suffix ? `jsonlAllowedStatus${suffix}` : 'jsonlAllowedStatus';
            const jsonlStatusEl = document.getElementById(jsonlStatusId);
            
            if (!jsonlStatusEl) {
                console.warn(`âš ï¸ æœªæ‰¾åˆ°JSONLçŠ¶æ€å…ƒç´ : ${jsonlStatusId}`);
                return;
            }
            
            console.log(`ğŸ” æ£€æŸ¥JSONLæ‰§è¡Œè®¸å¯çŠ¶æ€: strategy=${strategyType}, suffix=${suffix}, elementId=${jsonlStatusId}`);
            
            try {
                // æ ¹æ®ç­–ç•¥ç±»å‹è°ƒç”¨ä¸åŒçš„API
                const response = await fetch(`/api/okx-trading/check-allowed/${account.id}/${strategyType}`);
                const result = await response.json();
                
                console.log(`ğŸ“„ JSONLçŠ¶æ€æ£€æŸ¥ç»“æœ:`, result);
                
                if (result.success) {
                    if (result.allowed) {
                        jsonlStatusEl.textContent = 'âœ… å…è®¸æ‰§è¡Œ';
                        jsonlStatusEl.style.color = '#10b981';
                    } else {
                        jsonlStatusEl.textContent = 'ğŸš« å·²ç¦æ­¢';
                        jsonlStatusEl.style.color = '#ef4444';
                    }
                } else {
                    jsonlStatusEl.textContent = 'âŒ æ£€æŸ¥å¤±è´¥';
                    jsonlStatusEl.style.color = '#6b7280';
                }
            } catch (e) {
                console.error('æ£€æŸ¥JSONLçŠ¶æ€å¤±è´¥:', e);
                jsonlStatusEl.textContent = 'âŒ å¼‚å¸¸';
                jsonlStatusEl.style.color = '#6b7280';
            }
        }
        
        // é‡ç½®JSONLæ‰§è¡Œè®¸å¯
        async function resetJsonlAllowed(suffix = '') {
            const account = accounts.find(acc => acc.id === currentAccount);
            if (!account) {
                alert('âŒ è¯·å…ˆé€‰æ‹©è´¦æˆ·');
                return;
            }
            
            // è·å–å½“å‰ç­–ç•¥ç±»å‹
            const typeId = suffix ? `autoStrategyType${suffix}` : 'autoStrategyType';
            const typeEl = document.getElementById(typeId);
            const strategyType = typeEl ? typeEl.value : 'bottom_performers';
            
            // è·å–è§¦å‘ä»·æ ¼
            const priceId = suffix ? `autoTriggerPrice${suffix}` : 'autoTriggerPrice';
            const priceEl = document.getElementById(priceId);
            const triggerPrice = priceEl ? parseFloat(priceEl.value) : 66000;
            
            if (!confirm(`ğŸ”„ ç¡®è®¤é‡ç½®æ‰§è¡Œè®¸å¯ï¼Ÿ\n\nè¿™å°†å…è®¸ç­–ç•¥å†æ¬¡æ‰§è¡Œã€‚\n\nè´¦æˆ·: ${account.name}\nç­–ç•¥: ${strategyType === 'top_performers' ? 'æ¶¨å¹…å‰8å' : 'æ¶¨å¹…å8å'}\nè§¦å‘ä»·æ ¼: $${triggerPrice}`)) {
                return;
            }
            
            try {
                const response = await fetch(`/api/okx-trading/set-allowed/${account.id}/${strategyType}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        allowed: true,
                        reason: 'User manually reset execution permission',
                        triggerPrice: triggerPrice
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    alert('âœ… é‡ç½®æˆåŠŸï¼ç­–ç•¥ç°åœ¨å¯ä»¥æ‰§è¡Œäº†ã€‚');
                    // åˆ·æ–°JSONLçŠ¶æ€æ˜¾ç¤º
                    await updateJsonlAllowedStatus(strategyType, suffix);
                } else {
                    alert(`âŒ é‡ç½®å¤±è´¥: ${result.error}`);
                }
            } catch (e) {
                alert('âŒ é‡ç½®å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥');
                console.error('é‡ç½®JSONLè®¸å¯å¤±è´¥:', e);
            }
        }
        
        // é‡ç½®æ¶¨å¹…å‰8åç­–ç•¥çš„JSONLæ‰§è¡Œè®¸å¯
        async function resetJsonlAllowedUpRatio0Top8() {
            const account = accounts.find(acc => acc.id === currentAccount);
            if (!account) {
                alert('âŒ è¯·å…ˆé€‰æ‹©è´¦æˆ·');
                return;
            }
            
            const strategyType = 'top8';
            
            // è·å–å½“å‰ä¸Šæ¶¨å æ¯”
            const upRatioEl = document.getElementById('currentUpRatioTop8');
            const currentUpRatio = upRatioEl ? parseFloat(upRatioEl.textContent) : 0;
            
            if (!confirm(`ğŸ”„ ç¡®è®¤é‡ç½®æ¶¨å¹…å‰8åç­–ç•¥çš„æ‰§è¡Œè®¸å¯ï¼Ÿ\n\nè¿™å°†å…è®¸ç­–ç•¥å†æ¬¡æ‰§è¡Œã€‚\n\nè´¦æˆ·: ${account.name}\nç­–ç•¥ç±»å‹: æ¶¨å¹…å‰8å\nå½“å‰ä¸Šæ¶¨å æ¯”: ${currentUpRatio}%`)) {
                return;
            }
            
            try {
                const response = await fetch(`/api/okx-trading/set-allowed-upratio0/${account.id}/${strategyType}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        allowed: true,
                        reason: 'User manually reset execution permission for top8 strategy',
                        up_ratio: currentUpRatio
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    alert('âœ… é‡ç½®æˆåŠŸï¼æ¶¨å¹…å‰8åç­–ç•¥ç°åœ¨å¯ä»¥æ‰§è¡Œäº†ã€‚');
                    // åˆ·æ–°JSONLçŠ¶æ€æ˜¾ç¤º
                    const jsonlStatusEl = document.getElementById('jsonlAllowedStatusUpRatio0Top8');
                    if (jsonlStatusEl) {
                        jsonlStatusEl.textContent = 'âœ… å…è®¸æ‰§è¡Œ';
                        jsonlStatusEl.style.color = '#10b981';
                    }
                } else {
                    alert(`âŒ é‡ç½®å¤±è´¥: ${result.error}`);
                }
            } catch (e) {
                alert('âŒ é‡ç½®å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥');
                console.error('é‡ç½®æ¶¨å¹…å‰8åç­–ç•¥JSONLè®¸å¯å¤±è´¥:', e);
            }
        }
        
        // é‡ç½®æ¶¨å¹…å8åç­–ç•¥çš„JSONLæ‰§è¡Œè®¸å¯
        async function resetJsonlAllowedUpRatio0Bottom8() {
            const account = accounts.find(acc => acc.id === currentAccount);
            if (!account) {
                alert('âŒ è¯·å…ˆé€‰æ‹©è´¦æˆ·');
                return;
            }
            
            const strategyType = 'bottom8';
            
            // è·å–å½“å‰ä¸Šæ¶¨å æ¯”
            const upRatioEl = document.getElementById('currentUpRatioBottom8');
            const currentUpRatio = upRatioEl ? parseFloat(upRatioEl.textContent) : 0;
            
            if (!confirm(`ğŸ”„ ç¡®è®¤é‡ç½®æ¶¨å¹…å8åç­–ç•¥çš„æ‰§è¡Œè®¸å¯ï¼Ÿ\n\nè¿™å°†å…è®¸ç­–ç•¥å†æ¬¡æ‰§è¡Œã€‚\n\nè´¦æˆ·: ${account.name}\nç­–ç•¥ç±»å‹: æ¶¨å¹…å8å\nå½“å‰ä¸Šæ¶¨å æ¯”: ${currentUpRatio}%`)) {
                return;
            }
            
            try {
                const response = await fetch(`/api/okx-trading/set-allowed-upratio0/${account.id}/${strategyType}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        allowed: true,
                        reason: 'User manually reset execution permission for bottom8 strategy',
                        up_ratio: currentUpRatio
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    alert('âœ… é‡ç½®æˆåŠŸï¼æ¶¨å¹…å8åç­–ç•¥ç°åœ¨å¯ä»¥æ‰§è¡Œäº†ã€‚');
                    // åˆ·æ–°JSONLçŠ¶æ€æ˜¾ç¤º
                    const jsonlStatusEl = document.getElementById('jsonlAllowedStatusUpRatio0Bottom8');
                    if (jsonlStatusEl) {
                        jsonlStatusEl.textContent = 'âœ… å…è®¸æ‰§è¡Œ';
                        jsonlStatusEl.style.color = '#10b981';
                    }
                } else {
                    alert(`âŒ é‡ç½®å¤±è´¥: ${result.error}`);
                }
            } catch (e) {
                alert('âŒ é‡ç½®å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥');
                console.error('é‡ç½®æ¶¨å¹…å8åç­–ç•¥JSONLè®¸å¯å¤±è´¥:', e);
            }
        }
        
        // æ›´æ–°æ€»æ¶¨è·Œå¹…æ˜¾ç¤º
        async function updateTotalChangeOKX() {
            try {
                const response = await fetch('/api/coin-change-tracker/latest');
                if (response.ok) {
                    const result = await response.json();
                    if (result.success && result.data) {
                        const totalChange = result.data.total_change;
                        const element = document.getElementById('totalChangePercent');
                        if (element) {
                            element.textContent = `${totalChange > 0 ? '+' : ''}${totalChange.toFixed(2)}%`;
                            element.style.color = totalChange > 0 ? '#10b981' : totalChange < 0 ? '#ef4444' : '#6b7280';
                        }
                    }
                }
            } catch (e) {
                console.warn('âš ï¸ OKXé¡µé¢ï¼šæ›´æ–°æ€»æ¶¨è·Œå¹…å¤±è´¥', e);
            }
        }
        
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        (async () => {
            await init();
            
            // åŠ è½½é¢„è­¦è®¾ç½®
            loadAlertSettingsOKX();
            
            // åŠ è½½æ­¢ç›ˆæ­¢æŸè®¾ç½®
            loadTakeProfitStopLossSettings();
            
            // åŠ è½½è‡ªåŠ¨äº¤æ˜“ç­–ç•¥è®¾ç½®
            loadAutoStrategySettings();
            
            // ğŸ†• åŠ è½½è¿½æ¶¨ç­–ç•¥è®¾ç½®ï¼ˆæ¶¨å¹…å‰8åï¼‰
            loadAutoStrategySettingsTop();
            
            // ğŸ†• åŠ è½½ä¸Šæ¶¨å æ¯”0ç­–ç•¥è®¾ç½®
            loadUpRatio0StrategySettings();
            
            // âœ… æ·»åŠ äº‹ä»¶ç›‘å¬å™¨ï¼ˆå¿…é¡»åœ¨DOMåŠ è½½åï¼‰
            // æ·»åŠ æ­¢ç›ˆæ­¢æŸè®¾ç½®çš„äº‹ä»¶ç›‘å¬å™¨
            ['takeProfitThreshold', 'stopLossThreshold', 'rsiTakeProfitThreshold'].forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.addEventListener('change', saveTakeProfitStopLossSettings);
                }
            });
            
            ['takeProfitSwitch', 'stopLossSwitch'].forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.addEventListener('change', saveTakeProfitStopLossSettings);
                }
            });
            
            // RSIæ­¢ç›ˆå¼€å…³ç‰¹æ®Šå¤„ç†ï¼šåŒæ—¶è®¾ç½®JSONLæ‰§è¡Œè®¸å¯
            const rsiTakeProfitSwitchEl = document.getElementById('rsiTakeProfitSwitch');
            if (rsiTakeProfitSwitchEl) {
                rsiTakeProfitSwitchEl.addEventListener('change', async function() {
                    // ä¿å­˜è®¾ç½®
                    await saveTakeProfitStopLossSettings();
                    
                    // è®¾ç½®JSONLæ‰§è¡Œè®¸å¯ï¼ˆå¤šå•ï¼‰
                    const account = accounts.find(acc => acc.id === currentAccount);
                    if (!account) return;
                    
                    const enabled = this.checked;
                    const rsiValue = parseFloat(document.getElementById('rsiTakeProfitThreshold').value) || 1900;
                    
                    try {
                        const response = await fetch(`/api/okx-trading/set-allowed-takeprofit/${account.id}`, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                allowed: enabled,
                                reason: enabled ? `å¼€å¯RSIå¤šå•æ­¢ç›ˆç›‘æ§ï¼Œé˜ˆå€¼${rsiValue}` : 'å…³é—­RSIå¤šå•æ­¢ç›ˆç›‘æ§',
                                takeprofitType: 'rsi',
                                rsiValue: rsiValue,
                                posSide: 'long'  // å¤šå•
                            })
                        });
                        
                        const result = await response.json();
                        console.log(enabled ? `âœ… å·²å¼€å¯RSIå¤šå•æ­¢ç›ˆç›‘æ§` : `âšª å·²å…³é—­RSIå¤šå•æ­¢ç›ˆç›‘æ§`, result);
                    } catch (e) {
                        console.error('âŒ è®¾ç½®RSIå¤šå•æ­¢ç›ˆæ‰§è¡Œè®¸å¯å¤±è´¥', e);
                    }
                });
            }
            
            // RSIç©ºå•æ­¢ç›ˆå¼€å…³ç‰¹æ®Šå¤„ç†ï¼šåŒæ—¶è®¾ç½®JSONLæ‰§è¡Œè®¸å¯
            const rsiShortTakeProfitSwitchEl = document.getElementById('rsiShortTakeProfitSwitch');
            if (rsiShortTakeProfitSwitchEl) {
                rsiShortTakeProfitSwitchEl.addEventListener('change', async function() {
                    // ä¿å­˜è®¾ç½®
                    await saveTakeProfitStopLossSettings();
                    
                    // è®¾ç½®JSONLæ‰§è¡Œè®¸å¯ï¼ˆç©ºå•ï¼‰
                    const account = accounts.find(acc => acc.id === currentAccount);
                    if (!account) return;
                    
                    const enabled = this.checked;
                    const rsiValue = parseFloat(document.getElementById('rsiShortTakeProfitThreshold').value) || 810;
                    
                    try {
                        const response = await fetch(`/api/okx-trading/set-allowed-takeprofit/${account.id}`, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                allowed: enabled,
                                reason: enabled ? `å¼€å¯RSIç©ºå•æ­¢ç›ˆç›‘æ§ï¼Œé˜ˆå€¼${rsiValue}` : 'å…³é—­RSIç©ºå•æ­¢ç›ˆç›‘æ§',
                                takeprofitType: 'rsi',
                                rsiValue: rsiValue,
                                posSide: 'short'  // ç©ºå•
                            })
                        });
                        
                        const result = await response.json();
                        console.log(enabled ? `âœ… å·²å¼€å¯RSIç©ºå•æ­¢ç›ˆç›‘æ§` : `âšª å·²å…³é—­RSIç©ºå•æ­¢ç›ˆç›‘æ§`, result);
                        
                        // æ˜¾ç¤ºç”¨æˆ·æç¤º
                        if (result.success) {
                            alert(enabled ? 
                                `âœ… å·²å¼€å¯RSIç©ºå•æ­¢ç›ˆç›‘æ§\n\nè´¦æˆ·ï¼š${account.name}\né˜ˆå€¼ï¼š${rsiValue}\nè¯´æ˜ï¼šå½“RSIè·Œç ´${rsiValue}æ—¶ï¼Œå°†è‡ªåŠ¨å¹³æ‰æ‰€æœ‰ç©ºå•` : 
                                `âšª å·²å…³é—­RSIç©ºå•æ­¢ç›ˆç›‘æ§\n\nè´¦æˆ·ï¼š${account.name}`
                            );
                        }
                    } catch (e) {
                        console.error('âŒ è®¾ç½®RSIç©ºå•æ­¢ç›ˆæ‰§è¡Œè®¸å¯å¤±è´¥', e);
                        alert('âŒ è®¾ç½®å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥');
                    }
                });
            }
            
            // ğŸ”¥ å¸‚åœºæƒ…ç»ªæ­¢ç›ˆå¼€å…³ï¼šåªä¿å­˜è®¾ç½®ï¼Œä¸éœ€è¦JSONLè®¸å¯
            const sentimentTakeProfitSwitchEl = document.getElementById('sentimentTakeProfitSwitch');
            if (sentimentTakeProfitSwitchEl) {
                sentimentTakeProfitSwitchEl.addEventListener('change', async function() {
                    await saveTakeProfitStopLossSettings();
                    const enabled = this.checked;
                    console.log(enabled ? `âœ… å·²å¼€å¯å¸‚åœºæƒ…ç»ªæ­¢ç›ˆç›‘æ§` : `âšª å·²å…³é—­å¸‚åœºæƒ…ç»ªæ­¢ç›ˆç›‘æ§`);
                });
            }
            
            // âš ï¸ è§é¡¶ä¿¡å·+æ¶¨å¹…å‰8åšç©ºå¼€å…³ï¼šä¿å­˜è®¾ç½® + è®¾ç½®JSONLæ‰§è¡Œè®¸å¯
            const topSignalTop8ShortSwitchEl = document.getElementById('topSignalTop8ShortSwitch');
            if (topSignalTop8ShortSwitchEl) {
                topSignalTop8ShortSwitchEl.addEventListener('change', async function() {
                    await saveTopSignalTop8Config();
                });
            }
            
            // âš ï¸ è§é¡¶ä¿¡å·+æ¶¨å¹…å8åšç©ºå¼€å…³ï¼šä¿å­˜è®¾ç½® + è®¾ç½®JSONLæ‰§è¡Œè®¸å¯
            const topSignalBottom8ShortSwitchEl = document.getElementById('topSignalBottom8ShortSwitch');
            if (topSignalBottom8ShortSwitchEl) {
                topSignalBottom8ShortSwitchEl.addEventListener('change', async function() {
                    await saveTopSignalBottom8Config();
                });
            }
            
            // ğŸ¯ è§åº•ä¿¡å·+æ¶¨å¹…å‰8åšå¤šå¼€å…³ï¼šä¿å­˜è®¾ç½® + è®¾ç½®JSONLæ‰§è¡Œè®¸å¯
            const bottomSignalTop8LongSwitchEl = document.getElementById('bottomSignalTop8LongSwitch');
            if (bottomSignalTop8LongSwitchEl) {
                bottomSignalTop8LongSwitchEl.addEventListener('change', async function() {
                    await saveBottomSignalTop8Config();
                });
            }
            
            // ğŸ¯ è§åº•ä¿¡å·+æ¶¨å¹…å8åšå¤šå¼€å…³ï¼šä¿å­˜è®¾ç½® + è®¾ç½®JSONLæ‰§è¡Œè®¸å¯
            const bottomSignalBottom8LongSwitchEl = document.getElementById('bottomSignalBottom8LongSwitch');
            if (bottomSignalBottom8LongSwitchEl) {
                bottomSignalBottom8LongSwitchEl.addEventListener('change', async function() {
                    await saveBottomSignalBottom8Config();
                });
            }
            
            // æ·»åŠ è‡ªåŠ¨äº¤æ˜“ç­–ç•¥è®¾ç½®çš„äº‹ä»¶ç›‘å¬å™¨
            const autoTriggerPriceEl = document.getElementById('autoTriggerPrice');
            if (autoTriggerPriceEl) {
                autoTriggerPriceEl.addEventListener('change', saveAutoStrategySettings);
                console.log('âœ… autoTriggerPrice äº‹ä»¶ç›‘å¬å™¨å·²æ·»åŠ ');
            } else {
                console.warn('âš ï¸ æœªæ‰¾åˆ° autoTriggerPrice å…ƒç´ ');
            }
            
            const autoTradeSwitchEl = document.getElementById('autoTradeSwitch');
            if (autoTradeSwitchEl) {
                autoTradeSwitchEl.addEventListener('change', saveAutoStrategySettings);
                console.log('âœ… autoTradeSwitch äº‹ä»¶ç›‘å¬å™¨å·²æ·»åŠ ');
            } else {
                console.warn('âš ï¸ æœªæ‰¾åˆ° autoTradeSwitch å…ƒç´ ');
            }
            
            // æ·»åŠ è¿½æ¶¨ç­–ç•¥ï¼ˆæ¶¨å¹…å‰8åï¼‰çš„äº‹ä»¶ç›‘å¬å™¨
            const autoTriggerPriceTopEl = document.getElementById('autoTriggerPriceTop');
            if (autoTriggerPriceTopEl) {
                autoTriggerPriceTopEl.addEventListener('change', () => saveAutoStrategySettings('Top'));
                console.log('âœ… autoTriggerPriceTop äº‹ä»¶ç›‘å¬å™¨å·²æ·»åŠ ');
            } else {
                console.warn('âš ï¸ æœªæ‰¾åˆ° autoTriggerPriceTop å…ƒç´ ');
            }
            
            const autoTradeSwitchTopEl = document.getElementById('autoTradeSwitchTop');
            if (autoTradeSwitchTopEl) {
                autoTradeSwitchTopEl.addEventListener('change', () => saveAutoStrategySettings('Top'));
                console.log('âœ… autoTradeSwitchTop äº‹ä»¶ç›‘å¬å™¨å·²æ·»åŠ ');
            } else {
                console.warn('âš ï¸ æœªæ‰¾åˆ° autoTradeSwitchTop å…ƒç´ ');
            }
            
            // æ·»åŠ å•ç¬”ä¸Šé™é…ç½®çš„äº‹ä»¶ç›‘å¬å™¨ï¼ˆæ¶¨å¹…å8åå’Œæ¶¨å¹…å‰8åï¼‰
            const maxOrderSizeEl = document.getElementById('maxOrderSizeInput');
            if (maxOrderSizeEl) {
                maxOrderSizeEl.addEventListener('change', saveAutoStrategySettings);
                console.log('âœ… maxOrderSizeInput äº‹ä»¶ç›‘å¬å™¨å·²æ·»åŠ ');
            }
            
            const maxOrderSizeTopEl = document.getElementById('maxOrderSizeInputTop');
            if (maxOrderSizeTopEl) {
                maxOrderSizeTopEl.addEventListener('change', () => saveAutoStrategySettings('Top'));
                console.log('âœ… maxOrderSizeInputTop äº‹ä»¶ç›‘å¬å™¨å·²æ·»åŠ ');
            }
            
            // âœ… ä¸Šæ¶¨å æ¯”0ç­–ç•¥Aï¼ˆæ¶¨å¹…å‰8åï¼‰å¼€å…³äº‹ä»¶ç›‘å¬
            const autoTradeSwitchUpRatio0Top8El = document.getElementById('autoTradeSwitchUpRatio0Top8');
            if (autoTradeSwitchUpRatio0Top8El) {
                autoTradeSwitchUpRatio0Top8El.addEventListener('change', async function() {
                    const account = accounts.find(acc => acc.id === currentAccount);
                    if (!account) return;
                    
                    const enabled = this.checked;
                    console.log(`[ä¸Šæ¶¨å æ¯”0-æ¶¨å¹…å‰8å] å¼€å…³${enabled ? 'å¼€å¯' : 'å…³é—­'}`);
                    
                    // æ›´æ–°å¼€å…³çŠ¶æ€æ˜¾ç¤º
                    const switchStatusEl = document.getElementById('switchStatusUpRatio0Top8');
                    if (switchStatusEl) {
                        switchStatusEl.textContent = enabled ? 'ğŸŸ¢ å·²å¼€å¯' : 'ğŸ”´ æœªå¼€å¯';
                        switchStatusEl.style.color = enabled ? '#10b981' : '#6b7280';
                    }
                    
                    // å¦‚æœå¼€å¯ï¼Œå†™å…¥JSONLè®¾ç½®allowed=true
                    if (enabled) {
                        try {
                            await fetch(`/api/okx-trading/set-allowed-upratio0/${account.id}/top8`, {
                                method: 'POST',
                                headers: { 'Content-Type': 'application/json' },
                                body: JSON.stringify({
                                    allowed: true,
                                    reason: 'User enabled strategy',
                                    upRatio: null
                                })
                            });
                            console.log('âœ… å·²å†™å…¥JSONLï¼šå…è®¸æ‰§è¡Œï¼ˆæ¶¨å¹…å‰8åï¼‰');
                            
                            // æ›´æ–°çŠ¶æ€æ˜¾ç¤º
                            const statusEl = document.getElementById('autoTradeStatusUpRatio0Top8');
                            if (statusEl) statusEl.textContent = 'ç›‘æ§ä¸­';
                            
                            const switchStatusEl = document.getElementById('switchStatusUpRatio0Top8');
                            if (switchStatusEl) {
                                switchStatusEl.textContent = 'ğŸŸ¢ å·²å¼€å¯';
                                switchStatusEl.style.color = '#10b981';
                            }
                            
                            // ğŸ†• æ›´æ–°JSONLæ‰§è¡Œè®¸å¯çŠ¶æ€æ˜¾ç¤º
                            const jsonlStatusEl = document.getElementById('jsonlAllowedStatusUpRatio0Top8');
                            if (jsonlStatusEl) {
                                jsonlStatusEl.textContent = 'âœ… å…è®¸æ‰§è¡Œ';
                                jsonlStatusEl.style.color = '#10b981';
                            }
                        } catch (e) {
                            console.error('âŒ å†™å…¥JSONLå¤±è´¥:', e);
                            this.checked = false;
                        }
                    } else {
                        // å¦‚æœå…³é—­ï¼Œå†™å…¥JSONLè®¾ç½®allowed=false
                        try {
                            await fetch(`/api/okx-trading/set-allowed-upratio0/${account.id}/top8`, {
                                method: 'POST',
                                headers: { 'Content-Type': 'application/json' },
                                body: JSON.stringify({
                                    allowed: false,
                                    reason: 'User disabled strategy',
                                    upRatio: null
                                })
                            });
                            console.log('âœ… å·²å†™å…¥JSONLï¼šç¦æ­¢æ‰§è¡Œï¼ˆæ¶¨å¹…å‰8åï¼‰');
                            
                            // æ›´æ–°çŠ¶æ€æ˜¾ç¤º
                            const statusEl = document.getElementById('autoTradeStatusUpRatio0Top8');
                            if (statusEl) statusEl.textContent = 'æœªå¯ç”¨';
                            
                            const switchStatusEl = document.getElementById('switchStatusUpRatio0Top8');
                            if (switchStatusEl) {
                                switchStatusEl.textContent = 'ğŸ”´ æœªå¼€å¯';
                                switchStatusEl.style.color = '#6b7280';
                            }
                            
                            // ğŸ†• æ›´æ–°JSONLæ‰§è¡Œè®¸å¯çŠ¶æ€æ˜¾ç¤º
                            const jsonlStatusEl = document.getElementById('jsonlAllowedStatusUpRatio0Top8');
                            if (jsonlStatusEl) {
                                jsonlStatusEl.textContent = 'ğŸš« ç¦æ­¢æ‰§è¡Œ';
                                jsonlStatusEl.style.color = '#ef4444';
                            }
                        } catch (e) {
                            console.error('âŒ å†™å…¥JSONLå¤±è´¥:', e);
                        }
                    }
                });
                console.log('âœ… autoTradeSwitchUpRatio0Top8 äº‹ä»¶ç›‘å¬å™¨å·²æ·»åŠ ');
            } else {
                console.warn('âš ï¸ æœªæ‰¾åˆ° autoTradeSwitchUpRatio0Top8 å…ƒç´ ');
            }
            
            // âœ… ä¸Šæ¶¨å æ¯”0ç­–ç•¥Bï¼ˆæ¶¨å¹…å8åï¼‰å¼€å…³äº‹ä»¶ç›‘å¬
            const autoTradeSwitchUpRatio0Bottom8El = document.getElementById('autoTradeSwitchUpRatio0Bottom8');
            if (autoTradeSwitchUpRatio0Bottom8El) {
                autoTradeSwitchUpRatio0Bottom8El.addEventListener('change', async function() {
                    const account = accounts.find(acc => acc.id === currentAccount);
                    if (!account) return;
                    
                    const enabled = this.checked;
                    console.log(`[ä¸Šæ¶¨å æ¯”0-æ¶¨å¹…å8å] å¼€å…³${enabled ? 'å¼€å¯' : 'å…³é—­'}`);
                    
                    // æ›´æ–°å¼€å…³çŠ¶æ€æ˜¾ç¤º
                    const switchStatusEl = document.getElementById('switchStatusUpRatio0Bottom8');
                    if (switchStatusEl) {
                        switchStatusEl.textContent = enabled ? 'ğŸŸ¢ å·²å¼€å¯' : 'ğŸ”´ æœªå¼€å¯';
                        switchStatusEl.style.color = enabled ? '#10b981' : '#6b7280';
                    }
                    
                    // å¦‚æœå¼€å¯ï¼Œå†™å…¥JSONLè®¾ç½®allowed=true
                    if (enabled) {
                        try {
                            await fetch(`/api/okx-trading/set-allowed-upratio0/${account.id}/bottom8`, {
                                method: 'POST',
                                headers: { 'Content-Type': 'application/json' },
                                body: JSON.stringify({
                                    allowed: true,
                                    reason: 'User enabled strategy',
                                    upRatio: null
                                })
                            });
                            console.log('âœ… å·²å†™å…¥JSONLï¼šå…è®¸æ‰§è¡Œï¼ˆæ¶¨å¹…å8åï¼‰');
                            
                            // æ›´æ–°çŠ¶æ€æ˜¾ç¤º
                            const statusEl = document.getElementById('autoTradeStatusUpRatio0Bottom8');
                            if (statusEl) statusEl.textContent = 'ç›‘æ§ä¸­';
                            
                            const switchStatusEl = document.getElementById('switchStatusUpRatio0Bottom8');
                            if (switchStatusEl) {
                                switchStatusEl.textContent = 'ğŸŸ¢ å·²å¼€å¯';
                                switchStatusEl.style.color = '#10b981';
                            }
                            
                            // ğŸ†• æ›´æ–°JSONLæ‰§è¡Œè®¸å¯çŠ¶æ€æ˜¾ç¤º
                            const jsonlStatusEl = document.getElementById('jsonlAllowedStatusUpRatio0Bottom8');
                            if (jsonlStatusEl) {
                                jsonlStatusEl.textContent = 'âœ… å…è®¸æ‰§è¡Œ';
                                jsonlStatusEl.style.color = '#10b981';
                            }
                        } catch (e) {
                            console.error('âŒ å†™å…¥JSONLå¤±è´¥:', e);
                            this.checked = false;
                        }
                    } else {
                        // å¦‚æœå…³é—­ï¼Œå†™å…¥JSONLè®¾ç½®allowed=false
                        try {
                            await fetch(`/api/okx-trading/set-allowed-upratio0/${account.id}/bottom8`, {
                                method: 'POST',
                                headers: { 'Content-Type': 'application/json' },
                                body: JSON.stringify({
                                    allowed: false,
                                    reason: 'User disabled strategy',
                                    upRatio: null
                                })
                            });
                            console.log('âœ… å·²å†™å…¥JSONLï¼šç¦æ­¢æ‰§è¡Œï¼ˆæ¶¨å¹…å8åï¼‰');
                            
                            // æ›´æ–°çŠ¶æ€æ˜¾ç¤º
                            const statusEl = document.getElementById('autoTradeStatusUpRatio0Bottom8');
                            if (statusEl) statusEl.textContent = 'æœªå¯ç”¨';
                            
                            const switchStatusEl = document.getElementById('switchStatusUpRatio0Bottom8');
                            if (switchStatusEl) {
                                switchStatusEl.textContent = 'ğŸ”´ æœªå¼€å¯';
                                switchStatusEl.style.color = '#6b7280';
                            }
                            
                            // ğŸ†• æ›´æ–°JSONLæ‰§è¡Œè®¸å¯çŠ¶æ€æ˜¾ç¤º
                            const jsonlStatusEl = document.getElementById('jsonlAllowedStatusUpRatio0Bottom8');
                            if (jsonlStatusEl) {
                                jsonlStatusEl.textContent = 'ğŸš« ç¦æ­¢æ‰§è¡Œ';
                                jsonlStatusEl.style.color = '#ef4444';
                            }
                        } catch (e) {
                            console.error('âŒ å†™å…¥JSONLå¤±è´¥:', e);
                        }
                    }
                });
                console.log('âœ… autoTradeSwitchUpRatio0Bottom8 äº‹ä»¶ç›‘å¬å™¨å·²æ·»åŠ ');
            } else {
                console.warn('âš ï¸ æœªæ‰¾åˆ° autoTradeSwitchUpRatio0Bottom8 å…ƒç´ ');
            }
            
            // âœ… ç­–ç•¥ç±»å‹é€‰æ‹©å™¨äº‹ä»¶ç›‘å¬
            const autoStrategyTypeEl = document.getElementById('autoStrategyType');
            if (autoStrategyTypeEl) {
                autoStrategyTypeEl.addEventListener('change', function() {
                    // æ›´æ–°ç­–ç•¥æè¿°
                    const strategyTarget = document.getElementById('strategyTarget');
                    if (strategyTarget) {
                        strategyTarget.textContent = this.value === 'top_performers' ? 'æ¶¨å¹…å‰8å' : 'æ¶¨å¹…å8å';
                    }
                    // ä¿å­˜è®¾ç½®
                    saveAutoStrategySettings();
                });
                console.log('âœ… autoStrategyType äº‹ä»¶ç›‘å¬å™¨å·²æ·»åŠ ');
            } else {
                console.warn('âš ï¸ æœªæ‰¾åˆ° autoStrategyType å…ƒç´ ');
            }
        })();
        
        // è¯·æ±‚æµè§ˆå™¨é€šçŸ¥æƒé™
        if ('Notification' in window && Notification.permission === 'default') {
            Notification.requestPermission();
        }
        
        // æ›´æ–°æ€»æ¶¨è·Œå¹…
        updateTotalChangeOKX();

        // æ£€æŸ¥å¹¶æ‰§è¡Œè‡ªåŠ¨äº¤æ˜“ç­–ç•¥
        // å‘é€Telegramæ¶ˆæ¯
        async function sendTelegramMessage(message) {
            try {
                const response = await fetch('/api/telegram/send-message', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ message: message })
                });
                
                const result = await response.json();
                if (result.success) {
                    console.log('âœ… Telegramæ¶ˆæ¯å‘é€æˆåŠŸ');
                } else {
                    console.warn('âš ï¸ Telegramæ¶ˆæ¯å‘é€å¤±è´¥:', result.error);
                }
            } catch (e) {
                console.error('âŒ Telegramæ¶ˆæ¯å‘é€å¼‚å¸¸:', e);
            }
        }
        
        // ğŸ”’ æ·»åŠ æ‰§è¡Œé”ï¼Œé˜²æ­¢é‡å¤è§¦å‘
        let strategyExecuting = false;
        
        async function checkAndExecuteAutoStrategy() {
            const account = accounts.find(acc => acc.id === currentAccount);
            if (!account || !account.apiKey) return;
            
            // æ£€æŸ¥æ˜¯å¦æ­£åœ¨æ‰§è¡Œ
            if (strategyExecuting) {
                console.log('âš ï¸ ç­–ç•¥æ­£åœ¨æ‰§è¡Œä¸­ï¼Œè·³è¿‡æœ¬æ¬¡æ£€æŸ¥');
                return;
            }
            
            try {
                // åŠ è½½ç­–ç•¥è®¾ç½®
                const settings = await loadAutoStrategySettingsData();
                if (!settings || !settings.enabled) {
                    return; // ç­–ç•¥æœªå¯ç”¨
                }
                
                // è·å–å½“å‰BTCä»·æ ¼
                const btcPrice = await getBTCPrice();
                if (!btcPrice) {
                    console.warn('âš ï¸ æ— æ³•è·å–BTCä»·æ ¼');
                    return;
                }
                
                // æ›´æ–°æ˜¾ç¤º
                const priceEl = document.getElementById('currentBtcPrice');
                if (priceEl) {
                    priceEl.textContent = `$${btcPrice.toFixed(2)}`;
                    priceEl.style.color = btcPrice < settings.triggerPrice ? '#ef4444' : '#6b7280';
                }
                
                // æ£€æŸ¥è§¦å‘æ¡ä»¶ï¼šBTCä»·æ ¼è·Œç ´è®¾å®šä»·æ ¼
                if (btcPrice < settings.triggerPrice) {
                    // ğŸ”’ ç¬¬ä¸€é‡æ£€æŸ¥ï¼šJSONL allowedçŠ¶æ€ï¼ˆæœ€é‡è¦ï¼ï¼‰
                    const strategyType = settings.strategyType || 'bottom_performers';
                    console.log(`ğŸ” æ£€æŸ¥JSONLæ‰§è¡Œè®¸å¯çŠ¶æ€ (ç­–ç•¥: ${strategyType})...`);
                    const allowedCheck = await fetch(`/api/okx-trading/check-allowed/${account.id}/${strategyType}`);
                    const allowedResult = await allowedCheck.json();
                    
                    if (!allowedResult.success) {
                        console.error('âŒ æ£€æŸ¥JSONLçŠ¶æ€å¤±è´¥:', allowedResult.error);
                        return;
                    }
                    
                    if (!allowedResult.allowed) {
                        console.log('ğŸš« JSONLçŠ¶æ€ä¸å…è®¸æ‰§è¡Œï¼Œè·³è¿‡æœ¬æ¬¡æ‰§è¡Œ');
                        console.log('ğŸ“„ æœ€åè®°å½•:', allowedResult.lastRecord);
                        
                        // åŒæ—¶å…³é—­UIå¼€å…³
                        if (settings.enabled) {
                            document.getElementById('autoTradeSwitch').checked = false;
                            await saveAutoStrategySettings();
                        }
                        return;
                    }
                    
                    console.log('âœ… JSONLçŠ¶æ€å…è®¸æ‰§è¡Œ');
                    
                    // ğŸ”’ ç¬¬äºŒé‡æ£€æŸ¥ï¼šå†·å´æœŸï¼ˆ5åˆ†é’Ÿå†…ä¸é‡å¤æ‰§è¡Œï¼‰
                    const COOLDOWN_PERIOD = 5 * 60 * 1000; // 5åˆ†é’Ÿ
                    if (settings.lastExecutedTime) {
                        const lastTime = new Date(settings.lastExecutedTime.replace(/\//g, '-')).getTime();
                        const now = Date.now();
                        const timeSinceLastExec = now - lastTime;
                        if (timeSinceLastExec < COOLDOWN_PERIOD) {
                            const remainingSeconds = Math.ceil((COOLDOWN_PERIOD - timeSinceLastExec) / 1000);
                            console.log(`â³ ç­–ç•¥åœ¨å†·å´æœŸå†…ï¼ˆè¿˜éœ€ç­‰å¾… ${remainingSeconds} ç§’ï¼‰ï¼Œè·³è¿‡æ‰§è¡Œ`);
                            return;
                        }
                    }
                    
                    // ğŸ”’ ç¬¬ä¸‰é‡æ£€æŸ¥ï¼šè®¾ç½®æ‰§è¡Œé”
                    strategyExecuting = true;
                    console.log(`ğŸ”’ å·²è®¾ç½®æ‰§è¡Œé”ï¼Œé˜²æ­¢é‡å¤è§¦å‘`);
                    
                    console.log(`ğŸ¯ è§¦å‘æ¡ä»¶æ»¡è¶³ï¼BTCä»·æ ¼ $${btcPrice} ä½äºè§¦å‘ä»· $${settings.triggerPrice}`);
                    // æ ¹æ®ç­–ç•¥ç±»å‹ç¡®å®šåç§°ï¼ˆstrategyTypeå·²åœ¨ä¸Šé¢å®šä¹‰ï¼‰
                    const strategyName = strategyType === 'top_performers' ? 'æ¶¨å¹…å‰8å' : 'æ¶¨å¹…å8å';
                    const strategyEmoji = strategyType === 'top_performers' ? 'ğŸ“ˆ' : 'ğŸ“‰';
                    
                    console.log(`ğŸ“Š å‡†å¤‡å¯¹å¸¸ç”¨å¸(15ä¸ª)ä¸­${strategyName}å¼€å¤šå•...`);
                    
                    // å‘é€TGé€šçŸ¥ï¼šè§¦å‘
                    const triggerTime = new Date().toLocaleString('zh-CN', { timeZone: 'Asia/Shanghai' });
                    const triggerMessage = `ğŸ¯ <b>${strategyName}ç­–ç•¥è§¦å‘</b>\n\n` +
                        `â° è§¦å‘æ—¶é—´: ${triggerTime}\n` +
                        `ğŸ’° BTCä»·æ ¼: $${btcPrice.toFixed(2)}\n` +
                        `${strategyEmoji} è§¦å‘ä»·æ ¼: $${settings.triggerPrice}\n` +
                        `ğŸ‘¤ è´¦æˆ·: ${account.name}\n\n` +
                        `ğŸ“Š æ­£åœ¨åˆ†æå¸¸ç”¨å¸(15ä¸ª)æ¶¨è·Œå¹…...\n` +
                        `ğŸ”„ å‡†å¤‡å¯¹${strategyName}å¼€å¤šå•...`;
                    await sendTelegramMessage(triggerMessage);
                    
                    // æ‰§è¡Œå¼€å•
                    const result = await executeAutoTrade(account, btcPrice, settings.triggerPrice, strategyType);
                    
                    if (result.success) {
                        // âš ï¸ æ‰§è¡ŒæˆåŠŸåç«‹å³å†™å…¥JSONLè®¾ç½®allowed=false
                        console.log(`ğŸ“ å†™å…¥JSONLï¼šè®¾ç½®allowed=falseï¼Œç¦æ­¢å†æ¬¡æ‰§è¡Œ (ç­–ç•¥: ${strategyType})`);
                        await fetch(`/api/okx-trading/set-allowed/${account.id}/${strategyType}`, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                allowed: false,
                                reason: 'Strategy executed successfully',
                                triggerPrice: settings.triggerPrice,
                                btcPrice: btcPrice,
                                strategyType: strategyType
                            })
                        });
                        
                        // æ›´æ–°è®¾ç½®ï¼šå…³é—­å¼€å…³ï¼Œè®°å½•æ‰§è¡Œæ—¶é—´
                        const now = new Date().toLocaleString('zh-CN', { timeZone: 'Asia/Shanghai' });
                        await fetch(`/api/okx-trading/auto-strategy/${account.id}`, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                enabled: false, // æ‰§è¡Œåè‡ªåŠ¨å…³é—­
                                triggerPrice: settings.triggerPrice,
                                strategyType: strategyType,
                                lastExecutedTime: now,
                                executedCount: (settings.executedCount || 0) + 1
                            })
                        });
                        
                        // åˆ·æ–°UI
                        await loadAutoStrategySettings();
                        
                        // å‘é€TGé€šçŸ¥ï¼šå®Œæˆ
                        const successCoins = result.successCoins.map(c => c.name).join(', ');
                        const failedCoins = result.failedCoins.map(c => c.name).join(', ');
                        
                        let completionMessage = `âœ… <b>${strategyName}ç­–ç•¥æ‰§è¡Œå®Œæˆ</b>\n\n`;
                        completionMessage += `â° å®Œæˆæ—¶é—´: ${now}\n`;
                        completionMessage += `ğŸ‘¤ è´¦æˆ·: ${account.name}\n`;
                        completionMessage += `ğŸ’° BTCä»·æ ¼: $${btcPrice.toFixed(2)}\n\n`;
                        completionMessage += `ğŸ“Š <b>æ‰§è¡Œç»“æœ</b>\n`;
                        completionMessage += `âœ“ æˆåŠŸ: ${result.successCount}/${result.totalCount} ä¸ªå¸ç§\n`;
                        
                        if (successCoins) {
                            completionMessage += `\nğŸŸ¢ <b>æˆåŠŸå¸ç§:</b>\n${successCoins}\n`;
                        }
                        
                        if (failedCoins) {
                            completionMessage += `\nğŸ”´ <b>å¤±è´¥å¸ç§:</b>\n${failedCoins}\n`;
                        }
                        
                        // æ·»åŠ æ¶¨å¹…è¯¦æƒ…ï¼ˆæ ¹æ®ç­–ç•¥ç±»å‹ï¼‰
                        if (strategyType === 'bottom_performers' && result.bottom8Coins && result.bottom8Coins.length > 0) {
                            completionMessage += `\nğŸ“‰ <b>æ¶¨å¹…å8å:</b>\n`;
                            result.bottom8Coins.forEach((coin, index) => {
                                completionMessage += `${index + 1}. ${coin.name} (${coin.change >= 0 ? '+' : ''}${coin.change.toFixed(2)}%)\n`;
                            });
                        } else if (strategyType === 'top_performers' && result.top8Coins && result.top8Coins.length > 0) {
                            completionMessage += `\nğŸ“ˆ <b>æ¶¨å¹…å‰8å:</b>\n`;
                            result.top8Coins.forEach((coin, index) => {
                                completionMessage += `${index + 1}. ${coin.name} (${coin.change >= 0 ? '+' : ''}${coin.change.toFixed(2)}%)\n`;
                            });
                        }
                        
                        completionMessage += `\nğŸ”’ ç­–ç•¥å·²è‡ªåŠ¨å…³é—­`;
                        
                        await sendTelegramMessage(completionMessage);
                        
                        // ğŸ”• ç§»é™¤å¼¹çª—é€šçŸ¥ï¼Œåªå‘é€TGæ¶ˆæ¯ï¼ˆç”¨æˆ·éœ€æ±‚ï¼šä¸è¦ç¡®è®¤å¼¹çª—ï¼Œè‡ªåŠ¨æ‰§è¡Œï¼‰
                        // åŸå¼¹çª—ä»£ç å·²æ³¨é‡Šï¼š
                        // const priceCondition = strategyType === 'top_performers' 
                        //     ? `BTCä»·æ ¼ $${btcPrice.toFixed(2)} > $${settings.triggerPrice}`
                        //     : `BTCä»·æ ¼ $${btcPrice.toFixed(2)} < $${settings.triggerPrice}`;
                        // 
                        // let alertMessage = `âœ… ${strategyName}ç­–ç•¥æ‰§è¡Œå®Œæˆï¼\n\n`;
                        // alertMessage += `è§¦å‘æ¡ä»¶ï¼š${priceCondition}\n`;
                        // alertMessage += `æˆåŠŸå¼€å•ï¼š${result.successCount}/${result.totalCount} ä¸ªå¸ç§\n\n`;
                        // if (successCoins) alertMessage += `æˆåŠŸå¸ç§ï¼š\n${successCoins}\n\n`;
                        // if (failedCoins) alertMessage += `å¤±è´¥å¸ç§ï¼š\n${failedCoins}\n\n`;
                        // alertMessage += `ç­–ç•¥å·²è‡ªåŠ¨å…³é—­ï¼Œå¦‚éœ€å†æ¬¡æ‰§è¡Œè¯·é‡æ–°å¼€å¯ã€‚`;
                        // 
                        // alert(alertMessage);
                        // playAlertSound();
                        
                        console.log(`ğŸ“¢ ç­–ç•¥æ‰§è¡Œå®Œæˆé€šçŸ¥å·²å‘é€åˆ°Telegram`);
                        
                        // åˆ·æ–°æŒä»“
                        await loadPositions();
                    }
                }
            } catch (e) {
                console.error('âŒ è‡ªåŠ¨äº¤æ˜“ç­–ç•¥æ£€æŸ¥å¼‚å¸¸:', e);
            } finally {
                // ğŸ”“ é‡Šæ”¾æ‰§è¡Œé”
                if (strategyExecuting) {
                    strategyExecuting = false;
                    console.log('ğŸ”“ å·²é‡Šæ”¾æ‰§è¡Œé”');
                }
            }
        }
        
        // ========== æ–°å¢ç­–ç•¥ï¼šä¸Šæ¶¨å æ¯”=0è§¦å‘ç­–ç•¥ï¼ˆæŒ‰è´¦å·ç‹¬ç«‹æ§åˆ¶ï¼‰==========
        
        // æ£€æŸ¥å¹¶æ‰§è¡Œä¸Šæ¶¨å æ¯”0ç­–ç•¥Aï¼ˆæ¶¨å¹…å‰8åå¤šå•ï¼‰
        async function checkAndExecuteUpRatio0Top8() {
            const account = accounts.find(acc => acc.id === currentAccount);
            if (!account || !account.apiKey) return;
            
            try {
                // ğŸ”„ å§‹ç»ˆè·å–å¹¶æ›´æ–°ä¸Šæ¶¨å æ¯”æ˜¾ç¤ºï¼ˆä¸ç®¡å¼€å…³çŠ¶æ€ï¼‰
                const upRatio = await getUpRatio();
                const upRatioEl = document.getElementById('currentUpRatioTop8');
                if (upRatioEl) {
                    if (upRatio !== null) {
                        upRatioEl.textContent = `${upRatio}%`;
                        upRatioEl.style.color = upRatio === 0 ? '#ef4444' : '#6b7280';
                        upRatioEl.style.fontWeight = '800';
                    } else {
                        upRatioEl.textContent = '--';
                        upRatioEl.style.color = '#6b7280';
                    }
                }
                
                // è¯»å–å¼€å…³çŠ¶æ€ï¼ˆä»UIï¼‰
                const switchEl = document.getElementById('autoTradeSwitchUpRatio0Top8');
                if (!switchEl || !switchEl.checked) {
                    return; // ç­–ç•¥æœªå¯ç”¨ï¼Œä½†å·²æ›´æ–°æ˜¾ç¤º
                }
                
                // æ£€æŸ¥æ˜¯å¦æ­£åœ¨æ‰§è¡Œ
                if (strategyExecuting) {
                    console.log('âš ï¸ ç­–ç•¥æ­£åœ¨æ‰§è¡Œä¸­ï¼Œè·³è¿‡ä¸Šæ¶¨å æ¯”0-æ¶¨å¹…å‰8åæ£€æŸ¥');
                    return;
                }
                
                // è·å–å½“å‰æ—¶é—´ï¼ˆåŒ—äº¬æ—¶é—´ï¼‰
                const now = new Date();
                const bjHour = (now.getUTCHours() + 8) % 24;
                const bjMinute = now.getUTCMinutes();
                
                // æ’é™¤0:00-0:30
                if (bjHour === 0 && bjMinute < 30) {
                    console.log('â° å½“å‰æ—¶é—´åœ¨0:00-0:30æ’é™¤æ—¶æ®µï¼Œè·³è¿‡ä¸Šæ¶¨å æ¯”0-æ¶¨å¹…å‰8åç­–ç•¥');
                    return;
                }
                
                // æ£€æŸ¥ä¸Šæ¶¨å æ¯”æ˜¯å¦æœ‰æ•ˆ
                if (upRatio === null) {
                    console.warn('âš ï¸ æ— æ³•è·å–ä¸Šæ¶¨å æ¯”');
                    return;
                }
                
                // æ£€æŸ¥è§¦å‘æ¡ä»¶ï¼šä¸Šæ¶¨å æ¯”=0
                if (upRatio === 0) {
                    // ğŸ”’ ç¬¬ä¸€é‡æ£€æŸ¥ï¼šJSONL allowedçŠ¶æ€ï¼ˆæœ€é‡è¦ï¼ï¼‰
                    console.log('ğŸ” æ£€æŸ¥JSONLæ‰§è¡Œè®¸å¯çŠ¶æ€ï¼ˆä¸Šæ¶¨å æ¯”0-æ¶¨å¹…å‰8åï¼‰...');
                    const allowedCheck = await fetch(`/api/okx-trading/check-allowed-upratio0/${account.id}/top8`);
                    const allowedResult = await allowedCheck.json();
                    
                    if (!allowedResult.success) {
                        console.error('âŒ æ£€æŸ¥JSONLçŠ¶æ€å¤±è´¥:', allowedResult.error);
                        return;
                    }
                    
                    if (!allowedResult.allowed) {
                        console.log('ğŸš« JSONLçŠ¶æ€ä¸å…è®¸æ‰§è¡Œï¼Œè·³è¿‡æœ¬æ¬¡æ‰§è¡Œ');
                        console.log('ğŸ“„ æœ€åè®°å½•:', allowedResult.lastRecord);
                        
                        // åŒæ—¶å…³é—­UIå¼€å…³
                        switchEl.checked = false;
                        const statusEl = document.getElementById('autoTradeStatusUpRatio0Top8');
                        if (statusEl) statusEl.textContent = 'å·²å…³é—­';
                        
                        // æ›´æ–°å¼€å…³çŠ¶æ€æ˜¾ç¤º
                        const switchStatusEl = document.getElementById('switchStatusUpRatio0Top8');
                        if (switchStatusEl) {
                            switchStatusEl.textContent = 'ğŸ”´ æœªå¼€å¯';
                            switchStatusEl.style.color = '#6b7280';
                        }
                        return;
                    }
                    
                    console.log('âœ… JSONLçŠ¶æ€å…è®¸æ‰§è¡Œ');
                    console.log('ğŸ¯ è§¦å‘æ¡ä»¶æ»¡è¶³ï¼ä¸Šæ¶¨å æ¯” = 0%');
                    console.log('ğŸ“Š å‡†å¤‡å¯¹å¸¸ç”¨å¸(15ä¸ª)ä¸­æ¶¨å¹…å‰8åå¼€å¤šå•...');
                    
                    // ğŸ”’ è®¾ç½®æ‰§è¡Œé”
                    strategyExecuting = true;
                    console.log('ğŸ”’ å·²è®¾ç½®æ‰§è¡Œé”ï¼ˆä¸Šæ¶¨å æ¯”0-æ¶¨å¹…å‰8åï¼‰');
                    
                    // æ‰§è¡Œå¼€å•
                    const result = await executeUpRatio0Strategy(account, upRatio, 'top_8');
                    
                    if (result.success) {
                        // âš ï¸ æ‰§è¡ŒæˆåŠŸåç«‹å³å†™å…¥JSONLè®¾ç½®allowed=false
                        console.log('ğŸ“ å†™å…¥JSONLï¼šè®¾ç½®allowed=falseï¼Œç¦æ­¢å†æ¬¡æ‰§è¡Œ');
                        await fetch(`/api/okx-trading/set-allowed-upratio0/${account.id}/top8`, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                allowed: false,
                                reason: 'Strategy executed successfully',
                                upRatio: upRatio
                            })
                        });
                        
                        // æ‰§è¡Œåè‡ªåŠ¨å…³é—­å¼€å…³
                        switchEl.checked = false;
                        
                        // æ›´æ–°çŠ¶æ€æ˜¾ç¤º
                        const statusEl = document.getElementById('autoTradeStatusUpRatio0Top8');
                        if (statusEl) statusEl.textContent = 'å·²æ‰§è¡Œ';
                        
                        // æ›´æ–°å¼€å…³çŠ¶æ€æ˜¾ç¤º
                        const switchStatusEl = document.getElementById('switchStatusUpRatio0Top8');
                        if (switchStatusEl) {
                            switchStatusEl.textContent = 'ğŸ”´ æœªå¼€å¯';
                            switchStatusEl.style.color = '#6b7280';
                        }
                        
                        const timeEl = document.getElementById('autoTradeLastTimeUpRatio0Top8');
                        if (timeEl) {
                            const now = new Date().toLocaleString('zh-CN', { timeZone: 'Asia/Shanghai' });
                            timeEl.textContent = now;
                        }
                        
                        // é™é»˜é€šçŸ¥ç”¨æˆ·ï¼ˆä¸éœ€è¦äººå·¥ç¡®è®¤ï¼‰
                        const successCoins = result.successCoins.map(c => c.name).join(', ');
                        const failedCoins = result.failedCoins.map(c => c.name).join(', ');
                        
                        // æ„å»ºé€šçŸ¥æ¶ˆæ¯
                        let notificationMessage = `âœ… ä¸Šæ¶¨å æ¯”0-æ¶¨å¹…å‰8åç­–ç•¥æ‰§è¡Œå®Œæˆï¼\n\n`;
                        notificationMessage += `è´¦æˆ·ï¼š${account.name}\n`;
                        notificationMessage += `è§¦å‘æ¡ä»¶ï¼šä¸Šæ¶¨å æ¯” = 0%\n`;
                        notificationMessage += `æˆåŠŸå¼€å•ï¼š${result.successCount}/${result.totalCount} ä¸ªå¸ç§\n`;
                        if (successCoins) notificationMessage += `æˆåŠŸå¸ç§ï¼š${successCoins}\n`;
                        if (failedCoins) notificationMessage += `å¤±è´¥å¸ç§ï¼š${failedCoins}\n`;
                        notificationMessage += `\nç­–ç•¥å·²è‡ªåŠ¨å…³é—­ï¼Œå¦‚éœ€å†æ¬¡æ‰§è¡Œè¯·é‡æ–°å¼€å¯ã€‚`;
                        
                        // æ§åˆ¶å°è¾“å‡ºè¯¦ç»†ä¿¡æ¯
                        console.log('ğŸ‰ ===== ç­–ç•¥æ‰§è¡Œå®Œæˆ =====');
                        console.log(notificationMessage);
                        console.log('ğŸ‰ ==========================');
                        
                        // æµè§ˆå™¨é€šçŸ¥ï¼ˆä¸é˜»å¡ï¼‰
                        if ('Notification' in window && Notification.permission === 'granted') {
                            new Notification('ä¸Šæ¶¨å æ¯”0-æ¶¨å¹…å‰8åç­–ç•¥', {
                                body: `è´¦æˆ·ï¼š${account.name}\næˆåŠŸï¼š${result.successCount}/${result.totalCount}\n${successCoins}`,
                                icon: '/static/icon.png',
                                requireInteraction: false
                            });
                        }
                        
                        // æ’­æ”¾æç¤ºéŸ³
                        playAlertSound();
                        
                        // åˆ·æ–°æŒä»“
                        await loadPositions();
                        
                        // å‘é€Telegramé€šçŸ¥
                        const telegramMsg = `ğŸ¯ ä¸Šæ¶¨å æ¯”0ç­–ç•¥-æ¶¨å¹…å‰8åæ‰§è¡Œå®Œæˆ\n\n` +
                            `è´¦æˆ·ï¼š${account.name}\n` +
                            `è§¦å‘æ¡ä»¶ï¼šä¸Šæ¶¨å æ¯” = 0%\n` +
                            `æˆåŠŸå¼€å•ï¼š${result.successCount}/${result.totalCount} ä¸ªå¸ç§\n` +
                            `æˆåŠŸå¸ç§ï¼š${successCoins || 'æ— '}\n` +
                            `å¤±è´¥å¸ç§ï¼š${failedCoins || 'æ— '}\n\n` +
                            `ç­–ç•¥å·²è‡ªåŠ¨å…³é—­ã€‚`;
                        try {
                            await sendTelegramMessage(telegramMsg);
                            console.log('ğŸ“± Telegramé€šçŸ¥å·²å‘é€');
                        } catch (err) {
                            console.error('âŒ Telegramé€šçŸ¥å‘é€å¤±è´¥:', err);
                        }
                        
                        // ğŸ”• ç§»é™¤å¼¹çª—é€šçŸ¥ï¼Œåªå‘é€TGæ¶ˆæ¯ï¼ˆç”¨æˆ·éœ€æ±‚ï¼šä¸è¦ç¡®è®¤å¼¹çª—ï¼Œè‡ªåŠ¨æ‰§è¡Œï¼‰
                        // åŸå¼¹çª—ä»£ç å·²æ³¨é‡Šï¼š
                        // const alertMsg = `âœ… ä¸Šæ¶¨å æ¯”0-æ¶¨å¹…å‰8åç­–ç•¥æ‰§è¡Œå®Œæˆï¼\n\n` +
                        //     `è´¦æˆ·ï¼š${account.name}\n` +
                        //     `è§¦å‘æ¡ä»¶ï¼šä¸Šæ¶¨å æ¯” = 0%\n` +
                        //     `æˆåŠŸå¼€å•ï¼š${result.successCount}/${result.totalCount} ä¸ªå¸ç§\n\n` +
                        //     `æˆåŠŸå¸ç§ï¼š\n${successCoins || 'æ— '}\n\n` +
                        //     `å¤±è´¥å¸ç§ï¼š\n${failedCoins || 'æ— '}\n\n` +
                        //     `ç­–ç•¥å·²è‡ªåŠ¨å…³é—­ï¼Œå¦‚éœ€å†æ¬¡æ‰§è¡Œè¯·é‡æ–°å¼€å¯ã€‚`;
                        // alert(alertMsg);
                        
                        console.log(`ğŸ“¢ ä¸Šæ¶¨å æ¯”0-æ¶¨å¹…å‰8åç­–ç•¥æ‰§è¡Œå®Œæˆé€šçŸ¥å·²å‘é€åˆ°Telegram`);
                    }
                }
            } catch (e) {
                console.error('âŒ ä¸Šæ¶¨å æ¯”0-æ¶¨å¹…å‰8åç­–ç•¥æ£€æŸ¥å¼‚å¸¸:', e);
            } finally {
                // ğŸ”“ é‡Šæ”¾æ‰§è¡Œé”
                if (strategyExecuting) {
                    strategyExecuting = false;
                    console.log('ğŸ”“ å·²é‡Šæ”¾æ‰§è¡Œé”ï¼ˆä¸Šæ¶¨å æ¯”0-æ¶¨å¹…å‰8åï¼‰');
                }
            }
        }
        
        // æ£€æŸ¥å¹¶æ‰§è¡Œä¸Šæ¶¨å æ¯”0ç­–ç•¥Bï¼ˆæ¶¨å¹…å8åå¤šå•ï¼‰
        async function checkAndExecuteUpRatio0Bottom8() {
            const account = accounts.find(acc => acc.id === currentAccount);
            if (!account || !account.apiKey) return;
            
            try {
                // ğŸ”„ å§‹ç»ˆè·å–å¹¶æ›´æ–°ä¸Šæ¶¨å æ¯”æ˜¾ç¤ºï¼ˆä¸ç®¡å¼€å…³çŠ¶æ€ï¼‰
                const upRatio = await getUpRatio();
                const upRatioEl = document.getElementById('currentUpRatioBottom8');
                if (upRatioEl) {
                    if (upRatio !== null) {
                        upRatioEl.textContent = `${upRatio}%`;
                        upRatioEl.style.color = upRatio === 0 ? '#ef4444' : '#6b7280';
                        upRatioEl.style.fontWeight = '800';
                    } else {
                        upRatioEl.textContent = '--';
                        upRatioEl.style.color = '#6b7280';
                    }
                }
                
                // è¯»å–å¼€å…³çŠ¶æ€ï¼ˆä»UIï¼‰
                const switchEl = document.getElementById('autoTradeSwitchUpRatio0Bottom8');
                if (!switchEl || !switchEl.checked) {
                    return; // ç­–ç•¥æœªå¯ç”¨ï¼Œä½†å·²æ›´æ–°æ˜¾ç¤º
                }
                
                // æ£€æŸ¥æ˜¯å¦æ­£åœ¨æ‰§è¡Œ
                if (strategyExecuting) {
                    console.log('âš ï¸ ç­–ç•¥æ­£åœ¨æ‰§è¡Œä¸­ï¼Œè·³è¿‡ä¸Šæ¶¨å æ¯”0-æ¶¨å¹…å8åæ£€æŸ¥');
                    return;
                }
                
                // è·å–å½“å‰æ—¶é—´ï¼ˆåŒ—äº¬æ—¶é—´ï¼‰
                const now = new Date();
                const bjHour = (now.getUTCHours() + 8) % 24;
                const bjMinute = now.getUTCMinutes();
                
                // æ’é™¤0:00-0:30
                if (bjHour === 0 && bjMinute < 30) {
                    console.log('â° å½“å‰æ—¶é—´åœ¨0:00-0:30æ’é™¤æ—¶æ®µï¼Œè·³è¿‡ä¸Šæ¶¨å æ¯”0-æ¶¨å¹…å8åç­–ç•¥');
                    return;
                }
                
                // æ£€æŸ¥ä¸Šæ¶¨å æ¯”æ˜¯å¦æœ‰æ•ˆ
                if (upRatio === null) {
                    console.warn('âš ï¸ æ— æ³•è·å–ä¸Šæ¶¨å æ¯”');
                    return;
                }
                
                // æ£€æŸ¥è§¦å‘æ¡ä»¶ï¼šä¸Šæ¶¨å æ¯”=0
                if (upRatio === 0) {
                    // ğŸ”’ ç¬¬ä¸€é‡æ£€æŸ¥ï¼šJSONL allowedçŠ¶æ€ï¼ˆæœ€é‡è¦ï¼ï¼‰
                    console.log('ğŸ” æ£€æŸ¥JSONLæ‰§è¡Œè®¸å¯çŠ¶æ€ï¼ˆä¸Šæ¶¨å æ¯”0-æ¶¨å¹…å8åï¼‰...');
                    const allowedCheck = await fetch(`/api/okx-trading/check-allowed-upratio0/${account.id}/bottom8`);
                    const allowedResult = await allowedCheck.json();
                    
                    if (!allowedResult.success) {
                        console.error('âŒ æ£€æŸ¥JSONLçŠ¶æ€å¤±è´¥:', allowedResult.error);
                        return;
                    }
                    
                    if (!allowedResult.allowed) {
                        console.log('ğŸš« JSONLçŠ¶æ€ä¸å…è®¸æ‰§è¡Œï¼Œè·³è¿‡æœ¬æ¬¡æ‰§è¡Œ');
                        console.log('ğŸ“„ æœ€åè®°å½•:', allowedResult.lastRecord);
                        
                        // åŒæ—¶å…³é—­UIå¼€å…³
                        switchEl.checked = false;
                        const statusEl = document.getElementById('autoTradeStatusUpRatio0Bottom8');
                        if (statusEl) statusEl.textContent = 'å·²å…³é—­';
                        
                        // æ›´æ–°å¼€å…³çŠ¶æ€æ˜¾ç¤º
                        const switchStatusEl = document.getElementById('switchStatusUpRatio0Bottom8');
                        if (switchStatusEl) {
                            switchStatusEl.textContent = 'ğŸ”´ æœªå¼€å¯';
                            switchStatusEl.style.color = '#6b7280';
                        }
                        return;
                    }
                    
                    console.log('âœ… JSONLçŠ¶æ€å…è®¸æ‰§è¡Œ');
                    console.log('ğŸ¯ è§¦å‘æ¡ä»¶æ»¡è¶³ï¼ä¸Šæ¶¨å æ¯” = 0%');
                    console.log('ğŸ“Š å‡†å¤‡å¯¹å¸¸ç”¨å¸(15ä¸ª)ä¸­æ¶¨å¹…å8åå¼€å¤šå•...');
                    
                    // ğŸ”’ è®¾ç½®æ‰§è¡Œé”
                    strategyExecuting = true;
                    console.log('ğŸ”’ å·²è®¾ç½®æ‰§è¡Œé”ï¼ˆä¸Šæ¶¨å æ¯”0-æ¶¨å¹…å8åï¼‰');
                    
                    // æ‰§è¡Œå¼€å•
                    const result = await executeUpRatio0Strategy(account, upRatio, 'bottom_8');
                    
                    if (result.success) {
                        // âš ï¸ æ‰§è¡ŒæˆåŠŸåç«‹å³å†™å…¥JSONLè®¾ç½®allowed=false
                        console.log('ğŸ“ å†™å…¥JSONLï¼šè®¾ç½®allowed=falseï¼Œç¦æ­¢å†æ¬¡æ‰§è¡Œ');
                        await fetch(`/api/okx-trading/set-allowed-upratio0/${account.id}/bottom8`, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                allowed: false,
                                reason: 'Strategy executed successfully',
                                upRatio: upRatio
                            })
                        });
                        
                        // æ‰§è¡Œåè‡ªåŠ¨å…³é—­å¼€å…³
                        switchEl.checked = false;
                        
                        // æ›´æ–°çŠ¶æ€æ˜¾ç¤º
                        const statusEl = document.getElementById('autoTradeStatusUpRatio0Bottom8');
                        if (statusEl) statusEl.textContent = 'å·²æ‰§è¡Œ';
                        
                        // æ›´æ–°å¼€å…³çŠ¶æ€æ˜¾ç¤º
                        const switchStatusEl = document.getElementById('switchStatusUpRatio0Bottom8');
                        if (switchStatusEl) {
                            switchStatusEl.textContent = 'ğŸ”´ æœªå¼€å¯';
                            switchStatusEl.style.color = '#6b7280';
                        }
                        
                        const timeEl = document.getElementById('autoTradeLastTimeUpRatio0Bottom8');
                        if (timeEl) {
                            const now = new Date().toLocaleString('zh-CN', { timeZone: 'Asia/Shanghai' });
                            timeEl.textContent = now;
                        }
                        
                        // é™é»˜é€šçŸ¥ç”¨æˆ·ï¼ˆä¸éœ€è¦äººå·¥ç¡®è®¤ï¼‰
                        const successCoins = result.successCoins.map(c => c.name).join(', ');
                        const failedCoins = result.failedCoins.map(c => c.name).join(', ');
                        
                        // æ„å»ºé€šçŸ¥æ¶ˆæ¯
                        let notificationMessage = `âœ… ä¸Šæ¶¨å æ¯”0-æ¶¨å¹…å8åç­–ç•¥æ‰§è¡Œå®Œæˆï¼\n\n`;
                        notificationMessage += `è´¦æˆ·ï¼š${account.name}\n`;
                        notificationMessage += `è§¦å‘æ¡ä»¶ï¼šä¸Šæ¶¨å æ¯” = 0%\n`;
                        notificationMessage += `æˆåŠŸå¼€å•ï¼š${result.successCount}/${result.totalCount} ä¸ªå¸ç§\n`;
                        if (successCoins) notificationMessage += `æˆåŠŸå¸ç§ï¼š${successCoins}\n`;
                        if (failedCoins) notificationMessage += `å¤±è´¥å¸ç§ï¼š${failedCoins}\n`;
                        notificationMessage += `\nç­–ç•¥å·²è‡ªåŠ¨å…³é—­ï¼Œå¦‚éœ€å†æ¬¡æ‰§è¡Œè¯·é‡æ–°å¼€å¯ã€‚`;
                        
                        // æ§åˆ¶å°è¾“å‡ºè¯¦ç»†ä¿¡æ¯
                        console.log('ğŸ‰ ===== ç­–ç•¥æ‰§è¡Œå®Œæˆ =====');
                        console.log(notificationMessage);
                        console.log('ğŸ‰ ==========================');
                        
                        // æµè§ˆå™¨é€šçŸ¥ï¼ˆä¸é˜»å¡ï¼‰
                        if ('Notification' in window && Notification.permission === 'granted') {
                            new Notification('ä¸Šæ¶¨å æ¯”0-æ¶¨å¹…å8åç­–ç•¥', {
                                body: `è´¦æˆ·ï¼š${account.name}\næˆåŠŸï¼š${result.successCount}/${result.totalCount}\n${successCoins}`,
                                icon: '/static/icon.png',
                                requireInteraction: false
                            });
                        }
                        
                        // æ’­æ”¾æç¤ºéŸ³
                        playAlertSound();
                        
                        // åˆ·æ–°æŒä»“
                        await loadPositions();
                        
                        // å‘é€Telegramé€šçŸ¥
                        const telegramMsg = `ğŸ¯ ä¸Šæ¶¨å æ¯”0ç­–ç•¥-æ¶¨å¹…å8åæ‰§è¡Œå®Œæˆ\n\n` +
                            `è´¦æˆ·ï¼š${account.name}\n` +
                            `è§¦å‘æ¡ä»¶ï¼šä¸Šæ¶¨å æ¯” = 0%\n` +
                            `æˆåŠŸå¼€å•ï¼š${result.successCount}/${result.totalCount} ä¸ªå¸ç§\n` +
                            `æˆåŠŸå¸ç§ï¼š${successCoins || 'æ— '}\n` +
                            `å¤±è´¥å¸ç§ï¼š${failedCoins || 'æ— '}\n\n` +
                            `ç­–ç•¥å·²è‡ªåŠ¨å…³é—­ã€‚`;
                        try {
                            await sendTelegramMessage(telegramMsg);
                            console.log('ğŸ“± Telegramé€šçŸ¥å·²å‘é€');
                        } catch (err) {
                            console.error('âŒ Telegramé€šçŸ¥å‘é€å¤±è´¥:', err);
                        }
                        
                        // ğŸ”• ç§»é™¤å¼¹çª—é€šçŸ¥ï¼Œåªå‘é€TGæ¶ˆæ¯ï¼ˆç”¨æˆ·éœ€æ±‚ï¼šä¸è¦ç¡®è®¤å¼¹çª—ï¼Œè‡ªåŠ¨æ‰§è¡Œï¼‰
                        // åŸå¼¹çª—ä»£ç å·²æ³¨é‡Šï¼š
                        // const alertMsg = `âœ… ä¸Šæ¶¨å æ¯”0-æ¶¨å¹…å8åç­–ç•¥æ‰§è¡Œå®Œæˆï¼\n\n` +
                        //     `è´¦æˆ·ï¼š${account.name}\n` +
                        //     `è§¦å‘æ¡ä»¶ï¼šä¸Šæ¶¨å æ¯” = 0%\n` +
                        //     `æˆåŠŸå¼€å•ï¼š${result.successCount}/${result.totalCount} ä¸ªå¸ç§\n\n` +
                        //     `æˆåŠŸå¸ç§ï¼š\n${successCoins || 'æ— '}\n\n` +
                        //     `å¤±è´¥å¸ç§ï¼š\n${failedCoins || 'æ— '}\n\n` +
                        //     `ç­–ç•¥å·²è‡ªåŠ¨å…³é—­ï¼Œå¦‚éœ€å†æ¬¡æ‰§è¡Œè¯·é‡æ–°å¼€å¯ã€‚`;
                        // alert(alertMsg);
                        
                        console.log(`ğŸ“¢ ä¸Šæ¶¨å æ¯”0-æ¶¨å¹…å8åç­–ç•¥æ‰§è¡Œå®Œæˆé€šçŸ¥å·²å‘é€åˆ°Telegram`);
                    }
                }
            } catch (e) {
                console.error('âŒ ä¸Šæ¶¨å æ¯”0-æ¶¨å¹…å8åç­–ç•¥æ£€æŸ¥å¼‚å¸¸:', e);
            } finally {
                // ğŸ”“ é‡Šæ”¾æ‰§è¡Œé”
                if (strategyExecuting) {
                    strategyExecuting = false;
                    console.log('ğŸ”“ å·²é‡Šæ”¾æ‰§è¡Œé”ï¼ˆä¸Šæ¶¨å æ¯”0-æ¶¨å¹…å8åï¼‰');
                }
            }
        }
        
        // è·å–å½“å‰ä¸Šæ¶¨å æ¯”
        async function getUpRatio() {
            try {
                const response = await fetch('/api/coin-change-tracker/latest');
                const result = await response.json();
                
                if (result.success && result.data && result.data.up_ratio !== undefined) {
                    return result.data.up_ratio;
                }
            } catch (e) {
                console.error('è·å–ä¸Šæ¶¨å æ¯”å¤±è´¥:', e);
            }
            return null;
        }
        
        // æ‰§è¡Œä¸Šæ¶¨å æ¯”0ç­–ç•¥ï¼ˆé€šç”¨å‡½æ•°ï¼‰- ç›´æ¥è°ƒç”¨æ‰‹åŠ¨æ‰¹é‡å¼€ä»“
        async function executeUpRatio0Strategy(account, upRatio, strategyType) {
            try {
                const strategyName = strategyType === 'top_8' ? 'æ¶¨å¹…å‰8å' : 'æ¶¨å¹…å8å';
                console.log(`ğŸ“Š å¼€å§‹æ‰§è¡Œä¸Šæ¶¨å æ¯”0-${strategyName}ç­–ç•¥...`);
                console.log(`ğŸ“Š ç›´æ¥è°ƒç”¨æ‰‹åŠ¨æ‰¹é‡å¼€ä»“å‡½æ•°ï¼ˆè‡ªåŠ¨è§¦å‘ï¼Œè·³è¿‡ç¡®è®¤ï¼‰...`);
                
                // è·å–è´¦æˆ·é…ç½®çš„ä»“ä½ç™¾åˆ†æ¯”ï¼Œé»˜è®¤1.5%
                const positionSizePercent = account.positionSize || 1.5;
                
                // ç›´æ¥è°ƒç”¨æ‰‹åŠ¨æ‰¹é‡å¼€ä»“å‡½æ•°ï¼ˆskipConfirm=true è·³è¿‡ç¡®è®¤å¼¹çª—ï¼‰
                let result;
                if (strategyType === 'top_8') {
                    result = await batchOrderTop8('long', positionSizePercent, true);
                } else {
                    result = await batchOrderBottom8('long', positionSizePercent, true);
                }
                
                return result;
            } catch (error) {
                console.error('âŒ æ‰§è¡Œä¸Šæ¶¨å æ¯”0ç­–ç•¥å¤±è´¥:', error);
                return { success: false, error: error.message };
            }
        }
        
        // è·å–BTCå½“å‰ä»·æ ¼
        async function getBTCPrice() {
            try {
                const response = await fetch('/api/okx-trading/market-tickers');
                const result = await response.json();
                
                if (result.success && result.data) {
                    const btcTicker = result.data.find(t => t.symbol === 'BTC-USDT-SWAP');
                    if (btcTicker) {
                        return btcTicker.price;
                    }
                }
            } catch (e) {
                console.error('è·å–BTCä»·æ ¼å¤±è´¥:', e);
            }
            return null;
        }
        
        // æ‰§è¡Œè‡ªåŠ¨å¼€å•ï¼ˆæ”¯æŒæ¶¨å¹…å8åå’Œæ¶¨å¹…å‰8åä¸¤ç§ç­–ç•¥ï¼‰- ç›´æ¥è°ƒç”¨æ‰‹åŠ¨æ‰¹é‡å¼€ä»“
        async function executeAutoTrade(account, btcPrice, triggerPrice, strategyType = 'bottom_performers') {
            try {
                const strategyName = strategyType === 'top_performers' ? 'æ¶¨å¹…å‰8å' : 'æ¶¨å¹…å8å';
                console.log(`ğŸ“Š å¼€å§‹æ‰§è¡Œ${strategyName}ç­–ç•¥...`);
                console.log(`ğŸ“Š ç›´æ¥è°ƒç”¨æ‰‹åŠ¨æ‰¹é‡å¼€ä»“å‡½æ•°ï¼ˆè‡ªåŠ¨è§¦å‘ï¼Œè·³è¿‡ç¡®è®¤ï¼‰...`);
                
                // è·å–è´¦æˆ·é…ç½®çš„ä»“ä½ç™¾åˆ†æ¯”ï¼Œé»˜è®¤1.5%
                const positionSizePercent = account.positionSize || 1.5;
                
                // ç›´æ¥è°ƒç”¨æ‰‹åŠ¨æ‰¹é‡å¼€ä»“å‡½æ•°ï¼ˆskipConfirm=true è·³è¿‡ç¡®è®¤å¼¹çª—ï¼‰
                let result;
                if (strategyType === 'top_performers') {
                    result = await batchOrderTop8('long', positionSizePercent, true);
                } else {
                    result = await batchOrderBottom8('long', positionSizePercent, true);
                }
                
                return result;
                
            } catch (e) {
                console.error('âŒ æ‰§è¡Œè‡ªåŠ¨å¼€å•å¼‚å¸¸:', e);
                return { success: false, error: e.message };
            }
        }
        
        // è·å–åˆçº¦ä¿¡æ¯
        async function getContractInfo(symbol) {
            try {
                // ä»å·²åŠ è½½çš„å¸‚åœºæ•°æ®ä¸­è·å–
                // OKX USDTæ°¸ç»­åˆçº¦çš„è§„æ ¼é€šå¸¸æ˜¯ï¼š
                // BTC/ETHç­‰ä¸»æµå¸ï¼š1å¼  = 0.01å¸
                // å…¶ä»–å°å¸ç§ï¼š1å¼  = 0.1å¸ æˆ– 1å¸
                
                // ç®€åŒ–å¤„ç†ï¼šæ ¹æ®å¸ç§åç§°åˆ¤æ–­
                const coinName = symbol.replace('-USDT-SWAP', '');
                
                if (['BTC', 'ETH'].includes(coinName)) {
                    return { ctVal: 0.01 }; // 1å¼  = 0.01å¸
                } else if (['SOL', 'BNB', 'XRP', 'DOGE', 'ADA', 'DOT', 'MATIC', 'SHIB'].includes(coinName)) {
                    return { ctVal: 0.1 }; // 1å¼  = 0.1å¸
                } else {
                    return { ctVal: 1 }; // 1å¼  = 1å¸
                }
            } catch (e) {
                console.error('è·å–åˆçº¦ä¿¡æ¯å¤±è´¥:', e);
                return null;
            }
        }
        
        // å®šæ—¶åˆ·æ–°è´¦æˆ·æ•°æ®ï¼ˆæ¯60ç§’ï¼‰ - ä¸ä¸Šé¢çš„å®šæ—¶å™¨åˆå¹¶ï¼Œé¿å…é‡å¤åˆ·æ–°
        // æ³¨æ„ï¼šæ­¤å®šæ—¶å™¨å·²åœ¨initä¸­è®¾ç½®ï¼Œè¿™é‡Œæ³¨é‡Šæ‰é¿å…é‡å¤
        // setInterval(() => {
        //     refreshAccountData();
        //     updateTotalChangeOKX(); // åŒæ—¶æ›´æ–°æ¶¨è·Œå¹…
        //     checkAndExecuteAutoStrategy(); // æ£€æŸ¥è‡ªåŠ¨äº¤æ˜“ç­–ç•¥
        // }, 60000);

        // ==================== 1%ä½™é¢ç­–ç•¥å‡½æ•° ====================
        
        /**
         * æ‰§è¡Œä½™é¢1%ç­–ç•¥
         * @param {string} type - ç­–ç•¥ç±»å‹: 'top8' æˆ– 'bottom8'
         * @param {string} direction - äº¤æ˜“æ–¹å‘: 'long' æˆ– 'short'
         */
        async function executeBalStrategy(type, direction) {
            try {
                console.log(`ğŸ“Š å¼€å§‹æ‰§è¡Œä½™é¢1%ç­–ç•¥: ${type === 'top8' ? 'æ¶¨å¹…å‰8' : 'æ¶¨å¹…å8'} - ${direction === 'long' ? 'åšå¤š' : 'åšç©º'}`);
                
                // è·å–å½“å‰è´¦æˆ·
                const account = accounts.find(acc => acc.id === currentAccount);
                if (!account) {
                    alert('âŒ è¯·å…ˆé€‰æ‹©è´¦æˆ·');
                    return;
                }
                
                // è·å–è´¦æˆ·ä½™é¢
                const balanceResponse = await fetch(`/api/okx-trading/account-balance/${account.id}`);
                const balanceResult = await balanceResponse.json();
                
                if (!balanceResult.success) {
                    alert(`âŒ è·å–è´¦æˆ·ä½™é¢å¤±è´¥: ${balanceResult.error}`);
                    return;
                }
                
                const availableBalance = balanceResult.data.availableBalance;
                console.log(`ğŸ’° è´¦æˆ·å¯ç”¨ä½™é¢: ${availableBalance} USDT`);
                
                // è®¡ç®—1%çš„é‡‘é¢
                const totalAmount = availableBalance * 0.01;
                console.log(`ğŸ’µ ä½¿ç”¨é‡‘é¢(1%): ${totalAmount.toFixed(2)} USDT`);
                
                // âœ… ç§»é™¤5 USDTæœ€å°é™åˆ¶ï¼Œåªè¦ä½™é¢è¶³å¤Ÿå¼€1å¼ åˆçº¦å³å¯
                // å®é™…çš„æœ€å°é‡‘é¢ç”±å„å¸ç§çš„minSzå†³å®šï¼Œä¸éœ€è¦åœ¨è¿™é‡Œç¡¬ç¼–ç é™åˆ¶
                if (totalAmount < 0.1) {
                    alert(`âŒ è´¦æˆ·ä½™é¢ä¸è¶³ï¼Œ1%é‡‘é¢(${totalAmount.toFixed(2)} USDT)å¤ªå°ï¼Œå»ºè®®è‡³å°‘0.1 USDT`);
                    return;
                }
                
                // ç¡®è®¤å¯¹è¯æ¡†
                const typeText = type === 'top8' ? 'æ¶¨å¹…å‰8å' : 'æ¶¨å¹…å8å';
                const directionText = direction === 'long' ? 'åšå¤š(å¼€å¤šå•)' : 'åšç©º(å¼€ç©ºå•)';
                const confirmMsg = `ç¡®è®¤æ‰§è¡Œä½™é¢1%ç­–ç•¥å—ï¼Ÿ\n\nç­–ç•¥ç±»å‹ï¼š${typeText}\näº¤æ˜“æ–¹å‘ï¼š${directionText}\nè´¦æˆ·ä½™é¢ï¼š${availableBalance.toFixed(2)} USDT\nä½¿ç”¨é‡‘é¢ï¼š${totalAmount.toFixed(2)} USDT (1%)\nå•å¸é‡‘é¢ï¼š${(totalAmount / 8).toFixed(2)} USDT`;

                
                if (!confirm(confirmMsg)) {
                    console.log('âŒ ç”¨æˆ·å–æ¶ˆæ‰§è¡Œ');
                    return;
                }
                
                // è·å–å¸ç§åˆ—è¡¨ï¼ˆæ¶¨å¹…å‰8æˆ–å8ï¼‰
                let symbols;
                const response = await fetch('/api/coin-change-tracker/latest?limit=1');
                const result = await response.json();
                
                console.log('ğŸ“Š APIè¿”å›æ•°æ®:', result);
                
                if (!result.success || !result.data) {
                    alert('âŒ æ— æ³•è·å–å¸ç§æ•°æ®');
                    return;
                }
                
                // ä»changeså¯¹è±¡ä¸­æå–å¸ç§åŠå…¶æ¶¨è·Œå¹…
                const changes = result.data.changes;
                if (!changes || Object.keys(changes).length === 0) {
                    alert('âŒ å¸ç§æ•°æ®ä¸ºç©º');
                    return;
                }
                
                // å°†changesè½¬æ¢ä¸ºæ•°ç»„å¹¶æŒ‰æ¶¨è·Œå¹…æ’åº
                const coinsArray = Object.entries(changes).map(([symbol, data]) => ({
                    symbol: symbol,
                    change_pct: data.change_pct,
                    current_price: data.current_price
                }));
                
                // æŒ‰æ¶¨è·Œå¹…é™åºæ’åº
                coinsArray.sort((a, b) => b.change_pct - a.change_pct);
                
                console.log('ğŸ“ˆ æ’åºåçš„å¸ç§åˆ—è¡¨:', coinsArray.map(c => `${c.symbol}(${c.change_pct.toFixed(2)}%)`));
                
                if (type === 'top8') {
                    // è·å–æ¶¨å¹…å‰8å
                    symbols = coinsArray.slice(0, 8).map(c => c.symbol);
                    console.log('âœ… æ¶¨å¹…å‰8å:', symbols);
                } else {
                    // è·å–æ¶¨å¹…å8åï¼ˆæœ€å8ä¸ªï¼‰
                    symbols = coinsArray.slice(-8).map(c => c.symbol);
                    console.log('âœ… æ¶¨å¹…å8å:', symbols);
                }
                
                console.log(`ğŸ“‹ ç›®æ ‡å¸ç§(${symbols.length}ä¸ª):`, symbols);
                
                // è®¡ç®—æ¯ä¸ªå¸ç§çš„ä¸‹å•é‡‘é¢
                const amountPerCoin = totalAmount / symbols.length;
                console.log(`ğŸ’µ æ¯ä¸ªå¸ç§é‡‘é¢: ${amountPerCoin.toFixed(2)} USDT`);
                
                // æ‰§è¡Œæ‰¹é‡ä¸‹å•
                let successCount = 0;
                let failedCount = 0;
                const successCoins = [];
                const failedCoins = [];
                
                for (const symbol of symbols) {
                    try {
                        console.log(`ğŸ“¤ æ­£åœ¨ä¸º ${symbol} ä¸‹å•...`);
                        
                        // æ„å»ºè®¢å•å‚æ•°
                        const orderPayload = {
                            symbol: `${symbol}-USDT-SWAP`,
                            direction: direction, // 'long' æˆ– 'short'
                            orderType: 'market',
                            amount: amountPerCoin,
                            leverage: account.leverage || 10
                        };
                        
                        // å‘é€ä¸‹å•è¯·æ±‚
                        const response = await fetch('/api/okx-trading/place-order', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                apiKey: account.apiKey,
                                apiSecret: account.apiSecret,
                                passphrase: account.passphrase,
                                order: orderPayload
                            })
                        });
                        
                        const result = await response.json();
                        
                        if (result.success) {
                            successCount++;
                            successCoins.push(symbol);
                            console.log(`âœ… ${symbol} ä¸‹å•æˆåŠŸ`);
                        } else {
                            failedCount++;
                            failedCoins.push(symbol);
                            console.error(`âŒ ${symbol} ä¸‹å•å¤±è´¥:`, result.error);
                        }
                        
                        // å»¶è¿Ÿ100msï¼Œé¿å…è¯·æ±‚è¿‡å¿«
                        await new Promise(resolve => setTimeout(resolve, 100));
                        
                    } catch (error) {
                        failedCount++;
                        failedCoins.push(symbol);
                        console.error(`âŒ ${symbol} ä¸‹å•å¼‚å¸¸:`, error);
                    }
                }
                
                // æ˜¾ç¤ºç»“æœ
                const resultMsg = `æ‰§è¡Œå®Œæˆï¼\n\næˆåŠŸï¼š${successCount}ä¸ª\nå¤±è´¥ï¼š${failedCount}ä¸ª\n\næˆåŠŸå¸ç§ï¼š${successCoins.join(', ')}\nå¤±è´¥å¸ç§ï¼š${failedCoins.join(', ')}`;
                alert(resultMsg);
                
                // å‘é€Telegramé€šçŸ¥
                const telegramMsg = `âœ… ä½™é¢1%ç­–ç•¥æ‰§è¡Œå®Œæˆ\n\nè´¦æˆ·ï¼š${account.name}\nç­–ç•¥ï¼š${typeText} - ${directionText}\nä½¿ç”¨é‡‘é¢ï¼š${totalAmount.toFixed(2)} USDT\næˆåŠŸï¼š${successCount}/${symbols.length}\næˆåŠŸå¸ç§ï¼š${successCoins.join(', ')}`;
                
                await fetch('/api/telegram/send-message', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ message: telegramMsg })
                });
                
                // åˆ·æ–°è´¦æˆ·æ•°æ®
                await fetchAccountData();
                
            } catch (error) {
                console.error('âŒ æ‰§è¡Œä½™é¢1%ç­–ç•¥å¤±è´¥:', error);
                alert(`âŒ æ‰§è¡Œå¤±è´¥: ${error.message}`);
            }
        }
        
        // ==================== æ‰€æœ‰è´¦æˆ·çŠ¶æ€æ€»è§ˆ ====================
        
        // åˆ‡æ¢æ˜¾ç¤º/éšè—æ‰€æœ‰è´¦æˆ·çŠ¶æ€æ€»è§ˆ
        function toggleAllAccountsOverview() {
            const overviewDiv = document.getElementById('allAccountsOverview');
            const toggleBtn = document.getElementById('toggleAllAccountsBtn');
            
            if (overviewDiv.style.display === 'none') {
                overviewDiv.style.display = 'block';
                toggleBtn.textContent = 'ğŸ“Š éšè—æ‰€æœ‰è´¦æˆ·çŠ¶æ€';
                // é¦–æ¬¡æ‰“å¼€æ—¶åˆ·æ–°æ•°æ®
                refreshAllAccountsOverview();
            } else {
                overviewDiv.style.display = 'none';
                toggleBtn.textContent = 'ğŸ“Š æŸ¥çœ‹æ‰€æœ‰è´¦æˆ·çŠ¶æ€';
            }
        }
        
        // åˆ·æ–°æ‰€æœ‰è´¦æˆ·çš„çŠ¶æ€
        async function refreshAllAccountsOverview() {
            const listDiv = document.getElementById('allAccountsStatusList');
            
            if (!listDiv) {
                console.error('âŒ æ‰¾ä¸åˆ° allAccountsStatusList å…ƒç´ ');
                return;
            }
            
            listDiv.innerHTML = '<div style="text-align: center; color: #6b7280; padding: 20px; font-size: 12px;">â³ æ­£åœ¨åŠ è½½...</div>';
            
            try {
                // è·å–æ‰€æœ‰è´¦æˆ·
                if (!accounts || accounts.length === 0) {
                    listDiv.innerHTML = '<div style="text-align: center; color: #6b7280; padding: 20px; font-size: 12px;">âš ï¸ æ²¡æœ‰æ‰¾åˆ°è´¦æˆ·</div>';
                    return;
                }
                
                // ä¸ºæ¯ä¸ªè´¦æˆ·è·å–è®¾ç½®
                const accountsStatus = [];
                
                for (const account of accounts) {
                    try {
                        const response = await fetch(`/api/okx-trading/tpsl-settings/${account.id}`);
                        const result = await response.json();
                        
                        if (result.success && result.settings) {
                            accountsStatus.push({
                                id: account.id,
                                name: account.name,
                                settings: result.settings
                            });
                        }
                    } catch (e) {
                        console.warn(`âš ï¸ è·å–è´¦æˆ· ${account.name} è®¾ç½®å¤±è´¥:`, e);
                    }
                }
                
                // ç”ŸæˆHTML
                if (accountsStatus.length === 0) {
                    listDiv.innerHTML = '<div style="text-align: center; color: #6b7280; padding: 20px; font-size: 12px;">âš ï¸ æ— æ³•åŠ è½½è´¦æˆ·è®¾ç½®</div>';
                    return;
                }
                
                let html = '';
                
                for (const account of accountsStatus) {
                    const s = account.settings;
                    const isCurrentAccount = account.id === currentAccount;
                    
                    // ç»Ÿè®¡å¯ç”¨çš„ç­–ç•¥æ•°é‡
                    let enabledCount = 0;
                    if (s.takeProfitEnabled) enabledCount++;
                    if (s.stopLossEnabled) enabledCount++;
                    if (s.rsiTakeProfitEnabled) enabledCount++;
                    if (s.rsiShortTakeProfitEnabled) enabledCount++;
                    if (s.sentimentTakeProfitEnabled) enabledCount++;
                    if (s.top_signal_top8_short_enabled) enabledCount++;
                    if (s.top_signal_bottom8_short_enabled) enabledCount++;
                    
                    const totalStrategies = 7;
                    const enabledPercentage = (enabledCount / totalStrategies * 100).toFixed(0);
                    
                    // èƒŒæ™¯è‰²ï¼ˆå½“å‰è´¦æˆ·é«˜äº®ï¼‰
                    const bgColor = isCurrentAccount ? 'rgba(59, 130, 246, 0.15)' : 'rgba(255, 255, 255, 0.6)';
                    const borderColor = isCurrentAccount ? '#3b82f6' : '#d1d5db';
                    const borderWidth = isCurrentAccount ? '2px' : '1px';
                    
                    html += `
                    <div style="padding: 10px; background: ${bgColor}; border-radius: 6px; border: ${borderWidth} solid ${borderColor};">
                        <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px;">
                            <div style="display: flex; align-items: center; gap: 8px;">
                                <span style="font-size: 13px; font-weight: 700; color: #1f2937;">
                                    ${isCurrentAccount ? 'ğŸ‘‰ ' : ''}${account.name}
                                </span>
                                <span style="font-size: 10px; padding: 2px 6px; border-radius: 4px; background: ${enabledCount > 0 ? 'rgba(34, 197, 94, 0.2)' : 'rgba(156, 163, 175, 0.2)'}; color: ${enabledCount > 0 ? '#166534' : '#6b7280'}; font-weight: 600;">
                                    ${enabledCount}/${totalStrategies} ç­–ç•¥å·²å¯ç”¨
                                </span>
                            </div>
                            <button onclick="selectAccount('${account.id}')" style="background: #3b82f6; color: white; border: none; padding: 2px 8px; border-radius: 4px; cursor: pointer; font-size: 10px; font-weight: 600;">
                                ${isCurrentAccount ? 'âœ… å½“å‰' : 'åˆ‡æ¢'}
                            </button>
                        </div>
                        
                        <!-- è¿›åº¦æ¡ -->
                        <div style="height: 4px; background: rgba(209, 213, 219, 0.5); border-radius: 2px; overflow: hidden; margin-bottom: 8px;">
                            <div style="height: 100%; width: ${enabledPercentage}%; background: linear-gradient(90deg, #10b981 0%, #22c55e 100%); transition: width 0.3s ease;"></div>
                        </div>
                        
                        <!-- ç­–ç•¥åˆ—è¡¨ -->
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 4px; font-size: 10px;">
                            <div style="display: flex; align-items: center; gap: 4px; color: ${s.takeProfitEnabled ? '#166534' : '#9ca3af'};">
                                ${s.takeProfitEnabled ? 'âœ…' : 'âšª'} æ­¢ç›ˆ (+${s.takeProfitThreshold || 50}U)
                            </div>
                            <div style="display: flex; align-items: center; gap: 4px; color: ${s.stopLossEnabled ? '#991b1b' : '#9ca3af'};">
                                ${s.stopLossEnabled ? 'âœ…' : 'âšª'} æ­¢æŸ (${s.stopLossThreshold || -30}U)
                            </div>
                            <div style="display: flex; align-items: center; gap: 4px; color: ${s.rsiTakeProfitEnabled ? '#9a3412' : '#9ca3af'};">
                                ${s.rsiTakeProfitEnabled ? 'âœ…' : 'âšª'} RSIå¤šå• (${s.rsiTakeProfitThreshold || 1900})
                            </div>
                            <div style="display: flex; align-items: center; gap: 4px; color: ${s.rsiShortTakeProfitEnabled ? '#065f46' : '#9ca3af'};">
                                ${s.rsiShortTakeProfitEnabled ? 'âœ…' : 'âšª'} RSIç©ºå• (${s.rsiShortTakeProfitThreshold || 810})
                            </div>
                            <div style="display: flex; align-items: center; gap: 4px; color: ${s.top_signal_top8_short_enabled ? '#991b1b' : '#9ca3af'};">
                                ${s.top_signal_top8_short_enabled ? 'âœ…' : 'âšª'} è§é¡¶å‰8ç©º
                            </div>
                            <div style="display: flex; align-items: center; gap: 4px; color: ${s.top_signal_bottom8_short_enabled ? '#7f1d1d' : '#9ca3af'};">
                                ${s.top_signal_bottom8_short_enabled ? 'âœ…' : 'âšª'} è§é¡¶å8ç©º
                            </div>
                            <div style="display: flex; align-items: center; gap: 4px; color: ${s.sentimentTakeProfitEnabled ? '#991b1b' : '#9ca3af'}; grid-column: span 2;">
                                ${s.sentimentTakeProfitEnabled ? 'âœ…' : 'âšª'} å¸‚åœºæƒ…ç»ªæ­¢ç›ˆ
                            </div>
                        </div>
                    </div>
                    `;
                }
                
                listDiv.innerHTML = html;
                console.log(`âœ… å·²åŠ è½½ ${accountsStatus.length} ä¸ªè´¦æˆ·çš„çŠ¶æ€`);
                
            } catch (error) {
                console.error('âŒ åˆ·æ–°æ‰€æœ‰è´¦æˆ·çŠ¶æ€å¤±è´¥:', error);
                listDiv.innerHTML = '<div style="text-align: center; color: #ef4444; padding: 20px; font-size: 12px;">âŒ åŠ è½½å¤±è´¥ï¼Œè¯·é‡è¯•</div>';
            }
        }

    </script>
</body>
</html>
