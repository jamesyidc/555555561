<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{symbol}} - SAR æŒç»­æ—¶é—´æ®µç»Ÿè®¡</title>
    
    <!-- ECharts -->
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', sans-serif;
            background: #1e2139;
            color: #fff;
            padding: 20px;
        }
        
        .container {
            max-width: 1800px;
            margin: 0 auto;
        }
        
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid rgba(59, 125, 255, 0.3);
        }
        
        .nav-buttons {
            display: flex;
            gap: 10px;
        }
        
        h1 {
            font-size: 28px;
            color: #00d4ff;
        }
        
        .back-btn {
            background: rgba(59, 125, 255, 0.2);
            border: 1px solid rgba(59, 125, 255, 0.4);
            color: #00d4ff;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            text-decoration: none;
            font-size: 14px;
        }
        
        .back-btn:hover {
            background: rgba(59, 125, 255, 0.3);
        }
        
        .status-bar {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
            padding: 15px;
            background: rgba(42, 45, 71, 0.6);
            border-radius: 8px;
        }
        
        .status-item {
            text-align: center;
        }
        
        .status-label {
            font-size: 12px;
            color: #8b92b8;
            margin-bottom: 5px;
        }
        
        .status-value {
            font-size: 18px;
            font-weight: bold;
            color: #00d4ff;
        }
        
        /* åå¤šåç©ºå›¾è¡¨åŒºåŸŸ */
        .bias-chart-container {
            background: rgba(42, 45, 71, 0.6);
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .bias-chart-title {
            font-size: 18px;
            font-weight: 600;
            color: #00d4ff;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .bias-chart-subtitle {
            font-size: 13px;
            color: #8b92b8;
            margin-top: -10px;
            margin-bottom: 15px;
        }
        
        #biasChart {
            width: 100%;
            height: 400px;
        }
        
        .data-table {
            width: 100%;
            background: rgba(42, 45, 71, 0.6);
            border-radius: 8px;
            overflow: hidden;
        }
        
        .table-header {
            display: grid;
            grid-template-columns: 60px 80px 90px 100px 100px 100px 100px 110px 90px 100px 110px 90px 100px 110px 100px 110px;
            gap: 8px;
            padding: 15px;
            background: rgba(59, 125, 255, 0.2);
            font-weight: bold;
            font-size: 12px;
            color: #00d4ff;
            border-bottom: 1px solid rgba(59, 125, 255, 0.3);
        }
        
        .table-row {
            display: grid;
            grid-template-columns: 60px 80px 90px 100px 100px 100px 100px 110px 90px 100px 110px 90px 100px 110px 100px 110px;
            gap: 8px;
            padding: 12px 15px;
            font-size: 12px;
            border-bottom: 1px solid rgba(139, 146, 184, 0.1);
            transition: background 0.2s;
        }
        
        .table-row:hover {
            background: rgba(59, 125, 255, 0.1);
        }
        
        .table-cell {
            color: #d0d4e8;
        }
        
        .position-long {
            color: #00ff00;
            font-weight: bold;
        }
        
        .position-short {
            color: #ff4444;
            font-weight: bold;
        }
        
        .trend-increase {
            color: #ff4444;
        }
        
        .trend-decrease {
            color: #00ff00;
        }
        
        .bias-bullish {
            color: #00ff00;
            font-weight: bold;
        }
        
        .bias-bearish {
            color: #ff4444;
            font-weight: bold;
        }
        
        .loading {
            text-align: center;
            padding: 50px;
            font-size: 18px;
            color: #8b92b8;
        }
        
        .error {
            text-align: center;
            padding: 30px;
            background: rgba(255, 68, 68, 0.1);
            border: 1px solid rgba(255, 68, 68, 0.3);
            border-radius: 8px;
            color: #ff4444;
        }
        
        /* è®¡ç®—é€»è¾‘è¯´æ˜å¡ç‰‡ */
        .info-card {
            background: rgba(42, 45, 71, 0.8);
            border: 1px solid rgba(139, 69, 255, 0.4);
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
            display: none;
        }
        
        .info-card.show {
            display: block;
        }
        
        .info-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            user-select: none;
            padding: 5px 0;
        }
        
        .info-title {
            font-size: 16px;
            font-weight: 600;
            color: #8b45ff;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .toggle-icon {
            font-size: 18px;
            transition: transform 0.3s;
            color: #8b45ff;
        }
        
        .toggle-icon.expanded {
            transform: rotate(180deg);
        }
        
        .info-content {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid rgba(139, 69, 255, 0.2);
            display: none;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }
        
        .info-content.show {
            display: block;
            max-height: 2000px;
        }
        
        .info-section {
            margin-bottom: 15px;
        }
        
        .info-section-title {
            font-size: 14px;
            font-weight: 600;
            color: #ffd700;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .info-text {
            font-size: 13px;
            line-height: 1.6;
            color: #b8c1ec;
            margin-bottom: 8px;
        }
        
        .info-formula {
            background: rgba(0, 0, 0, 0.4);
            border-left: 3px solid #00d4ff;
            padding: 10px 12px;
            margin: 8px 0;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            color: #26ff82;
            border-radius: 4px;
        }
        
        .info-example {
            background: rgba(139, 69, 255, 0.1);
            border: 1px solid rgba(139, 69, 255, 0.3);
            border-radius: 6px;
            padding: 10px;
            margin: 8px 0;
        }
        
        .info-example-title {
            font-size: 13px;
            font-weight: 600;
            color: #8b45ff;
            margin-bottom: 6px;
        }
        
        .info-list {
            list-style: none;
            padding-left: 0;
            margin: 5px 0;
        }
        
        .info-list li {
            padding: 4px 0;
            padding-left: 18px;
            position: relative;
            font-size: 12px;
            color: #b8c1ec;
        }
        
        .info-list li:before {
            content: "â–¸";
            position: absolute;
            left: 0;
            color: #00d4ff;
        }
        
        .highlight-green {
            color: #26ff82;
            font-weight: 600;
        }
        
        .highlight-red {
            color: #ff4444;
            font-weight: 600;
        }
        
        .highlight-blue {
            color: #00d4ff;
            font-weight: 600;
        }
        
        .info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 10px 0;
        }
        
        @media (max-width: 768px) {
            .info-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 id="pageTitle">åŠ è½½ä¸­...</h1>
            <div class="nav-buttons">
                <a href="/" class="back-btn">â† è¿”å›é¦–é¡µ</a>
                <a href="/sar-slope" class="back-btn">â† è¿”å›åˆ—è¡¨</a>
            </div>
        </div>
        
        <div id="statusBar" class="status-bar" style="display: none;"></div>
        
        <!-- åå¤šåç©ºå›¾è¡¨ -->
        <div class="bias-chart-container" id="biasChartContainer" style="display: none;">
            <div class="bias-chart-title">
                <span>ğŸ“Š</span>
                <span>åå¤šåç©ºåˆ†æ</span>
            </div>
            <div class="bias-chart-subtitle">åŸºäºæ˜¨å¤©+ä»Šå¤©çš„SARæ•°æ®ç»Ÿè®¡ï¼ˆ5åˆ†é’Ÿå‘¨æœŸï¼‰</div>
            <div id="biasChart"></div>
        </div>
        
        <!-- è®¡ç®—é€»è¾‘è¯´æ˜å¡ç‰‡ -->
        <div id="infoCard" class="info-card">
            <div class="info-header" onclick="toggleInfo()">
                <div class="info-title">
                    <span>ğŸ“š</span>
                    <span>SARå¤šç©ºåºå·è®¡ç®—é€»è¾‘è¯´æ˜</span>
                </div>
                <span class="toggle-icon" id="toggleIcon">â–¼</span>
            </div>
            <div class="info-content" id="infoContent">
                <div class="info-grid">
                    <div class="info-section">
                        <div class="info-section-title">ğŸ¯ SARå¤šç©ºå®šä¹‰</div>
                        <div class="info-text">
                            æ ¹æ®SARç‚¹ä¸Kçº¿çš„ç›¸å¯¹ä½ç½®åˆ¤æ–­ï¼š
                        </div>
                        <ul class="info-list">
                            <li><span class="highlight-green">SARå¤šå¤´</span>ï¼šSARç‚¹åœ¨Kçº¿<strong>ä¸‹æ–¹</strong>ï¼ˆçœ‹æ¶¨ï¼‰</li>
                            <li><span class="highlight-red">SARç©ºå¤´</span>ï¼šSARç‚¹åœ¨Kçº¿<strong>ä¸Šæ–¹</strong>ï¼ˆçœ‹è·Œï¼‰</li>
                        </ul>
                        <div class="info-formula">
                            å¤šå¤´: close > sar (æ”¯æ’‘ä½)<br>
                            ç©ºå¤´: close < sar (å‹åŠ›ä½)
                        </div>
                    </div>
                    
                    <div class="info-section">
                        <div class="info-section-title">ğŸ”¢ åºå·è®¡ç®—æ–¹æ³•</div>
                        <div class="info-text">
                            ä»æœ€è¿‘ä¸€æ¬¡å¤šç©ºè½¬æ¢ç‚¹å¼€å§‹è®¡æ•°ï¼š
                        </div>
                        <ul class="info-list">
                            <li>æ­¥éª¤1ï¼šè·å–æœ€æ–°Kçº¿çš„SARçŠ¶æ€</li>
                            <li>æ­¥éª¤2ï¼šå¾€å‰æ‰¾æœ€è¿‘ä¸€æ¬¡è½¬æ¢ç‚¹</li>
                            <li>æ­¥éª¤3ï¼šä»è½¬æ¢ç‚¹å¼€å§‹è®¡æ•°(01, 02...)</li>
                        </ul>
                        <div class="info-formula">
                            åºå· = ä»è½¬æ¢ç‚¹åˆ°å½“å‰çš„æ•°æ®ç‚¹æ•°é‡
                        </div>
                    </div>
                </div>
                
                <div class="info-section">
                    <div class="info-section-title">ğŸ“Š æ•°æ®æ¥æº</div>
                    <div class="info-text">
                        æ‰€æœ‰æ•°æ®ä¸¥æ ¼æ¥è‡ª<span class="highlight-blue">OKXæ°¸ç»­åˆçº¦å¸‚åœº</span>ï¼š
                    </div>
                    <ul class="info-list">
                        <li>Kçº¿æ•°æ®ï¼šOKXæ°¸ç»­åˆçº¦5åˆ†é’ŸKçº¿ï¼ˆå¼€é«˜ä½æ”¶ï¼‰</li>
                        <li>æ›´æ–°é¢‘ç‡ï¼šæ¯5åˆ†é’Ÿé‡‡é›†ä¸€æ¬¡</li>
                        <li>å¸ç§èŒƒå›´ï¼š29ä¸ªä¸»æµå¸ç§</li>
                        <li>SARå‚æ•°ï¼šAF_START=0.02, AF_MAX=0.2</li>
                    </ul>
                </div>
                
                <div class="info-section">
                    <div class="info-section-title">ğŸ“ˆ åºå·ç¤ºä¾‹</div>
                    <div class="info-example">
                        <div class="info-example-title">æ¡ˆä¾‹ï¼šä»ç©ºå¤´è½¬å¤šå¤´</div>
                        <div class="info-formula" style="border-color: #26ff82;">
20:05 ç©ºå¤´ â† ä¸Šä¸ªå‘¨æœŸ<br>
20:10 <span class="highlight-green">å¤šå¤´</span> â† è½¬æ¢ç‚¹ï¼ˆåºåˆ—01ï¼‰<br>
20:15 <span class="highlight-green">å¤šå¤´</span> â† åºåˆ—02<br>
20:20 <span class="highlight-green">å¤šå¤´</span> â† åºåˆ—03ï¼ˆå½“å‰ï¼‰<br>
<br>
æ˜¾ç¤ºï¼š<span class="highlight-green">å¤šå¤´03</span>
                        </div>
                    </div>
                </div>
                
                <div class="info-grid">
                    <div class="info-section">
                        <div class="info-section-title">ğŸ“Š åºå·ç»Ÿè®¡è®¡ç®—æ–¹æ³•</div>
                        <div class="info-text">
                            ç»Ÿè®¡æœ€è¿‘24å°æ—¶å†…ï¼Œæ¯ä¸ªåºå·çš„SARå·®å€¼å¹¶åˆ¤æ–­åå‘ï¼š
                        </div>
                        <div class="info-formula">
                            å·®å€¼ = SARå€¼ - ä»·æ ¼
                        </div>
                        <ul class="info-list">
                            <li><strong>å¤šå¤´åºå·</strong>ï¼ˆSARåœ¨ä¸‹æ–¹ï¼‰ï¼š
                                <ul style="margin-top: 8px;">
                                    <li>å·®å€¼è¶Šå¤§ï¼ˆæ›´æ­£ï¼‰â†’ <span class="highlight-red">åç©º</span>ï¼ˆSARç¦»ä»·æ ¼è¿œï¼Œè¶‹åŠ¿å¼±ï¼‰</li>
                                    <li>å·®å€¼è¶Šå°ï¼ˆæ›´è´Ÿï¼‰â†’ <span class="highlight-green">åå¤š</span>ï¼ˆSARç´§è´´ä»·æ ¼ï¼Œè¶‹åŠ¿å¼ºï¼‰</li>
                                </ul>
                            </li>
                            <li style="margin-top: 8px;"><strong>ç©ºå¤´åºå·</strong>ï¼ˆSARåœ¨ä¸Šæ–¹ï¼‰ï¼š
                                <ul style="margin-top: 8px;">
                                    <li>å·®å€¼è¶Šå¤§ï¼ˆæ›´æ­£ï¼‰â†’ <span class="highlight-green">åå¤š</span>ï¼ˆSARç¦»ä»·æ ¼è¿œï¼Œåè½¬å¯èƒ½å¤§ï¼‰</li>
                                    <li>å·®å€¼è¶Šå°ï¼ˆæ›´è´Ÿï¼‰â†’ <span class="highlight-red">åç©º</span>ï¼ˆSARç´§è´´ä»·æ ¼ï¼Œä¸‹è·Œå¼ºåŠ²ï¼‰</li>
                                </ul>
                            </li>
                        </ul>
                        <div class="info-example" style="margin-top: 12px;">
                            <div class="info-example-title">ç¤ºä¾‹ï¼šDOTå¤šå¤´02ç»Ÿè®¡</div>
                            <div class="info-formula" style="border-color: #26ff82; font-size: 12px;">
ç»Ÿè®¡æœ€è¿‘24å°æ—¶å†…æ‰€æœ‰"å¤šå¤´02"çš„å·®å€¼ï¼š<br>
- ç¬¬1æ¬¡å¤šå¤´02: å·®å€¼=-0.0045ï¼ˆSARç´§è´´ï¼‰<br>
- ç¬¬2æ¬¡å¤šå¤´02: å·®å€¼=-0.0051ï¼ˆSARç´§è´´ï¼‰<br>
- ç¬¬3æ¬¡å¤šå¤´02: å·®å€¼=-0.0042ï¼ˆSARç´§è´´ï¼‰<br>
<br>
å¹³å‡å·®å€¼: -0.0046 â†’ åˆ¤æ–­: <span class="highlight-green">åå¤š</span>âœ“
                            </div>
                        </div>
                    </div>
                    
                    <div class="info-section">
                        <div class="info-section-title">â° 2å°æ—¶å¤šç©ºå æ¯”è®¡ç®—</div>
                        <div class="info-text">
                            åŸºäº1å¤©åºå·ç»Ÿè®¡ï¼Œåˆ†ææœ€è¿‘2å°æ—¶çš„å¤šç©ºåå‘åˆ†å¸ƒï¼š
                        </div>
                        <div class="info-formula" style="background: rgba(38, 255, 130, 0.1); padding: 12px; border-radius: 8px; margin-top: 10px;">
                            <strong>è®¡ç®—æ­¥éª¤ï¼š</strong><br>
                            1ï¸âƒ£ è·å–1å¤©åºå·ç»Ÿè®¡ä½œä¸ºåŸºå‡†<br>
                            2ï¸âƒ£ è¯»å–æœ€è¿‘2å°æ—¶æ•°æ®ç‚¹ï¼ˆçº¦24ä¸ªï¼‰<br>
                            3ï¸âƒ£ è¯†åˆ«æ¯ä¸ªç‚¹çš„åºå·<br>
                            4ï¸âƒ£ æŸ¥æ‰¾åºå·çš„åå‘ï¼ˆåå¤š/åç©º/ä¸­æ€§ï¼‰<br>
                            5ï¸âƒ£ ç»Ÿè®¡å¹¶è®¡ç®—å æ¯”
                        </div>
                        <div class="info-example" style="margin-top: 12px;">
                            <div class="info-example-title">ç¤ºä¾‹ï¼šDOTæœ€è¿‘2å°æ—¶</div>
                            <div class="info-formula" style="border-color: #26ff82; font-size: 12px;">
20:05 å¤šå¤´01 â†’ æŸ¥1å¤©ç»Ÿè®¡ â†’ <span class="highlight-green">åå¤š</span> âœ“<br>
20:10 å¤šå¤´02 â†’ æŸ¥1å¤©ç»Ÿè®¡ â†’ <span class="highlight-green">åå¤š</span> âœ“<br>
20:15 ç©ºå¤´01 â†’ æŸ¥1å¤©ç»Ÿè®¡ â†’ <span class="highlight-green">åå¤š</span> âœ“<br>
20:20 ç©ºå¤´02 â†’ æŸ¥1å¤©ç»Ÿè®¡ â†’ <span class="highlight-green">åå¤š</span> âœ“<br>
20:25 ç©ºå¤´03 â†’ æŸ¥1å¤©ç»Ÿè®¡ â†’ ä¸­æ€§<br>
...<br>
<br>
ç»Ÿè®¡ç»“æœ:<br>
â€¢ åå¤š: 22ä¸ª (95.7%)<br>
â€¢ åç©º: 0ä¸ª (0.0%)<br>
â€¢ ä¸­æ€§: 1ä¸ª (4.3%)<br>
<br>
ä¸»å¯¼åå‘: <span class="highlight-green">åå¤š</span> â†’ è¿‘2å°æ—¶è¶‹åŠ¿åå¤š
                            </div>
                        </div>
                        <div class="info-text" style="margin-top: 12px; font-size: 12px; color: #8b92b8;">
                            <strong>åº”ç”¨åœºæ™¯</strong>ï¼šåˆ¤æ–­çŸ­æœŸå¸‚åœºè¶‹åŠ¿ï¼Œé…åˆåºå·ç»Ÿè®¡åšäº¤æ˜“å†³ç­–
                        </div>
                    </div>
                    
                    <div class="info-section">
                        <div class="info-section-title">ğŸ’¡ åå¤šåç©ºè®¡ç®—é€»è¾‘ï¼ˆv2.2æœ€ç»ˆç‰ˆï¼‰</div>
                        <div class="info-text">
                            <strong style="color: #ffd700;">æ ¸å¿ƒåŸç†ï¼š</strong><br>
                            ä¸æ˜¯ç®€å•ç»Ÿè®¡å¤šç©ºçŠ¶æ€çš„æ¬¡æ•°ï¼Œè€Œæ˜¯æ¯”è¾ƒ<strong>å½“å‰åºå·çš„SARå·®å€¼</strong>ä¸<strong>è¯¥åºå·çš„å†å²å¹³å‡å·®å€¼</strong>ã€‚
                        </div>
                        <div class="info-formula" style="background: rgba(0, 212, 255, 0.1); padding: 12px; border-radius: 8px; margin-top: 10px;">
                            <strong>è®¡ç®—æ­¥éª¤ï¼š</strong><br>
                            1ï¸âƒ£ ç»Ÿè®¡å†å²æ•°æ®ï¼ˆæ˜¨å¤©+ä»Šå¤©ï¼Œçº¦500æ¡ï¼‰<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;â€¢ å¤šå¤´01çš„æ‰€æœ‰å·®å€¼ â†’ è®¡ç®—å¹³å‡å€¼<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;â€¢ å¤šå¤´02çš„æ‰€æœ‰å·®å€¼ â†’ è®¡ç®—å¹³å‡å€¼<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;â€¢ ç©ºå¤´01çš„æ‰€æœ‰å·®å€¼ â†’ è®¡ç®—å¹³å‡å€¼<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;â€¢ ç©ºå¤´02çš„æ‰€æœ‰å·®å€¼ â†’ è®¡ç®—å¹³å‡å€¼<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;â€¢ ...<br>
                            <br>
                            2ï¸âƒ£ åˆ†ææœ€è¿‘2å°æ—¶çš„æ•°æ®ï¼ˆ24ä¸ªç‚¹ï¼‰<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;â€¢ å¦‚æœå½“å‰æ˜¯<span class="highlight-green">å¤šå¤´02</span>ï¼Œæ¯”è¾ƒå½“å‰å·®å€¼ vs <strong>å†å²å¤šå¤´02çš„å¹³å‡</strong><br>
                            &nbsp;&nbsp;&nbsp;&nbsp;â€¢ å¦‚æœå½“å‰æ˜¯<span class="highlight-red">ç©ºå¤´05</span>ï¼Œæ¯”è¾ƒå½“å‰å·®å€¼ vs <strong>å†å²ç©ºå¤´05çš„å¹³å‡</strong><br>
                            <br>
                            3ï¸âƒ£ ç»Ÿè®¡åå¤š/åç©ºçš„æ•°é‡å’Œæ¯”ä¾‹<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;â€¢ åå¤šæ¯”ä¾‹ = åå¤šæ¬¡æ•° / æ€»åˆ†ææ¬¡æ•° Ã— 100%<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;â€¢ åç©ºæ¯”ä¾‹ = åç©ºæ¬¡æ•° / æ€»åˆ†ææ¬¡æ•° Ã— 100%
                        </div>
                        <div class="info-formula" style="background: rgba(255, 215, 0, 0.1); padding: 12px; border-radius: 8px; margin-top: 10px;">
                            <strong>åˆ¤æ–­è§„åˆ™ï¼š</strong><br>
                            ğŸ“ˆ <strong>å¤šå¤´çŠ¶æ€</strong>ï¼ˆä»·æ ¼ > SARï¼‰ï¼š<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;â€¢ å½“å‰å·®å€¼ &lt; å†å²å¹³å‡ â†’ <span class="highlight-green">åå¤š</span>ï¼ˆä»·æ ¼æ¥è¿‘æ”¯æ’‘ä½ï¼Œå¯èƒ½åå¼¹ï¼‰<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;â€¢ å½“å‰å·®å€¼ &gt; å†å²å¹³å‡ â†’ <span class="highlight-red">åç©º</span>ï¼ˆä»·æ ¼ç¦»æ”¯æ’‘ä½è¿œï¼Œå¯èƒ½å›è°ƒï¼‰<br>
                            <br>
                            ğŸ“‰ <strong>ç©ºå¤´çŠ¶æ€</strong>ï¼ˆä»·æ ¼ &lt; SARï¼‰ï¼š<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;â€¢ å½“å‰å·®å€¼ &lt; å†å²å¹³å‡ â†’ <span class="highlight-red">åç©º</span>ï¼ˆç©ºå¤´å¼ºåŠ¿ï¼Œç»§ç»­ä¸‹è·Œï¼‰<br>
                            &nbsp;&nbsp;&nbsp;&nbsp;â€¢ å½“å‰å·®å€¼ &gt; å†å²å¹³å‡ â†’ <span class="highlight-green">åå¤š</span>ï¼ˆå¿«é€Ÿä¸‹è·Œåï¼Œå¯èƒ½åå¼¹ï¼‰
                        </div>
                        <div class="info-example" style="margin-top: 12px;">
                            <div class="info-example-title">ç¤ºä¾‹è¯´æ˜</div>
                            <div class="info-formula" style="border-color: #26ff82; font-size: 12px;">
å‡è®¾å†å²æ•°æ®ç»Ÿè®¡ï¼š<br>
&nbsp;&nbsp;&nbsp;&nbsp;â€¢ å¤šå¤´02çš„å¹³å‡å·®å€¼ = 0.0095<br>
&nbsp;&nbsp;&nbsp;&nbsp;â€¢ ç©ºå¤´05çš„å¹³å‡å·®å€¼ = 0.0094<br>
<br>
å½“å‰æ•°æ®ç‚¹ï¼š<br>
&nbsp;&nbsp;&nbsp;&nbsp;â€¢ æ—¶åˆ»1: å¤šå¤´02, å½“å‰å·®å€¼=0.007 &lt; 0.0095 â†’ <span class="highlight-green">åå¤š</span> âœ“<br>
&nbsp;&nbsp;&nbsp;&nbsp;â€¢ æ—¶åˆ»2: å¤šå¤´02, å½“å‰å·®å€¼=0.012 &gt; 0.0095 â†’ <span class="highlight-red">åç©º</span> âœ—<br>
&nbsp;&nbsp;&nbsp;&nbsp;â€¢ æ—¶åˆ»3: ç©ºå¤´05, å½“å‰å·®å€¼=0.012 &gt; 0.0094 â†’ <span class="highlight-green">åå¤š</span> âœ“
                            </div>
                        </div>
                        <div class="info-formula" style="background: rgba(38, 255, 130, 0.1); padding: 12px; border-radius: 8px; margin-top: 10px;">
                            <strong>âœ¨ å…³é”®ä¼˜åŠ¿ï¼š</strong><br>
                            âœ… æ¯ä¸ªåºå·æœ‰ç‹¬ç«‹çš„å†å²åŸºå‡†<br>
                            âœ… è€ƒè™‘äº†å‘¨æœŸå†…çš„ä½ç½®ç‰¹å¾<br>
                            âœ… æ›´ç²¾å‡†åœ°åæ˜ å¸‚åœºåå‘<br>
                            âœ… ç§‘å­¦æ€§å¼ºï¼Œç¬¦åˆæŠ€æœ¯åˆ†æåŸç†
                        </div>
                    </div>
                    
                    <div class="info-section">
                        <div class="info-section-title">ğŸ”Œ APIæ¥å£</div>
                        <div class="info-text">ç³»ç»Ÿæä¾›ä»¥ä¸‹APIç«¯ç‚¹ï¼š</div>
                        <ul class="info-list" style="font-family: monospace; font-size: 11px;">
                            <li><strong>å½“å‰åºå·æŸ¥è¯¢</strong>ï¼š<br>GET /api/sar-slope/current-sequence<br><span style="color: #8b92b8;">è¿”å›æ‰€æœ‰å¸ç§çš„å½“å‰åºå·å’ŒçŠ¶æ€</span></li>
                            <li><strong>å®Œæ•´å‘¨æœŸæ•°æ®</strong>ï¼š<br>GET /api/sar-slope/current-cycle/&lt;symbol&gt;<br><span style="color: #8b92b8;">è¿”å›å½“å‰å‘¨æœŸçš„æ‰€æœ‰åºåˆ—æ•°æ®</span></li>
                            <li><strong>åºå·ç»Ÿè®¡æ•°æ®</strong>ï¼š<br>GET /api/sar-slope/sequence-statistics?hours=24<br><span style="color: #8b92b8;">è¿”å›å„åºå·çš„å¹³å‡å·®å€¼å’Œåå‘åˆ¤æ–­</span></li>
                            <li><strong>2å°æ—¶å¤šç©ºå æ¯”</strong>ï¼š<br>GET /api/sar-slope/bias-ratio-2h<br><span style="color: #8b92b8;">è¿”å›æœ€è¿‘2å°æ—¶çš„å¤šç©ºå æ¯”åˆ†æ</span></li>
                        </ul>
                    </div>
                </div>
                
                <div class="info-section">
                    <div class="info-section-title">âš™ï¸ ç³»ç»Ÿæ¶æ„</div>
                    <div class="info-grid" style="grid-template-columns: 1fr 1fr;">
                        <div>
                            <div class="info-text"><strong>PM2è¿›ç¨‹ç®¡ç†</strong></div>
                            <ul class="info-list" style="font-size: 11px;">
                                <li><code>sar-jsonl-collector</code><br>SARæ•°æ®é‡‡é›†å™¨ï¼ˆæ¯5åˆ†é’Ÿï¼‰</li>
                                <li><code>flask-app</code><br>Flask APIæœåŠ¡å™¨ï¼ˆç«¯å£5000ï¼‰</li>
                                <li><code>coin-change-tracker</code><br>å¸ç§æ¶¨è·Œå¹…ç›‘æ§</li>
                                <li><code>panic-collector</code><br>ææ…ŒæŒ‡æ ‡é‡‡é›†</li>
                            </ul>
                        </div>
                        <div>
                            <div class="info-text"><strong>æ ¸å¿ƒæ¨¡å—</strong></div>
                            <ul class="info-list" style="font-size: 11px;">
                                <li><code>sar_api_jsonl.py</code><br>SARæ•°æ®APIé€»è¾‘</li>
                                <li><code>app.py</code><br>Flaskåº”ç”¨ä¸»æ–‡ä»¶</li>
                                <li><code>sar_slope_detail.html</code><br>è¯¦æƒ…é¡µå‰ç«¯æ¨¡æ¿</li>
                                <li><code>DOT.jsonl</code><br>SARæ•°æ®å­˜å‚¨ï¼ˆJSONLæ ¼å¼ï¼‰</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <div class="info-section">
                    <div class="info-section-title">ğŸ›£ï¸ è·¯ç”±åˆ—è¡¨</div>
                    <div class="info-grid" style="grid-template-columns: 1fr 1fr;">
                        <div>
                            <div class="info-text"><strong>é¡µé¢è·¯ç”±</strong></div>
                            <ul class="info-list" style="font-family: monospace; font-size: 11px;">
                                <li>/sar-slope<br><span style="color: #8b92b8;">å¸ç§åˆ—è¡¨é¡µ</span></li>
                                <li>/sar-slope/&lt;symbol&gt;<br><span style="color: #8b92b8;">å¸ç§è¯¦æƒ…é¡µï¼ˆæœ¬é¡µï¼‰</span></li>
                                <li>/sar-slope/chart<br><span style="color: #8b92b8;">å®æ—¶æ›²çº¿å›¾</span></li>
                                <li>/sar-bias-trend<br><span style="color: #8b92b8;">åå‘è¶‹åŠ¿å›¾</span></li>
                            </ul>
                        </div>
                        <div>
                            <div class="info-text"><strong>æ•°æ®è·¯ç”±</strong></div>
                            <ul class="info-list" style="font-family: monospace; font-size: 11px;">
                                <li>/api/sar-slope/status<br><span style="color: #8b92b8;">å…¨å±€çŠ¶æ€</span></li>
                                <li>/api/sar-slope/bias-ratios<br><span style="color: #8b92b8;">å¤šç©ºæ¯”ä¾‹</span></li>
                                <li>/api/data-health-monitor/status<br><span style="color: #8b92b8;">å¥åº·ç›‘æ§</span></li>
                                <li>/api/okx-trading/*<br><span style="color: #8b92b8;">OKXäº¤æ˜“æ¥å£</span></li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <div class="info-section">
                    <div class="info-section-title">ğŸ’¾ æ•°æ®å­˜å‚¨</div>
                    <ul class="info-list">
                        <li><strong>å­˜å‚¨æ ¼å¼</strong>ï¼šJSONLï¼ˆæ¯è¡Œä¸€ä¸ªJSONå¯¹è±¡ï¼‰</li>
                        <li><strong>å­˜å‚¨è·¯å¾„</strong>ï¼š/home/user/webapp/data/sar_jsonl/</li>
                        <li><strong>æ–‡ä»¶å‘½å</strong>ï¼š{å¸ç§}.jsonlï¼ˆå¦‚DOT.jsonlï¼‰</li>
                        <li><strong>ä¿ç•™æ—¶é•¿</strong>ï¼šæŒç»­ç´¯ç§¯ï¼Œå®šæœŸå½’æ¡£</li>
                        <li><strong>æ•°æ®å­—æ®µ</strong>ï¼štimestamp, beijing_time, symbol, close, sar, position, duration_minutes, slope_valueç­‰</li>
                    </ul>
                </div>
                
                <div class="info-section">
                    <div class="info-section-title">ğŸ”„ æ•°æ®æµç¨‹</div>
                    <div class="info-formula" style="background: rgba(139, 69, 255, 0.1); padding: 15px; border-radius: 8px;">
                        <strong style="color: #8b45ff;">å®Œæ•´æ•°æ®é“¾è·¯ï¼š</strong><br><br>
                        1ï¸âƒ£ OKX API â†’ è·å–5åˆ†é’ŸKçº¿æ•°æ®ï¼ˆå¼€é«˜ä½æ”¶ï¼‰<br>
                        2ï¸âƒ£ SARé‡‡é›†å™¨ â†’ è®¡ç®—SARæŒ‡æ ‡ï¼ˆAF_START=0.02, AF_MAX=0.2ï¼‰<br>
                        3ï¸âƒ£ åˆ¤æ–­å¤šç©º â†’ closeä¸saræ¯”è¾ƒï¼Œç¡®å®špositionçŠ¶æ€<br>
                        4ï¸âƒ£ å†™å…¥JSONL â†’ è¿½åŠ åˆ°å¸ç§å¯¹åº”çš„.jsonlæ–‡ä»¶<br>
                        5ï¸âƒ£ APIè¯»å– â†’ Flaskä»JSONLè¯»å–æœ€æ–°æ•°æ®<br>
                        6ï¸âƒ£ è®¡ç®—åºå· â†’ å‘å‰æ‰«ææ‰¾è½¬æ¢ç‚¹ï¼Œä»01å¼€å§‹è®¡æ•°<br>
                        7ï¸âƒ£ å‰ç«¯å±•ç¤º â†’ æœ¬é¡µé¢æ˜¾ç¤ºå®Œæ•´å‘¨æœŸåºåˆ—ï¼ˆæœ€æ–°åœ¨å‰ï¼‰<br>
                        8ï¸âƒ£ åºå·ç»Ÿè®¡ â†’ ç»Ÿè®¡24å°æ—¶å†…å„åºå·çš„å·®å€¼å’Œåå‘
                    </div>
                </div>
                
                <div class="info-section">
                    <div class="info-section-title">ğŸ“š æŠ€æœ¯æ–‡æ¡£</div>
                    <ul class="info-list">
                        <li><strong>è¯¦ç»†è¯´æ˜</strong>ï¼š/home/user/webapp/SAR_CALCULATION_LOGIC.md</li>
                        <li><strong>åºå·ç³»ç»Ÿ</strong>ï¼š/home/user/webapp/SAR_SEQUENCE_SYSTEM.md</li>
                        <li><strong>æ›´æ–°æŒ‡å—</strong>ï¼š/home/user/webapp/SAR_LOGIC_UPDATE_GUIDE.md</li>
                        <li><strong>Gitä»“åº“</strong>ï¼šæ‰€æœ‰å˜æ›´å·²æäº¤åˆ°mainåˆ†æ”¯</li>
                    </ul>
                </div>
                
                <div class="info-section">
                    <div class="info-section-title">âš ï¸ é‡è¦è¯´æ˜</div>
                    <ul class="info-list">
                        <li><strong>åºå·01-03</strong>ï¼šè¶‹åŠ¿åˆšç¡®ç«‹ï¼Œéœ€è¦è§‚å¯Ÿç¡®è®¤</li>
                        <li><strong>åºå·04-08</strong>ï¼šè¶‹åŠ¿å»¶ç»­ä¸­ï¼Œå¯ä»¥è·Ÿéš</li>
                        <li><strong>åºå·09+</strong>ï¼šè¶‹åŠ¿æˆç†Ÿï¼Œæ³¨æ„åè½¬é£é™©</li>
                        <li>æ•°æ®æ¯5åˆ†é’Ÿæ›´æ–°ä¸€æ¬¡ï¼Œåºå·ä¼šè‡ªåŠ¨é€’å¢</li>
                        <li>è½¬æ¢å‘ç”Ÿæ—¶ï¼Œåºå·é‡æ–°ä»01å¼€å§‹è®¡æ•°</li>
                    </ul>
                </div>
                
                <div class="info-text" style="margin-top: 15px; padding-top: 15px; border-top: 1px solid rgba(139, 69, 255, 0.2); text-align: center; color: #8b92b8; font-size: 12px;">
                    âš ï¸ æ³¨æ„ï¼šå¦‚åæœŸé€»è¾‘æœ‰æ”¹åŠ¨ï¼Œæ­¤è¯´æ˜ä¹Ÿä¼šåŒæ­¥æ›´æ–°
                </div>
            </div>
        </div>
        
        <div id="loading" class="loading">æ­£åœ¨åŠ è½½æ•°æ®...</div>
        <div id="error" class="error" style="display: none;"></div>
        
        <div id="dataTable" style="display: none;">
            <div class="data-table">
                <div class="table-header">
                    <div>åºåˆ—</div>
                    <div>æ—¶é—´</div>
                    <div>å¸ä»·</div>
                    <div>SARå€¼</div>
                    <div>SARå·®å€¼</div>
                    <div>å˜åŒ–ç‡%</div>
                    <div>1å¤©å·®å€¼æ¯”%</div>
                    <div>1å¤©å¹³å‡</div>
                    <div>1å¤©åå‘</div>
                    <div>3å¤©å˜åŒ–%</div>
                    <div>3å¤©å¹³å‡</div>
                    <div>3å¤©åå‘</div>
                    <div>7å¤©å˜åŒ–%</div>
                    <div>7å¤©å¹³å‡</div>
                    <div>15å¤©å˜åŒ–%</div>
                    <div>15å¤©å¹³å‡</div>
                </div>
                <div id="tableBody"></div>
            </div>
        </div>
    </div>

    <script>
        const symbol = window.location.pathname.split('/').pop();
        
        // æŠ˜å /å±•å¼€è®¡ç®—é€»è¾‘è¯´æ˜
        function toggleInfo() {
            const content = document.getElementById('infoContent');
            const icon = document.getElementById('toggleIcon');
            const isExpanded = content.classList.contains('show');
            
            if (isExpanded) {
                content.classList.remove('show');
                icon.classList.remove('expanded');
            } else {
                content.classList.add('show');
                icon.classList.add('expanded');
            }
        }
        
        async function loadData(retryCount = 0) {
            try {
                // æ·»åŠ æ—¶é—´æˆ³å‚æ•°é˜²æ­¢ç¼“å­˜ï¼ˆç‰¹åˆ«æ˜¯å¤–éƒ¨ä»£ç†ç¼“å­˜ï¼‰
                const cacheBuster = Date.now() + Math.random();
                // limit=500 è¡¨ç¤ºæœ€è¿‘500æ¡æ•°æ®ï¼ˆçº¦42å°æ—¶ï¼‰ï¼ŒåŒ…å«å†å²å‘¨æœŸ
                const url = `/api/sar-slope/current-cycle/${symbol}?include_history=true&limit=500&_t=${cacheBuster}`;
                
                const response = await fetch(url, {
                    method: 'GET',
                    headers: {
                        'Cache-Control': 'no-cache',
                        'Pragma': 'no-cache'
                    }
                });
                
                // æ£€æŸ¥å“åº”ç±»å‹ï¼Œå¦‚æœä¸æ˜¯JSONåˆ™æŠ›å‡ºé”™è¯¯
                const contentType = response.headers.get('content-type');
                if (!contentType || !contentType.includes('application/json')) {
                    // å¦‚æœè¿”å›çš„æ˜¯HTMLï¼ˆ500é”™è¯¯é¡µé¢ï¼‰ï¼Œå°è¯•é‡è¯•
                    if (retryCount < 2) {
                        console.warn(`è¿”å›éJSONå“åº”ï¼Œ${2-retryCount}ç§’åé‡è¯• (${retryCount + 1}/3)...`);
                        document.getElementById('loading').textContent = `åŠ è½½ä¸­... (é‡è¯• ${retryCount + 1}/3)`;
                        await new Promise(resolve => setTimeout(resolve, 2000));
                        return loadData(retryCount + 1);
                    }
                    throw new Error('æœåŠ¡å™¨è¿”å›é”™è¯¯æ ¼å¼ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•');
                }
                
                const data = await response.json();
                
                if (!data.success) {
                    throw new Error(data.error || 'åŠ è½½å¤±è´¥');
                }
                
                document.getElementById('loading').style.display = 'none';
                document.getElementById('pageTitle').textContent = `${symbol} - ${data.current_status.position_cn}å®Œæ•´å‘¨æœŸ (${data.current_status.cycle_info})`;
                
                renderStatusBar(data);
                renderBiasChart(data.bias_statistics);
                renderDataTable(data);
                
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('loading').style.display = 'none';
                document.getElementById('error').style.display = 'block';
                const errorMsg = error.message || 'The operation was aborted';
                document.getElementById('error').textContent = 'åŠ è½½å¤±è´¥: ' + errorMsg + (retryCount > 0 ? ` (å·²é‡è¯•${retryCount}æ¬¡)` : '');
                
                // æ·»åŠ é‡è¯•æŒ‰é’®
                const retryBtn = document.createElement('button');
                retryBtn.textContent = 'ç‚¹å‡»é‡è¯•';
                retryBtn.style.cssText = 'margin-top: 10px; padding: 8px 16px; background: #3b7dff; border: none; border-radius: 4px; color: white; cursor: pointer;';
                retryBtn.onclick = () => {
                    document.getElementById('error').style.display = 'none';
                    document.getElementById('loading').style.display = 'block';
                    document.getElementById('loading').textContent = 'åŠ è½½ä¸­...';
                    loadData(0);
                };
                if (!document.getElementById('error').querySelector('button')) {
                    document.getElementById('error').appendChild(retryBtn);
                }
            }
        }
        
        function renderBiasChart(biasStats) {
            if (!biasStats) return;
            
            const container = document.getElementById('biasChartContainer');
            container.style.display = 'block';
            
            const chartDom = document.getElementById('biasChart');
            const myChart = echarts.init(chartDom);
            
            const option = {
                backgroundColor: 'transparent',
                title: {
                    text: `åå¤š: ${biasStats.bullish_ratio}%  |  åç©º: ${biasStats.bearish_ratio}%`,
                    left: 'center',
                    top: 10,
                    textStyle: {
                        color: '#00d4ff',
                        fontSize: 16,
                        fontWeight: 'normal'
                    }
                },
                tooltip: {
                    trigger: 'item',
                    formatter: '{b}: {c} æ¬¡ ({d}%)',
                    backgroundColor: 'rgba(0, 0, 0, 0.8)',
                    borderColor: '#00d4ff',
                    borderWidth: 1,
                    textStyle: {
                        color: '#fff'
                    }
                },
                legend: {
                    orient: 'vertical',
                    left: 'left',
                    top: 'middle',
                    textStyle: {
                        color: '#d0d4e8',
                        fontSize: 14
                    },
                    itemWidth: 20,
                    itemHeight: 14
                },
                series: [
                    {
                        name: 'å¤šç©ºåˆ†å¸ƒ',
                        type: 'pie',
                        radius: ['40%', '70%'],
                        center: ['60%', '50%'],
                        avoidLabelOverlap: true,
                        itemStyle: {
                            borderRadius: 10,
                            borderColor: '#1e2139',
                            borderWidth: 2
                        },
                        label: {
                            show: true,
                            formatter: '{b}\n{d}%',
                            color: '#d0d4e8',
                            fontSize: 13
                        },
                        emphasis: {
                            label: {
                                show: true,
                                fontSize: 16,
                                fontWeight: 'bold'
                            },
                            itemStyle: {
                                shadowBlur: 10,
                                shadowOffsetX: 0,
                                shadowColor: 'rgba(0, 0, 0, 0.5)'
                            }
                        },
                        labelLine: {
                            show: true,
                            lineStyle: {
                                color: '#8b92b8'
                            }
                        },
                        data: [
                            {
                                value: biasStats.bullish_count,
                                name: 'åå¤š (Bullish)',
                                itemStyle: {
                                    color: {
                                        type: 'linear',
                                        x: 0, y: 0, x2: 0, y2: 1,
                                        colorStops: [
                                            { offset: 0, color: '#00ff88' },
                                            { offset: 1, color: '#00aa55' }
                                        ]
                                    }
                                }
                            },
                            {
                                value: biasStats.bearish_count,
                                name: 'åç©º (Bearish)',
                                itemStyle: {
                                    color: {
                                        type: 'linear',
                                        x: 0, y: 0, x2: 0, y2: 1,
                                        colorStops: [
                                            { offset: 0, color: '#ff5555' },
                                            { offset: 1, color: '#cc3333' }
                                        ]
                                    }
                                }
                            }
                        ]
                    }
                ]
            };
            
            myChart.setOption(option);
            
            // å“åº”å¼è°ƒæ•´
            window.addEventListener('resize', function() {
                myChart.resize();
            });
        }
        
        function renderStatusBar(data) {
            const statusBar = document.getElementById('statusBar');
            const status = data.current_status;
            const biasStats = data.bias_statistics;
            
            let html = `
                <div class="status-item">
                    <div class="status-label">å½“å‰çŠ¶æ€</div>
                    <div class="status-value ${status.position === 'long' ? 'position-long' : 'position-short'}">
                        ${status.position_cn}
                    </div>
                </div>
                <div class="status-item">
                    <div class="status-label">å½“å‰åºåˆ—</div>
                    <div class="status-value">${status.current_sequence}</div>
                </div>
                <div class="status-item">
                    <div class="status-label">å‘¨æœŸèŒƒå›´</div>
                    <div class="status-value">${status.cycle_info}</div>
                </div>
                <div class="status-item">
                    <div class="status-label">åºåˆ—æ€»æ•°</div>
                    <div class="status-value">${data.total_sequences}</div>
                </div>
                <div class="status-item">
                    <div class="status-label">æœ€åæ›´æ–°</div>
                    <div class="status-value">${status.last_update}</div>
                </div>
            `;
            
            // æ·»åŠ 2å°æ—¶åå‘ç»Ÿè®¡ï¼ˆå¦‚æœæœ‰æ•°æ®ï¼‰
            if (biasStats && biasStats.total_records > 0) {
                html += `
                    <div class="status-item" style="grid-column: 1 / -1; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 15px; margin-top: 10px;">
                        <div class="status-label">æœ€è¿‘2å°æ—¶åå‘ç»Ÿè®¡ (${biasStats.total_records}æ¡æ•°æ®)</div>
                    </div>
                    <div class="status-item">
                        <div class="status-label">åå¤šæ¬¡æ•°</div>
                        <div class="status-value bias-bullish">${biasStats.bullish_count} (${biasStats.bullish_ratio}%)</div>
                    </div>
                    <div class="status-item">
                        <div class="status-label">åç©ºæ¬¡æ•°</div>
                        <div class="status-value bias-bearish">${biasStats.bearish_count} (${biasStats.bearish_ratio}%)</div>
                    </div>
                    <div class="status-item">
                        <div class="status-label">ä¸­æ€§æ¬¡æ•°</div>
                        <div class="status-value">${biasStats.neutral_count}</div>
                    </div>
                `;
            }
            
            statusBar.innerHTML = html;
            statusBar.style.display = 'grid';
            
            // æ˜¾ç¤ºè®¡ç®—é€»è¾‘è¯´æ˜å¡ç‰‡
            document.getElementById('infoCard').classList.add('show');
        }
        
        function renderDataTable(data) {
            const tableBody = document.getElementById('tableBody');
            const sequences = data.sequences;
            
            let html = '';
            
            // åè½¬æ•°ç»„ï¼Œè®©æœ€æ–°çš„æ•°æ®æ˜¾ç¤ºåœ¨å‰é¢
            const reversedSequences = sequences.slice().reverse();
            
            reversedSequences.forEach(seq => {
                const hasChange = seq.sequence_change_percent !== undefined && seq.sar_diff_abs !== undefined;
                // ä½¿ç”¨æ¯è¡Œæ•°æ®è‡ªå·±çš„positionï¼Œè€Œä¸æ˜¯å…¨å±€çš„currentPosition
                const rowPosition = seq.position;
                const positionClass = rowPosition === 'bullish' ? 'position-long' : 'position-short';
                const positionCn = rowPosition === 'bullish' ? 'å¤šå¤´' : 'ç©ºå¤´';
                
                // 1å¤©åå‘ - ç›´æ¥ä½¿ç”¨APIè¿”å›çš„ bias_1day å­—æ®µ
                const bias1day = seq.bias_1day || '-';
                const bias1dayClass = bias1day === 'åå¤š' ? 'bias-bullish' : (bias1day === 'åç©º' ? 'bias-bearish' : '');
                
                // 3å¤©åå‘ï¼ˆåŸºäº3å¤©å˜åŒ–%çš„æ­£è´Ÿï¼Œä¸”ç»å¯¹å€¼>30%æ‰æ˜¾ç¤ºï¼‰
                let bias3day = '-';
                let bias3dayClass = '';
                if (seq.change_3day_percent !== undefined) {
                    const abs3day = Math.abs(seq.change_3day_percent);
                    if (abs3day > 30) {  // åªæœ‰åç¦»å€¼å¤§äº30%æ‰æ˜¾ç¤º
                        if (rowPosition === 'bullish') {
                            bias3day = seq.change_3day_percent < 0 ? 'åå¤š' : 'åç©º';
                        } else {
                            bias3day = seq.change_3day_percent < 0 ? 'åç©º' : 'åå¤š';
                        }
                        bias3dayClass = bias3day === 'åå¤š' ? 'bias-bullish' : 'bias-bearish';
                    }
                }
                
                const sarDiffClass = hasChange && seq.sar_diff_abs >= 0 ? 'trend-increase' : 'trend-decrease';
                const changeClass = hasChange && seq.sequence_change_percent >= 0 ? 'trend-increase' : 'trend-decrease';
                const diffRatioClass = seq.diff_ratio_1day !== undefined && seq.diff_ratio_1day >= 100 ? 'trend-increase' : 'trend-decrease';
                const change3Class = seq.change_3day_percent !== undefined && seq.change_3day_percent >= 0 ? 'trend-increase' : 'trend-decrease';
                const change7Class = seq.change_7day_percent !== undefined && seq.change_7day_percent >= 0 ? 'trend-increase' : 'trend-decrease';
                const change15Class = seq.change_15day_percent !== undefined && seq.change_15day_percent >= 0 ? 'trend-increase' : 'trend-decrease';
                
                html += `
                    <div class="table-row">
                        <div class="table-cell ${positionClass}">${positionCn}${(seq.sequence || 0).toString().padStart(2, '0')}</div>
                        <div class="table-cell">${(seq.time || '').substring(11, 16)}</div>
                        <div class="table-cell">$${(seq.price || 0).toFixed(2)}</div>
                        <div class="table-cell">${(seq.sar || seq.sar_value || 0).toFixed(4)}</div>
                        <div class="table-cell ${hasChange ? sarDiffClass : ''}">${seq.sar_diff_abs !== undefined ? seq.sar_diff_abs.toFixed(6) : '-'}</div>
                        <div class="table-cell ${hasChange ? changeClass : ''}">${hasChange ? (seq.sequence_change_percent >= 0 ? '+' : '') + seq.sequence_change_percent.toFixed(4) + '%' : '-'}</div>
                        <div class="table-cell ${diffRatioClass}">${seq.diff_ratio_1day !== undefined ? seq.diff_ratio_1day.toFixed(2) + '%' : '-'}</div>
                        <div class="table-cell">${seq.avg_diff_1day !== undefined ? seq.avg_diff_1day.toFixed(6) : '-'}</div>
                        <div class="table-cell ${bias1dayClass}">${bias1day}</div>
                        <div class="table-cell ${change3Class}">${seq.change_3day_percent !== undefined ? (seq.change_3day_percent >= 0 ? '+' : '') + seq.change_3day_percent.toFixed(2) + '%' : '-'}</div>
                        <div class="table-cell">${seq.avg_3day !== undefined ? seq.avg_3day.toFixed(6) + '%' : '-'}</div>
                        <div class="table-cell ${bias3dayClass}">${bias3day}</div>
                        <div class="table-cell ${change7Class}">${seq.change_7day_percent !== undefined ? (seq.change_7day_percent >= 0 ? '+' : '') + seq.change_7day_percent.toFixed(2) + '%' : '-'}</div>
                        <div class="table-cell">${seq.avg_7day !== undefined ? seq.avg_7day.toFixed(6) + '%' : '-'}</div>
                        <div class="table-cell ${change15Class}">${seq.change_15day_percent !== undefined ? (seq.change_15day_percent >= 0 ? '+' : '') + seq.change_15day_percent.toFixed(2) + '%' : '-'}</div>
                        <div class="table-cell">${seq.avg_15day !== undefined ? seq.avg_15day.toFixed(6) + '%' : '-'}</div>
                    </div>
                `;
            });
            
            tableBody.innerHTML = html;
            document.getElementById('dataTable').style.display = 'block';
        }
        
        // åŠ è½½æ•°æ®
        loadData();
        
        // æ¯30ç§’è‡ªåŠ¨åˆ·æ–°
        setInterval(loadData, 30000);
    </script>
</body>
</html>
