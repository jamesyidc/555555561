<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>SARåå‘è¶‹åŠ¿å›¾ - 24å°æ—¶åˆ†é¡µ v2.2-1day</title>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <script>
        // ç‰ˆæœ¬æ£€æŸ¥ä¸ç¼“å­˜æ¸…é™¤
        const CURRENT_VERSION = '2.2-1day-5min';
        const STORED_VERSION = localStorage.getItem('sar_bias_trend_version');
        
        if (STORED_VERSION !== CURRENT_VERSION) {
            console.log('ğŸ”„ æ£€æµ‹åˆ°æ–°ç‰ˆæœ¬ï¼Œæ¸…é™¤ç¼“å­˜...');
            console.log('æ—§ç‰ˆæœ¬:', STORED_VERSION, 'â†’ æ–°ç‰ˆæœ¬:', CURRENT_VERSION);
            localStorage.setItem('sar_bias_trend_version', CURRENT_VERSION);
            
            // å¦‚æœä¹‹å‰æœ‰ç‰ˆæœ¬è®°å½•ï¼Œè¯´æ˜æ˜¯æ›´æ–°ï¼Œéœ€è¦åˆ·æ–°
            if (STORED_VERSION) {
                console.log('ğŸ”„ å¼ºåˆ¶åˆ·æ–°é¡µé¢ä»¥åŠ è½½æ–°ç‰ˆæœ¬...');
                location.reload(true);
            }
        }
    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', sans-serif;
            background: #1e2139;
            color: #fff;
            padding: 20px;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
        }
        
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }
        
        h1 {
            font-size: 28px;
            color: #00d4ff;
        }
        
        .back-btn {
            background: rgba(59, 125, 255, 0.2);
            border: 1px solid rgba(59, 125, 255, 0.4);
            color: #00d4ff;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            text-decoration: none;
            font-size: 14px;
            transition: all 0.3s;
        }
        
        .back-btn:hover {
            background: rgba(59, 125, 255, 0.3);
            border-color: rgba(59, 125, 255, 0.6);
        }
        
        .pagination-container {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            margin-bottom: 30px;
            background: rgba(42, 45, 71, 0.8);
            border: 1px solid rgba(59, 125, 255, 0.3);
            border-radius: 8px;
            padding: 15px 25px;
        }
        
        .page-btn {
            background: #3b7dff;
            border: none;
            color: #ffffff;
            padding: 8px 18px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s;
            min-width: 90px;
        }
        
        .page-btn:hover:not(:disabled) {
            background: #5a92ff;
            transform: translateY(-1px);
        }
        
        .page-btn:disabled {
            opacity: 0.4;
            cursor: not-allowed;
            background: #4a5273;
        }
        
        .page-info {
            display: flex;
            align-items: center;
            gap: 12px;
            background: rgba(255, 255, 255, 0.05);
            padding: 8px 20px;
            border-radius: 6px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .page-date {
            font-size: 16px;
            font-weight: 600;
            color: #ffffff;
            min-width: 120px;
            text-align: center;
        }
        
        .page-time-range {
            font-size: 12px;
            color: #8b92b8;
            border-left: 1px solid rgba(255, 255, 255, 0.1);
            padding-left: 12px;
        }
        
        .stats-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: rgba(42, 45, 71, 0.8);
            border: 1px solid rgba(59, 125, 255, 0.3);
            border-radius: 8px;
            padding: 20px;
        }
        
        .stat-label {
            font-size: 14px;
            color: #8b92b8;
            margin-bottom: 10px;
        }
        
        .stat-value {
            font-size: 32px;
            font-weight: bold;
            color: #00d4ff;
        }
        
        .stat-value.bullish {
            color: #26d639;
        }
        
        .stat-value.bearish {
            color: #ff4757;
        }
        
        .stat-trend {
            font-size: 12px;
            color: #8b92b8;
            margin-top: 5px;
        }
        
        .chart-container {
            background: rgba(42, 45, 71, 0.8);
            border: 1px solid rgba(59, 125, 255, 0.3);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 30px;
        }
        
        .chart-title {
            font-size: 18px;
            color: #00d4ff;
            margin-bottom: 15px;
        }
        
        #trendChart {
            width: 100%;
            height: 600px;
            min-height: 600px;
        }
        
        .symbol-lists {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .symbol-list {
            background: rgba(42, 45, 71, 0.8);
            border: 1px solid rgba(59, 125, 255, 0.3);
            border-radius: 8px;
            padding: 20px;
        }
        
        .list-title {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .list-title.bullish {
            color: #26d639;
        }
        
        .list-title.bearish {
            color: #ff4757;
        }
        
        .symbol-item {
            background: rgba(30, 33, 57, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            padding: 10px;
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .symbol-name {
            font-weight: bold;
            color: #00d4ff;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: #8b92b8;
        }
        
        .update-info {
            text-align: center;
            color: #8b92b8;
            font-size: 12px;
            margin-top: 20px;
        }
        
        .timezone-badge {
            display: inline-block;
            background: rgba(0, 212, 255, 0.2);
            border: 1px solid rgba(0, 212, 255, 0.4);
            color: #00d4ff;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            margin-left: 10px;
        }
        
        /* åŠ è½½è¿›åº¦æ¡æ ·å¼ */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(30, 33, 57, 0.95);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            backdrop-filter: blur(5px);
        }
        
        .loading-content {
            text-align: center;
            max-width: 500px;
            width: 90%;
        }
        
        .loading-title {
            font-size: 24px;
            color: #00d4ff;
            margin-bottom: 30px;
            font-weight: bold;
        }
        
        .progress-container {
            width: 100%;
            height: 8px;
            background: rgba(59, 125, 255, 0.2);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 20px;
            position: relative;
        }
        
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #3b7dff, #00d4ff);
            border-radius: 4px;
            transition: width 0.5s ease;
            box-shadow: 0 0 10px rgba(0, 212, 255, 0.5);
        }
        
        .progress-text {
            font-size: 16px;
            color: #8b92b8;
            margin-bottom: 10px;
        }
        
        .progress-percent {
            font-size: 28px;
            color: #00d4ff;
            font-weight: bold;
            margin-bottom: 20px;
        }
        
        .loading-steps {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }
        
        .loading-step {
            flex: 1;
            padding: 10px;
            margin: 0 5px;
            background: rgba(59, 125, 255, 0.1);
            border: 1px solid rgba(59, 125, 255, 0.3);
            border-radius: 4px;
            font-size: 12px;
            color: #8b92b8;
            transition: all 0.3s;
        }
        
        .loading-step.active {
            background: rgba(0, 212, 255, 0.2);
            border-color: #00d4ff;
            color: #00d4ff;
            transform: translateY(-2px);
        }
        
        .loading-step.completed {
            background: rgba(38, 214, 57, 0.2);
            border-color: #26d639;
            color: #26d639;
        }
    </style>
</head>
<body>
    <!-- åŠ è½½è¿›åº¦è¦†ç›–å±‚ -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-content">
            <div class="loading-title">ğŸ“Š SARåå‘è¶‹åŠ¿ç³»ç»ŸåŠ è½½ä¸­</div>
            <div class="progress-percent" id="loadingPercent">0%</div>
            <div class="progress-container">
                <div class="progress-bar" id="progressBar" style="width: 0%"></div>
            </div>
            <div class="progress-text" id="loadingText">æ­£åœ¨åˆå§‹åŒ–...</div>
            <div class="loading-steps">
                <div class="loading-step" id="step1">1. åˆå§‹åŒ–å›¾è¡¨</div>
                <div class="loading-step" id="step2">2. åŠ è½½è¶‹åŠ¿æ•°æ®</div>
                <div class="loading-step" id="step3">3. åŠ è½½å½“å‰ç»Ÿè®¡</div>
                <div class="loading-step" id="step4">4. æ¸²æŸ“å›¾è¡¨</div>
            </div>
        </div>
    </div>
    
    <div class="container">
        <div class="header">
            <h1>
                SARåå‘è¶‹åŠ¿å›¾ - 24å°æ—¶åˆ†é¡µ
                <span class="timezone-badge">ğŸ• åŒ—äº¬æ—¶é—´ (UTC+8)</span>
            </h1>
            <a href="/sar-slope" class="back-btn">â† è¿”å›åˆ—è¡¨</a>
        </div>
        
        <!-- ç³»ç»Ÿè¯´æ˜é¢æ¿ -->
        <div style="margin: 20px 0;">
            <button onclick="toggleSystemDocs()" style="
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
                border: none;
                padding: 12px 24px;
                border-radius: 8px;
                cursor: pointer;
                font-size: 14px;
                font-weight: bold;
                box-shadow: 0 4px 6px rgba(0,0,0,0.3);
                transition: all 0.3s ease;
                width: 100%;
                text-align: left;
                display: flex;
                justify-content: space-between;
                align-items: center;
            " onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 12px rgba(0,0,0,0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 6px rgba(0,0,0,0.3)'">
                <span>ğŸ“š SARåå‘è¶‹åŠ¿ç³»ç»Ÿ - å®Œæ•´è¯´æ˜æ–‡æ¡£</span>
                <span id="docsToggleIcon">â–¼</span>
            </button>
            
            <div id="systemDocsPanel" style="
                display: none;
                background: rgba(30, 33, 57, 0.95);
                border: 1px solid rgba(102, 126, 234, 0.3);
                border-radius: 8px;
                padding: 30px;
                margin-top: 15px;
                max-height: 600px;
                overflow-y: auto;
                box-shadow: 0 4px 12px rgba(0,0,0,0.3);
                color: #e0e0e0;
                line-height: 1.8;
                font-size: 14px;
            ">
                <h2 style="color: #667eea; margin-top: 0;">ğŸ“š SARåå‘è¶‹åŠ¿ç³»ç»Ÿ - å®Œæ•´è¯´æ˜æ–‡æ¡£</h2>
                
                <div style="background: rgba(102, 126, 234, 0.1); padding: 15px; border-radius: 6px; margin-bottom: 20px;">
                    <p style="margin: 5px 0;"><strong>ğŸ“… åˆ›å»ºæ—¶é—´</strong>: 2026-02-12 08:45</p>
                    <p style="margin: 5px 0;"><strong>ğŸ”– ç‰ˆæœ¬</strong>: v1.0</p>
                    <p style="margin: 5px 0;"><strong>âœ… çŠ¶æ€</strong>: å·²å®Œæˆ - é‡‡é›†å™¨è¿è¡Œä¸­ï¼Œè¶‹åŠ¿å›¾æ­£å¸¸æ˜¾ç¤º</p>
                </div>
                
                <h3 style="color: #26d639; border-left: 4px solid #26d639; padding-left: 10px;">ğŸ¯ ç³»ç»Ÿæ¦‚è¿°</h3>
                <p><strong>æ ¸å¿ƒåŠŸèƒ½</strong>ï¼šSARåå‘è¶‹åŠ¿ç³»ç»Ÿç›‘æ§29ç§ä¸»æµåŠ å¯†è´§å¸çš„SARï¼ˆæŠ›ç‰©çº¿è½¬å‘æŒ‡æ ‡ï¼‰åå¤š/åç©ºçŠ¶æ€ã€‚</p>
                <ul style="line-height: 2;">
                    <li>ğŸ“Š <strong>å®æ—¶ç»Ÿè®¡</strong>ï¼šæ¯5åˆ†é’Ÿç»Ÿè®¡åå¤š/åç©ºå¸ç§æ•°é‡</li>
                    <li>ğŸ“ˆ <strong>è¶‹åŠ¿å›¾è¡¨</strong>ï¼šæ˜¾ç¤ºå†å²å˜åŒ–è¶‹åŠ¿ï¼ˆåŒæ›²çº¿ï¼‰</li>
                    <li>ğŸ¯ <strong>ç²¾å‡†ç­›é€‰</strong>ï¼šä»…ç»Ÿè®¡"2å°æ—¶å‘¨æœŸå æ¯”>80%"çš„å¸ç§</li>
                    <li>ğŸ”„ <strong>è‡ªåŠ¨æ›´æ–°</strong>ï¼šæ¯5åˆ†é’Ÿè‡ªåŠ¨é‡‡é›†ï¼Œé¡µé¢60ç§’åˆ·æ–°</li>
                </ul>
                
                <!-- ğŸ‰ V2.0 æ›´æ–°è¯´æ˜ (2026-02-16) - åç«¯è®¡ç®—è¿ç§» -->
                <div style="background: linear-gradient(135deg, rgba(147, 51, 234, 0.15), rgba(59, 130, 246, 0.15)); padding: 20px; border-radius: 10px; margin-bottom: 20px; border: 2px solid rgba(147, 51, 234, 0.3);">
                    <h3 style="color: #a78bfa; border-left: 4px solid #a78bfa; padding-left: 10px; margin-bottom: 15px;">
                        ğŸ‰ V2.0 æ›´æ–°è¯´æ˜ - åç«¯è®¡ç®—è¿ç§» (2026-02-16)
                    </h3>
                    
                    <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 8px; margin-bottom: 12px; border-left: 4px solid #ef4444;">
                        <h4 style="color: #ef4444; margin-bottom: 8px;">âŒ é—®é¢˜æ ¹æº</h4>
                        <p style="margin-bottom: 8px;">ç”¨æˆ·åé¦ˆï¼šä¾èµ–å‰ç«¯è®¡ç®—ï¼Œå…³é—­æµè§ˆå™¨åæ•°æ®ä¸¢å¤±ã€‚</p>
                        <ul style="line-height: 2; margin-left: 20px;">
                            <li><strong>è¡¨è±¡ï¼š</strong>å‰ç«¯JavaScriptã€é‡‡é›†å™¨ã€åç«¯APIä¸‰å¤„é‡å¤>80%ç­›é€‰é€»è¾‘</li>
                            <li><strong>é—®é¢˜ï¼š</strong>è¿åå•ä¸€èŒè´£åŸåˆ™ï¼Œæ•°æ®ä¸€è‡´æ€§æ— æ³•ä¿è¯</li>
                            <li><strong>å½±å“ï¼š</strong>ç»´æŠ¤æˆæœ¬é«˜ï¼Œé€»è¾‘ä¸ä¸€è‡´å¯¼è‡´ç»Ÿè®¡ç»“æœå·®å¼‚</li>
                        </ul>
                    </div>
                    
                    <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 8px; margin-bottom: 12px; border-left: 4px solid #10b981;">
                        <h4 style="color: #10b981; margin-bottom: 8px;">âœ… è§£å†³æ–¹æ¡ˆ</h4>
                        <p style="margin-bottom: 8px;"><strong>1. åç«¯APIæ”¹è¿›ï¼š</strong></p>
                        <ul style="line-height: 2; margin-left: 20px;">
                            <li>API <code>/api/sar-slope/bias-ratios</code> ç›´æ¥è¿”å›ç­›é€‰åçš„ <code>bullish_symbols</code> å’Œ <code>bearish_symbols</code></li>
                            <li>æ·»åŠ  <code>bullish_count</code>ã€<code>bearish_count</code>ã€<code>threshold: 80</code> å­—æ®µ</li>
                            <li>ç»“æœæŒ‰ ratio é™åºæ’åº</li>
                            <li>æ·»åŠ é˜²ç¼“å­˜å“åº”å¤´</li>
                        </ul>
                        <p style="margin-top: 10px; margin-bottom: 8px;"><strong>2. å‰ç«¯ç®€åŒ–ï¼š</strong></p>
                        <ul style="line-height: 2; margin-left: 20px;">
                            <li>ç§»é™¤æ‰€æœ‰ <code>if (ratio > 80%)</code> ç­›é€‰é€»è¾‘</li>
                            <li>ç›´æ¥æ˜¾ç¤ºåç«¯è¿”å›çš„ <code>bullish_symbols</code> å’Œ <code>bearish_symbols</code></li>
                            <li>æ·»åŠ  <code>cache: 'no-store'</code> å’Œæ—¶é—´æˆ³å‚æ•°</li>
                        </ul>
                        <p style="margin-top: 10px; margin-bottom: 8px;"><strong>3. é‡‡é›†å™¨ä¼˜åŒ–ï¼š</strong></p>
                        <ul style="line-height: 2; margin-left: 20px;">
                            <li>ç§»é™¤é‡å¤çš„ç­›é€‰é€»è¾‘</li>
                            <li>ç›´æ¥ä½¿ç”¨åç«¯APIè¿”å›çš„ç»“æœ</li>
                            <li>æ•°æ®ä¸­æ·»åŠ  <code>_computed_by: 'backend'</code> æ ‡è®°</li>
                        </ul>
                    </div>
                    
                    <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 8px; margin-bottom: 12px; border-left: 4px solid #3b82f6;">
                        <h4 style="color: #3b82f6; margin-bottom: 8px;">ğŸ“Š æ”¹è¿›æ•ˆæœ</h4>
                        <table style="width: 100%; border-collapse: collapse; font-size: 13px; margin-top: 10px;">
                            <thead>
                                <tr style="background: rgba(59, 130, 246, 0.2);">
                                    <th style="padding: 8px; border: 1px solid rgba(255,255,255,0.1);">æŒ‡æ ‡</th>
                                    <th style="padding: 8px; border: 1px solid rgba(255,255,255,0.1);">V1.0</th>
                                    <th style="padding: 8px; border: 1px solid rgba(255,255,255,0.1);">V2.0</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td style="padding: 8px; border: 1px solid rgba(255,255,255,0.1);">å‰ç«¯ä»£ç è¡Œæ•°</td>
                                    <td style="padding: 8px; border: 1px solid rgba(255,255,255,0.1); color: #ef4444;">47è¡Œï¼ˆå«è®¡ç®—ï¼‰</td>
                                    <td style="padding: 8px; border: 1px solid rgba(255,255,255,0.1); color: #10b981;">25è¡Œï¼ˆä»…å±•ç¤ºï¼‰â†“47%</td>
                                </tr>
                                <tr>
                                    <td style="padding: 8px; border: 1px solid rgba(255,255,255,0.1);">é‡‡é›†å™¨ä»£ç è¡Œæ•°</td>
                                    <td style="padding: 8px; border: 1px solid rgba(255,255,255,0.1); color: #ef4444;">47è¡Œï¼ˆå«ç­›é€‰ï¼‰</td>
                                    <td style="padding: 8px; border: 1px solid rgba(255,255,255,0.1); color: #10b981;">35è¡Œï¼ˆè°ƒAPIï¼‰â†“26%</td>
                                </tr>
                                <tr>
                                    <td style="padding: 8px; border: 1px solid rgba(255,255,255,0.1);">ç»´æŠ¤ç‚¹æ•°é‡</td>
                                    <td style="padding: 8px; border: 1px solid rgba(255,255,255,0.1); color: #ef4444;">3å¤„ï¼ˆé‡å¤é€»è¾‘ï¼‰</td>
                                    <td style="padding: 8px; border: 1px solid rgba(255,255,255,0.1); color: #10b981;">1å¤„ï¼ˆåç«¯ç»Ÿä¸€ï¼‰</td>
                                </tr>
                                <tr>
                                    <td style="padding: 8px; border: 1px solid rgba(255,255,255,0.1);">æ•°æ®ä¸€è‡´æ€§</td>
                                    <td style="padding: 8px; border: 1px solid rgba(255,255,255,0.1); color: #ef4444;">âŒ å¯èƒ½ä¸ä¸€è‡´</td>
                                    <td style="padding: 8px; border: 1px solid rgba(255,255,255,0.1); color: #10b981;">âœ“ 100%ä¸€è‡´</td>
                                </tr>
                                <tr>
                                    <td style="padding: 8px; border: 1px solid rgba(255,255,255,0.1);">å‰ç«¯è®¡ç®—æ—¶é—´</td>
                                    <td style="padding: 8px; border: 1px solid rgba(255,255,255,0.1); color: #ef4444;">~50ms</td>
                                    <td style="padding: 8px; border: 1px solid rgba(255,255,255,0.1); color: #10b981;">0msï¼ˆåç«¯ç¼“å­˜30sï¼‰</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <div style="background: rgba(59, 130, 246, 0.1); padding: 12px; border-radius: 6px;">
                        <p style="margin-bottom: 8px;"><strong style="color: #60a5fa;">ğŸ’¡ æŠ€æœ¯æ¶æ„ä¿è¯ï¼š</strong></p>
                        <ul style="line-height: 2; margin-left: 20px;">
                            <li>æ‰€æœ‰ä¸šåŠ¡é€»è¾‘ï¼ˆ>80%ç­›é€‰ã€æ’åºï¼‰åœ¨åç«¯ API å®Œæˆ</li>
                            <li>å‰ç«¯ä»…è´Ÿè´£å±•ç¤ºï¼Œé›¶ä¸šåŠ¡è®¡ç®—</li>
                            <li>é‡‡é›†å™¨ä¾èµ–åç«¯ APIï¼Œç¡®ä¿æ•°æ®æ¥æºä¸€è‡´</li>
                            <li>Gitæäº¤è®°å½•ï¼š<code>8413205</code>, <code>d921727</code></li>
                        </ul>
                    </div>
                </div>
                
                <h3 style="color: #26d639; border-left: 4px solid #26d639; padding-left: 10px;">ğŸ’¡ æ ¸å¿ƒæ¦‚å¿µï¼š"2å°æ—¶å‘¨æœŸå æ¯”>80%"</h3>
                <div style="background: rgba(38, 214, 57, 0.1); padding: 15px; border-radius: 6px; margin-bottom: 15px;">
                    <p><strong>ç»Ÿè®¡æ–¹æ³•</strong>ï¼š</p>
                    <ol style="line-height: 2;">
                        <li>æ¯5åˆ†é’Ÿé‡‡é›†ä¸€æ¬¡SARæ•°æ®</li>
                        <li>ç»Ÿè®¡æœ€è¿‘24æ¡è®°å½•ï¼ˆ24æ¡ Ã— 5åˆ†é’Ÿ = 2å°æ—¶ï¼‰</li>
                        <li>è®¡ç®— <code style="background: rgba(255,255,255,0.1); padding: 2px 6px; border-radius: 3px;">position=bullish</code>ï¼ˆå¤šå¤´ï¼‰çš„æ•°é‡</li>
                        <li>è®¡ç®—å æ¯”ï¼š<code style="background: rgba(255,255,255,0.1); padding: 2px 6px; border-radius: 3px;">bullish_ratio = count / 24 Ã— 100%</code></li>
                        <li>å¦‚æœ <code style="background: rgba(255,255,255,0.1); padding: 2px 6px; border-radius: 3px;">bullish_ratio > 80%</code>ï¼Œæ ‡è®°ä¸º"åå¤š"</li>
                    </ol>
                    <p><strong>ç‰©ç†å«ä¹‰</strong>ï¼šåœ¨æœ€è¿‘2å°æ—¶å†…ï¼Œè‡³å°‘æœ‰1å°æ—¶36åˆ†é’Ÿï¼ˆ80%ï¼‰å¤„äºåŒä¸€è¶‹åŠ¿æ–¹å‘ã€‚</p>
                    <p><strong>ä¸ºä»€ä¹ˆé€‰æ‹©80%</strong>ï¼šå¼ºè¶‹åŠ¿ç¡®è®¤ï¼Œé¿å…é¢‘ç¹å¤šç©ºåˆ‡æ¢å¯¼è‡´çš„è¯¯åˆ¤ã€‚</p>
                </div>
                
                <h3 style="color: #26d639; border-left: 4px solid #26d639; padding-left: 10px;">âš™ï¸ ç³»ç»Ÿæ¶æ„ï¼ˆ5å±‚ï¼‰</h3>
                <pre style="background: rgba(0,0,0,0.3); padding: 15px; border-radius: 6px; overflow-x: auto; font-size: 12px; line-height: 1.5;">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         SARåå‘è¶‹åŠ¿ç³»ç»Ÿ - æ•°æ®æµç¨‹å›¾                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ã€ç¬¬1å±‚ï¼šåŸºç¡€æ•°æ®é‡‡é›†ã€‘
  PM2è¿›ç¨‹: sar-jsonl-collector
  â”œâ”€ æ¯5åˆ†é’Ÿé‡‡é›†29ç§å¸çš„SARæ•°æ®
  â”œâ”€ æ•°æ®æº: OKXäº¤æ˜“æ‰€15åˆ†é’ŸKçº¿
  â”œâ”€ è®¡ç®—SARæŒ‡æ ‡å€¼å’Œå·®å€¼
  â””â”€ å­˜å‚¨: data/sar_jsonl/{SYMBOL}.jsonl
          â†“
ã€ç¬¬2å±‚ï¼šåå‘ç»Ÿè®¡é‡‡é›†ã€‘
  PM2è¿›ç¨‹: sar-bias-stats-collector
  â”œâ”€ è¯»å–29ç§å¸æœ€è¿‘24æ¡SARæ•°æ®
  â”œâ”€ è®¡ç®—bullish/bearishå æ¯”
  â”œâ”€ ç­›é€‰å æ¯”>80%çš„å¸ç§
  â””â”€ å­˜å‚¨: data/sar_bias_stats/bias_stats_YYYYMMDD.jsonl
          â†“
ã€ç¬¬3å±‚ï¼šAPIæœåŠ¡ã€‘
  Flask API (ç«¯å£5000)
  â”œâ”€ /api/sar-slope/bias-ratios (æ‰¹é‡APIï¼Œé¡¶éƒ¨ç»Ÿè®¡)
  â”œâ”€ /api/sar-slope/bias-stats (è¶‹åŠ¿å›¾å†å²æ•°æ®)
  â””â”€ /api/sar-slope/current-cycle/{symbol} (å•å¸è¯¦æƒ…)
          â†“
ã€ç¬¬4å±‚ï¼šå‰ç«¯å±•ç¤ºã€‘
  é¡µé¢: /sar-bias-trend
  â”œâ”€ é¡¶éƒ¨ç»Ÿè®¡å¡ç‰‡ï¼šå½“å‰åå¤š/åç©ºæ•°é‡
  â”œâ”€ EChartsè¶‹åŠ¿å›¾ï¼šåŒæ›²çº¿ï¼ˆç»¿è‰²/çº¢è‰²ï¼‰
  â”œâ”€ å¸ç§åˆ—è¡¨ï¼šæ˜¾ç¤ºå…·ä½“å¸ç§å’Œå æ¯”
  â””â”€ åˆ†é¡µæ§åˆ¶ï¼šæŒ‰æ—¥æœŸæŸ¥çœ‹å†å²æ•°æ®
                </pre>
                
                <h3 style="color: #26d639; border-left: 4px solid #26d639; padding-left: 10px;">ğŸ’¾ æ•°æ®å­˜å‚¨æ ¼å¼</h3>
                
                <h4 style="color: #8b92b8;">1. SARåŸºç¡€æ•°æ®ï¼ˆJSONLæ ¼å¼ï¼‰</h4>
                <p><strong>æ–‡ä»¶è·¯å¾„</strong>: <code style="background: rgba(255,255,255,0.1); padding: 2px 6px; border-radius: 3px;">data/sar_jsonl/{SYMBOL}.jsonl</code></p>
                <p><strong>ç¤ºä¾‹</strong>ï¼ˆBTC.jsonlï¼‰ï¼š</p>
                <pre style="background: rgba(0,0,0,0.3); padding: 12px; border-radius: 6px; overflow-x: auto; font-size: 11px;">{"beijing_time":"2026-02-12 08:40:00","price":67345.2,"sar":66100.78,"position":"bullish","sar_diff_abs":1244.42,"sar_diff_pct":1.85}</pre>
                
                <table style="width: 100%; border-collapse: collapse; margin: 15px 0; font-size: 13px;">
                    <thead>
                        <tr style="background: rgba(102, 126, 234, 0.2);">
                            <th style="padding: 8px; border: 1px solid rgba(255,255,255,0.1);">å­—æ®µå</th>
                            <th style="padding: 8px; border: 1px solid rgba(255,255,255,0.1);">ç±»å‹</th>
                            <th style="padding: 8px; border: 1px solid rgba(255,255,255,0.1);">è¯´æ˜</th>
                            <th style="padding: 8px; border: 1px solid rgba(255,255,255,0.1);">ç¤ºä¾‹å€¼</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td style="padding: 8px; border: 1px solid rgba(255,255,255,0.1);">beijing_time</td>
                            <td style="padding: 8px; border: 1px solid rgba(255,255,255,0.1);">string</td>
                            <td style="padding: 8px; border: 1px solid rgba(255,255,255,0.1);">åŒ—äº¬æ—¶é—´</td>
                            <td style="padding: 8px; border: 1px solid rgba(255,255,255,0.1);">2026-02-12 08:40:00</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid rgba(255,255,255,0.1);">price</td>
                            <td style="padding: 8px; border: 1px solid rgba(255,255,255,0.1);">float</td>
                            <td style="padding: 8px; border: 1px solid rgba(255,255,255,0.1);">å½“å‰ä»·æ ¼</td>
                            <td style="padding: 8px; border: 1px solid rgba(255,255,255,0.1);">67345.2</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid rgba(255,255,255,0.1);">sar</td>
                            <td style="padding: 8px; border: 1px solid rgba(255,255,255,0.1);">float</td>
                            <td style="padding: 8px; border: 1px solid rgba(255,255,255,0.1);">SARæŒ‡æ ‡å€¼</td>
                            <td style="padding: 8px; border: 1px solid rgba(255,255,255,0.1);">66100.78</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid rgba(255,255,255,0.1);">position</td>
                            <td style="padding: 8px; border: 1px solid rgba(255,255,255,0.1);">string</td>
                            <td style="padding: 8px; border: 1px solid rgba(255,255,255,0.1);">å‘¨æœŸç±»å‹</td>
                            <td style="padding: 8px; border: 1px solid rgba(255,255,255,0.1);">bullish / bearish</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid rgba(255,255,255,0.1);">sar_diff_pct</td>
                            <td style="padding: 8px; border: 1px solid rgba(255,255,255,0.1);">float</td>
                            <td style="padding: 8px; border: 1px solid rgba(255,255,255,0.1);">å·®å€¼ç™¾åˆ†æ¯”</td>
                            <td style="padding: 8px; border: 1px solid rgba(255,255,255,0.1);">1.85</td>
                        </tr>
                    </tbody>
                </table>
                
                <h4 style="color: #8b92b8;">2. åå‘ç»Ÿè®¡æ•°æ®ï¼ˆJSONLæ ¼å¼ï¼‰</h4>
                <p><strong>æ–‡ä»¶è·¯å¾„</strong>: <code style="background: rgba(255,255,255,0.1); padding: 2px 6px; border-radius: 3px;">data/sar_bias_stats/bias_stats_YYYYMMDD.jsonl</code></p>
                <p><strong>ç¤ºä¾‹</strong>ï¼ˆbias_stats_20260212.jsonlï¼‰ï¼š</p>
                <pre style="background: rgba(0,0,0,0.3); padding: 12px; border-radius: 6px; overflow-x: auto; font-size: 11px;">{"timestamp":1707696600,"beijing_time":"2026-02-12 08:30:00","bullish_count":7,"bearish_count":0,"bullish_symbols":[{"symbol":"CFX","ratio":83.3},{"symbol":"DOGE","ratio":83.3}],"bearish_symbols":[],"total_monitored":28}</pre>
                
                <p><strong>æ•°æ®é‡ç»Ÿè®¡</strong>ï¼šæ¯5åˆ†é’Ÿ1æ¡ Ã— æ¯å¤©288æ¡ = çº¦144 KB/å¤©</p>
                
                <h3 style="color: #26d639; border-left: 4px solid #26d639; padding-left: 10px;">ğŸ”§ ç³»ç»Ÿä¾èµ–</h3>
                
                <h4 style="color: #8b92b8;">PM2è¿›ç¨‹ï¼ˆ3ä¸ªï¼‰</h4>
                <table style="width: 100%; border-collapse: collapse; margin: 15px 0; font-size: 13px;">
                    <thead>
                        <tr style="background: rgba(102, 126, 234, 0.2);">
                            <th style="padding: 8px; border: 1px solid rgba(255,255,255,0.1);">è¿›ç¨‹å</th>
                            <th style="padding: 8px; border: 1px solid rgba(255,255,255,0.1);">è„šæœ¬</th>
                            <th style="padding: 8px; border: 1px solid rgba(255,255,255,0.1);">åŠŸèƒ½</th>
                            <th style="padding: 8px; border: 1px solid rgba(255,255,255,0.1);">é¢‘ç‡</th>
                            <th style="padding: 8px; border: 1px solid rgba(255,255,255,0.1);">å†…å­˜</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td style="padding: 8px; border: 1px solid rgba(255,255,255,0.1);">sar-jsonl-collector</td>
                            <td style="padding: 8px; border: 1px solid rgba(255,255,255,0.1);">source_code/sar_jsonl_collector.py</td>
                            <td style="padding: 8px; border: 1px solid rgba(255,255,255,0.1);">SARåŸºç¡€æ•°æ®é‡‡é›†</td>
                            <td style="padding: 8px; border: 1px solid rgba(255,255,255,0.1);">5åˆ†é’Ÿ</td>
                            <td style="padding: 8px; border: 1px solid rgba(255,255,255,0.1);">~47MB</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid rgba(255,255,255,0.1);">sar-bias-stats-collector</td>
                            <td style="padding: 8px; border: 1px solid rgba(255,255,255,0.1);">source_code/sar_bias_stats_collector.py</td>
                            <td style="padding: 8px; border: 1px solid rgba(255,255,255,0.1);">åå‘ç»Ÿè®¡é‡‡é›†</td>
                            <td style="padding: 8px; border: 1px solid rgba(255,255,255,0.1);">5åˆ†é’Ÿ</td>
                            <td style="padding: 8px; border: 1px solid rgba(255,255,255,0.1);">~30MB</td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; border: 1px solid rgba(255,255,255,0.1);">flask-app</td>
                            <td style="padding: 8px; border: 1px solid rgba(255,255,255,0.1);">code/python/app.py</td>
                            <td style="padding: 8px; border: 1px solid rgba(255,255,255,0.1);">WebæœåŠ¡å™¨</td>
                            <td style="padding: 8px; border: 1px solid rgba(255,255,255,0.1);">å¸¸é©»</td>
                            <td style="padding: 8px; border: 1px solid rgba(255,255,255,0.1);">~200MB</td>
                        </tr>
                    </tbody>
                </table>
                
                <h4 style="color: #8b92b8;">Flask APIè·¯ç”±ï¼ˆ4ä¸ªï¼‰</h4>
                <ul style="line-height: 2;">
                    <li><code style="background: rgba(255,255,255,0.1); padding: 2px 6px; border-radius: 3px;">/sar-bias-trend</code> - è¶‹åŠ¿å›¾é¡µé¢</li>
                    <li><code style="background: rgba(255,255,255,0.1); padding: 2px 6px; border-radius: 3px;">/api/sar-slope/bias-ratios</code> - æ‰¹é‡è·å–29ç§å¸2hå æ¯”</li>
                    <li><code style="background: rgba(255,255,255,0.1); padding: 2px 6px; border-radius: 3px;">/api/sar-slope/bias-stats</code> - è¶‹åŠ¿å›¾å†å²æ•°æ®</li>
                    <li><code style="background: rgba(255,255,255,0.1); padding: 2px 6px; border-radius: 3px;">/api/sar-slope/current-cycle/{symbol}</code> - å•å¸è¯¦ç»†æ•°æ®</li>
                </ul>
                
                <h4 style="color: #8b92b8;">Pythonä¾èµ–åŒ…ï¼ˆæ ¸å¿ƒï¼‰</h4>
                <ul style="line-height: 2;">
                    <li>Flask 2.3.2 - Webæ¡†æ¶</li>
                    <li>pandas 2.0.3 - æ•°æ®åˆ†æ</li>
                    <li>pytz 2023.3 - æ—¶åŒºè½¬æ¢</li>
                    <li>requests 2.31.0 - HTTPè¯·æ±‚</li>
                </ul>
                
                <h3 style="color: #26d639; border-left: 4px solid #26d639; padding-left: 10px;">ğŸ“Š ç›‘æ§å¸ç§ï¼ˆ29ç§ï¼‰</h3>
                <p>BTC, ETH, BNB, XRP, ADA, DOGE, SOL, DOT, LTC, LINK, HBAR, TAO, CFX, TRX, TON, NEAR, LDO, CRO, ETC, XLM, BCH, UNI, SUI, FIL, STX, CRV, AAVE, APT, OKB</p>
                
                <h3 style="color: #26d639; border-left: 4px solid #26d639; padding-left: 10px;">ğŸ› ï¸ å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥</h3>
                <pre style="background: rgba(0,0,0,0.3); padding: 15px; border-radius: 6px; overflow-x: auto; font-size: 12px; line-height: 1.8;">
# PM2ç®¡ç†
pm2 status                              # æŸ¥çœ‹æ‰€æœ‰è¿›ç¨‹
pm2 logs sar-bias-stats-collector      # æŸ¥çœ‹é‡‡é›†å™¨æ—¥å¿—
pm2 restart sar-bias-stats-collector   # é‡å¯é‡‡é›†å™¨

# æ•°æ®æŸ¥çœ‹
ls -lh data/sar_bias_stats/            # æŸ¥çœ‹ç»Ÿè®¡æ–‡ä»¶
tail -f logs/sar-bias-stats-out.log    # å®æ—¶æ—¥å¿—

# APIæµ‹è¯•
curl localhost:5000/api/sar-slope/bias-stats?page=1
curl localhost:5000/api/sar-slope/bias-ratios
                </pre>
                
                <h3 style="color: #26d639; border-left: 4px solid #26d639; padding-left: 10px;">ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡</h3>
                <ul style="line-height: 2;">
                    <li><strong>APIå“åº”æ—¶é—´</strong>: < 200msï¼ˆæ— ç¼“å­˜ï¼‰ã€< 50msï¼ˆæœ‰ç¼“å­˜ï¼‰</li>
                    <li><strong>é¡µé¢åŠ è½½æ—¶é—´</strong>: < 1s</li>
                    <li><strong>é‡‡é›†å™¨CPUå ç”¨</strong>: 0-1%ï¼ˆå¾…æœºï¼‰ã€3-10%ï¼ˆé‡‡é›†æ—¶ï¼‰</li>
                    <li><strong>æ•°æ®é‡</strong>: 1.2 MB/å¤©ï¼ˆ29ç§å¸ï¼‰</li>
                </ul>
                
                <div style="background: rgba(102, 126, 234, 0.15); padding: 20px; border-radius: 8px; margin-top: 30px; text-align: center;">
                    <p style="font-size: 16px; margin: 0;"><strong>ğŸ“ å®Œæ•´æ–‡æ¡£</strong></p>
                    <p style="margin: 10px 0; color: #8b92b8;">æŸ¥çœ‹å®Œæ•´çš„ç³»ç»Ÿæ–‡æ¡£ï¼ˆåŒ…å«è¯¦ç»†çš„æ•°æ®æµç¨‹ã€APIè§„èŒƒã€æ•…éšœæ’æŸ¥ç­‰ï¼‰</p>
                    <a href="/static/SAR_BIAS_TREND_SYSTEM_DOCS.md" download style="
                        background: #667eea;
                        color: white;
                        padding: 10px 20px;
                        border-radius: 6px;
                        text-decoration: none;
                        font-size: 14px;
                        display: inline-block;
                        margin-top: 10px;
                        transition: background 0.3s ease;
                    " onmouseover="this.style.background='#764ba2'" onmouseout="this.style.background='#667eea'">
                        ğŸ“¥ ä¸‹è½½å®Œæ•´Markdownæ–‡æ¡£ (26 KB)
                    </a>
                </div>
            </div>
        </div>
        
        <script>
            function toggleSystemDocs() {
                const panel = document.getElementById('systemDocsPanel');
                const icon = document.getElementById('docsToggleIcon');
                if (panel.style.display === 'none') {
                    panel.style.display = 'block';
                    icon.textContent = 'â–²';
                } else {
                    panel.style.display = 'none';
                    icon.textContent = 'â–¼';
                }
            }
        </script>
        
        <div class="pagination-container">
            <button class="page-btn" id="prevBtn" onclick="previousPage()">
                â† å‰ä¸€å¤©
            </button>
            
            <div class="page-info">
                <div class="page-date" id="currentDate">
                    åŠ è½½ä¸­...
                </div>
                <div class="page-time-range" id="timeRangeDisplay">
                    åŠ è½½ä¸­...
                </div>
            </div>
            
            <button class="page-btn" id="nextBtn" onclick="nextPage()">
                åä¸€å¤© â†’
            </button>
        </div>
        
        <div class="stats-cards">
            <div class="stat-card">
                <div class="stat-label">å½“å‰åå¤šå¸ç§ (>80%)</div>
                <div class="stat-subtitle" style="font-size: 11px; color: #8b92b8; margin-top: 4px;">æœ€è¿‘2å°æ—¶å¤„äºå¤šå¤´å‘¨æœŸæ—¶é—´ >80%</div>
                <div class="stat-value bullish" id="currentBullish">-</div>
                <div class="stat-trend" id="bullishTrend">åŠ è½½ä¸­...</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-label">å½“å‰åç©ºå¸ç§ (>80%)</div>
                <div class="stat-subtitle" style="font-size: 11px; color: #8b92b8; margin-top: 4px;">æœ€è¿‘2å°æ—¶å¤„äºç©ºå¤´å‘¨æœŸæ—¶é—´ >80%</div>
                <div class="stat-value bearish" id="currentBearish">-</div>
                <div class="stat-trend" id="bearishTrend">åŠ è½½ä¸­...</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-label">æ€»ç›‘æ§å¸ç§</div>
                <div class="stat-value" id="totalSymbols">27</div>
                <div class="stat-trend">å®æ—¶æ›´æ–°ä¸­</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-label">æ•°æ®ç‚¹æ•°</div>
                <div class="stat-value" id="dataPoints">-</div>
                <div class="stat-trend" id="timeRange">åŠ è½½ä¸­...</div>
            </div>
        </div>
        
        <div class="chart-container">
            <div class="chart-title">ğŸ“Š åå¤š/åç©º >80% æ•°é‡è¶‹åŠ¿ï¼ˆå®æ—¶é‡‡é›†æ•°æ®ï¼‰</div>
            <div style="color: #8b92b8; font-size: 12px; margin-bottom: 10px;">
                ğŸ’¡ è¯´æ˜ï¼šå›¾è¡¨æ˜¾ç¤º"2å°æ—¶å‘¨æœŸå æ¯”>80%"çš„å¸ç§æ•°é‡å˜åŒ–è¶‹åŠ¿ï¼Œæ•°æ®æ¯5åˆ†é’Ÿé‡‡é›†ä¸€æ¬¡ï¼Œä»2026-02-12å¼€å§‹è®°å½•
            </div>
            <div id="trendChart"></div>
        </div>
        
        <div class="symbol-lists">
            <div class="symbol-list">
                <div class="list-title bullish">
                    â¬†ï¸ å½“å‰åå¤šå¸ç§ (>80%)
                </div>
                <div id="bullishList">
                    <div class="loading">åŠ è½½ä¸­...</div>
                </div>
            </div>
            
            <div class="symbol-list">
                <div class="list-title bearish">
                    â¬‡ï¸ å½“å‰åç©ºå¸ç§ (>80%)
                </div>
                <div id="bearishList">
                    <div class="loading">åŠ è½½ä¸­...</div>
                </div>
            </div>
        </div>
        
        <div class="update-info">
            æœ€åæ›´æ–°: <span id="lastUpdate">-</span> (åŒ—äº¬æ—¶é—´) | 
            æ•°æ®æ¯5åˆ†é’Ÿè‡ªåŠ¨æ›´æ–°ï¼Œæ¯é¡µæ˜¾ç¤º24å°æ—¶ï¼ˆä¸€å¤©ï¼‰æ•°æ®
        </div>
    </div>
    
    <script>
        let chart = null;
        let currentPage = 1;
        let totalPages = 1;
        let updateInterval = null;
        
        // åˆå§‹åŒ–å›¾è¡¨
        function initChart() {
            const chartDom = document.getElementById('trendChart');
            chart = echarts.init(chartDom);
            
            const option = {
                backgroundColor: 'transparent',
                tooltip: {
                    trigger: 'axis',
                    backgroundColor: 'rgba(30, 33, 57, 0.9)',
                    borderColor: 'rgba(59, 125, 255, 0.4)',
                    textStyle: {
                        color: '#fff'
                    },
                    formatter: function(params) {
                        let result = params[0].axisValue + '<br/>';
                        params.forEach(item => {
                            const color = item.seriesName.includes('åå¤š') ? '#26d639' : '#ff4757';
                            result += `<span style="color:${color}">â— ${item.seriesName}: ${item.value}</span><br/>`;
                        });
                        return result;
                    }
                },
                legend: {
                    data: ['åå¤šå¸ç§ (>80%)', 'åç©ºå¸ç§ (>80%)'],
                    textStyle: {
                        color: '#8b92b8'
                    },
                    top: 10
                },
                grid: {
                    left: '3%',
                    right: '4%',
                    bottom: '10%',
                    top: '15%',
                    containLabel: true
                },
                xAxis: {
                    type: 'category',
                    boundaryGap: false,
                    data: [],
                    axisLabel: {
                        color: '#8b92b8',
                        rotate: 45
                    },
                    axisLine: {
                        lineStyle: {
                            color: 'rgba(59, 125, 255, 0.3)'
                        }
                    }
                },
                yAxis: {
                    type: 'value',
                    name: 'å¸ç§æ•°é‡',
                    nameTextStyle: {
                        color: '#8b92b8'
                    },
                    axisLabel: {
                        color: '#8b92b8'
                    },
                    axisLine: {
                        lineStyle: {
                            color: 'rgba(59, 125, 255, 0.3)'
                        }
                    },
                    splitLine: {
                        lineStyle: {
                            color: 'rgba(59, 125, 255, 0.1)'
                        }
                    }
                },
                series: [
                    {
                        name: 'åå¤šå¸ç§ (>80%)',
                        type: 'line',
                        smooth: true,
                        symbol: 'circle',
                        symbolSize: 6,
                        lineStyle: {
                            color: '#26d639',
                            width: 2
                        },
                        itemStyle: {
                            color: '#26d639'
                        },
                        areaStyle: {
                            color: {
                                type: 'linear',
                                x: 0,
                                y: 0,
                                x2: 0,
                                y2: 1,
                                colorStops: [
                                    { offset: 0, color: 'rgba(38, 214, 57, 0.3)' },
                                    { offset: 1, color: 'rgba(38, 214, 57, 0.05)' }
                                ]
                            }
                        },
                        data: []
                    },
                    {
                        name: 'åç©ºå¸ç§ (>80%)',
                        type: 'line',
                        smooth: true,
                        symbol: 'circle',
                        symbolSize: 6,
                        lineStyle: {
                            color: '#ff4757',
                            width: 2
                        },
                        itemStyle: {
                            color: '#ff4757'
                        },
                        areaStyle: {
                            color: {
                                type: 'linear',
                                x: 0,
                                y: 0,
                                x2: 0,
                                y2: 1,
                                colorStops: [
                                    { offset: 0, color: 'rgba(255, 71, 87, 0.3)' },
                                    { offset: 1, color: 'rgba(255, 71, 87, 0.05)' }
                                ]
                            }
                        },
                        data: []
                    }
                ]
            };
            
            chart.setOption(option);
            
            // åˆå§‹åŒ–åå¼ºåˆ¶è°ƒæ•´å¤§å°
            setTimeout(() => chart.resize(), 100);
            
            // å“åº”å¼
            window.addEventListener('resize', () => {
                chart.resize();
            });
        }
        
        // åŠ è½½å½“å‰åå¤š/åç©º >80% çš„ç»Ÿè®¡ï¼ˆåç«¯å·²è®¡ç®—ï¼Œå‰ç«¯ç›´æ¥ä½¿ç”¨ï¼‰
        async function loadCurrentBiasStats() {
            try {
                // è°ƒç”¨æ‰¹é‡APIè·å–æ‰€æœ‰å¸ç§çš„2å°æ—¶å‘¨æœŸå æ¯”ï¼ˆåç«¯å·²ç­›é€‰ >80%ï¼‰
                const response = await fetch('/api/sar-slope/bias-ratios?_t=' + Date.now(), {
                    cache: 'no-store',
                    headers: {
                        'Cache-Control': 'no-cache, no-store, must-revalidate',
                        'Pragma': 'no-cache',
                        'Expires': '0'
                    }
                });
                const data = await response.json();
                
                if (!data.success) {
                    console.error('âŒ åŠ è½½åå‘ç»Ÿè®¡å¤±è´¥');
                    return;
                }
                
                // åç«¯å·²ç»è®¡ç®—å¥½äº† >80% çš„å¸ç§åˆ—è¡¨ï¼Œå‰ç«¯ç›´æ¥ä½¿ç”¨
                const bullishSymbols = data.bullish_symbols || [];
                const bearishSymbols = data.bearish_symbols || [];
                
                console.log(`âœ… [åç«¯è®¡ç®—] åå¤š >80%: ${bullishSymbols.length}ä¸ª, åç©º >80%: ${bearishSymbols.length}ä¸ª`);
                
                // æ‰“å°è¯¦ç»†ä¿¡æ¯
                bullishSymbols.forEach(item => {
                    console.log(`[Bias] âœ“ ${item.symbol} åå¤š ${item.ratio.toFixed(1)}%`);
                });
                bearishSymbols.forEach(item => {
                    console.log(`[Bias] âœ“ ${item.symbol} åç©º ${item.ratio.toFixed(1)}%`);
                });
                
                // æ›´æ–°é¡¶éƒ¨ç»Ÿè®¡å¡ç‰‡
                document.getElementById('currentBullish').textContent = data.bullish_count || 0;
                document.getElementById('currentBearish').textContent = data.bearish_count || 0;
                
                // æ›´æ–°å¸ç§åˆ—è¡¨ï¼ˆæ•°æ®å·²æŒ‰æ¯”ä¾‹æ’åºï¼‰
                updateSymbolLists(bullishSymbols, bearishSymbols);
                
            } catch (error) {
                console.error('âŒ åŠ è½½åå‘ç»Ÿè®¡å¤±è´¥:', error);
            }
        }
        
        // åŠ è½½è¶‹åŠ¿æ•°æ®
        async function loadTrendData(page = 1) {
            try {
                const response = await fetch(`/api/sar-slope/bias-stats?page=${page}&_t=${Date.now()}`, {
                    cache: 'no-store',
                    headers: {
                        'Cache-Control': 'no-cache, no-store, must-revalidate',
                        'Pragma': 'no-cache',
                        'Expires': '0'
                    }
                });
                const data = await response.json();
                
                if (data.success) {
                    currentPage = data.page;
                    totalPages = data.total_pages;
                    
                    // æ›´æ–°æ—¥æœŸæ˜¾ç¤º - ä½¿ç”¨APIè¿”å›çš„æ—¥æœŸ
                    if (data.date) {
                        // æ ¼å¼åŒ–æ—¥æœŸæ˜¾ç¤º (YYYY-MM-DD â†’ YYYY/MM/DD)
                        document.getElementById('currentDate').textContent = data.date.replace(/-/g, '/');
                    } else if (data.time_range && data.time_range.date) {
                        // å¤‡ç”¨ï¼šä»time_rangeæå–æ—¥æœŸ
                        document.getElementById('currentDate').textContent = data.time_range.date.replace(/-/g, '/');
                    }
                    
                    // æ›´æ–°æŒ‰é’®çŠ¶æ€
                    document.getElementById('prevBtn').disabled = !data.has_prev;
                    document.getElementById('nextBtn').disabled = !data.has_next;
                    
                    // æ›´æ–°æ—¶é—´èŒƒå›´æ˜¾ç¤º
                    if (data.time_range.start && data.time_range.end) {
                        const startTime = data.time_range.start.substring(11, 16); // HH:MM
                        const endTime = data.time_range.end.substring(11, 16); // HH:MM
                        document.getElementById('timeRangeDisplay').textContent = 
                            `${startTime} ~ ${endTime}`;
                    }
                    
                    if (data.data.length > 0) {
                        // å‡†å¤‡å›¾è¡¨æ•°æ®
                        const times = [];
                        const bullishData = [];
                        const bearishData = [];
                        
                        data.data.forEach(item => {
                            // ä½¿ç”¨å®Œæ•´æ—¶é—´ (åŒ—äº¬æ—¶é—´å·²åœ¨åç«¯å¤„ç†)
                            times.push(item.timestamp);
                            bullishData.push(item.bullish_count);
                            bearishData.push(item.bearish_count);
                        });
                        
                        // æ›´æ–°å›¾è¡¨
                        chart.setOption({
                            xAxis: {
                                data: times
                            },
                            series: [
                                { data: bullishData },
                                { data: bearishData }
                            ]
                        });
                        
                        // å¼ºåˆ¶è°ƒæ•´å›¾è¡¨å¤§å°
                        setTimeout(() => chart.resize(), 100);
                        
                        // æ›´æ–°æ•°æ®ç‚¹æ•°å’Œæ—¶é—´èŒƒå›´
                        document.getElementById('dataPoints').textContent = data.data.length;
                        const startTime = data.data[0].timestamp;
                        const endTime = data.data[data.data.length - 1].timestamp;
                        document.getElementById('timeRange').textContent = 
                            `${startTime.substring(5)} - ${endTime.substring(5)}`;
                        
                        // æ›´æ–°æ—¶é—´ï¼ˆåŒ—äº¬æ—¶é—´ï¼‰
                        const now = new Date();
                        const beijingTime = new Date(now.getTime() + (8 * 60 * 60 * 1000));
                        document.getElementById('lastUpdate').textContent = 
                            beijingTime.toISOString().substring(0, 19).replace('T', ' ');
                        
                        console.log(`âœ… è¶‹åŠ¿æ•°æ®å·²æ›´æ–°: ç¬¬${currentPage}é¡µ, ${data.data.length} ä¸ªæ•°æ®ç‚¹`);
                    } else {
                        console.log('âš ï¸  æœ¬é¡µæš‚æ— æ•°æ®');
                        // æ¸…ç©ºå›¾è¡¨
                        chart.setOption({
                            xAxis: { data: [] },
                            series: [{ data: [] }, { data: [] }]
                        });
                    }
                    
                    // å¦‚æœæ˜¯ç¬¬1é¡µï¼ˆä»Šå¤©ï¼‰ï¼ŒåŠ è½½å½“å‰çš„åå¤š/åç©º >80% ç»Ÿè®¡
                    if (page === 1) {
                        await loadCurrentBiasStats();
                    } else {
                        // å†å²é¡µé¢ï¼šæ¸…ç©ºå½“å‰ç»Ÿè®¡ï¼Œæ˜¾ç¤ºN/A
                        document.getElementById('currentBullish').textContent = 'N/A';
                        document.getElementById('currentBearish').textContent = 'N/A';
                        document.getElementById('bullishList').innerHTML = '<div class="loading">ä»…ç¬¬1é¡µæ˜¾ç¤ºå½“å‰ç»Ÿè®¡</div>';
                        document.getElementById('bearishList').innerHTML = '<div class="loading">ä»…ç¬¬1é¡µæ˜¾ç¤ºå½“å‰ç»Ÿè®¡</div>';
                    }
                } else {
                    console.error('âŒ APIè¿”å›é”™è¯¯:', data.error);
                }
            } catch (error) {
                console.error('âŒ åŠ è½½æ•°æ®å¤±è´¥:', error);
            }
        }
        
        // æ›´æ–°å¸ç§åˆ—è¡¨
        function updateSymbolLists(bullishSymbols, bearishSymbols) {
            // åå¤šåˆ—è¡¨
            const bullishList = document.getElementById('bullishList');
            if (bullishSymbols && bullishSymbols.length > 0) {
                bullishList.innerHTML = bullishSymbols.map(item => {
                    // å…¼å®¹ä¸¤ç§æ ¼å¼ï¼šå­—ç¬¦ä¸² æˆ– {symbol, ratio}
                    const symbol = typeof item === 'string' ? item : item.symbol;
                    const ratio = typeof item === 'object' ? item.ratio : '';
                    return `
                        <div class="symbol-item">
                            <span class="symbol-name">${symbol}</span>
                            ${ratio ? `<span style="color: #26d639; font-size: 12px;">${ratio.toFixed(1)}%</span>` : ''}
                            <span style="color: #26d639;">â¬†ï¸</span>
                        </div>
                    `;
                }).join('');
            } else {
                bullishList.innerHTML = '<div class="loading">æš‚æ— å¸ç§</div>';
            }
            
            // åç©ºåˆ—è¡¨
            const bearishList = document.getElementById('bearishList');
            if (bearishSymbols && bearishSymbols.length > 0) {
                bearishList.innerHTML = bearishSymbols.map(item => {
                    // å…¼å®¹ä¸¤ç§æ ¼å¼ï¼šå­—ç¬¦ä¸² æˆ– {symbol, ratio}
                    const symbol = typeof item === 'string' ? item : item.symbol;
                    const ratio = typeof item === 'object' ? item.ratio : '';
                    return `
                        <div class="symbol-item">
                            <span class="symbol-name">${symbol}</span>
                            ${ratio ? `<span style="color: #ff4757; font-size: 12px;">${ratio.toFixed(1)}%</span>` : ''}
                            <span style="color: #ff4757;">â¬‡ï¸</span>
                        </div>
                    `;
                }).join('');
            } else {
                bearishList.innerHTML = '<div class="loading">æš‚æ— å¸ç§</div>';
            }
        }
        
        // ä¸Šä¸€é¡µ (æ›´æ—©çš„æ•°æ®)
        function previousPage() {
            if (currentPage < totalPages) {
                // åœæ­¢è‡ªåŠ¨æ›´æ–°
                if (updateInterval) {
                    clearInterval(updateInterval);
                    updateInterval = null;
                }
                loadTrendData(currentPage + 1);
            }
        }
        
        // ä¸‹ä¸€é¡µ (æ›´æ–°çš„æ•°æ®)
        function nextPage() {
            if (currentPage > 1) {
                loadTrendData(currentPage - 1);
                
                // å¦‚æœå›åˆ°ç¬¬1é¡µï¼Œé‡æ–°å¼€å¯è‡ªåŠ¨æ›´æ–°
                if (currentPage - 1 === 1 && !updateInterval) {
                    updateInterval = setInterval(() => loadTrendData(1), 300000); // æ”¹ä¸º300ç§’ï¼ˆ5åˆ†é’Ÿï¼‰
                }
            }
        }
        
        // åŠ è½½è¿›åº¦æ§åˆ¶
        const loadingProgress = {
            current: 0,
            
            updateProgress(percent, text, step) {
                this.current = percent;
                document.getElementById('progressBar').style.width = percent + '%';
                document.getElementById('loadingPercent').textContent = percent + '%';
                document.getElementById('loadingText').textContent = text;
                
                // æ›´æ–°æ­¥éª¤çŠ¶æ€
                if (step) {
                    // æ ‡è®°ä¹‹å‰çš„æ­¥éª¤ä¸ºå®Œæˆ
                    for (let i = 1; i < step; i++) {
                        const stepEl = document.getElementById('step' + i);
                        if (stepEl) {
                            stepEl.classList.remove('active');
                            stepEl.classList.add('completed');
                        }
                    }
                    // æ ‡è®°å½“å‰æ­¥éª¤ä¸ºæ´»åŠ¨
                    const currentStepEl = document.getElementById('step' + step);
                    if (currentStepEl) {
                        currentStepEl.classList.add('active');
                    }
                }
            },
            
            hide() {
                // æ ‡è®°æ‰€æœ‰æ­¥éª¤ä¸ºå®Œæˆ
                for (let i = 1; i <= 4; i++) {
                    const stepEl = document.getElementById('step' + i);
                    if (stepEl) {
                        stepEl.classList.remove('active');
                        stepEl.classList.add('completed');
                    }
                }
                
                setTimeout(() => {
                    const overlay = document.getElementById('loadingOverlay');
                    if (overlay) {
                        overlay.style.opacity = '0';
                        setTimeout(() => {
                            overlay.style.display = 'none';
                        }, 300);
                    }
                }, 500);
            }
        };
        
        // é¡µé¢åŠ è½½å®Œæˆ
        window.addEventListener('DOMContentLoaded', async () => {
            console.log('ğŸ“Š SARåå‘è¶‹åŠ¿å›¾åŠ è½½ä¸­...');
            
            try {
                // æ­¥éª¤1: åˆå§‹åŒ–å›¾è¡¨ (0-25%)
                loadingProgress.updateProgress(0, 'æ­£åœ¨åˆå§‹åŒ–å›¾è¡¨...', 1);
                await new Promise(resolve => setTimeout(resolve, 300));
                
                initChart();
                loadingProgress.updateProgress(25, 'å›¾è¡¨åˆå§‹åŒ–å®Œæˆ', 1);
                await new Promise(resolve => setTimeout(resolve, 200));
                
                // æ­¥éª¤2: åŠ è½½è¶‹åŠ¿æ•°æ® (25-60%)
                loadingProgress.updateProgress(30, 'æ­£åœ¨åŠ è½½è¶‹åŠ¿æ•°æ®...', 2);
                await loadTrendData(1);
                loadingProgress.updateProgress(60, 'è¶‹åŠ¿æ•°æ®åŠ è½½å®Œæˆ', 2);
                await new Promise(resolve => setTimeout(resolve, 200));
                
                // æ­¥éª¤3: åŠ è½½å½“å‰ç»Ÿè®¡ (60-85%)
                loadingProgress.updateProgress(65, 'æ­£åœ¨åŠ è½½å½“å‰ç»Ÿè®¡...', 3);
                await loadCurrentBiasStats();
                loadingProgress.updateProgress(85, 'å½“å‰ç»Ÿè®¡åŠ è½½å®Œæˆ', 3);
                await new Promise(resolve => setTimeout(resolve, 200));
                
                // æ­¥éª¤4: æ¸²æŸ“å›¾è¡¨ (85-100%)
                loadingProgress.updateProgress(90, 'æ­£åœ¨æ¸²æŸ“å›¾è¡¨...', 4);
                await new Promise(resolve => setTimeout(resolve, 300));
                
                chart.resize();
                loadingProgress.updateProgress(100, 'åŠ è½½å®Œæˆï¼', 4);
                await new Promise(resolve => setTimeout(resolve, 300));
                
                // éšè—åŠ è½½ç•Œé¢
                loadingProgress.hide();
                
                // åªåœ¨ç¬¬1é¡µæ—¶è‡ªåŠ¨æ›´æ–°ï¼ˆæ”¹ä¸º5åˆ†é’Ÿï¼‰
                updateInterval = setInterval(() => {
                    if (currentPage === 1) {
                        console.log('â° 5åˆ†é’Ÿå®šæ—¶åˆ·æ–°ï¼Œå¼€å§‹åŠ è½½æ•°æ®...');
                        loadTrendData(1);
                    }
                }, 300000); // æ”¹ä¸º300ç§’ï¼ˆ5åˆ†é’Ÿï¼‰
                
                console.log('âœ… é¡µé¢åˆå§‹åŒ–å®Œæˆï¼Œç¬¬1é¡µæ¯5åˆ†é’Ÿè‡ªåŠ¨æ›´æ–°');
                
            } catch (error) {
                console.error('âŒ é¡µé¢åŠ è½½å¤±è´¥:', error);
                loadingProgress.updateProgress(100, 'åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•', null);
                setTimeout(() => loadingProgress.hide(), 2000);
            }
        });
        
        // é¡µé¢å¸è½½æ—¶æ¸…ç†
        window.addEventListener('beforeunload', () => {
            if (updateInterval) {
                clearInterval(updateInterval);
            }
            if (chart) {
                chart.dispose();
            }
        });
    </script>
</body>
</html>
