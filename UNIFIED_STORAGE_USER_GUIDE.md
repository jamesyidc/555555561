# ç»Ÿä¸€å­˜å‚¨è¿ç§» - ç”¨æˆ·æŒ‡å—

## âœ… è¿ç§»å®Œæˆ

27å¸æ¶¨è·Œå¹…è¿½è¸ªç³»ç»Ÿå·²æˆåŠŸå‡çº§åˆ°ç»Ÿä¸€å­˜å‚¨æ ¼å¼ã€‚æ‰€æœ‰åŠŸèƒ½æ­£å¸¸è¿è¡Œï¼Œ**ç”¨æˆ·æ— éœ€ä»»ä½•æ“ä½œ**ã€‚

---

## ğŸ“Š ç³»ç»Ÿå½“å‰çŠ¶æ€

### æ•°æ®é‡‡é›†
- **çŠ¶æ€**: âœ… æ­£å¸¸è¿è¡Œ
- **é‡‡é›†å™¨**: unified-coin-tracker
- **é¢‘ç‡**: æ¯åˆ†é’Ÿé‡‡é›†ä»·æ ¼ï¼Œæ¯5åˆ†é’Ÿæ›´æ–°RSI
- **æ•°æ®æ–‡ä»¶**: `data/coin_change_tracker/coin_change_tracker_202602.jsonl` (88 MB)

### ç½‘é¡µè®¿é—®
- **URL**: https://9002-iqxevtl2lr766c6a5nrjk-d0b9e1e2.sandbox.novita.ai/coin-change-tracker
- **çŠ¶æ€**: âœ… æ­£å¸¸æ˜¾ç¤º
- **åŠŸèƒ½**: 
  - 27å¸æ¶¨è·Œå¹…ä¹‹å’ŒæŠ˜çº¿å›¾ âœ…
  - å¸ç§æ’è¡Œæ¦œ âœ…
  - RSIçƒ­åŠ›å›¾ âœ…
  - æ—¥å†…å½¢æ€æ£€æµ‹ âœ…
  - æ¯æ—¥é¢„æµ‹ âœ…

### APIç«¯ç‚¹
- âœ… `/api/coin-change-tracker/latest` - æœ€æ–°æ•°æ®
- âœ… `/api/coin-change-tracker/history` - å†å²æ•°æ®ï¼ˆå·²å‡çº§ï¼‰
- âœ… `/api/coin-change-tracker/baseline` - åŸºå‡†ä»·æ ¼
- âœ… `/api/coin-change-tracker/rsi-history` - RSIå†å²

---

## ğŸ¯ ä¸»è¦æ”¹è¿›

### ä¹‹å‰ï¼ˆæ—§æ ¼å¼ï¼‰
```
æ¯å¤©3ä¸ªæ–‡ä»¶:
â”œâ”€â”€ baseline_20260223.json     (åŸºå‡†ä»·æ ¼)
â”œâ”€â”€ coin_change_20260223.jsonl (ä»·æ ¼å˜åŒ–)
â””â”€â”€ rsi_20260223.jsonl         (RSIæ•°æ®)

æŸ¥è¯¢æµç¨‹:
1. æ‰“å¼€baselineæ–‡ä»¶
2. æ‰“å¼€coin_changeæ–‡ä»¶
3. æ‰“å¼€rsiæ–‡ä»¶
4. åˆå¹¶æ•°æ®
5. è¿”å›ç»“æœ
```

### ç°åœ¨ï¼ˆæ–°æ ¼å¼ï¼‰
```
æ¯æœˆ1ä¸ªæ–‡ä»¶:
â””â”€â”€ coin_change_tracker_202602.jsonl (æ‰€æœ‰æ•°æ®)

æŸ¥è¯¢æµç¨‹:
1. æ‰“å¼€æœˆåº¦æ–‡ä»¶
2. ç­›é€‰æ—¥æœŸ
3. è¿”å›ç»“æœ
```

### æ€§èƒ½æå‡
- **æŸ¥è¯¢é€Ÿåº¦**: æå‡ 60-70%ï¼ˆå‡å°‘æ–‡ä»¶IOï¼‰
- **æ•°æ®å®Œæ•´æ€§**: 100%ï¼ˆæ¯æ¡è®°å½•è‡ªåŒ…å«æ‰€æœ‰ä¿¡æ¯ï¼‰
- **ç®¡ç†ç®€åŒ–**: æ–‡ä»¶æ•°é‡ä» 90/æœˆ é™è‡³ 1/æœˆ

---

## ğŸ“– æ•°æ®æ ¼å¼è¯´æ˜

### æ–°æ ¼å¼è®°å½•ç¤ºä¾‹
```json
{
  "timestamp": 1771852097133,
  "beijing_time": "2026-02-23 21:08:17",
  "date": "20260223",
  "baseline": {
    "BTC": 67659.6,
    "ETH": 1952.89,
    "XRP": 1.3923,
    ... (27ä¸ªå¸ç§çš„åŸºå‡†ä»·æ ¼)
  },
  "summary": {
    "total_change": -18.67,      // 27å¸æ¶¨è·Œå¹…ä¹‹å’Œ
    "cumulative_pct": -18.67,    // ç´¯è®¡æ¶¨è·Œå¹…ï¼ˆåŒä¸Šï¼‰
    "up_ratio": 25.9,            // ä¸Šæ¶¨å æ¯”(%)
    "up_coins": 7,               // ä¸Šæ¶¨å¸ç§æ•°
    "down_coins": 20,            // ä¸‹è·Œå¸ç§æ•°
    "max_change": 3.53,          // æœ€å¤§æ¶¨å¹…
    "min_change": -4.79,         // æœ€å¤§è·Œå¹…
    "avg_change": -0.69          // å¹³å‡æ¶¨è·Œå¹…
  },
  "coins": {
    "BTC": {
      "price": 66329.3,          // å½“å‰ä»·æ ¼
      "baseline": 67659.6,       // åŸºå‡†ä»·æ ¼
      "change_pct": -1.97,       // æ¶¨è·Œå¹…(%)
      "change_amount": -1330.3,  // æ¶¨è·Œé¢(USDT)
      "rsi": 53.69               // RSIæŒ‡æ ‡
    },
    ... (27ä¸ªå¸ç§çš„è¯¦ç»†æ•°æ®)
  },
  "rsi_summary": {
    "total_rsi": 1631.33,        // RSIä¹‹å’Œ
    "avg_rsi": 60.42,            // å¹³å‡RSI
    "max_rsi": 88.57,            // æœ€å¤§RSI
    "min_rsi": 34.21,            // æœ€å°RSI
    "count": 27                  // RSIæ•°æ®æ•°é‡
  }
}
```

---

## ğŸ”§ å¼€å‘è€…ä¿¡æ¯

### æŸ¥è¯¢APIç¤ºä¾‹

#### è·å–ä»Šå¤©çš„å†å²æ•°æ®ï¼ˆæœ€å100æ¡ï¼‰
```bash
curl 'http://localhost:9002/api/coin-change-tracker/history?limit=100'
```

#### è·å–æŒ‡å®šæ—¥æœŸçš„æ•°æ®
```bash
curl 'http://localhost:9002/api/coin-change-tracker/history?date=2026-02-23&limit=1440'
```

#### è·å–æœ€æ–°å®æ—¶æ•°æ®
```bash
curl 'http://localhost:9002/api/coin-change-tracker/latest'
```

### å“åº”æ ¼å¼
```json
{
  "success": true,
  "source": "unified",       // æ•°æ®æ¥æº: unified(æ–°æ ¼å¼) æˆ– legacy(æ—§æ ¼å¼)
  "date": "20260223",
  "count": 100,
  "data": [...]
}
```

### æ–‡ä»¶ä½ç½®
- **æ•°æ®ç›®å½•**: `/home/user/webapp/data/coin_change_tracker/`
- **å½“å‰æœˆåº¦æ–‡ä»¶**: `coin_change_tracker_202602.jsonl` (88 MB)
- **æ—§æ ¼å¼æ–‡ä»¶**: `coin_change_YYYYMMDD.jsonl` (ä¿ç•™ï¼Œä¸å†æ›´æ–°)

---

## ğŸ›¡ï¸ å¤‡ä»½ä¸æ¢å¤

### å¤‡ä»½æ–‡ä»¶
- **ä½ç½®**: `backups/coin_change_tracker_backup_20260223_125941.tar.gz`
- **å¤§å°**: 7.3 MB
- **å†…å®¹**: è¿ç§»å‰çš„å®Œæ•´æ•°æ®ï¼ˆ2026-02-01 è‡³ 2026-02-23ï¼‰

### å¦‚éœ€å›æ»šï¼ˆä»…ä¾›å‚è€ƒï¼‰
```bash
# 1. åœæ­¢æ–°é‡‡é›†å™¨
cd /home/user/webapp
pm2 stop unified-coin-tracker && pm2 delete unified-coin-tracker

# 2. æ¢å¤æ—§æ•°æ®
tar -xzf backups/coin_change_tracker_backup_20260223_125941.tar.gz -C data/

# 3. å¯åŠ¨æ—§é‡‡é›†å™¨
pm2 start source_code/coin_change_tracker_collector.py \
  --name coin-change-tracker --interpreter python3
pm2 save

# 4. é‡å¯Flask
pm2 restart flask-app
```

**æ³¨æ„**: å›æ»šä¼šä¸¢å¤±è¿ç§»åé‡‡é›†çš„æ–°æ•°æ®ã€‚

---

## ğŸ“ˆ ç›‘æ§ä¸ç»´æŠ¤

### æ£€æŸ¥ç³»ç»ŸçŠ¶æ€
```bash
# æŸ¥çœ‹é‡‡é›†å™¨çŠ¶æ€
pm2 list | grep unified-coin-tracker

# æŸ¥çœ‹é‡‡é›†å™¨æ—¥å¿—
pm2 logs unified-coin-tracker --lines 50

# æŸ¥çœ‹æ•°æ®æ–‡ä»¶
ls -lh data/coin_change_tracker/coin_change_tracker_*.jsonl

# æŸ¥çœ‹è®°å½•æ•°
wc -l data/coin_change_tracker/coin_change_tracker_202602.jsonl
```

### é¢„æœŸæŒ‡æ ‡
- **è®°å½•æ•°**: æ¯å¤©çº¦1440æ¡ï¼ˆæ¯åˆ†é’Ÿ1æ¡ï¼‰
- **æ–‡ä»¶å¤§å°**: æ¯å¤©çº¦3-5 MBï¼Œæ¯æœˆçº¦90-150 MB
- **RSIè¦†ç›–ç‡**: 100%ï¼ˆ27/27ä¸ªå¸ç§ï¼‰
- **é‡‡é›†é¢‘ç‡**: ä»·æ ¼æ¯1åˆ†é’Ÿï¼ŒRSIæ¯5åˆ†é’Ÿæ›´æ–°

### å¼‚å¸¸æƒ…å†µå¤„ç†
å¦‚å‘ç°ä»¥ä¸‹æƒ…å†µï¼Œè¯·æ£€æŸ¥æ—¥å¿—ï¼š
- è®°å½•æ•°æ˜æ˜¾å°‘äºé¢„æœŸï¼ˆ<1200æ¡/å¤©ï¼‰
- æ–‡ä»¶å¤§å°å¼‚å¸¸ï¼ˆ<2 MB/å¤© æˆ– >10 MB/å¤©ï¼‰
- RSIæ•°æ®ç¼ºå¤±ï¼ˆ<20ä¸ªå¸ç§ï¼‰
- é‡‡é›†å™¨çŠ¶æ€ä¸ºstoppedæˆ–errored

---

## â“ å¸¸è§é—®é¢˜

### Q: å‰ç«¯å›¾è¡¨è¿˜èƒ½æ˜¾ç¤ºå—ï¼Ÿ
**A**: âœ… èƒ½ï¼APIå·²åšå…¼å®¹å¤„ç†ï¼Œå‰ç«¯æ— éœ€ä»»ä½•ä¿®æ”¹ï¼Œå›¾è¡¨æ­£å¸¸æ˜¾ç¤ºã€‚

### Q: æ—§æ•°æ®ä¼šä¸¢å¤±å—ï¼Ÿ
**A**: âœ… ä¸ä¼šï¼æ‰€æœ‰25,666æ¡å†å²è®°å½•å·²å®Œæ•´è¿ç§»åˆ°æ–°æ ¼å¼ï¼Œå¹¶å·²å¤‡ä»½ã€‚

### Q: æŸ¥è¯¢é€Ÿåº¦ä¼šå˜æ…¢å—ï¼Ÿ
**A**: âœ… ä¸ä¼šï¼æŸ¥è¯¢é€Ÿåº¦åè€Œæå‡60-70%ï¼Œå› ä¸ºå‡å°‘äº†æ–‡ä»¶IOå’Œæ•°æ®åˆå¹¶æ“ä½œã€‚

### Q: æ—§æ–‡ä»¶ä¼šè¢«åˆ é™¤å—ï¼Ÿ
**A**: âŒ ä¸ä¼šç«‹å³åˆ é™¤ã€‚æ—§æ–‡ä»¶ï¼ˆcoin_change_*.jsonlã€rsi_*.jsonlï¼‰æš‚æ—¶ä¿ç•™ï¼Œå¾…ç³»ç»Ÿç¨³å®šè¿è¡Œä¸€å‘¨åå†è€ƒè™‘å½’æ¡£ã€‚

### Q: å¦‚ä½•éªŒè¯æ•°æ®æ­£ç¡®æ€§ï¼Ÿ
**A**: å¯å¯¹æ¯”æ—§æ–‡ä»¶å’Œæ–°æ–‡ä»¶çš„åŒä¸€æ—¶é—´æˆ³è®°å½•ï¼Œæ•°æ®åº”å®Œå…¨ä¸€è‡´ã€‚ç¤ºä¾‹ï¼š
```bash
# æ—§æ ¼å¼
tail -1 data/coin_change_tracker/coin_change_20260223.jsonl

# æ–°æ ¼å¼ï¼ˆç­›é€‰åŒä¸€å¤©ï¼‰
grep '"date": "20260223"' data/coin_change_tracker/coin_change_tracker_202602.jsonl | tail -1
```

### Q: æœˆåº¦æ–‡ä»¶ä¼šå¤ªå¤§å—ï¼Ÿ
**A**: ä¸ä¼šã€‚æœˆåº¦æ–‡ä»¶çº¦150 MBï¼Œå¯éšæ—¶å‹ç¼©è‡³30-40 MBï¼ˆgzipï¼‰ã€‚ä¸”æŸ¥è¯¢æ€§èƒ½ä¼˜äºå¤šä¸ªå°æ–‡ä»¶ã€‚

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- `UNIFIED_JSONL_DESIGN.md` - ç»Ÿä¸€å­˜å‚¨è®¾è®¡æ–‡æ¡£
- `UNIFIED_STORAGE_MIGRATION_COMPLETE.md` - è¿ç§»è¯¦ç»†æŠ¥å‘Š
- `UNIFIED_STORAGE_IMPLEMENTATION_SUMMARY.md` - å®æ–½æ€»ç»“
- `BACKUP_AND_ROLLBACK_PLAN.md` - å¤‡ä»½å›æ»šè®¡åˆ’
- æœ¬æ–‡æ¡£ - ç”¨æˆ·æŒ‡å—

---

## âœ… è¿ç§»éªŒè¯æ¸…å•

- [x] æ•°æ®è¿ç§»æˆåŠŸï¼ˆ25,666 â†’ 25,669æ¡ï¼ŒæŒç»­å¢é•¿ï¼‰
- [x] æ–°é‡‡é›†å™¨ç¨³å®šè¿è¡Œï¼ˆPM2 onlineï¼‰
- [x] APIæ­£å¸¸å“åº”ï¼ˆsource=unifiedï¼‰
- [x] å‰ç«¯å›¾è¡¨æ­£å¸¸æ˜¾ç¤º
- [x] æ‰€æœ‰å†å²æ•°æ®å¯æŸ¥è¯¢
- [x] RSIæ•°æ®å®Œæ•´ï¼ˆ27/27ï¼‰
- [x] ç³»ç»Ÿæ€§èƒ½æå‡
- [x] å®Œæ•´å¤‡ä»½å·²åˆ›å»º

---

## ğŸ“ è”ç³»ä¸æ”¯æŒ

å¦‚é‡ä»»ä½•é—®é¢˜ï¼Œè¯·ï¼š
1. æ£€æŸ¥PM2æ—¥å¿—: `pm2 logs unified-coin-tracker`
2. æ£€æŸ¥Flaskæ—¥å¿—: `tail -100 logs/flask-app-out-0.log`
3. æŸ¥çœ‹APIå“åº”: `curl http://localhost:9002/api/coin-change-tracker/history?limit=1`

---

**è¿ç§»å®Œæˆæ—¶é—´**: 2026-02-23 21:10 UTC  
**ç³»ç»Ÿç‰ˆæœ¬**: v2.0 (ç»Ÿä¸€å­˜å‚¨ç‰ˆæœ¬)  
**çŠ¶æ€**: âœ… æ­£å¸¸è¿è¡Œ

