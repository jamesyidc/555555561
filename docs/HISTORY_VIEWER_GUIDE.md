# 总涨跌幅趋势图 - 历史查看功能

## 🎯 功能概述

总涨跌幅趋势图现在支持**查看历史数据**，您可以：
- 📅 选择任意历史日期查看当天的趋势
- ⬅️ 点击"前一天"按钮翻看更早的数据
- ➡️ 点击"后一天"按钮翻看更近的数据  
- 🔄 点击"今天"按钮快速返回今日实时数据

## 📸 界面展示

页面顶部新增了日期导航栏：

```
┌─────────────────────────────────────────────────────────┐
│  总涨跌幅趋势  [← 前一天] [2026-02-05] [后一天 →] [今天] │
└─────────────────────────────────────────────────────────┘
```

## 🎨 功能特点

### 1. 日期选择器
- **位置**: 图表标题右侧
- **格式**: YYYY-MM-DD (例如：2026-02-05)
- **限制**: 不能选择未来的日期
- **范围**: 可回溯到 **2026-01-28**

### 2. 导航按钮

#### ⬅️ 前一天
- 功能：查看前一天的数据
- 无限制：可以一直往前翻

#### ➡️ 后一天
- 功能：查看后一天的数据
- 智能禁用：当查看今天时自动禁用（灰色不可点击）

#### 🔄 今天
- 功能：快速返回今日实时数据
- 智能禁用：当已经在查看今天时自动禁用

### 3. 自动刷新
- ✅ **查看今天**: 每10秒自动刷新数据
- ❌ **查看历史**: 不自动刷新（历史数据固定）

## 🔧 使用方法

### 方法1: 使用按钮导航
```
1. 点击"前一天"查看昨天的数据
2. 继续点击"前一天"查看更早的数据
3. 点击"后一天"回到较近的日期
4. 点击"今天"返回今日实时数据
```

### 方法2: 手动选择日期
```
1. 点击日期选择器
2. 在日历中选择想要查看的日期
3. 系统自动加载该日期的数据
```

## 📊 数据范围

### 可用历史数据
系统保存了从 **2026-01-28** 至今的所有数据：

| 日期 | 数据点数 | 文件大小 |
|------|---------|----------|
| 2026-01-28 | ~900 | 1.6 MB |
| 2026-01-29 | ~1440 | 3.7 MB |
| 2026-01-30 | ~1440 | 3.7 MB |
| 2026-01-31 | ~1440 | 3.3 MB |
| 2026-02-01 | ~1440 | 2.3 MB |
| 2026-02-02 | ~1440 | 1.9 MB |
| 2026-02-03 | ~1440 | 1.9 MB |
| 2026-02-04 | ~1440 | 4.2 MB |
| 2026-02-05 | 实时更新 | 3.5 MB+ |

**注**: 每天约1440个数据点（每分钟采集一次）

## 🎯 使用场景

### 场景1: 对比不同日期的市场表现
```
1. 查看今天的趋势
2. 点击"前一天"查看昨天
3. 对比两天的最高/最低点
4. 分析市场变化趋势
```

### 场景2: 回溯重要事件
```
1. 记住某个重要事件发生的日期
2. 使用日期选择器跳转到那一天
3. 查看当时的市场反应
4. 分析涨跌幅变化
```

### 场景3: 追踪连续几天的表现
```
1. 选择一个起始日期
2. 点击"后一天"逐日查看
3. 观察市场恢复或下跌的过程
4. 识别趋势转折点
```

## 💡 智能特性

### 1. 按钮状态管理
- 查看今天 → "后一天"和"今天"按钮禁用（灰色）
- 查看历史 → 所有按钮可用

### 2. 数据刷新策略
- **今天**: 自动刷新（实时数据）
- **历史**: 不刷新（数据已固定）

### 3. 日期验证
- 自动阻止选择未来日期
- 如果尝试选择未来，弹出提示并恢复到当前日期

## 🌐 API支持

### 历史数据API
```
GET /api/coin-change-tracker/history?date=YYYY-MM-DD&limit=1440
```

**参数**:
- `date`: 日期（可选）
  - 格式: `YYYY-MM-DD` 或 `YYYYMMDD`
  - 默认: 今天
- `limit`: 返回数据点数（可选）
  - 默认: 1440（一天）

**示例**:
```bash
# 查看2026-02-04的数据
curl "http://localhost:5000/api/coin-change-tracker/history?date=2026-02-04&limit=1440"

# 查看今天的最新100条数据
curl "http://localhost:5000/api/coin-change-tracker/history?limit=100"
```

**响应**:
```json
{
    "success": true,
    "date": "20260204",
    "count": 1440,
    "data": [
        {
            "time": "00:00:00",
            "total_change": -45.23,
            "valid_count": 27,
            "changes": {...}
        },
        ...
    ]
}
```

## 📈 图表功能保持不变

历史查看功能不影响原有图表功能：
- ✅ 最高价/最低价标记
- ✅ 四条关键支撑线（+180%, +90%, -90%, -180%）
- ✅ 趋势曲线和面积填充
- ✅ Tooltip悬停显示详情
- ✅ 响应式布局

## 🚀 快捷键（计划中）

未来可能添加的快捷键功能：
- `←` : 前一天
- `→` : 后一天
- `T` : 今天
- `Ctrl + D` : 打开日期选择器

## 📝 提交信息

- **Commit**: adc6c53
- **功能**: 添加历史查看功能
- **影响文件**:
  - `templates/coin_change_tracker.html` - 前端UI和逻辑
  - `app.py` - API支持日期参数

## 🎉 总结

现在您可以：
1. **自由查看历史**: 任意日期的趋势数据
2. **方便导航**: 前后翻动轻松对比
3. **快速返回**: 一键回到今日实时数据
4. **智能体验**: 按钮状态自动管理

历史数据可回溯到 **2026-01-28**，覆盖了所有重要的市场波动！

---

访问页面: http://localhost:5000/coin-change-tracker
