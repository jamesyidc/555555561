# 预警功能 - 保存按钮使用说明

## 🎯 新增功能

在预警设置面板底部新增了两个按钮：

### 1. 💾 保存预警设置按钮
- **颜色**：绿色渐变
- **图标**：💾 保存图标
- **功能**：手动保存当前的预警配置

### 2. 🔄 恢复默认按钮
- **颜色**：灰色渐变
- **图标**：🔄 恢复图标
- **功能**：一键恢复出厂默认设置

---

## 📋 保存按钮详细说明

### 保存按钮功能

点击"保存预警设置"按钮后：

1. **读取当前设置**
   - 上限阈值
   - 下限阈值
   - 上限开关状态
   - 下限开关状态

2. **保存到本地**
   - 存储到浏览器 localStorage
   - 数据持久化保存

3. **显示成功提示**
   - 绿色提示框
   - "预警设置已保存！"
   - 3秒后自动消失

4. **控制台日志**
   ```
   ✅ 预警设置已手动保存: {
     upperThreshold: 300,
     lowerThreshold: -300,
     upperEnabled: true,
     lowerEnabled: true,
     ...
   }
   ```

---

## 🔄 恢复默认按钮说明

### 恢复默认功能

点击"恢复默认"按钮后：

1. **重置所有设置**
   - 上限阈值：300%
   - 下限阈值：-300%
   - 上限开关：关闭
   - 下限开关：关闭

2. **更新界面**
   - 输入框恢复默认值
   - 开关全部关闭（灰色）
   - 清除触发状态

3. **显示提示**
   - 黄色提示框
   - "已恢复默认设置：上限300%，下限-300%，开关已关闭"
   - 3秒后自动消失

4. **控制台日志**
   ```
   🔄 预警设置已恢复默认
   ```

---

## 🎨 按钮样式

### 保存按钮
```html
┌──────────────────────┐
│ 💾 保存预警设置      │  (绿色渐变背景)
└──────────────────────┘
```

**交互效果**：
- 鼠标悬停：颜色加深
- 点击：轻微放大动画
- 成功后：显示绿色提示

### 恢复默认按钮
```html
┌──────────────────────┐
│ 🔄 恢复默认          │  (灰色渐变背景)
└──────────────────────┘
```

**交互效果**：
- 鼠标悬停：颜色加深
- 点击：轻微放大动画
- 成功后：显示黄色提示

---

## 📊 使用流程

### 标准流程

```
1. 调整预警设置
   ├─ 修改上限阈值
   ├─ 修改下限阈值
   ├─ 开启/关闭上限开关
   └─ 开启/关闭下限开关

2. 点击保存按钮
   ├─ 系统读取当前设置
   ├─ 保存到 localStorage
   └─ 显示"预警设置已保存！"

3. 设置生效
   ├─ 系统开始按新设置监控
   └─ 页面刷新后保持配置
```

### 恢复默认流程

```
1. 点击"恢复默认"按钮

2. 系统自动重置
   ├─ 阈值恢复：300% / -300%
   ├─ 开关关闭：全部灰色
   └─ 清除触发状态

3. 显示确认提示
   └─ "已恢复默认设置..."

4. 根据需要重新配置
   └─ 修改后点击保存
```

---

## 💡 使用建议

### 何时点击保存？

1. **修改阈值后**
   ```
   将上限从 300% 改为 200%
   → 点击保存按钮
   ```

2. **切换开关后**
   ```
   开启上限预警
   → 点击保存按钮
   ```

3. **完成所有配置后**
   ```
   调整了多个设置
   → 最后点击一次保存
   ```

4. **想确保设置生效时**
   ```
   不确定是否已保存
   → 点击保存按钮确认
   ```

### 何时使用恢复默认？

1. **设置混乱时**
   ```
   修改了很多次，想重新开始
   → 点击恢复默认
   ```

2. **测试后恢复**
   ```
   刚才用低阈值测试，现在要恢复
   → 点击恢复默认
   ```

3. **不知道设置什么**
   ```
   不确定合适的阈值
   → 先恢复默认，观察一段时间
   ```

---

## 🔍 自动保存 vs 手动保存

### 自动保存场景

以下操作会**自动保存**，无需点击保存按钮：

1. **修改阈值输入框**
   - 输入完成后自动保存
   - 实时生效

2. **切换开关**
   - 点击开关立即保存
   - 实时生效

3. **触发预警后**
   - 自动更新触发状态
   - 自动保存

### 手动保存场景

以下情况**建议手动保存**：

1. **批量修改多个设置**
   - 先修改所有设置
   - 最后点击保存确认

2. **重要配置**
   - 调整关键阈值
   - 点击保存确保生效

3. **页面即将关闭**
   - 确保最新设置已保存
   - 防止丢失

---

## 📈 保存成功提示

### 绿色提示框

```
┌─────────────────────────────────────┐
│ ✅ 预警设置已保存！                 │
└─────────────────────────────────────┘
```

**显示规则**：
- 点击保存按钮后出现
- 绿色背景，左侧绿色竖线
- 包含绿色勾选图标
- 3秒后自动消失

### 黄色提示框（恢复默认）

```
┌─────────────────────────────────────────────────────┐
│ ⚠️  已恢复默认设置：上限300%，下限-300%，开关已关闭 │
└─────────────────────────────────────────────────────┘
```

**显示规则**：
- 点击恢复默认按钮后出现
- 黄色背景，左侧黄色竖线
- 包含警告图标
- 3秒后自动消失

---

## 🎯 实际使用示例

### 示例1：首次配置

```
步骤：
1. 打开页面
2. 设置上限：300%
3. 设置下限：-300%
4. 开启两个开关
5. 点击"保存预警设置"
6. 看到"预警设置已保存！"
7. 完成配置
```

### 示例2：修改阈值

```
步骤：
1. 当前阈值：±300%
2. 觉得太高，改为：±200%
3. 点击"保存预警设置"
4. 看到"预警设置已保存！"
5. 新阈值生效
```

### 示例3：测试后恢复

```
步骤：
1. 为了测试，设置低阈值：±50%
2. 测试完成
3. 点击"恢复默认"
4. 看到"已恢复默认设置..."
5. 阈值恢复为：±300%
6. 开关自动关闭
```

### 示例4：批量修改

```
步骤：
1. 修改上限：350%
2. 修改下限：-350%
3. 开启上限开关
4. 开启下限开关
5. 点击"保存预警设置"（一次保存所有）
6. 看到"预警设置已保存！"
7. 所有设置生效
```

---

## 🛡️ 数据安全

### 数据存储

```javascript
// 保存位置
localStorage.setItem('coinAlertSettings', JSON.stringify({
  upperThreshold: 300,
  lowerThreshold: -300,
  upperEnabled: true,
  lowerEnabled: true,
  upperTriggered: false,
  lowerTriggered: false,
  lastCheckTime: null
}))
```

### 数据持久化

- ✅ 存储在浏览器本地
- ✅ 关闭页面不丢失
- ✅ 刷新页面自动恢复
- ✅ 清除缓存会删除

### 数据备份建议

1. **截图保存**
   - 记录当前配置
   - 方便恢复

2. **记录在文档**
   - 记下阈值数值
   - 记下开关状态

3. **定期检查**
   - 确认设置正确
   - 必要时重新保存

---

## 🔧 技术实现

### 保存按钮代码

```javascript
document.getElementById('saveAlertSettings').addEventListener('click', () => {
    // 1. 读取当前设置
    alertState.upperThreshold = parseFloat(document.getElementById('upperThreshold').value || 300);
    alertState.lowerThreshold = parseFloat(document.getElementById('lowerThreshold').value || -300);
    alertState.upperEnabled = document.getElementById('upperSwitch').checked;
    alertState.lowerEnabled = document.getElementById('lowerSwitch').checked;
    
    // 2. 保存到localStorage
    saveAlertSettings();
    
    // 3. 显示成功提示
    const successDiv = document.getElementById('saveSuccess');
    successDiv.classList.remove('hidden');
    
    // 4. 3秒后隐藏
    setTimeout(() => {
        successDiv.classList.add('hidden');
    }, 3000);
    
    console.log('✅ 预警设置已手动保存:', alertState);
});
```

### 恢复默认按钮代码

```javascript
document.getElementById('resetAlertSettings').addEventListener('click', () => {
    // 1. 重置状态
    alertState = {
        upperEnabled: false,
        lowerEnabled: false,
        upperThreshold: 300,
        lowerThreshold: -300,
        upperTriggered: false,
        lowerTriggered: false,
        lastCheckTime: null
    };
    
    // 2. 更新UI
    document.getElementById('upperThreshold').value = 300;
    document.getElementById('lowerThreshold').value = -300;
    document.getElementById('upperSwitch').checked = false;
    document.getElementById('lowerSwitch').checked = false;
    
    updateSwitchStyles();
    saveAlertSettings();
    
    // 3. 显示提示
    showResetMessage();
    
    console.log('🔄 预警设置已恢复默认');
});
```

---

## 📞 常见问题

### Q1: 点击保存后没有反应？
**A**: 检查：
- 是否有绿色提示出现（可能很快消失）
- 查看浏览器控制台是否有日志
- 刷新页面看设置是否保存

### Q2: 恢复默认后预警还在触发？
**A**: 正常现象：
- 恢复默认会关闭所有开关
- 需要重新开启才会预警
- 触发状态已清除

### Q3: 保存的设置会丢失吗？
**A**: 以下情况会丢失：
- 清除浏览器缓存
- 使用隐身模式
- 更换浏览器
- 更换设备

### Q4: 自动保存和手动保存有什么区别？
**A**: 
- 自动保存：每次修改后立即保存
- 手动保存：批量修改后统一保存
- 效果相同，手动保存更可靠

---

## ✅ 验证清单

使用以下清单验证保存功能：

- [ ] 保存按钮正常显示（绿色）
- [ ] 恢复默认按钮正常显示（灰色）
- [ ] 点击保存按钮有反应
- [ ] 保存后显示绿色提示
- [ ] 提示3秒后自动消失
- [ ] 点击恢复默认有反应
- [ ] 恢复后显示黄色提示
- [ ] 恢复后阈值变为±300%
- [ ] 恢复后开关全部关闭
- [ ] 刷新页面设置保持
- [ ] 控制台有保存日志

---

## 🎉 总结

**保存按钮的价值**：

1. **明确的操作反馈**
   - 用户点击后立即知道已保存
   - 绿色提示增强信心

2. **批量操作支持**
   - 可以修改多个设置后统一保存
   - 提高配置效率

3. **快速恢复能力**
   - 一键恢复默认设置
   - 方便测试和重置

4. **防止误操作**
   - 手动确认保存
   - 减少意外修改

**访问体验**：
```
https://5000-idfgz76cf9poiqtgzfhan-c81df28e.sandbox.novita.ai/coin-change-tracker
```

立即体验全新的保存按钮功能！💾
