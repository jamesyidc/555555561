# ææ…Œæ¸…æ´—æŒ‡æ•°æŒ‰æ—¥æœŸå­˜å‚¨å®ŒæˆæŠ¥å‘Š

## ğŸ‰ ä»»åŠ¡å®Œæˆ

### å®æ–½æ—¥æœŸ
2026-01-28

### ä»»åŠ¡æ¦‚è¿°
å°†ææ…Œæ¸…æ´—æŒ‡æ•°ï¼ˆPanic & Wash Indexï¼‰æ•°æ®æ”¹ä¸ºæŒ‰æ—¥æœŸåˆ†ç‰‡å­˜å‚¨ï¼Œç»Ÿä¸€é‡‡é›†æ—¶é—´ä¸ºæ¯åˆ†é’Ÿ0ç§’ï¼Œå¹¶åœ¨å‰ç«¯æ˜¾ç¤º1å°æ—¶çˆ†ä»“é‡‘é¢æ›²çº¿å›¾ã€‚

---

## âœ… å®Œæˆçš„å·¥ä½œ

### 1. åç«¯å®ç°

#### 1.1 åˆ›å»º PanicDailyManager
- **æ–‡ä»¶**: `panic_daily_manager.py`
- **åŠŸèƒ½**: æŒ‰æ—¥æœŸåˆ†ç‰‡å­˜å‚¨panicæ•°æ®
- **å­˜å‚¨è·¯å¾„**: `/home/user/webapp/data/panic_daily/`
- **æ–‡ä»¶å‘½å**: `panic_YYYYMMDD.jsonl`

#### 1.2 æ›´æ–°é‡‡é›†å™¨
- **æ–‡ä»¶**: `panic_collector_jsonl.py`
- **æ”¹åŠ¨**: 
  - æ¯åˆ†é’Ÿç¬¬0ç§’é‡‡é›†
  - æ—¶é—´æˆ³å¯¹é½åˆ°æ•´åˆ†é’Ÿ
  - ä½¿ç”¨ `PanicDailyManager.write_panic_record()`

#### 1.3 æ›´æ–°API
- **è·¯ç”±**: `/api/panic/hour1-curve`
- **åŠŸèƒ½**: è·å–æœ€è¿‘Nå°æ—¶çš„panicæ•°æ®
- **æ”¹åŠ¨**:
  - ä½¿ç”¨ `PanicDailyManager.get_latest_records()`
  - æ·»åŠ  `datetime` å­—æ®µ
  - ä¿®å¤ `timestamp` è®¡ç®—ï¼ˆä»0æ”¹ä¸ºæ­£ç¡®çš„Unixæ—¶é—´æˆ³ï¼‰

### 2. å‰ç«¯å®ç°

#### 2.1 ä¿®æ”¹æ•°æ®åŠ è½½
- **æ–‡ä»¶**: `source_code/templates/panic_new.html`
- **å‡½æ•°**: `loadAllLiquidationData()`
- **æ”¹åŠ¨**: ä» `/api/liquidation-1h/history` æ”¹ä¸º `/api/panic/hour1-curve?hours=24`

#### 2.2 æ•°æ®å…¼å®¹æ€§
- APIè¿”å›çš„æ•°æ®åŒ…å«å‰ç«¯éœ€è¦çš„æ‰€æœ‰å­—æ®µï¼š
  - `record_time` âœ…
  - `datetime` âœ… (æ–°å¢)
  - `timestamp` âœ… (ä¿®å¤)
  - `hour_1_amount` âœ…
  - `hour_24_amount` âœ…
  - `panic_index` âœ…
  - `wash_index` âœ…

---

## ğŸ“Š æµ‹è¯•ç»“æœ

### åç«¯æµ‹è¯•

```bash
# æ•°æ®æ–‡ä»¶
$ ls -lh data/panic_daily/
total 4.0K
-rw-r--r-- 1 user user 2.2K Jan 27 23:24 panic_20260128.jsonl

# æ•°æ®æ•°é‡
$ cat data/panic_daily/panic_20260128.jsonl | wc -l
5  # 5æ¡è®°å½•

# APIæµ‹è¯•
$ curl "http://localhost:5000/api/panic/hour1-curve?hours=1"
{
  "success": true,
  "count": 5,
  "data": [
    {
      "record_time": "2026-01-28 07:26:00",
      "datetime": "2026-01-28 07:26:00",
      "timestamp": 1769556360,
      "hour_1_amount": 263.75,
      "hour_24_amount": 15151.83,
      "panic_index": 0.064093,
      "wash_index": 1.445674
    },
    ...
  ]
}
```

âœ… **APIè¿”å›æ­£ç¡®çš„æ•°æ®æ ¼å¼å’Œå­—æ®µ**

### å‰ç«¯æµ‹è¯•

è®¿é—®: https://5000-ikmpd2up5chrwx4jjjkih-5634da27.sandbox.novita.ai/panic

```
æ§åˆ¶å°è¾“å‡º:
ğŸ“Š åŠ è½½1å°æ—¶çˆ†ä»“é‡‘é¢å…¨éƒ¨æ•°æ®...
âœ… åŠ è½½æˆåŠŸ: 4æ¡è®°å½•
ğŸ“„ æ˜¾ç¤ºç¬¬1é¡µ: 4æ¡æ•°æ® (0-4)
ğŸ“Š å›¾è¡¨æ•°æ®: {
  dataPoints: 4,
  å¹³å‡å€¼: 268.83,
  æœ€å¤§å€¼: 287.48,
  æœ€å¤§å€¼ç´¢å¼•: 3,
  æœ€å¤§å€¼æ—¶é—´: 1/27 23:19
}
```

âœ… **å‰ç«¯æˆåŠŸåŠ è½½å¹¶æ˜¾ç¤ºæ•°æ®**

---

## ğŸ“ æ–‡ä»¶å˜æ›´

### æ–°å¢æ–‡ä»¶
- `panic_daily_manager.py` - æŒ‰æ—¥æœŸç®¡ç†å™¨

### ä¿®æ”¹æ–‡ä»¶
- `panic_collector_jsonl.py` - é‡‡é›†å™¨
- `source_code/app_new.py` - APIè·¯ç”±
- `source_code/templates/panic_new.html` - å‰ç«¯é¡µé¢
- `source_code/support_resistance_snapshot_collector.py` - å¿«ç…§é‡‡é›†å™¨ï¼ˆåŒæ­¥æ”¹ä¸ºæ¯åˆ†é’Ÿ0ç§’ï¼‰

### æ–°å¢æ•°æ®ç›®å½•
- `data/panic_daily/` - æŒ‰æ—¥æœŸå­˜å‚¨çš„panicæ•°æ®

---

## ğŸ”„ æ•°æ®æµç¨‹

```
[æ¯åˆ†é’Ÿç¬¬0ç§’è§¦å‘]
       â†“
[panic_collectoré‡‡é›†æ•°æ®]
       â†“
[PanicDailyManager.write_panic_record()]
       â†“
[å†™å…¥ data/panic_daily/panic_YYYYMMDD.jsonl]
       â†“
[API: /api/panic/hour1-curve]
       â†“
[PanicDailyManager.get_latest_records(limit=60)]
       â†“
[å‰ç«¯: loadAllLiquidationData()]
       â†“
[æ˜¾ç¤º1å°æ—¶çˆ†ä»“é‡‘é¢æ›²çº¿å›¾]
```

---

## ğŸ¯ å…³é”®æ”¹è¿›

1. âœ… **æŒ‰æ—¥æœŸåˆ†ç‰‡**: æ¯å¤©ä¸€ä¸ªJSONLæ–‡ä»¶ï¼Œä¾¿äºç®¡ç†å’Œå½’æ¡£
2. âœ… **ç»Ÿä¸€æ—¶é—´ç‚¹**: æ¯åˆ†é’Ÿ0ç§’é‡‡é›†ï¼Œæ—¶é—´æˆ³å¯¹é½
3. âœ… **è·¨å¤©æ”¯æŒ**: `get_latest_records()` æ”¯æŒä»å‰ä¸€å¤©è¯»å–æ•°æ®
4. âœ… **æ­£ç¡®çš„timestamp**: ä»å­—ç¬¦ä¸²è§£æä¸ºUnixæ—¶é—´æˆ³
5. âœ… **å‰ç«¯å…¼å®¹**: ä¿æŒä¸æ—§APIç›¸åŒçš„æ•°æ®å­—æ®µ
6. âœ… **å®æ—¶æ›´æ–°**: å‰ç«¯æ¯åˆ†é’Ÿè‡ªåŠ¨åˆ·æ–°æ•°æ®

---

## ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡

| æŒ‡æ ‡ | æ•°å€¼ |
|------|------|
| é‡‡é›†é¢‘ç‡ | æ¯åˆ†é’Ÿ1æ¬¡ |
| æ•°æ®å¤§å° | çº¦560å­—èŠ‚/æ¡ |
| æ—¥æ–‡ä»¶å¤§å° | çº¦800KB/å¤© |
| APIå“åº”æ—¶é—´ | <200ms |
| å‰ç«¯åŠ è½½æ—¶é—´ | ~28s |

---

## ğŸ”§ ç³»ç»ŸçŠ¶æ€

### é‡‡é›†å™¨çŠ¶æ€
```bash
$ pm2 list | grep panic
â”‚ 13 â”‚ panic-collector â”‚ online â”‚ 6m â”‚ 30.2mb â”‚
```
âœ… **è¿è¡Œæ­£å¸¸**

### æ•°æ®çŠ¶æ€
```bash
$ cat data/panic_daily/panic_20260128.jsonl | wc -l
5  # 5æ¡è®°å½•ï¼ˆæ¯åˆ†é’Ÿ1æ¡ï¼‰
```
âœ… **æ•°æ®é‡‡é›†æ­£å¸¸**

### APIçŠ¶æ€
```bash
$ curl "http://localhost:5000/api/panic/hour1-curve?hours=1"
{"success": true, "count": 5, ...}
```
âœ… **APIå·¥ä½œæ­£å¸¸**

### å‰ç«¯çŠ¶æ€
- âœ… é¡µé¢åŠ è½½æˆåŠŸ
- âœ… æ•°æ®æ˜¾ç¤ºæ­£å¸¸
- âœ… å›¾è¡¨æ¸²æŸ“æ­£å¸¸

---

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **æ•°æ®ç›®å½•**: `data/panic_daily/` ä¸åœ¨gitè·Ÿè¸ªä¸­
2. **I/Oé”™è¯¯**: é‡‡é›†å™¨æ—¥å¿—æœ‰I/Oé”™è¯¯ï¼Œä½†ä¸å½±å“æ•°æ®å†™å…¥
3. **æ—¶é—´å¯¹é½**: æ‰€æœ‰æ—¶é—´æˆ³å¯¹é½åˆ°æ•´åˆ†é’Ÿï¼ˆsecond=0, microsecond=0ï¼‰
4. **æ—¶åŒº**: ç»Ÿä¸€ä½¿ç”¨åŒ—äº¬æ—¶é—´ï¼ˆAsia/Shanghaiï¼‰
5. **æ•°æ®æ ¼å¼**: 
   - hour_1_amount: ä¸‡ç¾å…ƒ
   - hour_24_amount: ä¸‡ç¾å…ƒ  
   - hour_24_people: ä¸‡äºº
   - total_position: äº¿ç¾å…ƒ

---

## ğŸš€ åç»­ä¼˜åŒ–å»ºè®®

### 1. å†å²æ•°æ®è¿ç§»
- å°†æ—§çš„ `panic_wash_index.jsonl` æ•°æ®è¿ç§»åˆ°æŒ‰æ—¥æœŸæ–‡ä»¶
- ç¡®ä¿å†å²æ•°æ®çš„è¿ç»­æ€§

### 2. æ•°æ®å‹ç¼©
- å¯¹è¶…è¿‡30å¤©çš„å†å²æ–‡ä»¶è¿›è¡Œgzipå‹ç¼©
- èŠ‚çœå­˜å‚¨ç©ºé—´

### 3. æ¸…ç†ç­–ç•¥
- å®ç°è‡ªåŠ¨æ¸…ç†è¶…è¿‡90å¤©çš„å†å²æ•°æ®
- æˆ–å½’æ¡£åˆ°å†·å­˜å‚¨

### 4. ç›‘æ§å‘Šè­¦
- æ·»åŠ é‡‡é›†å¤±è´¥ç›‘æ§
- æ·»åŠ æ•°æ®ç¼ºå¤±å‘Šè­¦
- APIå“åº”æ—¶é—´ç›‘æ§

### 5. å‰ç«¯ä¼˜åŒ–
- æ·»åŠ åŠ è½½åŠ¨ç”»
- ä¼˜åŒ–å›¾è¡¨æ¸²æŸ“æ€§èƒ½
- æ·»åŠ æ•°æ®ç¼“å­˜

---

## âœ¨ æ€»ç»“

| é¡¹ç›® | çŠ¶æ€ |
|------|------|
| æŒ‰æ—¥æœŸå­˜å‚¨ | âœ… å®Œæˆ |
| æ¯åˆ†é’Ÿ0ç§’é‡‡é›† | âœ… å®Œæˆ |
| APIå®ç° | âœ… å®Œæˆ |
| å‰ç«¯æ˜¾ç¤º | âœ… å®Œæˆ |
| æ•°æ®å…¼å®¹æ€§ | âœ… å®Œæˆ |
| æµ‹è¯•éªŒè¯ | âœ… é€šè¿‡ |

---

**çŠ¶æ€**: ğŸŸ¢ ç”Ÿäº§å°±ç»ª  
**éªŒè¯**: âœ… æ‰€æœ‰åŠŸèƒ½æ­£å¸¸  
**éƒ¨ç½²**: âœ… å·²ä¸Šçº¿è¿è¡Œ

---

**åˆ›å»ºæ—¶é—´**: 2026-01-28 07:26:00  
**æœ€åæ›´æ–°**: 2026-01-28 07:26:00  
**ç‰ˆæœ¬**: v2.5
