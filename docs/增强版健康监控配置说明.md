# Enhanced Health Monitor é…ç½®æ–‡ä»¶

## Telegram é€šçŸ¥é…ç½®

è¦å¯ç”¨Telegramé€šçŸ¥åŠŸèƒ½ï¼Œè¯·æŒ‰ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š

### 1. åˆ›å»º Telegram Bot

1. åœ¨Telegramä¸­æœç´¢ `@BotFather`
2. å‘é€å‘½ä»¤ `/newbot`
3. æŒ‰æç¤ºè®¾ç½®æœºå™¨äººåç§°
4. è·å– Bot Tokenï¼ˆæ ¼å¼å¦‚ï¼š`123456789:ABCdefGHIjklMNOpqrsTUVwxyz`ï¼‰

### 2. è·å– Chat ID

æ–¹æ³•1ï¼šé€šè¿‡GetIDBot
1. åœ¨Telegramä¸­æœç´¢ `@getidsbot`
2. ç‚¹å‡» START
3. æœºå™¨äººä¼šè¿”å›æ‚¨çš„ Chat IDï¼ˆçº¯æ•°å­—ï¼‰

æ–¹æ³•2ï¼šé€šè¿‡å‘é€æ¶ˆæ¯è·å–
1. å‘æ‚¨çš„æœºå™¨äººå‘é€ä»»æ„æ¶ˆæ¯
2. æµè§ˆå™¨è®¿é—®ï¼š`https://api.telegram.org/bot<YOUR_BOT_TOKEN>/getUpdates`
3. åœ¨è¿”å›çš„JSONä¸­æ‰¾åˆ° `"chat":{"id":æ•°å­—}`

### 3. è®¾ç½®ç¯å¢ƒå˜é‡

#### æ–¹æ³•1ï¼šä¸´æ—¶è®¾ç½®ï¼ˆå½“å‰ä¼šè¯ï¼‰
```bash
export TELEGRAM_BOT_TOKEN='ä½ çš„Bot Token'
export TELEGRAM_CHAT_ID='ä½ çš„Chat ID'
```

#### æ–¹æ³•2ï¼šæ°¸ä¹…è®¾ç½®ï¼ˆæ¨èï¼‰
ç¼–è¾‘ `~/.bashrc` æˆ– `~/.zshrc`ï¼š
```bash
echo "export TELEGRAM_BOT_TOKEN='ä½ çš„Bot Token'" >> ~/.bashrc
echo "export TELEGRAM_CHAT_ID='ä½ çš„Chat ID'" >> ~/.bashrc
source ~/.bashrc
```

### 4. é‡å¯ç›‘æ§å™¨

```bash
pm2 restart data-health-monitor
```

æˆ–ä½¿ç”¨æ–°çš„å¢å¼ºç‰ˆç›‘æ§å™¨ï¼š
```bash
pm2 delete data-health-monitor
pm2 start source_code/enhanced_health_monitor.py --name enhanced-health-monitor --interpreter python3
```

## é…ç½®ç¤ºä¾‹

```bash
# ç¤ºä¾‹ï¼ˆè¯·æ›¿æ¢ä¸ºæ‚¨è‡ªå·±çš„å€¼ï¼‰
export TELEGRAM_BOT_TOKEN='1234567890:ABCdefGHIjklMNOpqrsTUVwxyz1234567'
export TELEGRAM_CHAT_ID='987654321'
```

## éªŒè¯é…ç½®

è¿è¡Œä»¥ä¸‹å‘½ä»¤éªŒè¯é…ç½®æ˜¯å¦æ­£ç¡®ï¼š

```bash
python3 /home/user/webapp/source_code/enhanced_health_monitor.py
```

å¦‚æœé…ç½®æ­£ç¡®ï¼Œæ‚¨åº”è¯¥åœ¨å¯åŠ¨æ—¥å¿—ä¸­çœ‹åˆ°ï¼š
```
ğŸ“± Telegramé€šçŸ¥: âœ… å·²å¯ç”¨
```

å¦‚æœæœªå¯ç”¨ï¼Œä¼šæ˜¾ç¤ºï¼š
```
ğŸ“± Telegramé€šçŸ¥: âŒ æœªå¯ç”¨
âš ï¸ Telegramé€šçŸ¥æœªå¯ç”¨
è¯·è®¾ç½®ç¯å¢ƒå˜é‡:
  export TELEGRAM_BOT_TOKEN='your_bot_token'
  export TELEGRAM_CHAT_ID='your_chat_id'
```

## é€šçŸ¥ç¤ºä¾‹

å½“ç³»ç»Ÿæ£€æµ‹åˆ°æ— æ³•è‡ªåŠ¨ä¿®å¤çš„é—®é¢˜æ—¶ï¼Œæ‚¨ä¼šæ”¶åˆ°ç±»ä¼¼è¿™æ ·çš„Telegramæ¶ˆæ¯ï¼š

```
ğŸš¨ æ•°æ®å¥åº·ç›‘æ§å‘Šè­¦

ğŸ• æ—¶é—´: 2026-02-15 15:30:00
âš ï¸ æ— æ³•è‡ªåŠ¨ä¿®å¤çš„é—®é¢˜ (2 ä¸ª):

1. è¿›ç¨‹ signal-collector æœªåœ¨PM2ä¸­é…ç½®
2. è¡¨ sar_slope_data æ•°æ®å»¶è¿Ÿ 35 åˆ†é’Ÿï¼Œéœ€æ£€æŸ¥å¯¹åº”é‡‡é›†å™¨

âœ… å·²è‡ªåŠ¨ä¿®å¤ (1 ä¸ª):
1. æˆåŠŸé‡å¯è¿›ç¨‹: flask-app
```

## ç›‘æ§èŒƒå›´

å¢å¼ºç‰ˆå¥åº·ç›‘æ§å™¨ä¼šæ£€æŸ¥ï¼š

### PM2è¿›ç¨‹ï¼ˆ22ä¸ªï¼‰
- flask-app
- signal-collector
- price-speed-collector
- sar-slope-collector
- sar-bias-stats-collector
- price-comparison-collector
- financial-indicators-collector
- okx-day-change-collector
- price-baseline-collector
- panic-wash-collector
- liquidation-1h-collector
- crypto-index-collector
- v1v2-collector
- liquidation-alert-monitor
- system-health-monitor
- coin-change-tracker
- dashboard-jsonl-manager
- gdrive-jsonl-manager
- okx-trade-history-collector
- okx-trading-marks-collector
- price-position-collector
- data-health-monitor

### æ•°æ®åº“è¡¨ï¼ˆ6ä¸ªï¼‰
- signal_timelineï¼ˆæœ€å¤§å»¶è¿Ÿ10åˆ†é’Ÿï¼‰
- price_speed_10mï¼ˆæœ€å¤§å»¶è¿Ÿ10åˆ†é’Ÿï¼‰
- sar_slope_dataï¼ˆæœ€å¤§å»¶è¿Ÿ10åˆ†é’Ÿï¼‰
- price_comparisonï¼ˆæœ€å¤§å»¶è¿Ÿ30åˆ†é’Ÿï¼‰
- panic_wash_dataï¼ˆæœ€å¤§å»¶è¿Ÿ30åˆ†é’Ÿï¼‰
- liquidation_1hï¼ˆæœ€å¤§å»¶è¿Ÿ120åˆ†é’Ÿï¼‰

### JSONLæ–‡ä»¶ç›®å½•ï¼ˆ3ä¸ªï¼‰
- sar_bias_statsï¼ˆæœ€å¤§å»¶è¿Ÿ10åˆ†é’Ÿï¼‰
- price_speed_10mï¼ˆæœ€å¤§å»¶è¿Ÿ10åˆ†é’Ÿï¼‰
- signal_statsï¼ˆæœ€å¤§å»¶è¿Ÿ10åˆ†é’Ÿï¼‰

### Flaskåº”ç”¨å¥åº·æ£€æŸ¥
- æ£€æŸ¥ http://localhost:9002/api/data-health-monitor/status
- è‡ªåŠ¨é‡å¯å¼‚å¸¸çš„Flaskåº”ç”¨

## è‡ªåŠ¨ä¿®å¤åŠŸèƒ½

ç›‘æ§å™¨ä¼šå°è¯•è‡ªåŠ¨ä¿®å¤ä»¥ä¸‹é—®é¢˜ï¼š

1. **è¿›ç¨‹çŠ¶æ€å¼‚å¸¸**ï¼šè‡ªåŠ¨é‡å¯stoppedæˆ–erroredçš„PM2è¿›ç¨‹
2. **Flaskåº”ç”¨æ— å“åº”**ï¼šè‡ªåŠ¨é‡å¯flask-appè¿›ç¨‹

æ— æ³•è‡ªåŠ¨ä¿®å¤çš„é—®é¢˜ä¼šé€šè¿‡Telegramé€šçŸ¥æ‚¨ã€‚

## æ£€æŸ¥é—´éš”

- é»˜è®¤ï¼š180ç§’ï¼ˆ3åˆ†é’Ÿï¼‰
- å¯åœ¨ `enhanced_health_monitor.py` ä¸­ä¿®æ”¹ `CHECK_INTERVAL` å˜é‡

## å¸¸è§é—®é¢˜

### Q: å¦‚ä½•æµ‹è¯•Telegramé€šçŸ¥ï¼Ÿ
A: å¯ä»¥æ‰‹åŠ¨åœæ­¢ä¸€ä¸ªè¿›ç¨‹ï¼Œç­‰å¾…ç›‘æ§å™¨æ£€æµ‹åˆ°å¼‚å¸¸ï¼š
```bash
pm2 stop signal-collector
# ç­‰å¾…3åˆ†é’Ÿï¼Œåº”è¯¥ä¼šæ”¶åˆ°Telegramé€šçŸ¥å’Œè‡ªåŠ¨é‡å¯
```

### Q: æ”¶ä¸åˆ°Telegramé€šçŸ¥ï¼Ÿ
A: æ£€æŸ¥ï¼š
1. Bot Tokenå’ŒChat IDæ˜¯å¦æ­£ç¡®
2. æ˜¯å¦å·²å‘æœºå™¨äººå‘é€è¿‡è‡³å°‘ä¸€æ¡æ¶ˆæ¯
3. æœºå™¨äººæ˜¯å¦è¢«å°ç¦
4. ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸

### Q: å¦‚ä½•æŸ¥çœ‹ç›‘æ§å™¨æ—¥å¿—ï¼Ÿ
A:
```bash
pm2 logs enhanced-health-monitor
```

### Q: å¦‚ä½•æ·»åŠ æ›´å¤šç›‘æ§é¡¹ï¼Ÿ
A: ç¼–è¾‘ `enhanced_health_monitor.py`ï¼Œåœ¨ä»¥ä¸‹å˜é‡ä¸­æ·»åŠ ï¼š
- `MONITORED_PROCESSES`ï¼šPM2è¿›ç¨‹
- `MONITORED_TABLES`ï¼šæ•°æ®åº“è¡¨
- `MONITORED_JSONL_DIRS`ï¼šJSONLç›®å½•
