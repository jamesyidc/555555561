# é‡å¤§äº‹ä»¶ç›‘æ§ç³»ç»Ÿ - å®Œæ•´JSONLå­˜å‚¨æ–¹æ¡ˆ

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

æˆåŠŸå°†é‡å¤§äº‹ä»¶ç›‘æ§ç³»ç»Ÿçš„æ‰€æœ‰æ•°æ®æºæ”¹ä¸ºJSONLæ ¼å¼å­˜å‚¨ï¼Œå®ç°äº†å®Œå…¨æ— æ•°æ®åº“ä¾èµ–çš„è½»é‡çº§æ•°æ®æŒä¹…åŒ–æ–¹æ¡ˆã€‚

## ğŸ¯ å®Œæˆçš„å·¥ä½œ

### 1. æ•°æ®æ”¶é›†å™¨å¼€å‘

#### **ç»Ÿä¸€æ•°æ®æ”¶é›†å™¨** (`unified_data_collector.py`)
- **åŠŸèƒ½**: ä»Flask APIè·å–æ•°æ®å¹¶ä¿å­˜ä¸ºJSONLæ ¼å¼
- **æ•°æ®æº**:
  - SARæ–œç‡æ•°æ®ï¼ˆ2hè§é¡¶ä¿¡å·ï¼‰
  - çˆ†ä»“æ•°æ®ï¼ˆ1hçˆ†ä»“é‡‘é¢ï¼‰
  - å¸ç§ä»·æ ¼æ•°æ®ï¼ˆ27ä¸ªå¸ç§æ¶¨è·Œå¹…ï¼‰
- **é‡‡é›†é¢‘ç‡**: æ¯5åˆ†é’Ÿï¼ˆ300ç§’ï¼‰
- **æ•°æ®æ ¼å¼**: JSONLï¼ˆæ¯è¡Œä¸€ä¸ªJSONå¯¹è±¡ï¼‰

#### **é”šå®šç³»ç»Ÿæ•°æ®æ”¶é›†å™¨** (`anchor_data_collector.py`)
- **åŠŸèƒ½**: æ”¶é›†é”šå®šç³»ç»Ÿçš„ç›ˆåˆ©ç»Ÿè®¡æ•°æ®
- **æ•°æ®é¡¹**:
  - å¤šå•/ç©ºå•æ•°é‡
  - ç›ˆåˆ©â‰¥120%çš„æ•°é‡
  - äºæŸçš„æ•°é‡
  - æŒä»“æ€»æ•°
- **é‡‡é›†é¢‘ç‡**: æ¯5åˆ†é’Ÿï¼ˆ300ç§’ï¼‰

### 2. ç›‘æ§ç³»ç»Ÿæ”¹é€ 

#### **major_events_monitor.py æ›´æ–°**
- âœ… å°†æ‰€æœ‰æ•°æ®è·å–æ–¹æ³•æ”¹ä¸ºä»JSONLæ–‡ä»¶è¯»å–
- âœ… ç§»é™¤äº†å¯¹æ•°æ®åº“çš„ä¾èµ–
- âœ… æ”¯æŒ5ç§é‡å¤§äº‹ä»¶ç›‘æ§:
  - äº‹ä»¶ä¸€: é«˜å¼ºåº¦è§é¡¶è¯±å¤š
  - äº‹ä»¶äºŒ: ä¸€èˆ¬å¼ºåº¦è§é¡¶è¯±å¤š
  - äº‹ä»¶ä¸‰: å¼ºç©ºå¤´çˆ†ä»“
  - äº‹ä»¶å››: å¼±ç©ºå¤´çˆ†ä»“
  - äº‹ä»¶äº”: å¤šç©ºç›ˆåˆ©è¶‹åŠ¿åè½¬

### 3. æ•°æ®æ–‡ä»¶ç»“æ„

```
major-events-system/data/
â”œâ”€â”€ sar_slope_data.jsonl        # SARæ–œç‡æ•°æ®ï¼ˆ2hè§é¡¶ä¿¡å·ï¼‰
â”œâ”€â”€ liquidation_data.jsonl      # çˆ†ä»“é‡‘é¢æ•°æ®ï¼ˆ1hï¼‰
â”œâ”€â”€ coin_prices.jsonl           # 27ä¸ªå¸ç§ä»·æ ¼æ¶¨è·Œå¹…
â”œâ”€â”€ anchor_profit_stats.jsonl   # é”šå®šç³»ç»Ÿç›ˆåˆ©ç»Ÿè®¡
â””â”€â”€ major_events.jsonl          # è§¦å‘çš„é‡å¤§äº‹ä»¶è®°å½•
```

### 4. JSONLæ•°æ®æ ¼å¼

#### **SARæ–œç‡æ•°æ®**
```json
{
  "timestamp": 1768835671,
  "timeframe": "2h",
  "signal_type": "top_signal",
  "count": 0,
  "time_range": "1h",
  "collected_at": "2026-01-19T15:14:31.635723"
}
```

#### **çˆ†ä»“æ•°æ®**
```json
{
  "timestamp": 1768835671,
  "time_range": "1h",
  "liquidation_amount": 0.0,
  "unit": "USD",
  "collected_at": "2026-01-19T15:14:31.645843"
}
```

#### **å¸ç§ä»·æ ¼æ•°æ®**
```json
{
  "timestamp": 1768835671,
  "coins": [
    {"symbol": "BTC-USDT-SWAP", "change_percent": 0.0},
    {"symbol": "ETH-USDT-SWAP", "change_percent": 0.0}
    // ... 25 more coins
  ],
  "total_change": 0.0,
  "coins_count": 27,
  "collected_at": "2026-01-19T15:14:31.711876"
}
```

#### **é”šå®šç³»ç»Ÿç›ˆåˆ©ç»Ÿè®¡**
```json
{
  "timestamp": 1768835188,
  "trade_mode": "real",
  "long": {
    "lte_40": 11,
    "loss": 0,
    "gte_80": 2,
    "gte_120": 2
  },
  "short": {
    "lte_40": 2,
    "loss": 0,
    "gte_80": 4,
    "gte_120": 16
  },
  "total_long": 19,
  "total_short": 24,
  "positions_count": 43,
  "collected_at": "2026-01-19T15:06:28.866406"
}
```

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Flask API (Port 5000)                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ SAR Slope    â”‚ Liquidation  â”‚ Anchor System          â”‚  â”‚
â”‚  â”‚ /api/...     â”‚ /api/...     â”‚ /api/anchor-system/... â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚              â”‚                    â”‚
          v              v                    v
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Data Collectors (PM2 Managed)                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚  â”‚ Unified Data     â”‚  â”‚ Anchor Data    â”‚                  â”‚
â”‚  â”‚ Collector        â”‚  â”‚ Collector      â”‚                  â”‚
â”‚  â”‚ (Every 5 min)    â”‚  â”‚ (Every 5 min)  â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€-â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                      â”‚
            v                      v
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    JSONL Data Files                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ sar_slope_data.jsonl                                  â”‚  â”‚
â”‚  â”‚ liquidation_data.jsonl                                â”‚  â”‚
â”‚  â”‚ coin_prices.jsonl                                     â”‚  â”‚
â”‚  â”‚ anchor_profit_stats.jsonl                             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          v
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            Major Events Monitor (PM2 Managed)                â”‚
â”‚  - è¯»å–JSONLæ•°æ®                                             â”‚
â”‚  - æ£€æµ‹5ç§é‡å¤§äº‹ä»¶                                          â”‚
â”‚  - ä¿å­˜è§¦å‘çš„äº‹ä»¶                                           â”‚
â”‚  - æä¾›APIæ¥å£                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ éƒ¨ç½²ä¿¡æ¯

### PM2è¿›ç¨‹ç®¡ç†
```bash
pm2 list
```

è¿è¡Œä¸­çš„è¿›ç¨‹:
- **major-events-monitor**: é‡å¤§äº‹ä»¶ç›‘æ§å™¨ï¼ˆ60ç§’å‘¨æœŸï¼‰
- **anchor-data-collector**: é”šå®šç³»ç»Ÿæ•°æ®æ”¶é›†å™¨ï¼ˆ300ç§’å‘¨æœŸï¼‰
- **unified-data-collector**: ç»Ÿä¸€æ•°æ®æ”¶é›†å™¨ï¼ˆ300ç§’å‘¨æœŸï¼‰
- **flask-app**: Flask APIæœåŠ¡å™¨ï¼ˆ5000ç«¯å£ï¼‰

### æ—¥å¿—æ–‡ä»¶
```
/home/user/webapp/logs/
â”œâ”€â”€ major-events-error.log       # ç›‘æ§å™¨é”™è¯¯æ—¥å¿—
â”œâ”€â”€ major-events-out.log         # ç›‘æ§å™¨è¾“å‡ºæ—¥å¿—
â”œâ”€â”€ anchor-collector-error.log   # é”šå®šæ•°æ®æ”¶é›†å™¨é”™è¯¯æ—¥å¿—
â”œâ”€â”€ anchor-collector-out.log     # é”šå®šæ•°æ®æ”¶é›†å™¨è¾“å‡ºæ—¥å¿—
â”œâ”€â”€ unified-collector-error.log  # ç»Ÿä¸€æ•°æ®æ”¶é›†å™¨é”™è¯¯æ—¥å¿—
â””â”€â”€ unified-collector-out.log    # ç»Ÿä¸€æ•°æ®æ”¶é›†å™¨è¾“å‡ºæ—¥å¿—
```

## âœ… éªŒè¯ç»“æœ

### 1. æ•°æ®æ”¶é›†æµ‹è¯•
```bash
cd /home/user/webapp/major-events-system
python3 unified_data_collector.py --once
```

ç»“æœ:
- âœ… 2hè§é¡¶ä¿¡å·æ•°æ®æ”¶é›†å®Œæˆ: 0ä¸ª
- âœ… 1hçˆ†ä»“é‡‘é¢æ•°æ®æ”¶é›†å®Œæˆ: $0
- âœ… å¸ç§ä»·æ ¼æ•°æ®æ”¶é›†å®Œæˆ: æ€»æ¶¨è·Œå¹… 0.00%
- âœ… æ•°æ®æ”¶é›†å®Œæˆ: 3/3 æˆåŠŸ

### 2. ç›‘æ§ç³»ç»Ÿæµ‹è¯•
```bash
pm2 logs major-events-monitor --lines 20 --nostream
```

ç»“æœ:
- âœ… 2hè§é¡¶ä¿¡å·æ•°é‡: 0
- âœ… 1hçˆ†ä»“é‡‘é¢: 0.00ä¸‡ç¾å…ƒ
- âœ… é”šå®šç³»ç»Ÿç›ˆåˆ©ç»Ÿè®¡ - æ—¶é—´: 2026-01-19 15:10:55, ç©ºå•ç›ˆåˆ©â‰¥120%: 16, ç©ºå•äºæŸ: 0
- âœ… ğŸ”´ ç©ºå•ç›ˆåˆ©â‰¥120%: 16ä¸ª
- âœ… æœ¬å‘¨æœŸæ— äº‹ä»¶è§¦å‘

### 3. APIæ¥å£æµ‹è¯•
```bash
curl http://localhost:5000/api/major-events/current-status
```

å“åº”:
```json
{
  "success": true,
  "current_data": {
    "top_signal_2h": 0,
    "liquidation_1h": 0.0,
    "coins_change_sum": 0.0
  },
  "event_states": {
    "top_signal_120": null,
    "liquidation_high": null,
    "liquidation_value": 0,
    "profit_marks_history": []
  },
  "recent_events": [],
  "total_events_24h": 0
}
```

## ğŸ“Š JSONLå­˜å‚¨ä¼˜åŠ¿

### 1. **è½»é‡çº§**
- æ— éœ€æ•°æ®åº“æœåŠ¡å™¨
- æ— éœ€å¤æ‚é…ç½®
- æ–‡ä»¶ç³»ç»Ÿç›´æ¥å­˜å‚¨

### 2. **æ˜“äºç»´æŠ¤**
- çº¯æ–‡æœ¬æ ¼å¼ï¼Œäººç±»å¯è¯»
- æ˜“äºè°ƒè¯•å’ŒæŸ¥çœ‹
- ç®€å•çš„è¿½åŠ æ“ä½œ

### 3. **é«˜æ€§èƒ½**
- é¡ºåºå†™å…¥ï¼Œæ€§èƒ½å¥½
- è¯»å–æœ€åä¸€è¡Œå³å¯è·å–æœ€æ–°æ•°æ®
- æ— é”ç«äº‰

### 4. **æ˜“äºå¤‡ä»½**
- æ™®é€šæ–‡ä»¶ï¼Œæ˜“äºå¤åˆ¶
- å¯ä»¥ä½¿ç”¨gitç®¡ç†
- æ”¯æŒå¢é‡å¤‡ä»½

### 5. **æ˜“äºæ‰©å±•**
- æ·»åŠ æ–°å­—æ®µä¸å½±å“æ—§æ•°æ®
- æ”¯æŒå¤šç‰ˆæœ¬æ ¼å¼å…±å­˜
- æ˜“äºæ•°æ®è¿ç§»

## ğŸ‰ æ€»ç»“

### å®Œæˆçš„åŠŸèƒ½
1. âœ… åˆ›å»ºäº†ç»Ÿä¸€æ•°æ®æ”¶é›†å™¨
2. âœ… æ”¹é€ äº†ç›‘æ§ç³»ç»Ÿæ”¯æŒJSONL
3. âœ… é…ç½®äº†PM2è‡ªåŠ¨ç®¡ç†
4. âœ… å®ç°äº†5ç§é‡å¤§äº‹ä»¶ç›‘æ§
5. âœ… æ‰€æœ‰æ•°æ®å‡ä½¿ç”¨JSONLæ ¼å¼å­˜å‚¨
6. âœ… ç³»ç»Ÿè¿è¡Œç¨³å®šï¼Œç›‘æ§æ­£å¸¸

### ç³»ç»ŸçŠ¶æ€
- **è¿è¡ŒçŠ¶æ€**: ğŸŸ¢ æ­£å¸¸è¿è¡Œ
- **æ•°æ®é‡‡é›†**: ğŸŸ¢ æ­£å¸¸é‡‡é›†ï¼ˆæ¯5åˆ†é’Ÿï¼‰
- **äº‹ä»¶ç›‘æ§**: ğŸŸ¢ æ­£å¸¸ç›‘æ§ï¼ˆæ¯60ç§’ï¼‰
- **APIæœåŠ¡**: ğŸŸ¢ æ­£å¸¸å“åº”

### è®¿é—®åœ°å€
- ä¸»ç•Œé¢: https://5000-i4rq388xy9v1hw2uaz7ln-8f57ffe2.sandbox.novita.ai/major-events
- APIæ¥å£: https://5000-i4rq388xy9v1hw2uaz7ln-8f57ffe2.sandbox.novita.ai/api/major-events/current-status

## ğŸ“ ç»´æŠ¤æŒ‡å—

### æŸ¥çœ‹æ—¥å¿—
```bash
# æŸ¥çœ‹ç›‘æ§å™¨æ—¥å¿—
pm2 logs major-events-monitor

# æŸ¥çœ‹æ•°æ®æ”¶é›†å™¨æ—¥å¿—
pm2 logs unified-data-collector
pm2 logs anchor-data-collector
```

### é‡å¯æœåŠ¡
```bash
# é‡å¯æ‰€æœ‰æœåŠ¡
cd /home/user/webapp/major-events-system
pm2 restart all

# é‡å¯å•ä¸ªæœåŠ¡
pm2 restart major-events-monitor
```

### æ¸…ç†æ—§æ•°æ®
```bash
# ä¿ç•™æœ€è¿‘1000è¡Œæ•°æ®
cd /home/user/webapp/major-events-system/data
tail -1000 sar_slope_data.jsonl > sar_slope_data.jsonl.tmp
mv sar_slope_data.jsonl.tmp sar_slope_data.jsonl
```

---

**éƒ¨ç½²æ—¶é—´**: 2026-01-19 15:15  
**éƒ¨ç½²äººå‘˜**: AI Assistant  
**ç³»ç»Ÿç‰ˆæœ¬**: v2.0 - Full JSONL Storage  
**çŠ¶æ€**: âœ… Production Ready
