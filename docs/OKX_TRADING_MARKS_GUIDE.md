# 📊 OKX交易标记系统

## 功能概述

这是一个专门用于可视化OKX交易历史的系统，将主账户的所有开仓和平仓点标记在27币累计涨跌幅趋势图上，帮助分析交易时机和市场走势的关系。

## 访问地址

🔗 https://5000-idfgz76cf9poiqtgzfhan-c81df28e.sandbox.novita.ai/okx-trading-marks

## 核心功能

### 📈 趋势图 + 交易标记

#### 基础趋势线
- **蓝色曲线**：27个币种的累计涨跌幅
- **渐变填充**：更直观地展示涨跌区域
- **实时数据**：基于最新的历史数据

#### 交易标记点

| 类型 | 符号 | 颜色 | 说明 |
|-----|------|------|------|
| 多单开仓 | ● | 🔴 红色 | BUY - 做多开仓 |
| 多单平仓 | ● | 🟢 绿色 | SELL - 做多平仓 |
| 空单开仓 | ◆ | 🟠 橙色 | BUY - 做空开仓 |
| 空单平仓 | ◆ | 🔵 青色 | SELL - 做空平仓 |

### 📊 统计面板

实时显示交易统计：
- **总交易次数**：所有开仓和平仓的总数
- **多单开仓**：做多买入的次数
- **多单平仓**：做多卖出的次数
- **空单开仓**：做空买入的次数
- **空单平仓**：做空卖出的次数

### 🔍 筛选功能

- **账户选择**：切换不同的OKX账户
- **日期范围**：选择查看的时间段（默认最近7天）
- **刷新按钮**：重新加载最新数据

## 使用方法

### 第一步：选择账户

1. 打开页面后，顶部会显示账户下拉框
2. 选择要查看的账户（默认是主账户）
3. 如果没有账户，会提示"请先在OKX交易页面添加账户"

### 第二步：设置日期范围

1. 页面默认显示最近7天的数据
2. 可以自定义开始日期和结束日期
3. 建议不要选择超过30天的范围（数据量大）

### 第三步：查看图表

1. 系统自动加载数据并渲染图表
2. 鼠标悬停在曲线上可查看详细数值
3. 鼠标悬停在标记点上可查看交易信息

### 第四步：分析交易

- **观察趋势**：查看在哪些涨跌幅位置进行了交易
- **对比时机**：分析开仓和平仓的时机是否合理
- **优化策略**：根据历史数据调整未来的交易策略

## 数据来源

### 27币涨跌幅数据

来自 `/api/coin-change-tracker/history` 接口：
- 27个主流币种的实时涨跌幅
- 累计涨跌幅计算
- 每分钟更新一次

### 交易历史数据

来自OKX API：
- 账户的所有历史交易记录
- 包含开仓、平仓、时间、方向等信息
- 通过API Key获取

## 标记说明

### 多单交易

**多单开仓（BUY - 红色圆点）**：
- 预期市场上涨
- 在低位买入
- 希望高位卖出获利

**多单平仓（SELL - 绿色圆点）**：
- 市场达到目标或止损
- 在高位卖出
- 平仓获利或止损

### 空单交易

**空单开仓（BUY - 橙色菱形）**：
- 预期市场下跌
- 在高位做空
- 希望低位平仓获利

**空单平仓（SELL - 青色菱形）**：
- 市场达到目标或止损
- 在低位平仓
- 平仓获利或止损

## 交互功能

### 图表缩放

- **鼠标滚轮**：放大/缩小图表
- **拖拽选区**：选中区域放大
- **双击**：恢复原始视图

### 图例交互

- **点击图例**：显示/隐藏对应的数据系列
- **双击图例**：只显示该数据系列

### Tooltip提示

鼠标悬停在图表上会显示：
- 时间点
- 累计涨跌幅
- 标记点类型（如果有）

## 技术实现

### 前端技术

- **ECharts 5.4.3**：强大的图表库
- **原生JavaScript**：轻量级，无依赖
- **响应式设计**：适配不同屏幕

### 数据处理

```javascript
// 1. 加载趋势数据
const trendData = await fetchTrendData();

// 2. 加载交易数据
const tradesData = await fetchTradesData();

// 3. 合并渲染
renderChart(trendData, tradesData);
```

### 标记点映射

```javascript
// 多单开仓：红色圆点
longBuy: {
    color: '#f56565',
    borderColor: '#c53030',
    symbol: 'circle'
}

// 多单平仓：绿色圆点
longSell: {
    color: '#48bb78',
    borderColor: '#2f855a',
    symbol: 'circle'
}

// 空单开仓：橙色菱形
shortBuy: {
    color: '#ed8936',
    borderColor: '#c05621',
    symbol: 'diamond'
}

// 空单平仓：青色菱形
shortSell: {
    color: '#38b2ac',
    borderColor: '#2c7a7b',
    symbol: 'diamond'
}
```

## 分析案例

### 案例1：追涨策略

**场景**：
- 累计涨跌幅从 -5% 上涨到 +10%
- 在 +5% 时开多单（红点）
- 在 +10% 时平多单（绿点）

**分析**：
- ✅ 成功捕捉上涨趋势
- ✅ 进场时机较好
- ✅ 止盈及时

### 案例2：抄底反弹

**场景**：
- 累计涨跌幅从 +10% 下跌到 -8%
- 在 -8% 时开多单（红点）
- 在 -3% 时平多单（绿点）

**分析**：
- ✅ 成功抄底
- ⚠️ 反弹力度有限
- 💡 建议等待更明确的反转信号

### 案例3：高位做空

**场景**：
- 累计涨跌幅从 +5% 上涨到 +15%
- 在 +15% 时开空单（橙色菱形）
- 在 +10% 时平空单（青色菱形）

**分析**：
- ✅ 成功预判回调
- ✅ 高位做空策略有效
- 💡 继续观察是否有更大回调

## 使用建议

### 新手建议

1. **先观察后交易**
   - 多看几天的历史数据
   - 分析自己的交易时机
   - 找到规律后再交易

2. **小额测试**
   - 先用小额资金测试策略
   - 观察标记点在趋势中的位置
   - 逐步调整交易时机

3. **设置止损**
   - 每次交易都设置止损
   - 不要让亏损扩大
   - 保护本金最重要

### 进阶建议

1. **结合趋势分析**
   - 在上升趋势中做多
   - 在下降趋势中做空
   - 震荡市场少交易

2. **优化进场点**
   - 回调到支撑位做多
   - 反弹到阻力位做空
   - 避免追高杀跌

3. **分批建仓**
   - 不要一次满仓
   - 分2-3次建仓
   - 降低平均成本

### 高手建议

1. **回测优化**
   - 记录每笔交易的原因
   - 定期回顾交易记录
   - 优化交易策略

2. **风险管理**
   - 单笔亏损不超过总资金的2%
   - 设置最大回撤限制
   - 保持资金安全边际

3. **持续改进**
   - 分析成功和失败的交易
   - 总结规律和教训
   - 不断完善交易系统

## 常见问题

### Q1: 为什么看不到标记点？

**A**: 可能的原因：
1. 选择的日期范围内没有交易
2. 账户没有配置API凭证
3. 交易数据还在加载中

**解决方案**：
- 检查是否有历史交易记录
- 确认API凭证配置正确
- 等待数据加载完成

### Q2: 如何切换不同账户？

**A**: 
1. 点击顶部的账户下拉框
2. 选择要查看的账户
3. 系统会自动重新加载该账户的数据

### Q3: 可以查看多长时间的历史？

**A**: 
- 理论上可以查看所有历史
- 建议一次查看不超过30天
- 数据量大时加载会较慢

### Q4: 标记点太多看不清？

**A**: 
- 使用图表缩放功能
- 鼠标滚轮放大查看细节
- 或者缩短日期范围

### Q5: 如何导出数据？

**A**: 
- 当前版本暂不支持导出
- 可以截图保存图表
- 或者在OKX交易页面查看详细记录

## 更新日志

### v1.0 - 2026-02-10

**新增功能**：
- ✅ 27币涨跌幅趋势图展示
- ✅ 多单开仓/平仓标记（红色/绿色圆点）
- ✅ 空单开仓/平仓标记（橙色/青色菱形）
- ✅ 账户选择功能
- ✅ 日期范围筛选
- ✅ 交易统计面板
- ✅ 响应式图例

**技术特性**：
- ✅ 基于ECharts 5.4.3
- ✅ 数据缓存优化
- ✅ 异步加载
- ✅ 错误处理

---

**访问地址**: https://5000-idfgz76cf9poiqtgzfhan-c81df28e.sandbox.novita.ai/okx-trading-marks

**相关页面**:
- OKX交易系统: /okx-trading
- 27币涨跌幅: /coin-change-tracker

**最后更新**: 2026-02-10
