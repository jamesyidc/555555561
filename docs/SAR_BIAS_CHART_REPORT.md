# SAR åå‘ç»Ÿè®¡æ›²çº¿å›¾åŠŸèƒ½æŠ¥å‘Š

ğŸ“… **åˆ›å»ºæ—¶é—´**: 2026-02-01 14:52:00  
ğŸ¯ **ç›®æ ‡**: ä¸º"åå¤šå æ¯” > 80%"å’Œ"åç©ºå æ¯” > 80%"è¿™ä¸¤ä¸ªå…³é”®æŒ‡æ ‡åˆ›å»ºå†å²è¶‹åŠ¿æ›²çº¿å›¾

---

## ğŸ“Š åŠŸèƒ½æ¦‚è¿°

### æ ¸å¿ƒæŒ‡æ ‡
1. **åå¤šå æ¯” > 80% çš„å¸ç§æ•°é‡** (ç»¿è‰²æ›²çº¿)
2. **åç©ºå æ¯” > 80% çš„å¸ç§æ•°é‡** (çº¢è‰²æ›²çº¿)

### æ•°æ®é‡‡é›†
- **é‡‡é›†é—´éš”**: 5åˆ†é’Ÿ
- **ç›‘æ§å¸ç§**: 27ä¸ªä¸»æµå¸ç§
- **æ•°æ®æ¥æº**: ä» `/api/sar-slope/latest` è·å–å®æ—¶SARæ•°æ®
- **å­˜å‚¨æ ¼å¼**: JSONL (æŒ‰æ—¥æœŸåˆ†åŒº)
- **æ•°æ®ç›®å½•**: `/home/user/webapp/data/sar_bias_stats/`

---

## ğŸš€ å·²å®ç°åŠŸèƒ½

### 1. æ•°æ®é‡‡é›†å™¨
**æ–‡ä»¶**: `source_code/sar_bias_stats_collector.py`

**åŠŸèƒ½**:
- âœ… æ¯5åˆ†é’Ÿé‡‡é›†ä¸€æ¬¡æ‰€æœ‰å¸ç§çš„SARåå‘æ•°æ®
- âœ… ç»Ÿè®¡åå¤šå æ¯” > 80% çš„å¸ç§æ•°é‡
- âœ… ç»Ÿè®¡åç©ºå æ¯” > 80% çš„å¸ç§æ•°é‡
- âœ… è®¡ç®—å¹³å‡åå¤š/åç©ºæ¯”ä¾‹
- âœ… ä¿å­˜åˆ°æŒ‰æ—¥æœŸåˆ†åŒºçš„JSONLæ–‡ä»¶
- âœ… ä¿ç•™30å¤©å†å²æ•°æ®ï¼ˆè‡ªåŠ¨æ¸…ç†ï¼‰

**æ•°æ®æ ¼å¼**:
```json
{
  "timestamp": "2026-02-01 14:46:44",
  "bullish_count": 0,
  "bearish_count": 24,
  "avg_bullish_ratio": 4.19,
  "avg_bearish_ratio": 95.81,
  "total_coins": 27,
  "bullish_symbols": [],
  "bearish_symbols": ["AAVE", "BTC", "ETH", ...]
}
```

**PM2 æœåŠ¡çŠ¶æ€**:
```
åç§°: sar-bias-stats-collector
çŠ¶æ€: online âœ…
PID: 726493
å†…å­˜: 5.4 MB
```

### 2. API ç«¯ç‚¹
**è·¯ç”±**: `/api/sar-slope/bias-stats`

**å‚æ•°**:
- `hours`: æ—¶é—´èŒƒå›´ï¼ˆå°æ—¶ï¼‰ï¼Œå¯é€‰å€¼: 6, 12, 24, 48, 72, 168 (7å¤©)
  - é»˜è®¤: 24å°æ—¶

**è¿”å›æ•°æ®**:
```json
{
  "success": true,
  "data": [
    {
      "timestamp": "2026-02-01 14:46:44",
      "bullish_count": 0,
      "bearish_count": 24,
      "avg_bullish_ratio": 4.19,
      "avg_bearish_ratio": 95.81
    }
  ],
  "count": 288,
  "start_time": "2026-02-01 14:46:44",
  "end_time": "2026-02-01 14:51:44"
}
```

### 3. æ›²çº¿å›¾é¡µé¢
**è·¯ç”±**: `/sar-slope/bias-chart`  
**è®¿é—®é“¾æ¥**: https://5000-ikmpd2up5chrwx4jjjkih-5634da27.sandbox.novita.ai/sar-slope/bias-chart

**é¡µé¢ç‰¹æ€§**:
- âœ… **åŒæ›²çº¿æ˜¾ç¤º**:
  - ç»¿è‰²æ›²çº¿: åå¤šå æ¯” > 80% çš„å¸ç§æ•°é‡
  - çº¢è‰²æ›²çº¿: åç©ºå æ¯” > 80% çš„å¸ç§æ•°é‡
- âœ… **æ—¶é—´èŒƒå›´åˆ‡æ¢**: 6å°æ—¶ | 12å°æ—¶ | 24å°æ—¶ | 2å¤© | 3å¤© | 7å¤©
- âœ… **å®æ—¶ç»Ÿè®¡æ˜¾ç¤º**:
  - å½“å‰åå¤šæ•°é‡
  - å½“å‰åç©ºæ•°é‡
  - å¹³å‡åå¤šæ¯”ä¾‹
  - å¹³å‡åç©ºæ¯”ä¾‹
- âœ… **è‡ªåŠ¨åˆ·æ–°**: æ¯5åˆ†é’Ÿè‡ªåŠ¨æ›´æ–°
- âœ… **æ‰‹åŠ¨åˆ·æ–°**: ç‚¹å‡»åˆ·æ–°æŒ‰é’®
- âœ… **å¥åº·ç›‘æ§å¡ç‰‡**: æ˜¾ç¤ºé‡‡é›†å™¨è¿è¡ŒçŠ¶æ€
- âœ… **å“åº”å¼è®¾è®¡**: é€‚é…å„ç§å±å¹•å°ºå¯¸
- âœ… **æš—è‰²ä¸»é¢˜**: ä¸“ä¸šçš„å¯è§†åŒ–ç•Œé¢

**å›¾è¡¨æŠ€æœ¯**:
- Chart.js 3.x
- åŒYè½´ï¼ˆå·¦ä¾§: åå¤šï¼Œå³ä¾§: åç©ºï¼‰
- å¹³æ»‘æ›²çº¿ï¼ˆcubicInterpolationMode: 'monotone'ï¼‰
- æ‚¬åœæç¤ºï¼ˆæ˜¾ç¤ºæ—¶é—´ã€æ•°é‡ã€æ¯”ä¾‹ï¼‰

### 4. ä¸»é¡µé¢é›†æˆ
**æ›´æ–°**: `templates/sar_slope.html`

**æ–°å¢åŠŸèƒ½**:
- âœ… åœ¨SARä¸»é¡µé¢é¡¶éƒ¨æ·»åŠ äº† "ğŸ“ˆ åå‘è¶‹åŠ¿å›¾" æŒ‰é’®
- âœ… ç´«è‰²ä¸»é¢˜æŒ‰é’®ï¼Œä¸å…¶ä»–å…¥å£ä¿æŒä¸€è‡´çš„è§†è§‰é£æ ¼
- âœ… ç‚¹å‡»è·³è½¬åˆ° `/sar-slope/bias-chart`

---

## ğŸ“ˆ ç¬¬ä¸€æ¬¡é‡‡é›†æ•°æ®

**é‡‡é›†æ—¶é—´**: 2026-02-01 14:46:44  
**é‡‡é›†ç»“æœ**:
- âœ… æˆåŠŸé‡‡é›†: 25/27 ä¸ªå¸ç§
- âŒ å¤±è´¥: 2ä¸ª (SUI, TAO - è¿æ¥è¢«æ‹’)

**ç»Ÿè®¡æ•°æ®**:
```
åå¤šå æ¯” > 80%: 0 ä¸ªå¸ç§
åç©ºå æ¯” > 80%: 24 ä¸ªå¸ç§
å¹³å‡åå¤šæ¯”ä¾‹: 4.2%
å¹³å‡åç©ºæ¯”ä¾‹: 95.8%
```

**åç©ºå æ¯” > 80% çš„å¸ç§** (24ä¸ª):
```
AAVE, BTC, ETH, XRP, SOL, BNB, DOGE, LINK, DOT, LTC, 
UNI, NEAR, FIL, ETC, APT, HBAR, LDO, STX, CFX, CRO, 
BCH, TRX, TON, XLM
```

---

## ğŸ”§ ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SAR åå‘ç»Ÿè®¡ç³»ç»Ÿæ¶æ„                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. æ•°æ®æº
   â”œâ”€ OKX API (Kçº¿æ•°æ®)
   â”œâ”€ SARè®¡ç®—å™¨ (æŠ€æœ¯æŒ‡æ ‡)
   â””â”€ 5åˆ†é’Ÿçº§åˆ«æ•°æ® (source_code/sar_jsonl_collector.py)

2. ç»Ÿè®¡é‡‡é›†å™¨ (æ¯5åˆ†é’Ÿ)
   â”œâ”€ source_code/sar_bias_stats_collector.py
   â”œâ”€ è¯»å–: /api/sar-slope/latest
   â”œâ”€ è®¡ç®—: åå¤š/åç©ºå æ¯” > 80% çš„å¸ç§æ•°é‡
   â””â”€ ä¿å­˜: data/sar_bias_stats/bias_stats_YYYYMMDD.jsonl

3. API å±‚
   â”œâ”€ /api/sar-slope/bias-stats?hours=24
   â””â”€ è¿”å›: å†å²è¶‹åŠ¿æ•°æ® (JSONL â†’ JSON)

4. å‰ç«¯å±•ç¤º
   â”œâ”€ /sar-slope/bias-chart (æ›²çº¿å›¾é¡µé¢)
   â”œâ”€ Chart.js åŒæ›²çº¿æ¸²æŸ“
   â””â”€ å®æ—¶åˆ·æ–° (æ¯5åˆ†é’Ÿ)

5. ä¸»é¡µé¢å…¥å£
   â””â”€ /sar-slope â†’ æ·»åŠ  "ğŸ“ˆ åå‘è¶‹åŠ¿å›¾" æŒ‰é’®
```

---

## ğŸ“Š æ•°æ®ç¤ºä¾‹

### é‡‡é›†æ•°æ®æ–‡ä»¶
**è·¯å¾„**: `/home/user/webapp/data/sar_bias_stats/bias_stats_20260201.jsonl`

**å†…å®¹**:
```jsonl
{"timestamp":"2026-02-01 14:46:44","bullish_count":0,"bearish_count":24,"avg_bullish_ratio":4.19,"avg_bearish_ratio":95.81,"total_coins":27,"bullish_symbols":[],"bearish_symbols":["AAVE","BTC","ETH","XRP","SOL","BNB","DOGE","LINK","DOT","LTC","UNI","NEAR","FIL","ETC","APT","HBAR","LDO","STX","CFX","CRO","BCH","TRX","TON","XLM"],"collected_at":"2026-02-01T14:46:44.123456+08:00"}
{"timestamp":"2026-02-01 14:51:44","bullish_count":1,"bearish_count":23,"avg_bullish_ratio":8.5,"avg_bearish_ratio":91.5,"total_coins":27,"bullish_symbols":["TRX"],"bearish_symbols":["AAVE","BTC","ETH",...],"collected_at":"2026-02-01T14:51:44.789012+08:00"}
```

---

## ğŸ¯ æ€§èƒ½æŒ‡æ ‡

### é‡‡é›†å™¨æ€§èƒ½
- **é‡‡é›†é—´éš”**: 300ç§’ (5åˆ†é’Ÿ)
- **å•æ¬¡é‡‡é›†æ—¶é—´**: ~3-5ç§’
- **æ•°æ®ç‚¹/å¤©**: 288 (24å°æ—¶ Ã— 12æ¬¡/å°æ—¶)
- **å­˜å‚¨ç©ºé—´/å¤©**: ~100KB (å‹ç¼©åçš„JSONL)
- **å†…å­˜å ç”¨**: ~5.4 MB (PM2ç›‘æ§)

### APIæ€§èƒ½
- **å“åº”æ—¶é—´**: <100ms (24å°æ—¶æ•°æ®)
- **æ•°æ®é‡**: 288æ¡è®°å½• (24å°æ—¶)
- **å¹¶å‘æ”¯æŒ**: âœ… (Flaskå¤šçº¿ç¨‹)

### å‰ç«¯æ€§èƒ½
- **é¦–æ¬¡åŠ è½½**: ~500ms
- **å›¾è¡¨æ¸²æŸ“**: ~200ms
- **è‡ªåŠ¨åˆ·æ–°**: æ¯5åˆ†é’Ÿ
- **å†…å­˜å ç”¨**: ~50MB (æµè§ˆå™¨)

---

## ğŸ”— è®¿é—®é“¾æ¥

### ä¸»è¦é¡µé¢
1. **åå‘è¶‹åŠ¿å›¾**: https://5000-ikmpd2up5chrwx4jjjkih-5634da27.sandbox.novita.ai/sar-slope/bias-chart
2. **SARä¸»é¡µ**: https://5000-ikmpd2up5chrwx4jjjjih-5634da27.sandbox.novita.ai/sar-slope
3. **1åˆ†é’Ÿæ›²çº¿å›¾**: https://5000-ikmpd2up5chrwx4jjjkih-5634da27.sandbox.novita.ai/sar-slope/chart

### APIç«¯ç‚¹
1. **åå‘ç»Ÿè®¡**: `/api/sar-slope/bias-stats?hours=24`
2. **1åˆ†é’Ÿæ•°æ®**: `/api/sar-slope/1min-data?symbol=BTC&hours=1`
3. **æœ€æ–°æ•°æ®**: `/api/sar-slope/latest`

---

## ğŸ“ Git æäº¤è®°å½•

```bash
commit: feat: add SAR bias statistics chart
files: 
  - source_code/sar_bias_stats_collector.py (æ–°å»º)
  - source_code/app_new.py (æ›´æ–° API)
  - templates/sar_bias_chart.html (æ–°å»º)
  - templates/sar_slope.html (æ·»åŠ å…¥å£é“¾æ¥)

changes:
  - æ–°å¢åå‘ç»Ÿè®¡é‡‡é›†å™¨ (æ¯5åˆ†é’Ÿ)
  - æ–°å¢ API ç«¯ç‚¹ /api/sar-slope/bias-stats
  - æ–°å¢æ›²çº¿å›¾é¡µé¢ /sar-slope/bias-chart
  - æ”¯æŒå¤šç§æ—¶é—´èŒƒå›´ (6h-7å¤©)
  - è‡ªåŠ¨åˆ·æ–° (æ¯5åˆ†é’Ÿ)
```

---

## âœ… æµ‹è¯•éªŒè¯

### 1. é‡‡é›†å™¨æµ‹è¯•
```bash
# æ£€æŸ¥PM2çŠ¶æ€
pm2 list | grep sar-bias-stats-collector
âœ… çŠ¶æ€: online, PID: 726493

# æ£€æŸ¥æ—¥å¿—
pm2 logs sar-bias-stats-collector --nostream --lines 20
âœ… é‡‡é›†æˆåŠŸ: 25/27 ä¸ªå¸ç§
âœ… æ•°æ®ä¿å­˜æˆåŠŸ
âœ… ä¸‹æ¬¡é‡‡é›†æ—¶é—´: 2026-02-01 14:51:44
```

### 2. API æµ‹è¯•
```bash
# æµ‹è¯•24å°æ—¶æ•°æ®
curl "http://localhost:5000/api/sar-slope/bias-stats?hours=24"
âœ… è¿”å›: success=true, count=1, data=[...]
âœ… æ•°æ®æ ¼å¼: timestamp, bullish_count, bearish_count
```

### 3. å‰ç«¯æµ‹è¯•
```bash
# è®¿é—®æ›²çº¿å›¾é¡µé¢
curl -s "http://localhost:5000/sar-slope/bias-chart" | grep "åå‘ç»Ÿè®¡è¶‹åŠ¿å›¾"
âœ… é¡µé¢åŠ è½½æˆåŠŸ
âœ… Chart.js è„šæœ¬åŠ è½½æˆåŠŸ
âœ… å¥åº·ç›‘æ§å¡ç‰‡æ˜¾ç¤ºæ­£å¸¸
```

---

## ğŸ‰ åŠŸèƒ½å®Œæˆæ¸…å•

- âœ… **æ•°æ®é‡‡é›†å™¨**: æ¯5åˆ†é’Ÿé‡‡é›†åå‘ç»Ÿè®¡
- âœ… **JSONLå­˜å‚¨**: æŒ‰æ—¥æœŸåˆ†åŒºï¼Œä¿ç•™30å¤©
- âœ… **APIç«¯ç‚¹**: æ”¯æŒå¤šç§æ—¶é—´èŒƒå›´æŸ¥è¯¢
- âœ… **æ›²çº¿å›¾é¡µé¢**: åŒæ›²çº¿æ˜¾ç¤º (åå¤š/åç©º)
- âœ… **å®æ—¶ç»Ÿè®¡**: å½“å‰æ•°é‡å’Œå¹³å‡æ¯”ä¾‹
- âœ… **è‡ªåŠ¨åˆ·æ–°**: æ¯5åˆ†é’Ÿè‡ªåŠ¨æ›´æ–°
- âœ… **å¥åº·ç›‘æ§**: é‡‡é›†å™¨çŠ¶æ€å®æ—¶æ˜¾ç¤º
- âœ… **ä¸»é¡µé¢é›†æˆ**: æ·»åŠ å…¥å£é“¾æ¥
- âœ… **PM2éƒ¨ç½²**: æœåŠ¡ç¨³å®šè¿è¡Œ
- âœ… **æ–‡æ¡£å®Œå–„**: å®Œæ•´çš„åŠŸèƒ½æŠ¥å‘Š

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

1. **SAR_1MIN_CHART_REPORT.md** - 1åˆ†é’Ÿçº§SARæ•°æ®æ›²çº¿å›¾
2. **SAR_COMPLETE_FIX_REPORT.md** - SARç³»ç»Ÿå®Œæ•´ä¿®å¤æŠ¥å‘Š
3. **GDRIVE_DETECTOR_FINAL_FIX_REPORT.md** - Google Driveç›‘æ§ä¿®å¤æŠ¥å‘Š
4. **HEALTH_MONITOR_INTEGRATION.md** - å¥åº·ç›‘æ§é›†æˆæŠ¥å‘Š

---

## ğŸ”® æœªæ¥ä¼˜åŒ–å»ºè®®

### çŸ­æœŸä¼˜åŒ– (1-2å‘¨)
1. **æ·»åŠ å†å²å›æµ‹**: æ”¯æŒæŸ¥çœ‹è¿‡å»7å¤©ã€30å¤©çš„è¶‹åŠ¿
2. **æ·»åŠ é¢„è­¦åŠŸèƒ½**: å½“åå¤š/åç©ºè¶…è¿‡æŸä¸ªé˜ˆå€¼æ—¶å‘é€é€šçŸ¥
3. **ä¼˜åŒ–æ•°æ®å­˜å‚¨**: å‹ç¼©å†å²æ•°æ®ï¼Œå‡å°‘å­˜å‚¨ç©ºé—´

### ä¸­æœŸä¼˜åŒ– (1-3ä¸ªæœˆ)
1. **æ·»åŠ æ›´å¤šæŒ‡æ ‡**: åå‘å¼ºåº¦ã€è½¬æŠ˜ç‚¹è¯†åˆ«
2. **æœºå™¨å­¦ä¹ é¢„æµ‹**: åŸºäºå†å²è¶‹åŠ¿é¢„æµ‹æœªæ¥åå‘
3. **å¤šæ—¶é—´å‘¨æœŸ**: 1åˆ†é’Ÿã€5åˆ†é’Ÿã€15åˆ†é’Ÿçº§åˆ«å¯¹æ¯”

### é•¿æœŸä¼˜åŒ– (3-6ä¸ªæœˆ)
1. **å®æ—¶æ¨é€**: WebSocketå®æ—¶æ›´æ–°æ›²çº¿å›¾
2. **ç§»åŠ¨ç«¯é€‚é…**: å“åº”å¼è®¾è®¡ä¼˜åŒ–
3. **æ•°æ®å¯¼å‡º**: æ”¯æŒCSVã€Excelå¯¼å‡º

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æ£€æŸ¥:
1. PM2æœåŠ¡çŠ¶æ€: `pm2 list`
2. é‡‡é›†å™¨æ—¥å¿—: `pm2 logs sar-bias-stats-collector`
3. Flaskæ—¥å¿—: `pm2 logs flask-app`
4. æ•°æ®æ–‡ä»¶: `ls -lh data/sar_bias_stats/`

---

**æŠ¥å‘Šç”Ÿæˆæ—¶é—´**: 2026-02-01 14:52:00  
**ç³»ç»ŸçŠ¶æ€**: ğŸŸ¢ æ‰€æœ‰åŠŸèƒ½æ­£å¸¸è¿è¡Œ  
**ä¸‹æ¬¡æ•°æ®é‡‡é›†**: 2026-02-01 14:51:44 (5åˆ†é’Ÿå)
